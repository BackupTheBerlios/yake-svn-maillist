From codeandroid at berlios.de  Tue Jul  4 22:58:09 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Tue, 4 Jul 2006 22:58:09 +0200
Subject: [Yake-svn] r1366 - in trunk/yake/scripts/msvc8: . plugins/graphics plugins/gui plugins/physics
Message-ID: <200607042058.k64Kw9MP017397@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-04 22:58:08 +0200 (Tue, 04 Jul 2006)
New Revision: 1366

Modified:
   trunk/yake/scripts/msvc8/data.vcproj
   trunk/yake/scripts/msvc8/net.vcproj
   trunk/yake/scripts/msvc8/plugins/graphics/graphicsOgre.vcproj
   trunk/yake/scripts/msvc8/plugins/gui/ceguiOgreRendererAdapter.vcproj
   trunk/yake/scripts/msvc8/plugins/physics/terrainPhysMgr.vcproj
   trunk/yake/scripts/msvc8/yake.sln
Log:
fixed various settings

Modified: trunk/yake/scripts/msvc8/data.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/data.vcproj	2006-06-25 18:15:03 UTC (rev 1365)
+++ trunk/yake/scripts/msvc8/data.vcproj	2006-07-04 20:58:08 UTC (rev 1366)
@@ -123,7 +123,7 @@
 			<Tool
 				Name="VCCLCompilerTool"
 				AdditionalIncludeDirectories="../../;../../dependencies/boost/;../../dependencies/ttl/;..dependencies/tinyxml"
-				PreprocessorDefinitions="WIN32;NDEBUG;_WINDOWS;_USRDLL;YAKE_DATA_EXPORTS"
+				PreprocessorDefinitions="WIN32;NDEBUG;_WINDOWS;_USRDLL;YAKE_DATA_EXPORTS;_CRT_SECURE_NO_DEPRECATE"
 				RuntimeLibrary="2"
 				RuntimeTypeInfo="true"
 				UsePrecompiledHeader="2"

Modified: trunk/yake/scripts/msvc8/net.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/net.vcproj	2006-06-25 18:15:03 UTC (rev 1365)
+++ trunk/yake/scripts/msvc8/net.vcproj	2006-07-04 20:58:08 UTC (rev 1366)
@@ -124,7 +124,7 @@
 			/>
 			<Tool
 				Name="VCCLCompilerTool"
-				AdditionalIncludeDirectories="../../;../../dependencies/boost/;../../dependencies/ttl/;..dependencies/tinyxml"
+				AdditionalIncludeDirectories="../../;../../dependencies/enet/include;../../dependencies/boost/;../../dependencies/ttl/;..dependencies/tinyxml"
 				PreprocessorDefinitions="WIN32;NDEBUG;_WINDOWS;_USRDLL;YAKE_NET_EXPORTS"
 				RuntimeLibrary="2"
 				RuntimeTypeInfo="true"
@@ -252,6 +252,14 @@
 							UsePrecompiledHeader="0"
 						/>
 					</FileConfiguration>
+					<FileConfiguration
+						Name="Release|Win32"
+						>
+						<Tool
+							Name="VCCLCompilerTool"
+							UsePrecompiledHeader="0"
+						/>
+					</FileConfiguration>
 				</File>
 				<File
 					RelativePath="..\..\dependencies\enet\host.c"
@@ -264,6 +272,14 @@
 							UsePrecompiledHeader="0"
 						/>
 					</FileConfiguration>
+					<FileConfiguration
+						Name="Release|Win32"
+						>
+						<Tool
+							Name="VCCLCompilerTool"
+							UsePrecompiledHeader="0"
+						/>
+					</FileConfiguration>
 				</File>
 				<File
 					RelativePath="..\..\dependencies\enet\list.c"
@@ -276,6 +292,14 @@
 							UsePrecompiledHeader="0"
 						/>
 					</FileConfiguration>
+					<FileConfiguration
+						Name="Release|Win32"
+						>
+						<Tool
+							Name="VCCLCompilerTool"
+							UsePrecompiledHeader="0"
+						/>
+					</FileConfiguration>
 				</File>
 				<File
 					RelativePath="..\..\dependencies\enet\packet.c"
@@ -288,6 +312,14 @@
 							UsePrecompiledHeader="0"
 						/>
 					</FileConfiguration>
+					<FileConfiguration
+						Name="Release|Win32"
+						>
+						<Tool
+							Name="VCCLCompilerTool"
+							UsePrecompiledHeader="0"
+						/>
+					</FileConfiguration>
 				</File>
 				<File
 					RelativePath="..\..\dependencies\enet\peer.c"
@@ -300,6 +332,14 @@
 							UsePrecompiledHeader="0"
 						/>
 					</FileConfiguration>
+					<FileConfiguration
+						Name="Release|Win32"
+						>
+						<Tool
+							Name="VCCLCompilerTool"
+							UsePrecompiledHeader="0"
+						/>
+					</FileConfiguration>
 				</File>
 				<File
 					RelativePath="..\..\dependencies\enet\protocol.c"
@@ -312,6 +352,14 @@
 							UsePrecompiledHeader="0"
 						/>
 					</FileConfiguration>
+					<FileConfiguration
+						Name="Release|Win32"
+						>
+						<Tool
+							Name="VCCLCompilerTool"
+							UsePrecompiledHeader="0"
+						/>
+					</FileConfiguration>
 				</File>
 				<File
 					RelativePath="..\..\dependencies\enet\win32.c"

Modified: trunk/yake/scripts/msvc8/plugins/graphics/graphicsOgre.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/plugins/graphics/graphicsOgre.vcproj	2006-06-25 18:15:03 UTC (rev 1365)
+++ trunk/yake/scripts/msvc8/plugins/graphics/graphicsOgre.vcproj	2006-07-04 20:58:08 UTC (rev 1366)
@@ -125,8 +125,9 @@
 			/>
 			<Tool
 				Name="VCCLCompilerTool"
+				AdditionalOptions="-Zm120"
 				AdditionalIncludeDirectories="../../../../dependencies/oSceneLoaderLib/TinyXML;../../../../dependencies/oSceneLoaderLib/include;../../../../;../../../../dependencies/ttl/;../../../../dependencies/boost/;../../../../dependencies/ogrenew/OgreMain/include"
-				PreprocessorDefinitions="WIN32;NDEBUG;_WINDOWS;_USRDLL;YAKE_GRAPHICSCONCRETEAPI_EXPORTS"
+				PreprocessorDefinitions="WIN32;NDEBUG;_WINDOWS;_USRDLL;YAKE_GRAPHICSCONCRETEAPI_EXPORTS;_CRT_SECURE_NO_DEPRECATE"
 				RuntimeLibrary="2"
 				RuntimeTypeInfo="true"
 				UsePrecompiledHeader="2"

Modified: trunk/yake/scripts/msvc8/plugins/gui/ceguiOgreRendererAdapter.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/plugins/gui/ceguiOgreRendererAdapter.vcproj	2006-06-25 18:15:03 UTC (rev 1365)
+++ trunk/yake/scripts/msvc8/plugins/gui/ceguiOgreRendererAdapter.vcproj	2006-07-04 20:58:08 UTC (rev 1366)
@@ -124,7 +124,8 @@
 			/>
 			<Tool
 				Name="VCCLCompilerTool"
-				AdditionalIncludeDirectories="../../../../;../../../../dependencies/ttl/;../../../../dependencies/boost/;../../../../dependencies/ogrenew/;../../../../dependencies/ogrenew/OgreMain/include;../../../../dependencies/cegui_mk2/CEGUI;../../../../dependencies/ogrenew/CEGUIRenderer/include"
+				AdditionalOptions="-Zm135"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/ttl/;../../../../dependencies/boost/;../../../../dependencies/ogrenew/;../../../../dependencies/ogrenew/OgreMain/include;../../../../dependencies/cegui_mk2;../../../../dependencies/ogrenew/CEGUIRenderer/include"
 				PreprocessorDefinitions="WIN32;NDEBUG;_WINDOWS;_USRDLL;YAKE_CEGUIRENDERERADAPTER_OGRE_EXPORTS"
 				RuntimeLibrary="2"
 				UsePrecompiledHeader="2"
@@ -147,7 +148,7 @@
 				AdditionalDependencies="OgreMain.lib yapp.lib CEGUIBase.lib OgreGUIRenderer.lib"
 				OutputFile="$(OutDir)/$(ProjectName).dll"
 				LinkIncremental="1"
-				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/ogrenew/OgreMain/lib/Release;../../../../dependencies/cegui_mk2/lib/;../../../../dependencies/ogrenew/CEGUIRenderer/lib/release;../../../../dependencies/lib"
+				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/ogrenew/OgreMain/lib/release;../../../../dependencies/cegui_mk2/lib/;../../../../dependencies/ogrenew/CEGUIRenderer/lib;../../../../dependencies/lib"
 				ModuleDefinitionFile="../../../../src/yapp/plugins/ceguiOgreRendererAdapter/plugin.def"
 				GenerateDebugInformation="false"
 				SubSystem="2"

Modified: trunk/yake/scripts/msvc8/plugins/physics/terrainPhysMgr.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/plugins/physics/terrainPhysMgr.vcproj	2006-06-25 18:15:03 UTC (rev 1365)
+++ trunk/yake/scripts/msvc8/plugins/physics/terrainPhysMgr.vcproj	2006-07-04 20:58:08 UTC (rev 1366)
@@ -124,7 +124,7 @@
 			/>
 			<Tool
 				Name="VCCLCompilerTool"
-				AdditionalIncludeDirectories="../../../../;../../../../dependencies/ttl/;../../../../dependencies/boost/;../../../../dependencies/ode/include;../../../../dependencies/ogrenew/ogremain/include"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/ttl/;../../../../dependencies/boost/;../../../../dependencies/ode/include;../../../../dependencies/ogrenew/ogremain/include;../../../..\dependencies\ogreaddons\paginglandscape\PlugIns\PagingLandScape2\include"
 				PreprocessorDefinitions="WIN32;NDEBUG;_WINDOWS;_USRDLL;YAKEPHYSICSODE_PLSM_EXPORTS"
 				RuntimeLibrary="2"
 				RuntimeTypeInfo="true"
@@ -145,10 +145,10 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="ode.lib physics.lib"
+				AdditionalDependencies="yapp.lib ode.lib physics.lib ogremain.lib Plugin_PagingLandScapeSceneManager2.lib"
 				OutputFile="$(OutDir)/$(ProjectName).dll"
 				LinkIncremental="1"
-				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/ode/lib/releasedll;../../../../dependencies/lib"
+				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/ode/lib/releasedll;../../../../dependencies/lib;&quot;../../../../dependencies/ogrenew/ogremain/lib/$(ConfigurationName)&quot;;&quot;../../../../dependencies/ogreaddons/paginglandscape/plugins/paginglandscape2/bin/$(ConfigurationName)&quot;"
 				GenerateDebugInformation="false"
 				SubSystem="2"
 				OptimizeReferences="2"

Modified: trunk/yake/scripts/msvc8/yake.sln
===================================================================
--- trunk/yake/scripts/msvc8/yake.sln	2006-06-25 18:15:03 UTC (rev 1365)
+++ trunk/yake/scripts/msvc8/yake.sln	2006-07-04 20:58:08 UTC (rev 1366)
@@ -1,5 +1,5 @@
 Microsoft Visual Studio Solution File, Format Version 9.00
-# Visual Studio 2005
+# Visual C++ Express 2005
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "base", "base.vcproj", "{D29771DD-715F-452B-B71C-911BACF5956D}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "graphics", "graphics.vcproj", "{ECC8FA24-93AC-4659-8EBD-26B6F418AC64}"
@@ -134,6 +134,16 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "loader", "loader.vcproj", "{2E5A589E-41FE-4BE9-80A0-1F8570944486}"
 EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "samplePhysicsDemo", "samples\physics\samplePhysicsDemo.vcproj", "{3DA99679-404B-44C7-9267-C97D066F3D96}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleCar", "samples\misc\sampleCar.vcproj", "{EE77E955-42BD-47A4-BDC6-D92759F45D01}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRoServer", "samples\net\sampleRoServer.vcproj", "{547611C2-43E2-4678-B8E9-92CF69770C40}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRoClient", "samples\net\sampleRoClient.vcproj", "{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleNetPacket", "samples\net\sampleNetPacket.vcproj", "{5473599B-AB7B-4259-B052-4DDC68CBEA54}"
+EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) = preSolution
 		Debug|Win32 = Debug|Win32
@@ -262,6 +272,26 @@
 		{2E5A589E-41FE-4BE9-80A0-1F8570944486}.Debug|Win32.Build.0 = Debug|Win32
 		{2E5A589E-41FE-4BE9-80A0-1F8570944486}.Release|Win32.ActiveCfg = Release|Win32
 		{2E5A589E-41FE-4BE9-80A0-1F8570944486}.Release|Win32.Build.0 = Release|Win32
+		{3DA99679-404B-44C7-9267-C97D066F3D96}.Debug|Win32.ActiveCfg = Debug|Win32
+		{3DA99679-404B-44C7-9267-C97D066F3D96}.Debug|Win32.Build.0 = Debug|Win32
+		{3DA99679-404B-44C7-9267-C97D066F3D96}.Release|Win32.ActiveCfg = Release|Win32
+		{3DA99679-404B-44C7-9267-C97D066F3D96}.Release|Win32.Build.0 = Release|Win32
+		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Debug|Win32.ActiveCfg = Debug|Win32
+		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Debug|Win32.Build.0 = Debug|Win32
+		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Release|Win32.ActiveCfg = Release|Win32
+		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Release|Win32.Build.0 = Release|Win32
+		{547611C2-43E2-4678-B8E9-92CF69770C40}.Debug|Win32.ActiveCfg = Debug|Win32
+		{547611C2-43E2-4678-B8E9-92CF69770C40}.Debug|Win32.Build.0 = Debug|Win32
+		{547611C2-43E2-4678-B8E9-92CF69770C40}.Release|Win32.ActiveCfg = Release|Win32
+		{547611C2-43E2-4678-B8E9-92CF69770C40}.Release|Win32.Build.0 = Release|Win32
+		{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}.Debug|Win32.ActiveCfg = Debug|Win32
+		{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}.Debug|Win32.Build.0 = Debug|Win32
+		{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}.Release|Win32.ActiveCfg = Release|Win32
+		{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}.Release|Win32.Build.0 = Release|Win32
+		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Debug|Win32.ActiveCfg = Debug|Win32
+		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Debug|Win32.Build.0 = Debug|Win32
+		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Release|Win32.ActiveCfg = Release|Win32
+		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Release|Win32.Build.0 = Release|Win32
 	EndGlobalSection
 	GlobalSection(SolutionProperties) = preSolution
 		HideSolutionNode = FALSE



From codeandroid at berlios.de  Tue Jul  4 23:11:40 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Tue, 4 Jul 2006 23:11:40 +0200
Subject: [Yake-svn] r1367 - trunk/yake/src/yake/plugins/scriptingLua
Message-ID: <200607042111.k64LBeYO018345@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-04 23:11:40 +0200 (Tue, 04 Jul 2006)
New Revision: 1367

Modified:
   trunk/yake/src/yake/plugins/scriptingLua/ScriptingSystemLua.cpp
Log:
Lua 5.1.1 compatibility

Modified: trunk/yake/src/yake/plugins/scriptingLua/ScriptingSystemLua.cpp
===================================================================
--- trunk/yake/src/yake/plugins/scriptingLua/ScriptingSystemLua.cpp	2006-07-04 20:58:08 UTC (rev 1366)
+++ trunk/yake/src/yake/plugins/scriptingLua/ScriptingSystemLua.cpp	2006-07-04 21:11:40 UTC (rev 1367)
@@ -56,7 +56,14 @@
 		if (IS_MASK_SET(libs, LUALIB_TABLE))
 			luaopen_table( mLuaState );
 		if (IS_MASK_SET(libs, LUALIB_IO))
-			luaopen_io( mLuaState );
+		{
+			// See linit.c and the Lua mailing list for more information why
+			// we have to load the IO lib this way instead of via luaopen_io().
+			//luaopen_io( mLuaState ); <= do *not* use.
+			lua_pushcfunction(mLuaState, luaopen_io);
+			lua_pushstring(mLuaState, "io");
+			lua_call(mLuaState, 1, 0);
+		}
 		if (IS_MASK_SET(libs, LUALIB_STRING))
 			luaopen_string( mLuaState );
 		if (IS_MASK_SET(libs, LUALIB_MATH))
@@ -81,7 +88,7 @@
 	void LuaVM::execute( const String & rData )
 	{
 		if (mLuaState)
-			lua_dostring( mLuaState, rData.c_str() );
+			luaL_dostring( mLuaState, rData.c_str() );
 	}
 
 	//------------------------------------------------------
@@ -95,7 +102,7 @@
 
 		const String& rFileName = pLuaScript->getData();
 
-		lua_dofile( mLuaState, rFileName.c_str() ); 
+		luaL_dofile( mLuaState, rFileName.c_str() ); 
 	}
 
 	//------------------------------------------------------



From codeandroid at berlios.de  Tue Jul  4 23:12:46 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Tue, 4 Jul 2006 23:12:46 +0200
Subject: [Yake-svn] r1368 - in trunk/yake: src/yake/net/detail src/yake/plugins/physicsODE yake/net
Message-ID: <200607042112.k64LCkf8018422@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-04 23:12:45 +0200 (Tue, 04 Jul 2006)
New Revision: 1368

Modified:
   trunk/yake/src/yake/net/detail/netEventConnection.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeActor.cpp
   trunk/yake/yake/net/netBitstream.h
   trunk/yake/yake/net/netBitstream.inl
   trunk/yake/yake/net/netBitstreamAdapters.h
   trunk/yake/yake/net/netEvent.h
   trunk/yake/yake/net/netPrerequisites.h
Log:
new bit stream implementation

Modified: trunk/yake/src/yake/net/detail/netEventConnection.cpp
===================================================================
--- trunk/yake/src/yake/net/detail/netEventConnection.cpp	2006-07-04 21:11:40 UTC (rev 1367)
+++ trunk/yake/src/yake/net/detail/netEventConnection.cpp	2006-07-04 21:12:45 UTC (rev 1368)
@@ -140,7 +140,7 @@
 			return;
 
 		bitstream_data data; // data container
-		bitstream_sink dataSink(data); // sink adapter
+		bitstream_sink dataSink(&data); // sink adapter
 		obitstream out(&dataSink); // stream interface
 
 		out.write( evt.id(), sizeof(NetEvent::id_type)*8 ) ;
@@ -167,7 +167,7 @@
 			data[i] = ((const uint8*)(dataPtr))[i];
 
 		// attach stream
-		bitstream_source dataSource(data);
+		bitstream_source dataSource(&data);
 		ibitstream in(&dataSource);
 
 		// extract event id

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeActor.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeActor.cpp	2006-07-04 21:11:40 UTC (rev 1367)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeActor.cpp	2006-07-04 21:12:45 UTC (rev 1368)
@@ -283,7 +283,7 @@
 		// if materials are not supposed to produce any contact forces
 		// This is the case if we just want some collision detection and without
 		// any contact joints...
-		if ( pMatA == NULL || pMatB == NULL )
+		if ( !pMatA || !pMatB )
 		{
 #ifdef DEBUG_COLLISIONS
 			YAKE_LOG( "collision detection without materials..." );

Modified: trunk/yake/yake/net/netBitstream.h
===================================================================
--- trunk/yake/yake/net/netBitstream.h	2006-07-04 21:11:40 UTC (rev 1367)
+++ trunk/yake/yake/net/netBitstream.h	2006-07-04 21:12:45 UTC (rev 1368)
@@ -1,93 +1,540 @@
 #ifndef NET_BITSTREAM_H
 #define NET_BITSTREAM_H
 
-#include <bitset>
+#include "netPrerequisites.h"
 
+template<typename T>
+struct type_bit_size
+{
+	static const size_t size = sizeof(T)*8;
+};
+
 namespace net {
 
-	/**
-		\todo - optimize: use bit masks ? => have to profile this. newer processor
-					architectures aren't that fast with bit operations...
-				- optimize: remove casts
+	/** Generic output bitstream.
+		@note When using it has to be specialized for a sink type.
+		@note It outputs data in single bytes via the specified sink.
+		@todo Make more generic to support different sizes of underlying storage primitives (not just uint8).
+		@sa ibitstream_base
 	*/
-	template<typename DataStreamType>
-	class ibstream_base
+	template<typename DataSinkType>
+	struct obitstream_base
 	{
-	public:
-		ibstream_base& operator = (const ibstream_base&);
-		ibstream_base(const ibstream_base&);
-		ibstream_base( DataStreamType* pds = 0 );
-		~ibstream_base();
-		void setDataSource( DataStreamType*, const bool takeOwnership = false );
-		uint8 read( bool& );
-		uint8 read( void* pd, size_t numBits );
-		uint8 read( uint8&, uint8 numBits );
-		uint8 read( float&, size_t numBits );
+		typedef DataSinkType sink_type;
+
+		obitstream_base(sink_type* sink = 0) :
+			sink_(sink),
+			byte_(0),
+			bitPos_(0),
+			totalBits_(0)
+		{}
+		/** Specify a different sink for receiving the storage primitives.
+			@note Do always flush the stream before changing to a different sink!
+			@note If you want to reset the total bit counter then call reset()
+				before setSink().
+		*/
+		void setSink(sink_type* sink)
+		{
+			flush();
+			sink_ = sink;
+		}
+		/** Write a single bit into the stream. */
+		void write(const bool bit)
+		{
+			assert(sink_);
+			byte_ |= ((bit?1:0) << bitPos_++);
+
+			assert(bitPos_ <= 8);
+			if (bitPos_==8)
+				flushByte();
+		}
+		/** Write any number of bits into the stream.
+			@note The implementation takes care to use special algorithms to improve
+				performance when possible (e.g. for byte aligned writes).
+		*/
+		void write(const void* data, const size_t numBits)
+		{
+			const uint8* ps = reinterpret_cast<const uint8*>(data);
+			assert(ps);
+			assert(numBits>0);
+			assert(sink_);
+
+			assert( bitPos_ <= 7 );
+			uint8 leftShift = uint8(bitPos_ & 0x7); // aka upShift
+			uint8 rightShift = 8 - leftShift; // aka downShift
+
+			// if numBits < 8 and if it fits into the current byte_:
+			//if (rightShift >= numBits)
+			if (numBits + bitPos_ <= 8)
+			{
+				assert(numBits<=8);
+				uint8 mask = ((1 << uint8(numBits))-1); // used to mask 'source' byte
+				byte_ |= ((*ps & mask) << leftShift) & 0xff;
+				bitPos_ += numBits;
+				flushByte();
+				return;
+			}
+
+			// byte aligned writes
+			if (bitPos_ == 0)
+			{
+				// copy full bytes
+				size_t leftOver = bitPos_ + numBits;
+				for (; leftOver>=8; leftOver-=8)
+				{
+					byte_ = *ps++ & 0xff;
+					*sink_ << byte_;
+					totalBits_ += 8; // Have to do this as we don't use flushByte() here!
+				}
+				byte_ = 0;
+				// copy remaining bits (if any)
+				if (leftOver)
+				{
+					const uint8 mask = (1 << uint8(leftOver)) - 1;
+					byte_ |= (*ps & mask) & 0xff;
+					bitPos_ += leftOver;
+					flushByte();
+				}
+				return;
+			}
+
+			// non byte aligned writes
+			size_t leftOver = numBits;
+			for (; leftOver>=8; leftOver-=8)
+			{
+				// write first bunch of bits
+				uint8 mask = ((1 << rightShift)-1); //@todo cache this?
+				// mask to be used for source!
+
+
+				byte_ |= ((*ps & mask) << leftShift) & 0xff;
+
+				bitPos_ += rightShift;
+
+				// flush byte
+				assert( bitPos_ == 8 );
+				flushByte();
+
+				// write second bunch of bits
+				mask = ~mask;
+				byte_ |= ((*ps & mask) >> rightShift) & 0xff;
+				
+				bitPos_ += leftShift;
+
+				++ps;
+			}
+
+			// copy remaining bits (if any)
+			if (leftOver <= rightShift) // fits into remaining bits
+			{
+				assert(leftOver<8);
+				uint8 mask = ((1<<uint8(leftOver))-1) << uint8(bitPos_);
+				byte_ |= ((*ps & mask) & 0xff); //@todo verify: is that here working correctly?
+				bitPos_ += leftOver;
+			}
+			else // write remaining bits into current and next byte
+			{
+				assert(leftOver <= 8);
+				// write first bunch of bits into remaining (=rightShift) bits of destination byte
+				uint8 mask = ((1 << rightShift)-1);
+				byte_ |= ((*ps & mask ) << leftShift) & 0xff;
+
+				bitPos_ += rightShift;
+				leftOver -= rightShift;
+
+				// flush byte
+				assert( bitPos_ == 8 );
+				flushByte();
+
+				// write remaining bits (if any)
+				if (leftOver)
+				{
+					assert(leftOver<8);
+					uint8 mask = ((1<<uint8(leftOver))-1) << rightShift;
+					byte_ |= ((*ps & mask) >> rightShift) & 0xff;
+					bitPos_ += leftOver;
+				}
+			}
+			assert( bitPos_ <= 8 );
+			flushByte();
+		}
+		/** Flush any remaining cached bits into the sink.
+			@note This fills the remaining bits up with 0's.
+			@sa setSink()
+		*/
+		void flush()
+		{
+			if (bitPos_)
+			{
+				assert( sink_ );
+				*sink_ << byte_;
+				totalBits_ += bitPos_;
+				bitPos_ = 0;
+				byte_ = 0;
+			}
+		}
+		/** Return the total number of bits (!) written into the stream.
+		*/
+		size_t size() const
+		{
+			return totalBits_;
+		}
+		/** Flushes and resets the stream as well as the count of total bits written.
+			@note Use this if you want to reuse the bit stream for a new set of writing operations.
+		*/
+		void reset()
+		{
+			flush();
+			totalBits_ = 0;
+		}
+		/*
+		template<typename T>
+		void write(const T value, const size_t numBits = type_bit_size<T>::size)
+		{
+			assert( numBits <= type_bit_size<T>::size );
+			this->write(&value,numBits);
+		}
+		*/
+		void write(const float value, const size_t numBits = type_bit_size<float>::size)
+		{
+			assert( numBits <= type_bit_size<float>::size );
+			this->write(&value,numBits);
+		}
+		void write(const double value, const size_t numBits = type_bit_size<double>::size)
+		{
+			assert( numBits <= type_bit_size<double>::size );
+			this->write(&value,numBits);
+		}
+		void write(const char value, const size_t numBits = type_bit_size<char>::size)
+		{
+			assert( numBits <= type_bit_size<char>::size );
+			this->write(&value,numBits);
+		}
+		void write(const wchar_t value, const size_t numBits = type_bit_size<wchar_t>::size)
+		{
+			assert( numBits <= type_bit_size<wchar_t>::size );
+			this->write(&value,numBits);
+		}
+		void write(const uint16 value, const size_t numBits = type_bit_size<uint16>::size)
+		{
+			assert( numBits <= type_bit_size<int16>::size );
+			this->write(&value,numBits);
+		}
+		void write(const int16 value, const size_t numBits = type_bit_size<int16>::size)
+		{
+			assert( numBits <= type_bit_size<int16>::size );
+			this->write(&value,numBits);
+		}
+		void write(const uint32 value, const size_t numBits = type_bit_size<uint32>::size)
+		{
+			assert( numBits <= type_bit_size<int32>::size );
+			this->write(&value,numBits);
+		}
+		void write(const int32 value, const size_t numBits = type_bit_size<int32>::size)
+		{
+			assert( numBits <= type_bit_size<int32>::size );
+			this->write(&value,numBits);
+		}
 	private:
-		bool _inByte( uint8& );
-		DataStreamType*	mSource;
-		uint8					mBitPos;
-		std::bitset<8>		mBuf;
-		size_t				mTotalBits;
-		size_t				mTotalBytes;
-		bool					mDestroyDataStream;
+		obitstream_base(const obitstream_base&);
+		obitstream_base& operator=(const obitstream_base&);
+	private:
+		void flushByte()
+		{
+			assert( bitPos_ <= 8 );
+			if (bitPos_ == 8)
+			{
+				assert(sink_);
+				*sink_ << byte_;
+				byte_ = 0;
+				totalBits_ += bitPos_;
+				bitPos_ = 0;
+			}
+		}
+	private:
+		sink_type*			sink_;
+		uint8				byte_;
+		size_t				bitPos_;
+		size_t				totalBits_;
 	};
 
-	template<class DataStreamType>
-	class obstream_base
+	/** Generic input bit stream.
+		@note It has to be specialized for a specific byte source to be used in client code.
+		@todo Make more generic to support different storage primitives (not just uint8 streams).
+		@sa obitstream_base
+	*/
+	template<typename DataSourceType>
+	struct ibitstream_base
 	{
+		typedef DataSourceType source_type;
+
+		ibitstream_base(source_type* source = 0) :
+			source_(source),
+			byte_(0),
+			bitPos_(8),
+			totalBitsRead_(0)
+		{}
+		void setSource(source_type* source)
+		{
+			source_ = source;
+		}
+
+		/** Reads a single bit from the stream and returns it in "bit".
+			@return Number of bits read, i.e. 1 or 0 (if an error occurred).
+		*/
+		size_t read(bool& bit)
+		{
+			assert(source_);
+			if (!updateByte())
+				return 0;
+			assert( bitPos_ < 8 );
+			const uint8 mask = (1 << uint8(bitPos_++));
+			bit = (byte_ & mask) != 0;
+			++totalBitsRead_;
+			return 1;
+		}
+	private:
+		bool updateByte()
+		{
+			assert(bitPos_<=8);
+			if (bitPos_ == 8)
+			{
+				if (!readByteFromSource())
+				{
+					assert("out of data" && 0);
+					return false;
+				}
+			}
+			return true;
+		}
 	public:
-		obstream_base& operator = (const obstream_base&);
-		obstream_base(const obstream_base&);
-		obstream_base( DataStreamType* pds = 0 );
-		~obstream_base();
-		void setDataSink( DataStreamType* s, const bool takeOwnership = false );
-		uint8 write( const uint8, uint8 numBits );
-		void write( const bool );
-		void write( const void*, size_t numBits );
+		/** Reads the specified number of bits into the specified buffer.
+			@return The number of bits read. If all goes well it should be equal to
+				numBits. If it is not then an error occurred, e.g. the stream (source)
+				could not deliver any more data.
+			@note This methods takes care of using optimized implementations for, for example,
+				byte aligned reads.
+		*/
+		size_t read(void* data, const size_t numBits)
+		{
+			assert(data);
+			assert(bitPos_ <= 8);
+			if (!updateByte())
+				return 0;
+			assert(bitPos_ < 8);
 
-		void write( const uint16, uint8 numBits );
-		void write( const uint32, uint8 numBits );
-		void write( const float, uint8 numBits );
-		void write( const double, uint8 numBits );
-		void flush();
+			uint8* pd = (uint8*)data;
+			const uint8 leftShift = uint8(bitPos_) & 0x7;
+			const uint8 rightShift = 8 - leftShift;
 
-		size_t numBits() const;
-		//size_t numBytes() const; //pre or post flush?
+			// case: requested bits are completely within the cached byte
+			if (numBits + bitPos_ <= 8)
+			{
+				const uint8 mask = ((1 << uint8(numBits))-1) << leftShift;
+				*pd |= (byte_ & mask) >> leftShift;
+				bitPos_ += numBits;
+				totalBitsRead_ += numBits;
+				return numBits;
+			}
 
-		void setNumBits(const uint8 numBitsForNextStreamOperations);
-		obstream_base& operator << (const uint8);
-		obstream_base& operator << (const uint16);
-		obstream_base& operator << (const uint32);
-		obstream_base& operator << (const int8);
-		obstream_base& operator << (const int16);
-		obstream_base& operator << (const int32);
-		obstream_base& operator << (const float);
-		obstream_base& operator << (const double);
+			// case: requested bits start byte-aligned
+			size_t bitsRead = 0;
+			if (!leftShift)
+			{
+				// read full bytes
+				size_t leftOver = bitPos_ + numBits;
+				while (leftOver>=8)
+				{
+					*pd++ = byte_;
+					bitsRead += 8;
+					leftOver-=8;
+					bitPos_+= 8;
+					if (leftOver)
+					{
+						if (!updateByte())
+						{
+							assert(0 && "failed to read");
+							totalBitsRead_ += bitsRead;
+							return bitsRead;
+						}
+					}
+				}
+				//byte_ = 0;
+				// read remaining bits (if any)
+				if (leftOver)
+				{
+					if (!updateByte())
+					{
+						assert(0 && "failed to read");
+						totalBitsRead_ += bitsRead;
+						return bitsRead;
+					}
+					const uint8 mask = (1 << uint8(leftOver)) - 1;
+
+					//++pd;
+
+					*pd |= (byte_ & mask);
+
+					bitsRead += leftOver;
+					bitPos_ += leftOver;
+				}
+				assert( bitsRead == numBits );
+				totalBitsRead_ += bitsRead;
+				return bitsRead;
+			}
+
+			// case: non-byte-aligned
+			size_t leftOver = numBits;
+			for (; leftOver>=8; leftOver-=8)
+			{
+				// read first bits
+				uint8 mask = ((1<<rightShift)-1) << leftShift;
+				*pd |= (byte_ & mask) >> leftShift; // NB Set to = instead of |= if the destination
+													// should be cleared (set to 0's).
+				bitPos_ += rightShift;
+				bitsRead += rightShift;
+
+				// request next byte to read from
+				if (!updateByte())
+				{
+					assert(0 && "failed to read");
+					totalBitsRead_ += bitsRead;
+					return bitsRead;
+				}
+
+				// read second bunch of bits
+				mask = (~mask);
+
+				*pd |= (byte_ & mask) << rightShift;
+
+				bitPos_ += leftShift;
+				bitsRead += leftShift;
+
+				++pd;
+			}
+
+			// remaining bits (if any)
+			if (leftOver <= rightShift) // fits into remaining bits
+			{
+				assert(leftOver<8);
+				const uint8 mask = ((1<<uint8(leftOver))-1) << uint8(bitPos_);
+				*pd |= (byte_ & mask);
+
+				bitsRead += leftOver;
+				bitPos_ += leftOver;
+			}
+			else // read remaining bits of current and next byte into a single destination byte
+			{
+				// read first bunch of bits (current byte)
+				uint8 mask = ((1<<rightShift)-1) << leftShift;
+				*pd |= (byte_ & mask) >> leftShift; // NB Use = instead of |= if the destination
+													// should be cleared (set to 0's by default)!
+
+				bitPos_ += rightShift;
+				bitsRead += rightShift;
+				leftOver -= rightShift;
+
+				// get next byte
+				assert( bitPos_ == 8 );
+				if (!updateByte())
+				{
+					assert(0 && "failed to read");
+					totalBitsRead_ += bitsRead;
+					return bitsRead;
+				}
+
+				// read remaining bits ("next" byte)
+				if (leftOver)
+				{
+					assert(leftOver<8);
+					uint8 mask = ((1<<uint8(leftOver))-1);
+					*pd |= (byte_ & mask) << rightShift;
+					bitPos_ += leftOver;
+					bitsRead += leftOver;
+				}
+			}
+			assert( bitsRead == numBits );
+			totalBitsRead_ += bitsRead;
+			return bitsRead;
+		}
+		/** Resets the ibitstream_base object for a new set of operations.
+			@note Also resets the counter of "total bits read".
+		*/
+		void reset()
+		{
+			byte_ = 0;
+			bitPos_ = 0;
+			totalBitsRead_ = 0;
+		}
+		size_t size() const
+		{
+			return totalBitsRead_;
+		}
+		size_t read(float& value, const size_t numBits = type_bit_size<float>::size)
+		{
+			assert( numBits <= type_bit_size<float>::size );
+			return this->read(&value,numBits);
+		}
+		size_t read(double& value, const size_t numBits = type_bit_size<double>::size)
+		{
+			assert( numBits <= type_bit_size<double>::size );
+			return this->read(&value,numBits);
+		}
+		size_t read(char& value, const size_t numBits = type_bit_size<char>::size)
+		{
+			assert( numBits <= type_bit_size<char>::size );
+			return this->read(&value,numBits);
+		}
+		size_t read(wchar_t& value, const size_t numBits = type_bit_size<wchar_t>::size)
+		{
+			assert( numBits <= type_bit_size<wchar_t>::size );
+			return this->read(&value,numBits);
+		}
+		size_t read(uint8& value, const size_t numBits = type_bit_size<uint8>::size)
+		{
+			assert( numBits <= type_bit_size<uint8>::size );
+			return this->read(&value,numBits);
+		}
+		size_t read(int8& value, const size_t numBits = type_bit_size<int8>::size)
+		{
+			assert( numBits <= type_bit_size<int8>::size );
+			return this->read(&value,numBits);
+		}
+		size_t read(uint16& value, const size_t numBits = type_bit_size<uint16>::size)
+		{
+			assert( numBits <= type_bit_size<uint16>::size );
+			return this->read(&value,numBits);
+		}
+		size_t read(int16& value, const size_t numBits = type_bit_size<int16>::size)
+		{
+			assert( numBits <= type_bit_size<int16>::size );
+			return this->read(&value,numBits);
+		}
+		size_t read(uint32& value, const size_t numBits = type_bit_size<uint32>::size)
+		{
+			assert( numBits <= type_bit_size<uint32>::size );
+			return this->read(&value,numBits);
+		}
+		size_t read(int32& value, const size_t numBits = type_bit_size<int32>::size)
+		{
+			assert( numBits <= type_bit_size<int32>::size );
+			return this->read(&value,numBits);
+		}
 	private:
-		void _outByte( uint8 );
-		//std::ostream*	mStream;
-		DataStreamType*	mStream;
-		uint8					mBitPos;
-		std::bitset<8>		mBuf;
-		size_t				mTotalBits;
-		size_t				mTotalBytes;
-		uint8					mNumBitsForNextStreamOperations;
-		bool					mDestroyDataStream;
+		bool readByteFromSource()
+		{
+			assert(source_);
+			*source_ >> byte_;
+			bitPos_ = 0;
+			return true;
+		}
+	private:
+		source_type*		source_;
+		uint8				byte_;
+		size_t				bitPos_;
+		size_t				totalBitsRead_;
 	};
 
-	struct setNumBits
-	{
-		setNumBits(uint8 numBits) : b(numBits)
-		{}
-		uint8 b;
-	};
-	template<class ostream_type>
-	inline ostream_type& operator << (ostream_type& lhs, const setNumBits& rhs)
-	{
-		lhs.setNumBits(rhs.b);
-		return lhs;
-	}
 } // namespace net
 
 #include "netBitStream.inl"

Modified: trunk/yake/yake/net/netBitstream.inl
===================================================================
--- trunk/yake/yake/net/netBitstream.inl	2006-07-04 21:11:40 UTC (rev 1367)
+++ trunk/yake/yake/net/netBitstream.inl	2006-07-04 21:12:45 UTC (rev 1368)
@@ -3,322 +3,7 @@
 
 namespace net {
 
-	//--------------------------------------------------------------------------
-	// Class: ibstream
-	//--------------------------------------------------------------------------
-	template<class DataStreamType>
-	ibstream_base<DataStreamType>& ibstream_base<DataStreamType>::operator = (const ibstream_base<DataStreamType>& other)
-	{
-		mSource			= other.mSource;
-		mBitPos			= other.mBitPos;
-		mBuf				= other.mBuf;
-		mTotalBits		= other.mTotalBits;
-		mTotalBytes		= other.mTotalBytes;
-		mDestroyDataStream = other.mDestroyDataStream;
-		return *this;
-	}
-	template<class DataStreamType>
-	ibstream_base<DataStreamType>::ibstream_base(const ibstream_base<DataStreamType>& other)
-	{
-		mSource			= other.mSource;
-		mBitPos			= other.mBitPos;
-		mBuf				= other.mBuf;
-		mTotalBits		= other.mTotalBits;
-		mTotalBytes		= other.mTotalBytes;
-		mDestroyDataStream = other.mDestroyDataStream;
-	}
-	template<class DataStreamType>
-	ibstream_base<DataStreamType>::ibstream_base( DataStreamType* pds /*= 0*/ ) : mSource(pds), mBitPos(8), mTotalBits(0), mTotalBytes(0), mDestroyDataStream(false)
-	{
-		mBuf.set(0);
-	}
-	template<class DataStreamType>
-	ibstream_base<DataStreamType>::~ibstream_base()
-	{
-		if (mDestroyDataStream && mSource)
-			delete mSource;
-	#ifdef _OUTPUT_DEBUG_STUFF
-		std::cout << "ibstream: " << uint32(mTotalBits) << " bits read.\n";
-		std::cout << "ibstream: " << uint32(mTotalBytes) << " bytes read.\n";
-	#endif
-	}
-	template<class DataStreamType>
-	void ibstream_base<DataStreamType>::setDataSource( DataStreamType* s, const bool takeOwnership )
-	{
-		if (mDestroyDataStream && mSource)
-			delete mSource;
-		mDestroyDataStream = takeOwnership;
-		mSource = s;
-	}
-	template<class DataStreamType>
-	bool ibstream_base<DataStreamType>::_inByte( uint8& c )
-	{
-		if (!mSource)
-			return false;
-		if (!mSource->hasMoreData())
-			return false;
-		if (!mSource->read( c ))
-			return false;
-		++mTotalBytes;
-		return true;
-	}
-	template<class DataStreamType>
-	uint8 ibstream_base<DataStreamType>::read( uint8& bits, uint8 numBits )
-	{
-		if (!mSource)
-			return 0;
-		if (numBits > 8)
-			numBits = 8;
 
-		std::bitset<8> d(0);
-		//for (uint8 i = numBits-1; i != 0xff; i--)
-		for (uint8 i = 0; i < numBits; ++i)
-		{
-			bool b;
-			read(b);
-			d[i] = b;
-	#ifdef _OUTPUT_DEBUG_STUFF
-			std::cout << "reading bit " << uint32(i) << " = " << d[i] << "\n";
-	#endif
-			mTotalBits++;
-		}
-
-		bits = uint8(d.to_ulong() & 0xFF);
-
-		return numBits;
-	}
-	template<class DataStreamType>
-	uint8 ibstream_base<DataStreamType>::read( bool& bit )
-	{
-		if (mBitPos == 8)
-		{
-			uint8 c;
-			_inByte( c );
-			mBuf = c;
-			mBitPos = 0;
-		}
-
-		bit = mBuf[mBitPos++];
-		return 1;
-	}
-	template<class DataStreamType>
-	uint8 ibstream_base<DataStreamType>::read( void* pd, size_t numBits )
-	{
-		uint8* pc = static_cast<uint8*>(pd);
-		uint8* pe = pc+(numBits >> 3);
-		if (pc == pe)
-		{
-			read( *pc, uint8(numBits) );
-			return uint8(numBits);
-		}
-
-		size_t toread = numBits;
-		while (pc != pe)
-			toread -= read( *pc++, (toread > 8) ? 8 : uint8(toread) );
-
-		if (toread > 0)
-			read( *pc, uint8(toread) );
-
-		return uint8(numBits);
-	}
-	template<class DataStreamType>
-	uint8 ibstream_base<DataStreamType>::read( float& d, size_t numBits )
-	{
-		return read( &d, numBits );
-	}
-
-	//--------------------------------------------------------------------------
-	// Class: obstream
-	//--------------------------------------------------------------------------
-	template<class DataStreamType>
-	obstream_base<DataStreamType>& obstream_base<DataStreamType>::operator = (const obstream_base<DataStreamType>& other)
-	{
-		mStream			= other.mStream;
-		mBitPos			= other.mBitPos;
-		mBuf				= other.mBuf;
-		mTotalBits		= other.mTotalBits;
-		mTotalBytes		= other.mTotalBytes;
-		mDestroyDataStream = other.mDestroyDataStream;
-		mNumBitsForNextStreamOperations = other.mNumBitsForNextStreamOperations;
-		return *this;
-	}
-	template<class DataStreamType>
-	obstream_base<DataStreamType>::obstream_base(const obstream_base<DataStreamType>& other)
-	{
-		mStream			= other.mStream;
-		mBitPos			= other.mBitPos;
-		mBuf				= other.mBuf;
-		mTotalBits		= other.mTotalBits;
-		mTotalBytes		= other.mTotalBytes;
-		mDestroyDataStream = other.mDestroyDataStream;
-		mNumBitsForNextStreamOperations = other.mNumBitsForNextStreamOperations;
-	}
-	template<class DataStreamType>
-	obstream_base<DataStreamType>& obstream_base<DataStreamType>::operator << (const uint8 rhs)
-	{
-		write( rhs, mNumBitsForNextStreamOperations );
-		return *this;
-	}
-	template<class DataStreamType>
-	obstream_base<DataStreamType>& obstream_base<DataStreamType>::operator << (const uint16 rhs)
-	{
-		write( &rhs, mNumBitsForNextStreamOperations );
-		return *this;
-	}
-	template<class DataStreamType>
-	obstream_base<DataStreamType>& obstream_base<DataStreamType>::operator << (const uint32 rhs)
-	{
-		write( &rhs, mNumBitsForNextStreamOperations );
-		return *this;
-	}
-	template<class DataStreamType>
-	obstream_base<DataStreamType>& obstream_base<DataStreamType>::operator << (const int8 rhs)
-	{
-		write( &rhs, mNumBitsForNextStreamOperations );
-		return *this;
-	}
-	template<class DataStreamType>
-	obstream_base<DataStreamType>& obstream_base<DataStreamType>::operator << (const int16 rhs)
-	{
-		write( &rhs, mNumBitsForNextStreamOperations );
-		return *this;
-	}
-	template<class DataStreamType>
-	obstream_base<DataStreamType>& obstream_base<DataStreamType>::operator << (const int32 rhs)
-	{
-		write( &rhs, mNumBitsForNextStreamOperations );
-		return *this;
-	}
-	template<class DataStreamType>
-	obstream_base<DataStreamType>& obstream_base<DataStreamType>::operator << (const float rhs)
-	{
-		write( &rhs, mNumBitsForNextStreamOperations );
-		return *this;
-	}
-	template<class DataStreamType>
-	obstream_base<DataStreamType>& obstream_base<DataStreamType>::operator << (const double rhs)
-	{
-		write( &rhs, mNumBitsForNextStreamOperations );
-		return *this;
-	}
-	template<class DataStreamType>
-	obstream_base<DataStreamType>::obstream_base( DataStreamType* pds /*= 0*/ ) : mStream(pds), mBitPos(0), mTotalBits(0), mTotalBytes(0), mNumBitsForNextStreamOperations(8), mDestroyDataStream(false)
-	{
-		mBuf.set(0);
-	}
-	template<class DataStreamType>
-	obstream_base<DataStreamType>::~obstream_base()
-	{
-		if (mStream && mDestroyDataStream)
-			delete mStream;
-	#ifdef _OUTPUT_DEBUG_STUFF
-		std::cout << "obstream: " << uint32(mTotalBits) << " bits written.\n";
-		std::cout << "obstream: " << uint32(mTotalBytes) << " bytes written.\n";
-	#endif
-	}
-	template<class DataStreamType>
-	void obstream_base<DataStreamType>::setNumBits(const uint8 numBitsForNextStreamOperations)
-	{
-		mNumBitsForNextStreamOperations = numBitsForNextStreamOperations;
-	}
-	template<class DataStreamType>
-	void obstream_base<DataStreamType>::setDataSink( DataStreamType* s, const bool takeOwnership )
-	{
-		if (mStream && mDestroyDataStream)
-			delete mStream;
-		mDestroyDataStream = takeOwnership;
-		mStream = s;
-	}
-	template<class DataStreamType>
-	void obstream_base<DataStreamType>::_outByte( uint8 c )
-	{
-		if (!mStream)
-			return;
-		//*mStream << c;
-		mStream->write( c );
-		++mTotalBytes;
-	}
-	template<class DataStreamType>
-	uint8 obstream_base<DataStreamType>::write( const uint8 bits, uint8 numBits )
-	{
-		if (!mStream)
-			return 0;
-		if (numBits > 8)
-			numBits = 8;
-
-		std::bitset<8> d(bits);
-
-		//for (int8 i = numBits-1; i>=0; --i)
-		for (int8 i = 0; i<numBits; ++i)
-		{
-	#ifdef _OUTPUT_DEBUG_STUFF
-			std::cout << "writing bit " << uint32(i) << " = " << d[i] << "\n";
-	#endif
-			write( d[i] );
-		}
-
-		return numBits;
-	}
-	template<class DataStreamType>
-	void obstream_base<DataStreamType>::write( const bool bit )
-	{
-		mBuf[ mBitPos ++ ] = bit;
-		if (mBitPos >= 8)
-		{
-			uint8 c = uint8( mBuf.to_ulong() & 0xFF );
-			_outByte( c );
-			mBitPos -= 8;
-		}
-		++mTotalBits;
-	}
-	template<class DataStreamType>
-	void obstream_base<DataStreamType>::flush()
-	{
-		if (mBitPos > 0)
-		{
-			_outByte( uint8(mBuf.to_ulong() & 0xFF) );
-			mBitPos = 0;
-		}
-	}
-	template<class DataStreamType>
-	void obstream_base<DataStreamType>::write( const void* pd, size_t numBits )
-	{
-		const uint8* pc = static_cast<const uint8*>(pd);
-		const uint8* pe = pc+(numBits >> 3);
-		if (pc == pe)
-		{
-			write( *pc, uint8(numBits) );
-			return;
-		}
-
-		size_t towrite = numBits;
-		while (pc != pe)
-			towrite -= write( *pc++, (towrite > 8) ? 8 : uint8(towrite) );
-
-		if (towrite > 0)
-			write( *pc, uint8(towrite) );
-	}
-	template<class DataStreamType>
-	void obstream_base<DataStreamType>::write( const uint16 d, uint8 numBits )
-	{
-		write( &d, numBits );
-	}
-	template<class DataStreamType>
-	void obstream_base<DataStreamType>::write( const uint32 d, uint8 numBits )
-	{
-		write( &d, numBits );
-	}
-	template<class DataStreamType>
-	void obstream_base<DataStreamType>::write( const float d, uint8 numBits )
-	{
-		write( &d, numBits );
-	}
-	template<class DataStreamType>
-	size_t obstream_base<DataStreamType>::numBits() const
-	{
-		return mTotalBits;
-	}
-
 } // namespace net
 
 #endif

Modified: trunk/yake/yake/net/netBitstreamAdapters.h
===================================================================
--- trunk/yake/yake/net/netBitstreamAdapters.h	2006-07-04 21:11:40 UTC (rev 1367)
+++ trunk/yake/yake/net/netBitstreamAdapters.h	2006-07-04 21:12:45 UTC (rev 1368)
@@ -1,52 +1,57 @@
 #ifndef NET_BITSTREAMADAPTERS_H
 #define NET_BITSTREAMADAPTERS_H
 
+#include "netPrerequisites.h"
+#include "netBitstream.h"
+
 namespace net {
 
-	template<class ctr_type>
-	struct bitstream_sink_stlcontainer
+	template<class ContainerType>
+	struct stlsequence_data_sink
 	{
-	private:
-		bitstream_sink_stlcontainer();
-	public:
-		typedef ctr_type container_type;
-		bitstream_sink_stlcontainer(ctr_type& ctr) : ctr_(ctr) {}
-		void write(const net::uint8 c)
+		typedef ContainerType container_type;
+
+		stlsequence_data_sink(container_type* data = 0) : data_(data)
+		{}
+		stlsequence_data_sink& operator << (const uint8 rhs)
 		{
-			ctr_.push_back( c );
+			assert(data_);
+			for (size_t i=0; i<tmp_.size(); ++i)
+			{
+				assert(tmp_[i] == data_->at(i));
+			}
+			data_->push_back(rhs);
+			tmp_.push_back(rhs);
+			return *this;
 		}
-		ctr_type&	ctr_;
+	private:
+		container_type*	data_;
+		container_type	tmp_;
 	};
-	typedef bitstream_sink_stlcontainer<std::vector<net::uint8> > bitstream_stlvector_sink;
-	typedef net::obstream_base<bitstream_stlvector_sink> obitstream_vector;
+	typedef stlsequence_data_sink<std::vector<uint8> > ByteVectorSink;
+	typedef obitstream_base<ByteVectorSink> obitstream_vector;
 
-	template<class ctr_type>
-	struct bitstream_source_stlcontainer
+	template<class ContainerType>
+	struct stlsequence_data_source
 	{
-	private:
-		bitstream_source_stlcontainer();
-	public:
-		typedef ctr_type container_type;
-		bitstream_source_stlcontainer(const container_type& ctr) : currPos(ctr.begin()), itEnd(ctr.end()), ctr_(ctr)
+		typedef ContainerType container_type;
+
+		stlsequence_data_source(container_type* data = 0) : data_(data), pos_(0)
 		{}
-		bool hasMoreData() const
+		stlsequence_data_source& operator >> (uint8& rhs)
 		{
-			return currPos != itEnd;
+			assert(data_);
+			assert(pos_ < data_->size());
+			rhs = data_->at(pos_);
+			++pos_;
+			return *this;
 		}
-		bool read(net::uint8& c) const
-		{
-			if (!hasMoreData())
-				return false;
-			c = *currPos++;
-			return true;
-		}
 	private:
-		mutable typename container_type::const_iterator currPos;
-		mutable typename container_type::const_iterator itEnd;
-		const container_type&	ctr_;
+		container_type*	data_;
+		size_t			pos_;
 	};
-	typedef bitstream_source_stlcontainer<std::vector<net::uint8> > bitstream_stlvector_source;
-	typedef net::ibstream_base<bitstream_stlvector_source> ibitstream_vector;
+	typedef stlsequence_data_source<std::vector<uint8> > ByteVectorSource;
+	typedef ibitstream_base<ByteVectorSource> ibitstream_vector;
 
 	struct bitstream_source_voidptr
 	{
@@ -77,7 +82,7 @@
 		const uint8*			end_;
 		mutable uint8*			curr_;
 	};
-	typedef net::ibstream_base<bitstream_source_voidptr> ibitstream_voidptr;
+	typedef net::ibitstream_base<bitstream_source_voidptr> ibitstream_voidptr;
 } // namespace net
 
 #endif

Modified: trunk/yake/yake/net/netEvent.h
===================================================================
--- trunk/yake/yake/net/netEvent.h	2006-07-04 21:11:40 UTC (rev 1367)
+++ trunk/yake/yake/net/netEvent.h	2006-07-04 21:12:45 UTC (rev 1368)
@@ -9,9 +9,9 @@
 	typedef obitstream_vector obitstream;
 	typedef ibitstream_vector ibitstream;
 
-	typedef bitstream_stlvector_sink::container_type bitstream_data;
-	typedef bitstream_stlvector_sink bitstream_sink;
-	typedef bitstream_stlvector_source bitstream_source;
+	typedef ByteVectorSink::container_type bitstream_data;
+	typedef ByteVectorSink bitstream_sink;
+	typedef ByteVectorSource bitstream_source;
 
 	class NET_API NetEvent
 	{

Modified: trunk/yake/yake/net/netPrerequisites.h
===================================================================
--- trunk/yake/yake/net/netPrerequisites.h	2006-07-04 21:11:40 UTC (rev 1367)
+++ trunk/yake/yake/net/netPrerequisites.h	2006-07-04 21:12:45 UTC (rev 1368)
@@ -2,6 +2,7 @@
 #define NET_PREREQUISITES_H
 
 #include <yake/base/yakePrerequisites.h>
+#include <yake/base/yake.h>
 
 #define NET_DLL
 



From codeandroid at berlios.de  Tue Jul  4 23:20:49 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Tue, 4 Jul 2006 23:20:49 +0200
Subject: [Yake-svn] r1369 - trunk/yake/dependencies
Message-ID: <200607042120.k64LKnMI018980@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-04 23:20:49 +0200 (Tue, 04 Jul 2006)
New Revision: 1369

Modified:
   trunk/yake/dependencies/DEPENDENCIES
Log:
updated dependencies

Modified: trunk/yake/dependencies/DEPENDENCIES
===================================================================
--- trunk/yake/dependencies/DEPENDENCIES	2006-07-04 21:12:45 UTC (rev 1368)
+++ trunk/yake/dependencies/DEPENDENCIES	2006-07-04 21:20:49 UTC (rev 1369)
@@ -1,16 +1,18 @@
 
-boost/      <= 1.33.0 (1.32.x should work, too)
+boost/      <= 1.33.1 (1.33.0 and 1.32.x *should* work, too)
 cegui_mk2/
+enet/       <= enet 1.0
 libogg-1.1/
 libvorbis-1.0/
 loki/
-lua/
-luabind/    <= beta7-devel2 branch
-ode/
-ogrenew/
+lua/        <= Lua 5.1.1
+luabind/    <= Luabind 0.7 patched for lua 5.1.1 compatibility
+ode/        <= ode 0.6 (0.5 should work)
+ogrenew/    <= OGRE 1.2 (aka Dagon)
 OpenAL/
 openalpp/
 OpenThreads/
+oSceneLoaderLib/ <= pseudo-.scene loader :P (for OGRE 1.2 Dagon)
 tinyxml/
 ttl/
-zThread
+zThread/



From codeandroid at berlios.de  Wed Jul  5 21:04:04 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 21:04:04 +0200
Subject: [Yake-svn] r1370 - trunk/yake/scripts/msvc8/samples/model
Message-ID: <200607051904.k65J44CG020202@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 21:04:01 +0200 (Wed, 05 Jul 2006)
New Revision: 1370

Added:
   trunk/yake/scripts/msvc8/samples/model/sampleModel1.vcproj
Removed:
   trunk/yake/scripts/msvc8/samples/model/sampleDotScene.vcproj
Log:
renamed project

Deleted: trunk/yake/scripts/msvc8/samples/model/sampleDotScene.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/model/sampleDotScene.vcproj	2006-07-04 21:20:49 UTC (rev 1369)
+++ trunk/yake/scripts/msvc8/samples/model/sampleDotScene.vcproj	2006-07-05 19:04:01 UTC (rev 1370)
@@ -1,224 +0,0 @@
-<?xml version="1.0" encoding="Windows-1252"?>
-<VisualStudioProject
-	ProjectType="Visual C++"
-	Version="8,00"
-	Name="sampleModelDotScene"
-	ProjectGUID="{920E5CA3-620C-43C3-986C-5A6F9397F6DA}"
-	Keyword="Win32Proj"
-	>
-	<Platforms>
-		<Platform
-			Name="Win32"
-		/>
-	</Platforms>
-	<ToolFiles>
-	</ToolFiles>
-	<Configurations>
-		<Configuration
-			Name="Debug|Win32"
-			OutputDirectory="../../../../common/bin/debug"
-			IntermediateDirectory="../../../../common/obj/debug/$(ProjectName)"
-			ConfigurationType="1"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				Optimization="0"
-				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
-				PreprocessorDefinitions="_STLP_DEBUG;WIN32;_DEBUG;_CONSOLE"
-				MinimalRebuild="true"
-				BasicRuntimeChecks="3"
-				RuntimeLibrary="3"
-				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
-				PrecompiledHeaderThrough="yake/samples/model/dotScene/pch.h"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="4"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib"
-				OutputFile="$(OutDir)/$(ProjectName).exe"
-				LinkIncremental="2"
-				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/lib"
-				GenerateDebugInformation="true"
-				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
-				SubSystem="1"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-		<Configuration
-			Name="Release|Win32"
-			OutputDirectory="../../../../common/bin/release"
-			IntermediateDirectory="../../../../common/obj/release/$(ProjectName)"
-			ConfigurationType="1"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
-				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE"
-				RuntimeLibrary="2"
-				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
-				PrecompiledHeaderThrough="yake/samples/model/dotScene/pch.h"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="3"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib"
-				OutputFile="$(OutDir)/$(ProjectName).exe"
-				LinkIncremental="1"
-				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"
-				GenerateDebugInformation="false"
-				SubSystem="1"
-				OptimizeReferences="2"
-				EnableCOMDATFolding="2"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-	</Configurations>
-	<References>
-	</References>
-	<Files>
-		<Filter
-			Name="inc"
-			>
-			<File
-				RelativePath="..\..\..\..\yake\samples\model\dotScene\pch.h"
-				>
-			</File>
-		</Filter>
-		<Filter
-			Name="src"
-			>
-			<File
-				RelativePath="..\..\..\..\src\yake\samples\model\dotScene\demo.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\..\..\src\yake\samples\model\dotScene\pch.cpp"
-				>
-				<FileConfiguration
-					Name="Debug|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
-				<FileConfiguration
-					Name="Release|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
-			</File>
-		</Filter>
-	</Files>
-	<Globals>
-	</Globals>
-</VisualStudioProject>

Copied: trunk/yake/scripts/msvc8/samples/model/sampleModel1.vcproj (from rev 1347, trunk/yake/scripts/msvc8/samples/model/sampleDotScene.vcproj)
===================================================================
--- trunk/yake/scripts/msvc8/samples/model/sampleDotScene.vcproj	2006-06-20 08:05:16 UTC (rev 1347)
+++ trunk/yake/scripts/msvc8/samples/model/sampleModel1.vcproj	2006-07-05 19:04:01 UTC (rev 1370)
@@ -0,0 +1,224 @@
+<?xml version="1.0" encoding="Windows-1252"?>
+<VisualStudioProject
+	ProjectType="Visual C++"
+	Version="8,00"
+	Name="sampleModel1"
+	ProjectGUID="{920E5CA3-620C-43C3-986C-5A6F9397F6DA}"
+	Keyword="Win32Proj"
+	>
+	<Platforms>
+		<Platform
+			Name="Win32"
+		/>
+	</Platforms>
+	<ToolFiles>
+	</ToolFiles>
+	<Configurations>
+		<Configuration
+			Name="Debug|Win32"
+			OutputDirectory="../../../../common/bin/debug"
+			IntermediateDirectory="../../../../common/obj/debug/$(ProjectName)"
+			ConfigurationType="1"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				Optimization="0"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
+				PreprocessorDefinitions="_STLP_DEBUG;WIN32;_DEBUG;_CONSOLE"
+				MinimalRebuild="true"
+				BasicRuntimeChecks="3"
+				RuntimeLibrary="3"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="2"
+				PrecompiledHeaderThrough="yake/samples/model/dotScene/pch.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="4"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib"
+				OutputFile="$(OutDir)/$(ProjectName).exe"
+				LinkIncremental="2"
+				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/lib"
+				GenerateDebugInformation="true"
+				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
+				SubSystem="1"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+		<Configuration
+			Name="Release|Win32"
+			OutputDirectory="../../../../common/bin/release"
+			IntermediateDirectory="../../../../common/obj/release/$(ProjectName)"
+			ConfigurationType="1"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
+				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE"
+				RuntimeLibrary="2"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="2"
+				PrecompiledHeaderThrough="yake/samples/model/dotScene/pch.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="3"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib"
+				OutputFile="$(OutDir)/$(ProjectName).exe"
+				LinkIncremental="1"
+				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"
+				GenerateDebugInformation="false"
+				SubSystem="1"
+				OptimizeReferences="2"
+				EnableCOMDATFolding="2"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+	</Configurations>
+	<References>
+	</References>
+	<Files>
+		<Filter
+			Name="inc"
+			>
+			<File
+				RelativePath="..\..\..\..\yake\samples\model\dotScene\pch.h"
+				>
+			</File>
+		</Filter>
+		<Filter
+			Name="src"
+			>
+			<File
+				RelativePath="..\..\..\..\src\yake\samples\model\dotScene\demo.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\..\..\src\yake\samples\model\dotScene\pch.cpp"
+				>
+				<FileConfiguration
+					Name="Debug|Win32"
+					>
+					<Tool
+						Name="VCCLCompilerTool"
+						UsePrecompiledHeader="1"
+					/>
+				</FileConfiguration>
+				<FileConfiguration
+					Name="Release|Win32"
+					>
+					<Tool
+						Name="VCCLCompilerTool"
+						UsePrecompiledHeader="1"
+					/>
+				</FileConfiguration>
+			</File>
+		</Filter>
+	</Files>
+	<Globals>
+	</Globals>
+</VisualStudioProject>



From codeandroid at berlios.de  Wed Jul  5 21:05:36 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 21:05:36 +0200
Subject: [Yake-svn] r1371 - trunk/yake/yapp/samples/graphics
Message-ID: <200607051905.k65J5aMr020696@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 21:05:07 +0200 (Wed, 05 Jul 2006)
New Revision: 1371

Removed:
   trunk/yake/yapp/samples/graphics/dotScene/
Log:
deprecated



From codeandroid at berlios.de  Wed Jul  5 21:05:54 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 21:05:54 +0200
Subject: [Yake-svn] r1372 - trunk/yake/src/yapp/samples/graphics
Message-ID: <200607051905.k65J5sD1020859@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 21:05:52 +0200 (Wed, 05 Jul 2006)
New Revision: 1372

Removed:
   trunk/yake/src/yapp/samples/graphics/dotScene/
Log:
deprecated



From codeandroid at berlios.de  Wed Jul  5 21:06:54 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 21:06:54 +0200
Subject: [Yake-svn] r1373 - trunk/yake/scripts/msvc8
Message-ID: <200607051906.k65J6sKR021581@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 21:06:49 +0200 (Wed, 05 Jul 2006)
New Revision: 1373

Modified:
   trunk/yake/scripts/msvc8/samples.sln
   trunk/yake/scripts/msvc8/yapp.vcproj
Log:
deprecated

Modified: trunk/yake/scripts/msvc8/samples.sln
===================================================================
--- trunk/yake/scripts/msvc8/samples.sln	2006-07-05 19:05:52 UTC (rev 1372)
+++ trunk/yake/scripts/msvc8/samples.sln	2006-07-05 19:06:49 UTC (rev 1373)
@@ -1,14 +1,12 @@
 ?
 Microsoft Visual Studio Solution File, Format Version 9.00
-# Visual Studio 2005
+# Visual C++ Express 2005
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleAudio1", "samples\audio\sampleAudio1.vcproj", "{726DFDDE-71FA-403B-8F58-6DA9DF0EF297}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleDataMisc", "samples\data\sampleDataMisc.vcproj", "{22EFD734-D8C5-47D6-8461-C37E02A9F0B6}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleEntFsm", "samples\ent\sampleEntFsm.vcproj", "{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleDotScene", "samples\graphics\sampleDotScene.vcproj", "{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}"
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleGraphicsDemo", "samples\graphics\sampleGraphicsDemo.vcproj", "{723A2F36-A3DC-40E5-A7B0-0629219B04DE}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleCar", "samples\misc\sampleCar.vcproj", "{EE77E955-42BD-47A4-BDC6-D92759F45D01}"
@@ -49,6 +47,12 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleDebug", "samples\base\sampleDebug.vcproj", "{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}"
 EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleNetPacket", "samples\net\sampleNetPacket.vcproj", "{5473599B-AB7B-4259-B052-4DDC68CBEA54}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleDotScene", "samples\graphics\sampleDotScene.vcproj", "{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleModel1", "samples\model\sampleModel1.vcproj", "{920E5CA3-620C-43C3-986C-5A6F9397F6DA}"
+EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) = preSolution
 		Debug|Win32 = Debug|Win32
@@ -67,10 +71,6 @@
 		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Debug|Win32.Build.0 = Debug|Win32
 		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Release|Win32.ActiveCfg = Release|Win32
 		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Release|Win32.Build.0 = Release|Win32
-		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Debug|Win32.ActiveCfg = Debug|Win32
-		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Debug|Win32.Build.0 = Debug|Win32
-		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Release|Win32.ActiveCfg = Release|Win32
-		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Release|Win32.Build.0 = Release|Win32
 		{723A2F36-A3DC-40E5-A7B0-0629219B04DE}.Debug|Win32.ActiveCfg = Debug|Win32
 		{723A2F36-A3DC-40E5-A7B0-0629219B04DE}.Debug|Win32.Build.0 = Debug|Win32
 		{723A2F36-A3DC-40E5-A7B0-0629219B04DE}.Release|Win32.ActiveCfg = Release|Win32
@@ -151,6 +151,18 @@
 		{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}.Debug|Win32.Build.0 = Debug|Win32
 		{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}.Release|Win32.ActiveCfg = Release|Win32
 		{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}.Release|Win32.Build.0 = Release|Win32
+		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Debug|Win32.ActiveCfg = Debug|Win32
+		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Debug|Win32.Build.0 = Debug|Win32
+		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Release|Win32.ActiveCfg = Release|Win32
+		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Release|Win32.Build.0 = Release|Win32
+		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Debug|Win32.ActiveCfg = Debug|Win32
+		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Debug|Win32.Build.0 = Debug|Win32
+		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Release|Win32.ActiveCfg = Release|Win32
+		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Release|Win32.Build.0 = Release|Win32
+		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Debug|Win32.ActiveCfg = Debug|Win32
+		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Debug|Win32.Build.0 = Debug|Win32
+		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Release|Win32.ActiveCfg = Release|Win32
+		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Release|Win32.Build.0 = Release|Win32
 	EndGlobalSection
 	GlobalSection(SolutionProperties) = preSolution
 		HideSolutionNode = FALSE

Modified: trunk/yake/scripts/msvc8/yapp.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/yapp.vcproj	2006-07-05 19:05:52 UTC (rev 1372)
+++ trunk/yake/scripts/msvc8/yapp.vcproj	2006-07-05 19:06:49 UTC (rev 1373)
@@ -550,14 +550,6 @@
 				>
 			</File>
 		</Filter>
-		<Filter
-			Name="trigger"
-			>
-			<File
-				RelativePath="..\..\yapp\trigger\yakeTrigger.h"
-				>
-			</File>
-		</Filter>
 	</Files>
 	<Globals>
 	</Globals>



From codeandroid at berlios.de  Wed Jul  5 22:12:08 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 22:12:08 +0200
Subject: [Yake-svn] r1374 - trunk/yake/src/yake/samples/model/dotScene
Message-ID: <200607052012.k65KC8hs026963@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 22:12:07 +0200 (Wed, 05 Jul 2006)
New Revision: 1374

Modified:
   trunk/yake/src/yake/samples/model/dotScene/demo.cpp
Log:
fixed path

Modified: trunk/yake/src/yake/samples/model/dotScene/demo.cpp
===================================================================
--- trunk/yake/src/yake/samples/model/dotScene/demo.cpp	2006-07-05 19:06:49 UTC (rev 1373)
+++ trunk/yake/src/yake/samples/model/dotScene/demo.cpp	2006-07-05 20:12:07 UTC (rev 1374)
@@ -148,7 +148,7 @@
 		((model::Graphical*)m->getComponentByTag("gfx"))->translate(Vector3(40,20,0));
 
 		// method #2 - using dotModel templates
-		bool success = modelMgr.loadTemplatesFromDotModel("E:/dev/yake.trunk/yake/common/media/samples/dotLink/DynTest/DotScene1.model");
+		bool success = modelMgr.loadTemplatesFromDotModel("../../media/samples/dotLink/DynTest/DotScene1.model");
 		YAKE_ASSERT( success );
 		m = modelMgr.createModelFromTemplate("m3", "dotscene1");
 		YAKE_ASSERT( m );



From codeandroid at berlios.de  Wed Jul  5 22:15:01 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 22:15:01 +0200
Subject: [Yake-svn] r1375 - trunk/yake/scripts/msvc8/samples
Message-ID: <200607052015.k65KF1h6029676@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 22:15:00 +0200 (Wed, 05 Jul 2006)
New Revision: 1375

Removed:
   trunk/yake/scripts/msvc8/samples/state/
Log:
various fixes to get the samples (mostly) uptodate,
deprecated a few samples



From codeandroid at berlios.de  Wed Jul  5 22:15:17 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 22:15:17 +0200
Subject: [Yake-svn] r1376 - in trunk/yake/scripts/msvc8/samples: graphics model
Message-ID: <200607052015.k65KFH5k029924@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 22:15:16 +0200 (Wed, 05 Jul 2006)
New Revision: 1376

Removed:
   trunk/yake/scripts/msvc8/samples/graphics/sampleDotScene.vcproj
   trunk/yake/scripts/msvc8/samples/model/sampleXODE.vcproj
Log:
various fixes to get the samples (mostly) uptodate,
deprecated a few samples

Deleted: trunk/yake/scripts/msvc8/samples/graphics/sampleDotScene.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/graphics/sampleDotScene.vcproj	2006-07-05 20:15:00 UTC (rev 1375)
+++ trunk/yake/scripts/msvc8/samples/graphics/sampleDotScene.vcproj	2006-07-05 20:15:16 UTC (rev 1376)
@@ -1,225 +0,0 @@
-<?xml version="1.0" encoding="Windows-1252"?>
-<VisualStudioProject
-	ProjectType="Visual C++"
-	Version="8,00"
-	Name="sampleDotScene"
-	ProjectGUID="{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}"
-	Keyword="Win32Proj"
-	>
-	<Platforms>
-		<Platform
-			Name="Win32"
-		/>
-	</Platforms>
-	<ToolFiles>
-	</ToolFiles>
-	<Configurations>
-		<Configuration
-			Name="Debug|Win32"
-			OutputDirectory="../../../../common/bin/debug"
-			IntermediateDirectory="../../../../common/obj/debug/$(ProjectName)"
-			ConfigurationType="1"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				Optimization="0"
-				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
-				PreprocessorDefinitions="_STLP_DEBUG;WIN32;_DEBUG;_CONSOLE"
-				MinimalRebuild="true"
-				BasicRuntimeChecks="3"
-				RuntimeLibrary="3"
-				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
-				PrecompiledHeaderThrough="yapp/samples/graphics/dotScene/yakePCH.h"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="4"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib"
-				OutputFile="$(OutDir)/$(ProjectName).exe"
-				LinkIncremental="2"
-				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/lib"
-				GenerateDebugInformation="true"
-				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
-				SubSystem="1"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-		<Configuration
-			Name="Release|Win32"
-			OutputDirectory="../../../../common/bin/release"
-			IntermediateDirectory="../../../../common/obj/release/$(ProjectName)"
-			ConfigurationType="1"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
-				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE"
-				RuntimeLibrary="2"
-				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
-				PrecompiledHeaderThrough="yapp/samples/graphics/dotScene/yakePCH.h"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="3"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib"
-				OutputFile="$(OutDir)/$(ProjectName).exe"
-				LinkIncremental="1"
-				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"
-				GenerateDebugInformation="false"
-				SubSystem="1"
-				OptimizeReferences="2"
-				EnableCOMDATFolding="2"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-	</Configurations>
-	<References>
-	</References>
-	<Files>
-		<Filter
-			Name="inc"
-			>
-			<File
-				RelativePath="..\..\..\..\yapp\samples\graphics\dotscene\yakePCH.h"
-				>
-			</File>
-		</Filter>
-		<Filter
-			Name="src"
-			>
-			<File
-				RelativePath="..\..\..\..\src\yapp\samples\graphics\dotScene\yakeDotSceneDemo.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\..\..\src\yapp\samples\graphics\dotScene\yakePCH.cpp"
-				>
-				<FileConfiguration
-					Name="Debug|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-						PrecompiledHeaderThrough="yapp/samples/graphics/dotScene/yakePCH.h"
-					/>
-				</FileConfiguration>
-				<FileConfiguration
-					Name="Release|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
-			</File>
-		</Filter>
-	</Files>
-	<Globals>
-	</Globals>
-</VisualStudioProject>

Deleted: trunk/yake/scripts/msvc8/samples/model/sampleXODE.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/model/sampleXODE.vcproj	2006-07-05 20:15:00 UTC (rev 1375)
+++ trunk/yake/scripts/msvc8/samples/model/sampleXODE.vcproj	2006-07-05 20:15:16 UTC (rev 1376)
@@ -1,223 +0,0 @@
-<?xml version="1.0" encoding="Windows-1252"?>
-<VisualStudioProject
-	ProjectType="Visual C++"
-	Version="8,00"
-	Name="sampleModelXODE"
-	ProjectGUID="{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}"
-	Keyword="Win32Proj"
-	>
-	<Platforms>
-		<Platform
-			Name="Win32"
-		/>
-	</Platforms>
-	<ToolFiles>
-	</ToolFiles>
-	<Configurations>
-		<Configuration
-			Name="Debug|Win32"
-			OutputDirectory="../../../../common/bin/debug"
-			IntermediateDirectory="../../../../common/obj/debug/$(ProjectName)"
-			ConfigurationType="1"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				Optimization="0"
-				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
-				PreprocessorDefinitions="_STLP_DEBUG;WIN32;_DEBUG;_CONSOLE"
-				MinimalRebuild="true"
-				BasicRuntimeChecks="3"
-				RuntimeLibrary="3"
-				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
-				PrecompiledHeaderThrough="yapp/samples/model/yakePCH.h"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="4"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib"
-				OutputFile="$(OutDir)/$(ProjectName).exe"
-				LinkIncremental="2"
-				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/lib"
-				GenerateDebugInformation="true"
-				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
-				SubSystem="1"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-		<Configuration
-			Name="Release|Win32"
-			OutputDirectory="../../../../common/bin/release"
-			IntermediateDirectory="../../../../common/obj/release/$(ProjectName)"
-			ConfigurationType="1"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
-				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE"
-				RuntimeLibrary="2"
-				UsePrecompiledHeader="2"
-				PrecompiledHeaderThrough="yapp/samples/model/yakePCH.h"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="3"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib"
-				OutputFile="$(OutDir)/$(ProjectName).exe"
-				LinkIncremental="1"
-				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"
-				GenerateDebugInformation="false"
-				SubSystem="1"
-				OptimizeReferences="2"
-				EnableCOMDATFolding="2"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-	</Configurations>
-	<References>
-	</References>
-	<Files>
-		<Filter
-			Name="inc"
-			>
-			<File
-				RelativePath="..\..\..\..\yapp\samples\model\yakePCH.h"
-				>
-			</File>
-		</Filter>
-		<Filter
-			Name="src"
-			>
-			<File
-				RelativePath="..\..\..\..\src\yapp\samples\model\Xode\yakePCH.cpp"
-				>
-				<FileConfiguration
-					Name="Debug|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
-				<FileConfiguration
-					Name="Release|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
-			</File>
-			<File
-				RelativePath="..\..\..\..\src\yapp\samples\model\Xode\yakeXODELoaderDemo.cpp"
-				>
-			</File>
-		</Filter>
-	</Files>
-	<Globals>
-	</Globals>
-</VisualStudioProject>



From codeandroid at berlios.de  Wed Jul  5 22:15:35 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 22:15:35 +0200
Subject: [Yake-svn] r1377 - trunk/yake/src/yake/samples/net/roclient
Message-ID: <200607052015.k65KFZ3D030128@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 22:15:32 +0200 (Wed, 05 Jul 2006)
New Revision: 1377

Modified:
   trunk/yake/src/yake/samples/net/roclient/ROClient.cpp
Log:


Modified: trunk/yake/src/yake/samples/net/roclient/ROClient.cpp
===================================================================
--- trunk/yake/src/yake/samples/net/roclient/ROClient.cpp	2006-07-05 20:15:16 UTC (rev 1376)
+++ trunk/yake/src/yake/samples/net/roclient/ROClient.cpp	2006-07-05 20:15:32 UTC (rev 1377)
@@ -1,4 +1,5 @@
 #include <yake/samples/net/roclient/pch.h>
+#include <yake/base/yake.h>
 #include <yake/net/net.h>
 #include <yake/samples/net/common/common.h>
 #include <yake/samples/net/common/commonEvents.h>



From codeandroid at berlios.de  Wed Jul  5 22:16:17 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 22:16:17 +0200
Subject: [Yake-svn] r1378 - trunk/yake/src/yapp/raf
Message-ID: <200607052016.k65KGHC3030610@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 22:16:17 +0200 (Wed, 05 Jul 2006)
New Revision: 1378

Modified:
   trunk/yake/src/yapp/raf/yakeApplication.cpp
Log:
enabled lib name for win32

Modified: trunk/yake/src/yapp/raf/yakeApplication.cpp
===================================================================
--- trunk/yake/src/yapp/raf/yakeApplication.cpp	2006-07-05 20:15:32 UTC (rev 1377)
+++ trunk/yake/src/yapp/raf/yakeApplication.cpp	2006-07-05 20:16:17 UTC (rev 1378)
@@ -172,7 +172,8 @@
 #if YAKE_RAF_USES_CEGUI == 1
 	void Application::initCEGUI()
 	{
-		const String file = "CEGUIOgreAdapter";
+		//const String file = "CEGUIOgreAdapter";
+		const String file = "CEGUIOgreRendererAdapter";
 		yake::base::Library* pDynLib = new yake::base::Library( file ); //@FIXME. MEMORY LEAK.
 		YAKE_ASSERT( pDynLib ).debug( "Out of memory" );
 



From codeandroid at berlios.de  Wed Jul  5 22:16:33 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 22:16:33 +0200
Subject: [Yake-svn] r1379 - trunk/yake/src/yapp/samples/base
Message-ID: <200607052016.k65KGXEh030812@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 22:16:32 +0200 (Wed, 05 Jul 2006)
New Revision: 1379

Removed:
   trunk/yake/src/yapp/samples/base/statemachine/
Log:
various fixes to get the samples (mostly) uptodate,
deprecated a few samples



From codeandroid at berlios.de  Wed Jul  5 22:16:54 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 22:16:54 +0200
Subject: [Yake-svn] r1380 - in trunk/yake/src/yapp/samples/model: . sync1
Message-ID: <200607052016.k65KGsHZ031065@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 22:16:50 +0200 (Wed, 05 Jul 2006)
New Revision: 1380

Removed:
   trunk/yake/src/yapp/samples/model/XODE/
Modified:
   trunk/yake/src/yapp/samples/model/sync1/yakeDemo.cpp
Log:
various fixes to get the samples (mostly) uptodate,
deprecated a few samples

Modified: trunk/yake/src/yapp/samples/model/sync1/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/model/sync1/yakeDemo.cpp	2006-07-05 20:16:32 UTC (rev 1379)
+++ trunk/yake/src/yapp/samples/model/sync1/yakeDemo.cpp	2006-07-05 20:16:50 UTC (rev 1380)
@@ -31,10 +31,7 @@
 //============================================================================
 #include <yapp/samples/model/yakePCH.h>
 #include <yake/samples/graphics/pch.h>
-#include <yapp/model/yakeGraphical.h>
-#include <yapp/base/yapp.h>
-#include <yapp/model/yakePhysical.h>
-#include <yapp/model/yakeModelMovableLink.h>
+#include <yake/model/model.h>
 
 using namespace yake;
 using namespace yake::graphics;
@@ -194,15 +191,14 @@
 		}
 	}
 
-
-	class ModelLink_DynActorToMovable : public model::ModelLinkController< physics::IActor >
+	class ModelLink_DynActorToMovable: public ModelLink, public Updatable2<uint32,real>
 	{
 	public:
 		YAKE_DECLARE_CONCRETE( ModelLink_DynActorToMovable, "yake.DynamicsActorToMovable" );
 
 		ModelLink_DynActorToMovable(const real startTime = real(0.), const real interpTimeOffset = real(0.));
 
-		virtual void update(real timeElapsed);
+		virtual void update( const uint32, const real timeElapsed );
 		void updateHistoryFromSource(real theTime);
 
 		typedef Signal1< void(const Vector3 &) > PositionSignal;
@@ -213,9 +209,14 @@
 		SignalConnection subscribeToPositionChanged( Movable* pMovable );
 		SignalConnection subscribeToOrientationChanged( Movable* pMovable );
 
+		void setSource(physics::IActor* );
+		physics::IActor* getSource() const;
+
 		typedef model::DynamicsMoveHistory MoveHistory;
 		//void addMove( const MoveHistory::Move& move );
 	private:
+		physics::IActor*		mpSource;
+
 		MoveHistory				mMoveHistory;
 		real					mTime;
 		real					mInterpTimeOffset;
@@ -228,15 +229,24 @@
 	};
 	ModelLink_DynActorToMovable::ModelLink_DynActorToMovable(const real startTime /*= real(0.)*/, const real interpTimeOffset /*= real(0.)*/) :
 		mTime(startTime),
-		mInterpTimeOffset(interpTimeOffset)
+		mInterpTimeOffset(interpTimeOffset),
+		mpSource(0)
 	{
 	}
-	void ModelLink_DynActorToMovable::update(real timeElapsed)
+	void ModelLink_DynActorToMovable::setSource(physics::IActor* source)
 	{
+		mpSource = source;
+	}
+	physics::IActor* ModelLink_DynActorToMovable::getSource() const
+	{
+		return mpSource;
+	}
+	void ModelLink_DynActorToMovable::update( const uint32, const real timeElapsed )
+	{
 		mTime += timeElapsed;
-		const physics::IActor* pSource = getSource();
-		Vector3 position = pSource ? pSource->getPosition() : Vector3::kZero;
-		Quaternion orientation = pSource ? pSource->getOrientation() : Quaternion::kIdentity;
+		YAKE_ASSERT( mpSource );
+		Vector3 position = mpSource ? mpSource->getPosition() : Vector3::kZero;
+		Quaternion orientation = mpSource ? mpSource->getOrientation() : Quaternion::kIdentity;
 		mMoveHistory.interpolateTo( mTime + mInterpTimeOffset, position, orientation );
 
 		// fire signals if necessary
@@ -275,7 +285,7 @@
 } // ns model
 } // ns yake
 
-class TheApp : public yake::exapp::ExampleApplication
+class TheApp : public yake::exapp::ExampleApplication, public yake::model::CentralControllerBase
 {
 private:
 	Vector< std::pair<IViewport*,ICamera*> >	mVPs;
@@ -285,8 +295,8 @@
 
 	struct Object
 	{
-		SharedPtr<model::complex::Model>	mComplex;
-		SharedPtr<model::Graphical>		mGraphical;
+		SharedPtr<model::Model>					mComplex;
+		SharedPtr<model::Graphical>				mGraphical;
 
 		physics::IActor*						mPhysical;
 		graphics::ISceneNode*					mpSN;
@@ -338,7 +348,7 @@
 	}
 	void setupObject(Object& obj)
 	{
-		obj.mComplex.reset( new model::complex::Model() );
+		obj.mComplex.reset( new model::Model() );
 		using namespace model;
 
 		// Loading physical part
@@ -347,14 +357,14 @@
 		obj.mPhysical->createShape( physics::IShape::BoxDesc(Vector3(1,1,1)) );
 		Physical* pP = new Physical();
 		pP->addActor( obj.mPhysical, "root" );
-		obj.mComplex->addPhysical( SharedPtr<Physical>(pP), "p_box" );
+		obj.mComplex->addComponent( pP, "p_box" );
 
 		// Loading graphical part
 		obj.mGraphical.reset( new model::Graphical() );
 		YAKE_ASSERT( obj.mGraphical );
 
 		obj.mpSN = mGWorld->createSceneNode();
-		obj.mGraphical->addSceneNode( obj.mpSN, false );
+		obj.mGraphical->addSceneNode( obj.mpSN, "rootsn", false );
 		obj.mpSN->attachEntity( mGWorld->createEntity("box_1x1x1.mesh") );
 
 		// linking
@@ -364,7 +374,9 @@
 			obj.mpLink->subscribeToPositionChanged( obj.mpSN );
 			obj.mpLink->subscribeToOrientationChanged( obj.mpSN );
 
-			obj.mComplex->addLink( SharedPtr<model::ModelLink>( obj.mpLink ), "body2scenenode" );
+			obj.mComplex->addLink( obj.mpLink/*, "body2scenenode" */);
+
+			this->subscribeToGraphicsUpdate( Bind2(&Object::Link::update,obj.mpLink) );
 		}
 
 		obj.mPostStepConn = mPWorld->subscribeToPostStep(
@@ -467,10 +479,11 @@
 				{
 					mPWorld->step( physicsStepTime );
 					ptimeElapsed -= physicsStepTime;
+					triggerPhysicsUpdateSignal(0,physicsStepTime);
 				}
 
 				//// graphics: variable time step: as fast as possible
-				obj.mComplex->updateGraphics( timeElapsed );
+				triggerGraphicsUpdateSignal(0,timeElapsed);
 				
 				mGWorld->render( timeElapsed );
 			}



From codeandroid at berlios.de  Wed Jul  5 22:17:09 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 22:17:09 +0200
Subject: [Yake-svn] r1381 - in trunk/yake/src/yapp/samples: gui/console misc/cmdrmayhem
Message-ID: <200607052017.k65KH98p031273@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 22:17:08 +0200 (Wed, 05 Jul 2006)
New Revision: 1381

Modified:
   trunk/yake/src/yapp/samples/gui/console/yakeConsoleDemo.cpp
   trunk/yake/src/yapp/samples/misc/cmdrmayhem/yakeDemo.cpp
Log:
various fixes to get the samples (mostly) uptodate,
deprecated a few samples

Modified: trunk/yake/src/yapp/samples/gui/console/yakeConsoleDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/gui/console/yakeConsoleDemo.cpp	2006-07-05 20:16:50 UTC (rev 1380)
+++ trunk/yake/src/yapp/samples/gui/console/yakeConsoleDemo.cpp	2006-07-05 20:17:08 UTC (rev 1381)
@@ -52,7 +52,7 @@
 #include <yake/data/yakeData.h>
 #include <yapp/common/yakeCEGUIRendererAdapter.h>
 #include <yapp/common/yakeCEGUIHelpers.h>
-#include <yapp/model/yakeGraphical.h>
+#include <yake/model/yakeGraphical.h>
 
 // console 
 #include <yapp/gui_addons/console/yakeGenericConsole.h>
@@ -349,8 +349,8 @@
 	 */
 	void initGui()
 	{
-		mGuiRendererAdapter = loadPlugin( "CEGUIOgreAdapter" );
-		//mGuiRendererAdapter = loadPlugin( "ceguiOgreRendererAdapter" );
+		//mGuiRendererAdapter = loadPlugin( "CEGUIOgreAdapter" );
+		mGuiRendererAdapter = loadPlugin( "ceguiOgreRendererAdapter" );
 		YAKE_ASSERT( mGuiRendererAdapter );
 
 		YAKE_LOG( "Starting adapter version " + mGuiRendererAdapter->getName() );

Modified: trunk/yake/src/yapp/samples/misc/cmdrmayhem/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/misc/cmdrmayhem/yakeDemo.cpp	2006-07-05 20:16:50 UTC (rev 1380)
+++ trunk/yake/src/yapp/samples/misc/cmdrmayhem/yakeDemo.cpp	2006-07-05 20:17:08 UTC (rev 1381)
@@ -1,11 +1,8 @@
 #include <yapp/samples/misc/cmdrmayhem/yakePCH.h>
 #include <yake/audio/yakeAudio.h>
 #include <yapp/raf/yakeRaf.h>
-#include <yapp/model/yakeModelMovableLink.h>
+#include <yake/model/model.h>
 #include <yake/input/yakeInput.h>
-#include <yapp/loader/yakeXODEParser.h>
-#include <yapp/model/yakePhysicalDataImporter.h>
-#include <yapp/loader/yakeDotLinkLoader.h>
 #include <yapp/common/yakeCameraControllers.h>
 
 using namespace yake;
@@ -40,46 +37,18 @@
 
 struct Env
 {
-	SharedPtr<model::complex::Model> model_;
+	SharedPtr<model::Model> model_;
 };
 void loadEnvironment(Env& env, graphics::IWorld* pGWorld, physics::IWorld* pPWorld, const String& dotSceneFn, const String& dotXodeFn, const String& dotLinkFn)
 {
 	YAKE_ASSERT( pGWorld );
 	YAKE_ASSERT( pPWorld );
 
-	// Loading graphical part
-	model::Graphical* pG = new model::Graphical();
-	pG->fromDotScene( dotSceneFn, pGWorld );
-
-	// Loading physical part
-	model::Physical* pP = new model::Physical();
-
-	yake::data::dom::xml::XmlSerializer ser;
-	ser.parse( dotXodeFn, false );
-	YAKE_ASSERT( ser.getDocumentNode() )( dotXodeFn ).error("Could not load XODE document!");
-
-	data::parser::xode::XODEParserV1 parser;
-
-	using namespace yake::model;
-	model::XODEListener listener( *pP, pPWorld );
-
-	parser.subscribeToBodySignal( Bind1( &XODEListener::processBody, &listener ) );
-	parser.subscribeToGeomSignal( Bind1( &XODEListener::processGeom, &listener ) );
-
-	parser.load( ser.getDocumentNode() );
-
-	// Bringing it all together!
-	env.model_.reset( new model::complex::Model() );
-
-	env.model_->addGraphical( pG, "baseGraphical" );
-	env.model_->addPhysical( pP, "basePhysical" );
-
-	model::DotLinkLoader dotLinkLoader;
-	dotLinkLoader.load( dotLinkFn, *env.model_.get() );
+	YAKE_ASSERT( 0 );
 }
 
 /** Main application state */
-class TheMainState : public raf::RtMainState
+class TheMainState : public raf::RtMainState, public yake::model::CentralControllerBase
 {
 public:
 	TheMainState(raf::Application& owner) :
@@ -100,6 +69,8 @@
 	{
 		YAKE_LOG_INFORMATION("Creating scene");
 
+		getPhysicalWorld()->setGlobalGravity(Vector3(0,-2,0));
+
 		// create a light
 		graphics::ILight* pLight = getGraphicalWorld()->createLight();
 		pLight->setType( graphics::ILight::LT_DIRECTIONAL );
@@ -114,7 +85,7 @@
 		getDefaultCamera()->setPosition(math::Vector3(7,4,-7));
 
 		// create ground
-		mGround = new model::complex::Model();
+		mGround = new model::Model();
 		{
 			const real groundHeight = -2;
 			// visual
@@ -127,8 +98,8 @@
 			pGroundSN->setPosition( math::Vector3(0,groundHeight,0) );
 
 			model::Graphical* pG = new model::Graphical();
-			pG->addSceneNode( pGroundSN );
-			mGround->addGraphical( pG );
+			pG->addSceneNode( pGroundSN, "ground", true );
+			mGround->addComponent( pG, "p" );
 
 			// physical
 			physics::IActorPtr pGroundPlane = getPhysicalWorld()->createActor( physics::ACTOR_STATIC );
@@ -136,7 +107,7 @@
 
 			model::Physical* pP = new model::Physical();
 			pP->addActor( pGroundPlane, "groundPlane" );
-			mGround->addPhysical( pP );
+			mGround->addComponent( pP, "g" );
 		}
 
 		// sky box
@@ -158,20 +129,21 @@
 			);
 		YAKE_ASSERT( mPlayerRep );
 		{
-			mComplex = new model::complex::Model();
+			mComplex = new model::Model();
 			model::Graphical* pG = new model::Graphical();
-			mComplex->addGraphical( pG );
+			mComplex->addComponent( pG );
 			graphics::ISceneNode* pSN = getGraphicalWorld()->createSceneNode();
-			pG->addSceneNode( pSN );
+			pG->addSceneNode( pSN, "playerSN" );
 			graphics::IEntity* pE = getGraphicalWorld()->createEntity("sphere_d1.mesh");
 			pSN->attachEntity( pE );
 			pSN->setScale( 0.5 * math::Vector3::kUnitScale );
 
-			model::ModelMovableLink* pLink = new model::ModelMovableLink();
-			mComplex->addGraphicsController( pLink );
+			model::ModelMovableDirectLink* pLink = new model::ModelMovableDirectLink();
+			mComplex->addLink( pLink );
 			pLink->setSource( mPlayerRep );
 			pLink->subscribeToPositionChanged( pSN );
 			pLink->subscribeToOrientationChanged( pSN );
+			this->subscribeToGraphicsUpdate( Bind2(&model::ModelMovableDirectLink::update,pLink) );
 		}
 
 		// top-down camera controller
@@ -256,8 +228,8 @@
 
 		if (mComplex)
 		{
-			mComplex->updatePhysics( timeElapsed );
-			mComplex->updateGraphics( timeElapsed );
+			this->triggerGraphicsUpdateSignal(0,timeElapsed);
+			this->triggerPhysicsUpdateSignal(0,timeElapsed);
 		}
 
 		{ // top-down controller
@@ -295,8 +267,8 @@
 	{ mActiveActions.insert( input::ACTIONID_DOWN ); }
 private:
 	physics::IAvatarPtr		mPlayerRep;
-	model::complex::Model*	mGround;
-	model::complex::Model*	mComplex;
+	model::Model*	mGround;
+	model::Model*	mComplex;
 	input::ActionMap		mActionMap;
 
 	typedef std::set<input::ActionId> ActionIdList;



From codeandroid at berlios.de  Wed Jul  5 22:17:38 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 22:17:38 +0200
Subject: [Yake-svn] r1382 - trunk/yake/yake/samples/net/common
Message-ID: <200607052017.k65KHcXq031588@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 22:17:36 +0200 (Wed, 05 Jul 2006)
New Revision: 1382

Modified:
   trunk/yake/yake/samples/net/common/commonEvents.h
Log:


Modified: trunk/yake/yake/samples/net/common/commonEvents.h
===================================================================
--- trunk/yake/yake/samples/net/common/commonEvents.h	2006-07-05 20:17:08 UTC (rev 1381)
+++ trunk/yake/yake/samples/net/common/commonEvents.h	2006-07-05 20:17:36 UTC (rev 1382)
@@ -107,11 +107,20 @@
 	virtual bool pack(net::obitstream& out) const
 	{
 		out.write( accepted );
+		std::string msg("blah burp!");
+		out.write( msg.c_str(), msg.size()+1 );
 		return true;
 	}
 	virtual bool unpack(net::ibitstream& in)
 	{
 		in.read( accepted );
+		std::string msg;
+		net::uint8 c = 0;
+		while (in.read(c,8))
+		{
+			msg += c;
+		}
+		COUTLN("MSG " << msg.c_str());
 		return true;
 	}
 	bool accepted;



From codeandroid at berlios.de  Wed Jul  5 22:18:02 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 22:18:02 +0200
Subject: [Yake-svn] r1383 - in trunk/yake/yapp/samples: base misc/cmdrmayhem
Message-ID: <200607052018.k65KI2Li031817@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 22:18:00 +0200 (Wed, 05 Jul 2006)
New Revision: 1383

Removed:
   trunk/yake/yapp/samples/base/statemachine/
Modified:
   trunk/yake/yapp/samples/misc/cmdrmayhem/yakePCH.h
Log:
various fixes to get the samples (mostly) uptodate,
deprecated a few samples

Modified: trunk/yake/yapp/samples/misc/cmdrmayhem/yakePCH.h
===================================================================
--- trunk/yake/yapp/samples/misc/cmdrmayhem/yakePCH.h	2006-07-05 20:17:36 UTC (rev 1382)
+++ trunk/yake/yapp/samples/misc/cmdrmayhem/yakePCH.h	2006-07-05 20:18:00 UTC (rev 1383)
@@ -7,4 +7,4 @@
 #include <yake/base/yake.h>
 #include <yake/scripting/yakeScriptingSystem.h>
 #include <yapp/base/yapp.h>
-#include <yake/ent/yakeEnt.h>
+#include <yake/ent/ent.h>



From codeandroid at berlios.de  Wed Jul  5 22:18:32 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 5 Jul 2006 22:18:32 +0200
Subject: [Yake-svn] r1384 - trunk/yake/scripts/msvc8
Message-ID: <200607052018.k65KIWhA031987@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-05 22:18:31 +0200 (Wed, 05 Jul 2006)
New Revision: 1384

Modified:
   trunk/yake/scripts/msvc8/samples.sln
   trunk/yake/scripts/msvc8/yake.sln
Log:
various fixes to get the samples (mostly) uptodate,
deprecated a few samples

Modified: trunk/yake/scripts/msvc8/samples.sln
===================================================================
--- trunk/yake/scripts/msvc8/samples.sln	2006-07-05 20:18:00 UTC (rev 1383)
+++ trunk/yake/scripts/msvc8/samples.sln	2006-07-05 20:18:31 UTC (rev 1384)
@@ -19,12 +19,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleCmdrMayhem", "samples\misc\sampleCmdrMayhem.vcproj", "{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleModelDotLink", "samples\model\sampleDotLink.vcproj", "{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}"
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleModelSync1", "samples\model\sampleSync1.vcproj", "{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleModelXODE", "samples\model\sampleXODE.vcproj", "{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}"
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleMsg1", "samples\msg\sampleMsg1.vcproj", "{452438E8-F03B-47B9-984B-2CF79D2F6734}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRoClient", "samples\net\sampleRoClient.vcproj", "{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}"
@@ -39,8 +35,6 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleScriptingLua", "samples\scripting\sampleScriptingLua.vcproj", "{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleStateMachine", "samples\state\sampleStateMachine.vcproj", "{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}"
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleFsm1", "samples\statemachine\sampleFsm1.vcproj", "{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleEvents", "samples\base\sampleEvents.vcproj", "{CD6F13A0-F399-411A-9766-0F8E02761D90}"
@@ -49,8 +43,6 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleNetPacket", "samples\net\sampleNetPacket.vcproj", "{5473599B-AB7B-4259-B052-4DDC68CBEA54}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleDotScene", "samples\graphics\sampleDotScene.vcproj", "{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}"
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleModel1", "samples\model\sampleModel1.vcproj", "{920E5CA3-620C-43C3-986C-5A6F9397F6DA}"
 EndProject
 Global
@@ -95,18 +87,10 @@
 		{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}.Debug|Win32.Build.0 = Debug|Win32
 		{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}.Release|Win32.ActiveCfg = Release|Win32
 		{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}.Release|Win32.Build.0 = Release|Win32
-		{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}.Debug|Win32.ActiveCfg = Debug|Win32
-		{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}.Debug|Win32.Build.0 = Debug|Win32
-		{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}.Release|Win32.ActiveCfg = Release|Win32
-		{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}.Release|Win32.Build.0 = Release|Win32
 		{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}.Debug|Win32.ActiveCfg = Debug|Win32
 		{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}.Debug|Win32.Build.0 = Debug|Win32
 		{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}.Release|Win32.ActiveCfg = Release|Win32
 		{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}.Release|Win32.Build.0 = Release|Win32
-		{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}.Debug|Win32.ActiveCfg = Debug|Win32
-		{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}.Debug|Win32.Build.0 = Debug|Win32
-		{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}.Release|Win32.ActiveCfg = Release|Win32
-		{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}.Release|Win32.Build.0 = Release|Win32
 		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Debug|Win32.ActiveCfg = Debug|Win32
 		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Debug|Win32.Build.0 = Debug|Win32
 		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Release|Win32.ActiveCfg = Release|Win32
@@ -135,10 +119,6 @@
 		{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}.Debug|Win32.Build.0 = Debug|Win32
 		{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}.Release|Win32.ActiveCfg = Release|Win32
 		{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}.Release|Win32.Build.0 = Release|Win32
-		{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}.Debug|Win32.ActiveCfg = Debug|Win32
-		{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}.Debug|Win32.Build.0 = Debug|Win32
-		{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}.Release|Win32.ActiveCfg = Release|Win32
-		{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}.Release|Win32.Build.0 = Release|Win32
 		{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}.Debug|Win32.ActiveCfg = Debug|Win32
 		{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}.Debug|Win32.Build.0 = Debug|Win32
 		{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}.Release|Win32.ActiveCfg = Release|Win32
@@ -155,10 +135,6 @@
 		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Debug|Win32.Build.0 = Debug|Win32
 		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Release|Win32.ActiveCfg = Release|Win32
 		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Release|Win32.Build.0 = Release|Win32
-		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Debug|Win32.ActiveCfg = Debug|Win32
-		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Debug|Win32.Build.0 = Debug|Win32
-		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Release|Win32.ActiveCfg = Release|Win32
-		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Release|Win32.Build.0 = Release|Win32
 		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Debug|Win32.ActiveCfg = Debug|Win32
 		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Debug|Win32.Build.0 = Debug|Win32
 		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Release|Win32.ActiveCfg = Release|Win32

Modified: trunk/yake/scripts/msvc8/yake.sln
===================================================================
--- trunk/yake/scripts/msvc8/yake.sln	2006-07-05 20:18:00 UTC (rev 1383)
+++ trunk/yake/scripts/msvc8/yake.sln	2006-07-05 20:18:31 UTC (rev 1384)
@@ -130,8 +130,6 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "model", "model.vcproj", "{6BB1D3EF-8836-4D23-BE24-340D310D9913}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleModelDotScene", "samples\model\sampleDotScene.vcproj", "{920E5CA3-620C-43C3-986C-5A6F9397F6DA}"
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "loader", "loader.vcproj", "{2E5A589E-41FE-4BE9-80A0-1F8570944486}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "samplePhysicsDemo", "samples\physics\samplePhysicsDemo.vcproj", "{3DA99679-404B-44C7-9267-C97D066F3D96}"
@@ -264,10 +262,6 @@
 		{6BB1D3EF-8836-4D23-BE24-340D310D9913}.Debug|Win32.Build.0 = Debug|Win32
 		{6BB1D3EF-8836-4D23-BE24-340D310D9913}.Release|Win32.ActiveCfg = Release|Win32
 		{6BB1D3EF-8836-4D23-BE24-340D310D9913}.Release|Win32.Build.0 = Release|Win32
-		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Debug|Win32.ActiveCfg = Debug|Win32
-		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Debug|Win32.Build.0 = Debug|Win32
-		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Release|Win32.ActiveCfg = Release|Win32
-		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Release|Win32.Build.0 = Release|Win32
 		{2E5A589E-41FE-4BE9-80A0-1F8570944486}.Debug|Win32.ActiveCfg = Debug|Win32
 		{2E5A589E-41FE-4BE9-80A0-1F8570944486}.Debug|Win32.Build.0 = Debug|Win32
 		{2E5A589E-41FE-4BE9-80A0-1F8570944486}.Release|Win32.ActiveCfg = Release|Win32



From codeandroid at mail.berlios.de  Fri Jul 14 19:14:40 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Fri, 14 Jul 2006 19:14:40 +0200
Subject: [Yake-svn] r1385 - trunk/yake/src/yake/model
Message-ID: <200607141714.k6EHEebt019414@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-14 19:14:38 +0200 (Fri, 14 Jul 2006)
New Revision: 1385

Modified:
   trunk/yake/src/yake/model/yakeModelManager.cpp
Log:
removed inproperly placed assertion

Modified: trunk/yake/src/yake/model/yakeModelManager.cpp
===================================================================
--- trunk/yake/src/yake/model/yakeModelManager.cpp	2006-07-05 20:18:31 UTC (rev 1384)
+++ trunk/yake/src/yake/model/yakeModelManager.cpp	2006-07-14 17:14:38 UTC (rev 1385)
@@ -130,13 +130,6 @@
 			sigPreCreateModelComponent_(*m,ctx_,type);
 			creatorMgr_.create( type, ctx_, params );
 			sigPostCreateModelComponent_(*m,ctx_,type);
-
-#ifdef YAKE_DEBUG
-			if (!name.empty())
-			{
-				YAKE_ASSERT( m->getComponentByTag(name) != 0 )(name)(type).debug("Failed to create component!");
-			}
-#endif
 		}
 		ctx_.model_ = 0;
 		sigModelInitializedSignal_(*m,ctx_);



From codeandroid at mail.berlios.de  Sat Jul 15 16:29:58 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Sat, 15 Jul 2006 16:29:58 +0200
Subject: [Yake-svn] r1386 - in trunk/yake: src/yake/model src/yapp/raf
	src/yapp/samples/misc/car src/yapp/vehicle yake/model yapp/vehicle
Message-ID: <200607151429.k6FETwCr002647@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-15 16:29:56 +0200 (Sat, 15 Jul 2006)
New Revision: 1386

Modified:
   trunk/yake/src/yake/model/yakeGraphicalCreator.cpp
   trunk/yake/src/yake/model/yakeLinkCreator.cpp
   trunk/yake/src/yake/model/yakeModelComponentContainer.cpp
   trunk/yake/src/yake/model/yakeModelManager.cpp
   trunk/yake/src/yake/model/yakePhysicalCreator.cpp
   trunk/yake/src/yapp/raf/yakeApplication.cpp
   trunk/yake/src/yapp/samples/misc/car/yakeDemo.cpp
   trunk/yake/src/yapp/vehicle/yakeNativeOde.cpp
   trunk/yake/yake/model/model.h
   trunk/yake/yake/model/model_component.h
   trunk/yake/yapp/vehicle/yakeInterfaces.h
   trunk/yake/yapp/vehicle/yakeNativeOde.h
   trunk/yake/yapp/vehicle/yakeVehicle.h
Log:
added "graphics/empty" and "physics/empty" component creators,
fixed object management policy in yake::vehicle,
added generic model generation context parameters

Modified: trunk/yake/src/yake/model/yakeGraphicalCreator.cpp
===================================================================
--- trunk/yake/src/yake/model/yakeGraphicalCreator.cpp	2006-07-14 17:14:38 UTC (rev 1385)
+++ trunk/yake/src/yake/model/yakeGraphicalCreator.cpp	2006-07-15 14:29:56 UTC (rev 1386)
@@ -32,6 +32,21 @@
 namespace yake {
 namespace model {
 
+	//-----------------------------------------------------
+	// class GraphicalFromDotSceneCreator
+	//-----------------------------------------------------
+
+	struct GraphicalFromDotSceneCreator : public ComponentCreator
+	{
+		YAKE_DECLARE_CONCRETE(GraphicalFromDotSceneCreator,"graphics/dotScene");
+
+		GraphicalFromDotSceneCreator();
+		virtual void create(const ComponentCreationContext& ctx, const StringMap& params);
+
+	private:
+		SharedPtr<data::parser::dotscene::DotSceneParser>	defaultParser_;
+	};
+
 	YAKE_REGISTER_CONCRETE(GraphicalFromDotSceneCreator)
 
 	GraphicalFromDotSceneCreator::GraphicalFromDotSceneCreator() :
@@ -101,5 +116,35 @@
 		ctx.model_->addComponent( pGraphical, name );
 	}
 
+	//-----------------------------------------------------
+	// class GraphicalEmptyCreator
+	//-----------------------------------------------------
+
+	struct GraphicalEmptyCreator : public ComponentCreator
+	{
+		YAKE_DECLARE_CONCRETE(GraphicalEmptyCreator,"graphics/empty");
+
+		GraphicalEmptyCreator();
+		virtual void create(const ComponentCreationContext& ctx, const StringMap& params);
+	};
+
+	YAKE_REGISTER_CONCRETE(GraphicalEmptyCreator)
+
+	GraphicalEmptyCreator::GraphicalEmptyCreator()
+	{
+	}
+	void GraphicalEmptyCreator::create(const ComponentCreationContext& ctx, const StringMap& params)
+	{
+		// Extract parameters
+
+		StringMap::const_iterator itParam = params.find("name");
+		YAKE_ASSERT(itParam != params.end()).debug("Missing parameter 'name'.");
+		if (itParam == params.end())
+			return;
+		const String name = itParam->second;
+
+		YAKE_ASSERT( ctx.model_ );
+		ctx.model_->addComponent( new Graphical(), name );
+	}
 } // namespace model
 } // namespace yake

Modified: trunk/yake/src/yake/model/yakeLinkCreator.cpp
===================================================================
--- trunk/yake/src/yake/model/yakeLinkCreator.cpp	2006-07-14 17:14:38 UTC (rev 1385)
+++ trunk/yake/src/yake/model/yakeLinkCreator.cpp	2006-07-15 14:29:56 UTC (rev 1386)
@@ -32,6 +32,17 @@
 namespace yake {
 namespace model {
 
+	//-----------------------------------------------------
+	// class LinkFromDotLinkCreator
+	//-----------------------------------------------------
+
+	struct LinkFromDotLinkCreator : public ComponentCreator
+	{
+		YAKE_DECLARE_CONCRETE(LinkFromDotLinkCreator,"model/dotLink");
+
+		virtual void create(const ComponentCreationContext& ctx, const StringMap& params);
+	};
+
 	YAKE_REGISTER_CONCRETE(LinkFromDotLinkCreator)
 
 	void LinkFromDotLinkCreator::create(const ComponentCreationContext& ctx, const StringMap& params)

Modified: trunk/yake/src/yake/model/yakeModelComponentContainer.cpp
===================================================================
--- trunk/yake/src/yake/model/yakeModelComponentContainer.cpp	2006-07-14 17:14:38 UTC (rev 1385)
+++ trunk/yake/src/yake/model/yakeModelComponentContainer.cpp	2006-07-15 14:29:56 UTC (rev 1386)
@@ -37,6 +37,9 @@
 	ModelComponentContainer::ModelComponentContainer()
 	{
 	}
+	ModelComponentContainer::~ModelComponentContainer()
+	{
+	}
 	/*
 	void ModelComponentContainer::_cloneComponents(Model& cloned) const
 	{
@@ -77,17 +80,16 @@
 		YAKE_ASSERT( c );
 		YAKE_ASSERT( !tag.empty() )(tag);
 
-		SharedPtr<ModelComponent> ptr(c);
-		components_.push_back( ptr );
+		components_.push_back( SharedPtr<ModelComponent>(c) );
 #ifdef YAKE_DEBUG_BUILD
 		YAKE_ASSERT( tag2components_.end() == tag2components_.find(tag) );
 #endif
-		tag2components_[ tag ] = ptr;
+		tag2components_[ tag ] = c;
 	}
 	ModelComponent* ModelComponentContainer::getComponentByTag(const ComponentTag& tag) const
 	{
 		TagModelComponentMap::const_iterator it = tag2components_.find(tag);
-		return ((it == tag2components_.end()) ? 0 : it->second.get());
+		return ((it == tag2components_.end()) ? 0 : it->second);
 	}
 	ModelComponent* ModelComponentContainer::getComponentByIndex(const size_t idx) const
 	{

Modified: trunk/yake/src/yake/model/yakeModelManager.cpp
===================================================================
--- trunk/yake/src/yake/model/yakeModelManager.cpp	2006-07-14 17:14:38 UTC (rev 1385)
+++ trunk/yake/src/yake/model/yakeModelManager.cpp	2006-07-15 14:29:56 UTC (rev 1386)
@@ -193,6 +193,13 @@
 	{
 		ctx_.xodeParser_ = parser;
 	}
+	void ModelManager::setCreationContext_NamedParameter(const String& name, const boost::any& value)
+	{
+		YAKE_ASSERT( !name.empty() );
+		if (name.empty())
+			return;
+		ctx_.params_[ name ] = value;
+	}
 
 } // namespace model
 } // namespace yake

Modified: trunk/yake/src/yake/model/yakePhysicalCreator.cpp
===================================================================
--- trunk/yake/src/yake/model/yakePhysicalCreator.cpp	2006-07-14 17:14:38 UTC (rev 1385)
+++ trunk/yake/src/yake/model/yakePhysicalCreator.cpp	2006-07-15 14:29:56 UTC (rev 1386)
@@ -32,6 +32,20 @@
 namespace yake {
 namespace model {
 
+	//-----------------------------------------------------
+	// class PhysicalFromXODECreator
+	//-----------------------------------------------------
+	struct PhysicalFromXODECreator : public ComponentCreator
+	{
+		YAKE_DECLARE_CONCRETE(PhysicalFromXODECreator,"physics/dotXODE");
+
+		PhysicalFromXODECreator();
+		virtual void create(const ComponentCreationContext& ctx, const StringMap& params);
+
+	private:
+		SharedPtr<data::parser::xode::XODEParser>	defaultParser_;
+	};
+
 	YAKE_REGISTER_CONCRETE(PhysicalFromXODECreator)
 
 	PhysicalFromXODECreator::PhysicalFromXODECreator() :
@@ -95,5 +109,34 @@
 		ctx.model_->addComponent( pPhysical, name );
 	}
 
+	//-----------------------------------------------------
+	// class PhysicalEmptyCreator
+	//-----------------------------------------------------
+	struct PhysicalEmptyCreator : public ComponentCreator
+	{
+		YAKE_DECLARE_CONCRETE(PhysicalEmptyCreator,"physics/empty");
+
+		PhysicalEmptyCreator();
+		virtual void create(const ComponentCreationContext& ctx, const StringMap& params);
+	};
+
+	YAKE_REGISTER_CONCRETE(PhysicalEmptyCreator)
+
+	PhysicalEmptyCreator::PhysicalEmptyCreator()
+	{
+	}
+	void PhysicalEmptyCreator::create(const ComponentCreationContext& ctx, const StringMap& params)
+	{
+		// Extract parameters
+
+		StringMap::const_iterator itParam = params.find("name");
+		YAKE_ASSERT(itParam != params.end()).debug("Missing parameter 'name'.");
+		if (itParam == params.end())
+			return;
+		const String name = itParam->second;
+
+		YAKE_ASSERT( ctx.model_ );
+		ctx.model_->addComponent( new Physical(), name );
+	}
 } // namespace model
 } // namespace yake

Modified: trunk/yake/src/yapp/raf/yakeApplication.cpp
===================================================================
--- trunk/yake/src/yapp/raf/yakeApplication.cpp	2006-07-14 17:14:38 UTC (rev 1385)
+++ trunk/yake/src/yapp/raf/yakeApplication.cpp	2006-07-15 14:29:56 UTC (rev 1386)
@@ -373,6 +373,7 @@
 		if (!mMainState)
 			return false;
 		mMachine->addState( "main", mMainState );
+		mMachine->addState( "dead", new ApplicationState(*this) );
 
 		// user application init
 		if (!onInitialise())
@@ -389,6 +390,7 @@
 		YAKE_ASSERT( mMachine );
 		if (mMachine)
 		{
+			mMachine->setState("dead"); // This trigger's onExit etc
 			YAKE_SAFE_DELETE( mMachine );
 		}
 #if YAKE_RAF_USES_CEGUI == 1
@@ -422,6 +424,7 @@
 			return false;
 		mMachine->setState("main"); // initial state
 		mMachine->step();
+		mMachine->setState("dead");
 		return true;
 	}
 	AppMachine* Application::getMachine()

Modified: trunk/yake/src/yapp/samples/misc/car/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/misc/car/yakeDemo.cpp	2006-07-14 17:14:38 UTC (rev 1385)
+++ trunk/yake/src/yapp/samples/misc/car/yakeDemo.cpp	2006-07-15 14:29:56 UTC (rev 1386)
@@ -45,7 +45,7 @@
 	TheMainState(raf::Application& owner) :
 		raf::RtMainState(owner),
 		mVehicle(0),
-		mComplex(0),
+		mVehicleModel(0),
 		mGround(0)
 	{
 		enableInstantQuitByKey( input::KC_ESCAPE );
@@ -54,25 +54,15 @@
 	{
 	}
 private:
-	typedef Signal2<void(const uint32,const real)> GraphicsUpdateSignal;
-	GraphicsUpdateSignal	graphicsUpdateSig_;
-	void subscribeToGraphicsUpdate(const GraphicsUpdateSignal::slot_type& slot)
+	void _createWheelVisual(model::Model& theModel, vehicle::IVehicle& theVehicle, const String& wheelId, graphics::ISceneNode& parentSN)
 	{
-		graphicsUpdateSig_.connect(slot);
-	}
-	void _triggerGraphicsUpdate(const uint32 si, const real dt)
-	{
-		graphicsUpdateSig_(si,dt);
-	}
-	void _createWheelVisual(const String& wheelId, graphics::ISceneNode& parentSN)
-	{
 		// scene node + wheel mesh
 		graphics::ISceneNode* pSN = getGraphicalWorld()->createSceneNode();
 		graphics::IEntity* pE = getGraphicalWorld()->createEntity("wheel1.mesh");
 		pE->setCastsShadow( true );
 		pSN->attachEntity( pE );
-		model::ModelMovableLink* pLink = mComplex->createLink( mVehicle->getWheelInterface(wheelId), pSN );
-		this->subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
+		model::ModelMovableLink* pLink = theModel.createLink( theVehicle.getWheelInterface(wheelId), pSN );
+		mCentralController.subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
 
 		// scene node + particle system for smoke...
 		pSN = getGraphicalWorld()->createSceneNode();
@@ -81,16 +71,39 @@
 		mEmitterEmissionRate[wheelId] = pPS->getEmissionRate(0);
 		pSN->attachParticleSystem( pPS );
 		pLink = new model::ModelMovableDirectLink();
-		pLink->setSource( mVehicle->getWheelInterface(wheelId) );
+		pLink->setSource( theVehicle.getWheelInterface(wheelId) );
 		pLink->subscribeToPositionChanged( pSN ); //position only!
-		mComplex->addLink( pLink );
-		this->subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
+		theModel.addLink( pLink );
+		mCentralController.subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
 	}
+	void onModelComponent_preInit(const model::ComponentCreationContext& ctx, model::ModelComponent&)
+	{
+		YAKE_LOG("demo: onModelComponent_preInit()");
+	}
+	void onModelComponent_postInit(const model::ComponentCreationContext& ctx, model::ModelComponent&)
+	{
+		YAKE_LOG("demo: onModelComponent_postInit()");
+	}
 protected:
 	virtual void onCreateScene()
 	{
 		YAKE_LOG_INFORMATION("Creating scene");
 
+		// create vehicle system
+		mVehicleSystem.reset(new vehicle::GenericVehicleSystem());
+
+		// set up the model creation context.
+		mModelMgr.setCreationContext_GraphicalWorld( getGraphicalWorld() );
+		mModelMgr.setCreationContext_PhysicalWorld( getPhysicalWorld() );
+		mModelMgr.setCreationContext_CentralController( &mCentralController );
+		mModelMgr.setCreationContext_NamedParameter("vehicleSystem",static_cast<vehicle::IVehicleSystem*>(mVehicleSystem.get()));
+
+		// set up model component creation hooks.
+		mModelMgr.subscribeToComponentPreInitializeSignal( Bind2(&TheMainState::onModelComponent_preInit,this) );
+		mModelMgr.subscribeToComponentPostInitializeSignal( Bind2(&TheMainState::onModelComponent_postInit,this) );
+
+
+
 		// create a light
 		graphics::ILight* pLight = getGraphicalWorld()->createLight();
 		pLight->setType( graphics::ILight::LT_DIRECTIONAL );
@@ -99,7 +112,7 @@
 
 		getGraphicalWorld()->setShadowsEnabled( true );
 
-		// position camera and look at the ninja
+		// set up camera
 		getDefaultCamera()->setNearClipDistance( 1 );
 		getDefaultCamera()->setFixedYawAxis(Vector3::kUnitY);
 		getDefaultCamera()->setPosition(Vector3(7,4,-7));
@@ -133,30 +146,31 @@
 			mGround->addComponent( pP );
 		}
 
-		// create vehicle container (e.g. for graphical objects and links)
-		mComplex = new model::Model();
-		model::Graphical* pG = new model::Graphical();
-		mComplex->addComponent( pG, "g" );
-		model::Physical* pP = new model::Physical();
-		mComplex->addComponent( pP, "p" );
-
 		// materials @todo read from .physics:
 		getPhysicalWorld()->createMaterial( physics::IMaterial::Desc( 0.01f, 0.01f, 0.01f ), "chassis" );
 		getPhysicalWorld()->createMaterial( physics::IMaterial::Desc( 0.01f, 0.2f, 0.01f ), "chassisTop" );
 		getPhysicalWorld()->createMaterial( physics::IMaterial::Desc( 0.01f, 0.25f, 0.01f ), "wheel" );
 
-		// vehicle
-		SharedPtr<vehicle::IVehicleSystem> pVS = //create<vehicle::IVehicleSystem>("generic");
-			SharedPtr<vehicle::IVehicleSystem>(new vehicle::GenericVehicleSystem());
+		// vehicle(s)
 
-		pVS->loadTemplates("../../media/vehicles/delorean.xml");
+		YAKE_ASSERT( mVehicleSystem.get() );
+		mVehicleSystem->loadTemplates("../../media/vehicles/delorean.xml");
 
 		// It's possible retrieve the template and make further adjustments to it before
 		// instantiating vehicles.
 		// e.g.: vehicle::VehicleTemplate* tpl = pVS->getTemplate("delorean");
 
-		// instantiate
-		mVehicle = pVS->create("delorean", *getPhysicalWorld(), *pP );
+		// instantiate vehicle model (physics + representation containers)
+		mVehicleModel = mModelMgr.createModel("theCar",
+				"physics/empty:name=p"
+				"|graphics/empty:name=g"
+				"|yake/dotVehicle:name=veh;template=delorean;physical=p"
+				);
+		YAKE_ASSERT( mVehicleModel );
+		vehicle::VehicleModelComponent* vehComp = static_cast<vehicle::VehicleModelComponent*>(mVehicleModel->getComponentByTag("veh"));
+		YAKE_ASSERT( vehComp );
+		mVehicle = vehComp->getVehicle();
+		YAKE_ASSERT( mVehicle );
 
 		//mVehicle->enableDebugGeometry( *getGraphicalWorld() );
 
@@ -167,30 +181,35 @@
 		pE->setCastsShadow( true );
 		pSN->attachEntity( pE );
 		//pSN->setScale( Vector3::kUnitScale * razorMeshScale );
+		model::Graphical* pG = dynamic_cast<model::Graphical*>(mVehicleModel->getComponentByTag("g"));
+		YAKE_ASSERT( pG );
 		pG->addSceneNode(pSN, "delorean_root");
 
 		// - wheel visuals
 		if (mVehicle->getWheelInterface("leftFrontWheel"))
 		{
-			_createWheelVisual( "leftFrontWheel", *pSN );
-			_createWheelVisual( "rightFrontWheel", *pSN );
-			_createWheelVisual( "leftRearWheel", *pSN );
-			_createWheelVisual( "rightRearWheel", *pSN );
+			_createWheelVisual( *mVehicleModel, *mVehicle, "leftFrontWheel", *pSN );
+			_createWheelVisual( *mVehicleModel, *mVehicle, "rightFrontWheel", *pSN );
+			_createWheelVisual( *mVehicleModel, *mVehicle, "leftRearWheel", *pSN );
+			_createWheelVisual( *mVehicleModel, *mVehicle, "rightRearWheel", *pSN );
 		}
 
 		// create visual <-> physics links
-		model::ModelMovableLink* pLink = mComplex->createLink( mVehicle->getChassisMovable(), pSN );
-		this->subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
+		model::ModelMovableLink* pLink = mVehicleModel->createLink( mVehicle->getChassisMovable(), pSN );
+		mCentralController.subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
 
 		// sky box
 		getGraphicalWorld()->setSkyBox("Examples/SpaceSkyBox");
 	}
 	virtual void onDestroyScene()
 	{
+		mVehicleModel = 0;
+		mVehicle = 0;
+
+		mModelMgr.clear();
+		mVehicleSystem.reset();
+
 		YAKE_SAFE_DELETE( mGround );
-
-		YAKE_SAFE_DELETE( mComplex );
-		YAKE_SAFE_DELETE( mVehicle );
 	}
 	virtual void onEnter()
 	{
@@ -221,6 +240,7 @@
 	}
 	virtual void onExit()
 	{
+		RtMainState::onExit();
 	}
 	virtual void onFrame(const real timeElapsed)
 	{
@@ -255,7 +275,7 @@
 		mVehicle->getWheelInterface("rightFrontWheel")->brake(braking0);
 
 		mVehicle->updateSimulation( timeElapsed );
-		//mComplex->updatePhysics( timeElapsed );
+		//mVehicleModel->updatePhysics( timeElapsed );
 
 		ConstDequeIterator< WheelPsMap > itWheel( mWheelPs );
 		while (itWheel.hasMoreElements())
@@ -265,9 +285,10 @@
 		}
 
 		getDefaultCamera()->lookAt(mVehicle->getChassisPosition());
-		//mComplex->updateGraphics( timeElapsed );
+		//mVehicleModel->updateGraphics( timeElapsed );
 
-		this->_triggerGraphicsUpdate(0,timeElapsed);
+		mCentralController.triggerPhysicsUpdateSignal(0,timeElapsed);
+		mCentralController.triggerGraphicsUpdateSignal(0,timeElapsed);
 
 		mActiveActions.clear();
 	}
@@ -286,7 +307,7 @@
 private:
 	model::Model*			mGround;
 	vehicle::IVehicle*		mVehicle;
-	model::Model*			mComplex;
+	model::Model*			mVehicleModel;
 	typedef AssocVector<String,real> EmitterRealMap;
 	EmitterRealMap			mEmitterMinVel;
 	EmitterRealMap			mEmitterMaxVel;
@@ -297,6 +318,10 @@
 
 	typedef std::set<input::ActionId> ActionIdList;
 	ActionIdList			mActiveActions;
+
+	model::ModelManager					mModelMgr;
+	model::CentralControllerBase		mCentralController;
+	SharedPtr<vehicle::IVehicleSystem>	mVehicleSystem;
 };
 
 /** The mighty application itself! */

Modified: trunk/yake/src/yapp/vehicle/yakeNativeOde.cpp
===================================================================
--- trunk/yake/src/yapp/vehicle/yakeNativeOde.cpp	2006-07-14 17:14:38 UTC (rev 1385)
+++ trunk/yake/src/yapp/vehicle/yakeNativeOde.cpp	2006-07-15 14:29:56 UTC (rev 1386)
@@ -140,7 +140,9 @@
 			delete itMP.getNext().second;
 		mMountPoints.clear();
 
-		mpChassis->getCreator()->destroyActor( mpChassis );
+		// NB Do not destroy the mpChassis actor!
+		//    This object is owned by model::Physical and will be destroyed by it, too!
+		//    [mpChassis->getCreator()->destroyActor( mpChassis );]
 		mpChassis = 0;
 	}
 	void GenericVehicle::updateSimulation(real timeElapsed)
@@ -294,7 +296,7 @@
 		    ConstDequeIterator< VehicleTemplate::ShapeTplList > itShapeTpl( tpl.mChassis.mChassisShapes );
 		    while (itShapeTpl.hasMoreElements())
 		    {
-			mpChassis->createShape( *itShapeTpl.getNext() );
+				mpChassis->createShape( *itShapeTpl.getNext() );
 		    }
 		    mpChassis->getBody().setMass( tpl.mChassis.mMass );
 		}
@@ -492,6 +494,19 @@
 	{
 		YAKE_SAFE_DELETE( mDebugModel );
 	}
+	void GenericVehicle::setPosition(const Vector3& position)
+	{
+		YAKE_ASSERT( mpChassis );
+		const Vector3 delta = position - this->getChassisPosition();
+		this->translate(delta);
+	}
+	void GenericVehicle::translate(const Vector3& delta)
+	{
+		YAKE_ASSERT( mpChassis );
+		mpChassis->translate( delta );
+		for (WheelList::const_iterator it = mWheels.begin(); it != mWheels.end(); ++it)
+			it->second->translate(delta);
+	}
 
 #if defined(YAKE_VEHICLE_USE_ODE)
 	//-----------------------------------------------------
@@ -624,6 +639,16 @@
 	{
 		return mRadius;
 	}
+	void OdeWheel::setPosition(const math::Vector3& pos)
+	{
+		YAKE_ASSERT( mpWheel );
+		mpWheel->setPosition( pos );
+	}
+	void OdeWheel::setOrientation(const math::Quaternion& o)
+	{
+		YAKE_ASSERT( mpWheel );
+		mpWheel->setOrientation( o );
+	}
 	math::Vector3 OdeWheel::getPosition() const
 	{
 		YAKE_ASSERT( mpWheel );

Modified: trunk/yake/yake/model/model.h
===================================================================
--- trunk/yake/yake/model/model.h	2006-07-14 17:14:38 UTC (rev 1385)
+++ trunk/yake/yake/model/model.h	2006-07-15 14:29:56 UTC (rev 1386)
@@ -153,6 +153,7 @@
 		void setCreationContext_CentralController(CentralControllerBase*);
 		void setCreationContext_DotSceneParser(data::parser::dotscene::DotSceneParser*);
 		void setCreationContext_XODEParser(data::parser::xode::XODEParser*);
+		void setCreationContext_NamedParameter(const String& name, const boost::any& value);
 		//@}
 
 		/** @name Signals (in order that they are called in) */

Modified: trunk/yake/yake/model/model_component.h
===================================================================
--- trunk/yake/yake/model/model_component.h	2006-07-14 17:14:38 UTC (rev 1385)
+++ trunk/yake/yake/model/model_component.h	2006-07-15 14:29:56 UTC (rev 1386)
@@ -57,6 +57,9 @@
 		data::parser::dotscene::DotSceneParser*		dotSceneParser_;
 		data::parser::xode::XODEParser*				xodeParser_;
 
+		typedef AssocVector<String,boost::any> ParamMap;
+		ParamMap				params_;
+
 		typedef Signal2<void(const ComponentCreationContext&,ModelComponent&)> ComponentPreInitializeSignal;
 		typedef ComponentPreInitializeSignal ComponentPostInitializeSignal;
 		ComponentPreInitializeSignal	sigPreInit_;
@@ -107,6 +110,7 @@
 	struct YAKE_MODEL_API ModelComponentContainer
 	{
 		ModelComponentContainer();
+		~ModelComponentContainer();
 		/** @name Component container interface */
 		//@{
 		void addComponent(ModelComponent*);
@@ -123,7 +127,7 @@
 		//void _cloneComponents(Model& cloned) const;
 	protected:
 		ModelComponentList		components_;
-		typedef std::map<ComponentTag,ModelComponentSharedPtr> TagModelComponentMap;
+		typedef std::map<ComponentTag,ModelComponent*> TagModelComponentMap;
 		TagModelComponentMap	tag2components_;
 	};
 
@@ -292,32 +296,6 @@
 
 		virtual void create(const ComponentCreationContext& ctx, const StringMap& params) = 0;
 	};
-	struct GraphicalFromDotSceneCreator : public ComponentCreator
-	{
-		YAKE_DECLARE_CONCRETE(GraphicalFromDotSceneCreator,"graphics/dotScene");
-
-		GraphicalFromDotSceneCreator();
-		virtual void create(const ComponentCreationContext& ctx, const StringMap& params);
-
-	private:
-		SharedPtr<data::parser::dotscene::DotSceneParser>	defaultParser_;
-	};
-	struct PhysicalFromXODECreator : public ComponentCreator
-	{
-		YAKE_DECLARE_CONCRETE(PhysicalFromXODECreator,"physics/dotXODE");
-
-		PhysicalFromXODECreator();
-		virtual void create(const ComponentCreationContext& ctx, const StringMap& params);
-
-	private:
-		SharedPtr<data::parser::xode::XODEParser>	defaultParser_;
-	};
-	struct LinkFromDotLinkCreator : public ComponentCreator
-	{
-		YAKE_DECLARE_CONCRETE(LinkFromDotLinkCreator,"model/dotLink");
-
-		virtual void create(const ComponentCreationContext& ctx, const StringMap& params);
-	};
 	struct YAKE_MODEL_API ComponentCreatorManager
 	{
 		ComponentCreatorManager();

Modified: trunk/yake/yapp/vehicle/yakeInterfaces.h
===================================================================
--- trunk/yake/yapp/vehicle/yakeInterfaces.h	2006-07-14 17:14:38 UTC (rev 1385)
+++ trunk/yake/yapp/vehicle/yakeInterfaces.h	2006-07-15 14:29:56 UTC (rev 1386)
@@ -73,6 +73,9 @@
 
 		virtual void enableDebugGeometry(graphics::IWorld&) = 0;
 		virtual void disableDebugGeometry() = 0;
+
+		virtual void setPosition(const Vector3&) = 0;
+		virtual void translate(const Vector3&) = 0;
 	};
 
 	/** Interface to a vehicle engine.

Modified: trunk/yake/yapp/vehicle/yakeNativeOde.h
===================================================================
--- trunk/yake/yapp/vehicle/yakeNativeOde.h	2006-07-14 17:14:38 UTC (rev 1385)
+++ trunk/yake/yapp/vehicle/yakeNativeOde.h	2006-07-15 14:29:56 UTC (rev 1386)
@@ -108,6 +108,9 @@
 		virtual void enableDebugGeometry(graphics::IWorld&);
 		virtual void disableDebugGeometry();
 
+		virtual void setPosition(const Vector3&);
+		virtual void translate(const Vector3&);
+
 		void _create(const VehicleTemplate&, physics::IWorld& PWorld, model::Physical& physModel );
 
 		YAKE_MEMBERSIGNAL(private,void(real),UpdateEngineSimulation);
@@ -205,10 +208,10 @@
 					const VehicleTemplate::WheelTpl& tpl,
 					physics::IWorld& PWorld );
 
-		virtual void setPosition(const math::Vector3&) {}
+		virtual void setPosition(const math::Vector3&);
 		virtual math::Vector3 getPosition() const;
 		virtual math::Vector3 getDerivedPosition() const;
-		virtual void setOrientation(const math::Quaternion&) {}
+		virtual void setOrientation(const math::Quaternion&);
 		virtual math::Quaternion getOrientation() const;
 		virtual math::Quaternion getDerivedOrientation() const;
 

Modified: trunk/yake/yapp/vehicle/yakeVehicle.h
===================================================================
--- trunk/yake/yapp/vehicle/yakeVehicle.h	2006-07-14 17:14:38 UTC (rev 1385)
+++ trunk/yake/yapp/vehicle/yakeVehicle.h	2006-07-15 14:29:56 UTC (rev 1386)
@@ -42,6 +42,7 @@
 #include <yapp/vehicle/yakeMountPoint.h>
 #include <yapp/vehicle/yakeInterfaces.h>
 #include <yapp/vehicle/yakeVehicleSystem.h>
+#include <yapp/vehicle/yakeVehicleModelComponent.h>
 
 #endif
 



From codeandroid at mail.berlios.de  Sat Jul 15 16:30:34 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Sat, 15 Jul 2006 16:30:34 +0200
Subject: [Yake-svn] r1387 - trunk/yake/scripts/msvc8
Message-ID: <200607151430.k6FEUYM3002755@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-15 16:30:34 +0200 (Sat, 15 Jul 2006)
New Revision: 1387

Modified:
   trunk/yake/scripts/msvc8/vehicle.vcproj
   trunk/yake/scripts/msvc8/yake.sln
Log:


Modified: trunk/yake/scripts/msvc8/vehicle.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/vehicle.vcproj	2006-07-15 14:29:56 UTC (rev 1386)
+++ trunk/yake/scripts/msvc8/vehicle.vcproj	2006-07-15 14:30:34 UTC (rev 1387)
@@ -223,6 +223,14 @@
 				RelativePath="..\..\src\yapp\vehicle\yakeVehicle.cpp"
 				>
 			</File>
+			<File
+				RelativePath="..\..\src\yapp\vehicle\yakeVehicleModelComponent.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\src\yapp\vehicle\yakeVehicleModelComponentCreator.cpp"
+				>
+			</File>
 		</Filter>
 		<Filter
 			Name="inc"
@@ -258,6 +266,10 @@
 				>
 			</File>
 			<File
+				RelativePath="..\..\yapp\vehicle\yakeVehicleModelComponent.h"
+				>
+			</File>
+			<File
 				RelativePath="..\..\yapp\vehicle\yakeVehicleSystem.h"
 				>
 			</File>

Modified: trunk/yake/scripts/msvc8/yake.sln
===================================================================
--- trunk/yake/scripts/msvc8/yake.sln	2006-07-15 14:29:56 UTC (rev 1386)
+++ trunk/yake/scripts/msvc8/yake.sln	2006-07-15 14:30:34 UTC (rev 1387)
@@ -142,6 +142,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleNetPacket", "samples\net\sampleNetPacket.vcproj", "{5473599B-AB7B-4259-B052-4DDC68CBEA54}"
 EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleModel1", "samples\model\sampleModel1.vcproj", "{920E5CA3-620C-43C3-986C-5A6F9397F6DA}"
+EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) = preSolution
 		Debug|Win32 = Debug|Win32
@@ -286,6 +288,10 @@
 		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Debug|Win32.Build.0 = Debug|Win32
 		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Release|Win32.ActiveCfg = Release|Win32
 		{5473599B-AB7B-4259-B052-4DDC68CBEA54}.Release|Win32.Build.0 = Release|Win32
+		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Debug|Win32.ActiveCfg = Debug|Win32
+		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Debug|Win32.Build.0 = Debug|Win32
+		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Release|Win32.ActiveCfg = Release|Win32
+		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Release|Win32.Build.0 = Release|Win32
 	EndGlobalSection
 	GlobalSection(SolutionProperties) = preSolution
 		HideSolutionNode = FALSE



From codeandroid at mail.berlios.de  Sat Jul 15 16:31:07 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Sat, 15 Jul 2006 16:31:07 +0200
Subject: [Yake-svn] r1388 - in trunk/yake: src/yake/base yake/base
Message-ID: <200607151431.k6FEV7wZ002832@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-15 16:31:07 +0200 (Sat, 15 Jul 2006)
New Revision: 1388

Modified:
   trunk/yake/src/yake/base/yakeString.cpp
   trunk/yake/yake/base/yakeString.h
Log:
added toUInt32()

Modified: trunk/yake/src/yake/base/yakeString.cpp
===================================================================
--- trunk/yake/src/yake/base/yakeString.cpp	2006-07-15 14:30:34 UTC (rev 1387)
+++ trunk/yake/src/yake/base/yakeString.cpp	2006-07-15 14:31:07 UTC (rev 1388)
@@ -180,7 +180,14 @@
 	{
 		return static_cast<int32>(atoi( rString.c_str() ));
 	}
-    //-----------------------------------------------------------------------
+
+	//-----------------------------------------------------------------------
+	uint32 StringUtil::toUInt32( const String& rString )
+	{
+		return static_cast<uint32>(atoi( rString.c_str() ));
+	}
+
+	//-----------------------------------------------------------------------
     bool StringUtil::startsWith(const String& str, const String& pattern, bool lowerCase)
     {
         size_t thisLen = str.length();

Modified: trunk/yake/yake/base/yakeString.h
===================================================================
--- trunk/yake/yake/base/yakeString.h	2006-07-15 14:30:34 UTC (rev 1387)
+++ trunk/yake/yake/base/yakeString.h	2006-07-15 14:31:07 UTC (rev 1388)
@@ -90,6 +90,7 @@
 		static real toReal( const String& rString );
 		static size_t toSizeT( const String& rString );
 		static int32 toInt32( const String& rString );
+		static uint32 toUInt32( const String& rString );
 		// Thanks to OGRE!
 	    static bool StringUtil::startsWith(const String& str, const String& pattern, bool lowerCase);
 		// Thanks to OGRE!



From codeandroid at mail.berlios.de  Sat Jul 15 16:31:29 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Sat, 15 Jul 2006 16:31:29 +0200
Subject: [Yake-svn] r1389 - trunk/yake/src/yapp/vehicle
Message-ID: <200607151431.k6FEVTmB002878@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-15 16:31:29 +0200 (Sat, 15 Jul 2006)
New Revision: 1389

Added:
   trunk/yake/src/yapp/vehicle/yakeVehicleModelComponent.cpp
   trunk/yake/src/yapp/vehicle/yakeVehicleModelComponentCreator.cpp
Log:
initial revision

Added: trunk/yake/src/yapp/vehicle/yakeVehicleModelComponent.cpp
===================================================================
--- trunk/yake/src/yapp/vehicle/yakeVehicleModelComponent.cpp	2006-07-15 14:31:07 UTC (rev 1388)
+++ trunk/yake/src/yapp/vehicle/yakeVehicleModelComponent.cpp	2006-07-15 14:31:29 UTC (rev 1389)
@@ -0,0 +1,47 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright ? 2004 The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#include <yapp/vehicle/yakePCH.h>
+#include <yapp/vehicle/yakeVehicle.h>
+
+namespace yake {
+namespace vehicle {
+
+	//-----------------------------------------------------
+	// Class: VehicleModelComponent
+	//-----------------------------------------------------
+	VehicleModelComponent::VehicleModelComponent(IVehicle* vehicle) :
+		vehicle_(vehicle)
+	{
+		YAKE_ASSERT( vehicle_.get() );
+	}
+	VehicleModelComponent::~VehicleModelComponent()
+	{
+	}
+
+} // namespace vehicle
+} // namespace yake
+

Added: trunk/yake/src/yapp/vehicle/yakeVehicleModelComponentCreator.cpp
===================================================================
--- trunk/yake/src/yapp/vehicle/yakeVehicleModelComponentCreator.cpp	2006-07-15 14:31:07 UTC (rev 1388)
+++ trunk/yake/src/yapp/vehicle/yakeVehicleModelComponentCreator.cpp	2006-07-15 14:31:29 UTC (rev 1389)
@@ -0,0 +1,139 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright ? 2004 The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#include <yapp/vehicle/yakePCH.h>
+#include <yapp/vehicle/yakeVehicle.h>
+
+namespace yake {
+namespace vehicle {
+
+	//-----------------------------------------------------
+	// Class: VehicleModelComponentCreator
+	//-----------------------------------------------------
+	class VehicleModelComponentCreator : public model::ComponentCreator
+	{
+		YAKE_DECLARE_CONCRETE(VehicleModelComponentCreator,"yake/dotVehicle");
+
+		VehicleModelComponentCreator();
+		virtual void create(const model::ComponentCreationContext& ctx, const StringMap& params);
+
+	private:
+	};
+
+	//-----------------------------------------------------
+	// Class: VehicleModelComponentCreator
+	//-----------------------------------------------------
+	YAKE_REGISTER_CONCRETE(VehicleModelComponentCreator)
+
+	VehicleModelComponentCreator::VehicleModelComponentCreator()
+	{
+	}
+	void VehicleModelComponentCreator::create(const model::ComponentCreationContext& ctx, const StringMap& params)
+	{
+		// Verify validity of creation context
+		physics::IWorld* pPWorld = ctx.pworld_;
+		YAKE_ASSERT( pPWorld );
+		if (!pPWorld)
+			return;
+
+		// Extract parameters
+
+		StringMap::const_iterator itParam = params.find("file");
+		const String fn = (itParam == params.end()) ? "" : itParam->second;
+
+		itParam = params.find("name");
+		YAKE_ASSERT(itParam != params.end()).debug("Missing parameter 'name'.");
+		if (itParam == params.end())
+			return;
+		const String name = itParam->second;
+
+		itParam = params.find("physical");
+		YAKE_ASSERT(itParam != params.end()).debug("Missing parameter 'physical'.");
+		if (itParam == params.end())
+			return;
+		const String physicalTag = itParam->second;
+
+		itParam = params.find("template");
+		YAKE_ASSERT(itParam != params.end()).debug("Missing parameter 'template'.");
+		if (itParam == params.end())
+			return;
+		const String tplname = itParam->second;
+
+		// Retrieve vehicle system
+
+		IVehicleSystem* vehSys = 0;
+		{
+			model::ComponentCreationContext::ParamMap::const_iterator it = ctx.params_.find("vehicleSystem");
+			YAKE_ASSERT(it != ctx.params_.end()).debug("Missing context parameter 'vehicleSystem'.");
+			if (it == ctx.params_.end())
+				return;
+			try {
+				vehSys = boost::any_cast<vehicle::IVehicleSystem*>(it->second);
+			} catch (boost::bad_any_cast& e)
+			{
+				YAKE_ASSERT( 0 )(name).debug(String("Failed to retrieve IVehicleSystem interface from context parameter! (") + e.what() + ")");
+				return;
+			}
+			YAKE_ASSERT( vehSys )(name).debug("IVehicleSystem interface not set.");
+			if (!vehSys)
+				return;
+		}
+
+		// Load template if necessary
+		if (!fn.empty())
+		{
+			const bool succ = vehSys->loadTemplates( fn );
+			YAKE_ASSERT( succ )(name)(fn).debug("Failed to load template(s).");
+			if (!succ)
+				return;
+		}
+
+		// Retrieve 'Physical'
+
+		YAKE_ASSERT( ctx.model_ );
+
+		model::Physical* pPhysical = dynamic_cast<model::Physical*>(ctx.model_->getComponentByTag(physicalTag));
+		YAKE_ASSERT( pPhysical )(physicalTag)(name).debug("Failed to retrieve Physical.");
+
+		// Instantiate template vehicle
+
+		IVehicle* pVehicle = vehSys->create(tplname, *pPWorld, *pPhysical );
+		YAKE_ASSERT( pVehicle )(tplname).debug("Failed to instantiate vehicle.");
+		if (!pVehicle)
+			return;
+
+		// Create VehicleModelComponent
+		VehicleModelComponent* c = new VehicleModelComponent(pVehicle);
+		YAKE_ASSERT( c );
+
+		ctx.model_->addComponent( c, name );
+
+		return;
+	}
+
+} // namespace vehicle
+} // namespace yake
+



From codeandroid at mail.berlios.de  Sat Jul 15 16:38:30 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Sat, 15 Jul 2006 16:38:30 +0200
Subject: [Yake-svn] r1390 - trunk/yake/documentation/api
Message-ID: <200607151438.k6FEcUHf003232@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-15 16:38:29 +0200 (Sat, 15 Jul 2006)
New Revision: 1390

Modified:
   trunk/yake/documentation/api/DoxySfile
Log:


Modified: trunk/yake/documentation/api/DoxySfile
===================================================================
--- trunk/yake/documentation/api/DoxySfile	2006-07-15 14:31:29 UTC (rev 1389)
+++ trunk/yake/documentation/api/DoxySfile	2006-07-15 14:38:29 UTC (rev 1390)
@@ -1,12 +1,12 @@
-# DoxySfile 0.87b
+# DoxySfile 0.90b ShortConfig -- Do not remove or edit this line please --
 
 #---------------------------------------------------------------------------
 # General configuration options
 #---------------------------------------------------------------------------
 PROJECT_NAME                        = YAKE
-PROJECT_NUMBER                      = 
+PROJECT_NUMBER                      = 0.5.0-dev
 #INPUT                               = yake/msg
-INPUT                               = documentation/api yake/base/math yake/base/mpl yake/base/native yake/base/templates yake/base yake/audio yake/data yake/ent yake/file yake/graphics yake/input yake/net yake/object yake/physics yake/prop yake/scripting yake/statemachine yake/msg
+INPUT                               = documentation/api yake/base/math yake/base/mpl yake/base/native yake/base/templates yake/base yake/audio yake/data yake/ent yake/file yake/graphics yake/input yake/net yake/object yake/physics yake/prop yake/scripting yake/statemachine yake/msg yake/model
 OUTPUT_DIRECTORY                    = documentation/api/html
 GENERATE_DOXYS_HELP                 = YES
 HTML_FILE_EXTENSION                 = .html
@@ -63,6 +63,7 @@
 TODO_DOCS                           = YES
 INHERIT_DOCS                        = YES
 HIDE_CLASS_METHODS_IN_OVERVIEW      = NO
+CONCATENATE_DECL_AND_DEFINITION_DOC = YES
 #---------------------------------------------------------------------------
 # Customize layout for pure text projects (ie containing no code)
 #---------------------------------------------------------------------------
@@ -78,17 +79,18 @@
 #---------------------------------------------------------------------------
 # configuration options related to warning and progress messages
 #---------------------------------------------------------------------------
-QUIET                               = NO
-WARNINGS                            = YES
-WARN_IF_UNDOCUMENTED                = NO
-WARN_IF_DOC_ERROR                   = YES
-WARN_FORMAT                         = "$file:$line: $text"
-WARN_LOGFILE                        = 
+MESSAGE_LEVEL_SCREEN                = Messages Warnings
+OUTPUT_PREFIX_SCREEN                = Warnings Errors
+OUTPUT_PATTERNS_SCREEN              = Progress Preprocessor Scanner Generator Docparser Dot Definition Configfile Undocumented Unknown
+MESSAGE_SCREEN_LOGFILE              = 
+MESSAGE_LEVEL_HTML_FILE             = Messages Warnings Errors Debug
+OUTPUT_PATTERNS_HTML_FILE           = Progress Preprocessor Scanner Generator Docparser Dot Definition Configfile Undocumented Unknown
+QUIET                               = YES
 #---------------------------------------------------------------------------
 # Configuration options related to the input files
 #---------------------------------------------------------------------------
 IGNORE_FILE_NAME                    = DoxyS.ignore
-FILE_PATTERNS                       = *.inl *.h *.hh *.hxx *.hpp *.h++ 
+FILE_PATTERNS                       = *.c *.cc *.cxx *.cpp *.c++ *.java *.ii *.ixx *.ipp *.i++ *.inl *.h *.hh *.hxx *.hpp *.h++ *.idl *.odl *.cs *.page *.dir *.dxd *.doc
 RECURSIVE                           = NO
 EXCLUDE                             = yake/reflection/ yake/samples
 EXCLUDE_SYMLINKS                    = NO
@@ -131,6 +133,8 @@
 LEFT_MENU_ATTRIBUTES                = NO
 LEFT_MENU_TYPES                     = NO
 LEFT_MENU_UNITS                     = YES
+LEFT_MENU_STATISTICS                = YES
+STATISTICS_LINK_ON_MAIN_PAGE        = YES
 #---------------------------------------------------------------------------
 # Configuration options related to header and footer layout
 #---------------------------------------------------------------------------
@@ -166,6 +170,7 @@
 INCLUDE_GRAPH                       = YES
 INCLUDED_BY_GRAPH                   = YES
 CALL_GRAPH                          = YES
+DIR_GRAPH                           = YES
 GRAPHICAL_HIERARCHY                 = YES
 DOT_IMAGE_FORMAT                    = png
 DOTFILE_DIRS                        = 
@@ -179,3 +184,1105 @@
 #---------------------------------------------------------------------------
 OUTPUT_LANGUAGE                     = English
 USE_WINDOWS_ENCODING                = YES
+
+
+
+
+
+# - # DoxySfile 0.90b LongConfig -- Do not remove or edit this line please --
+# - 
+# - # This file describes the settings to be used by the documentation system
+# - # DoxyS (www.DoxyS.org) for a project
+# - #
+# - # All text after a hash (#) is considered a comment and will be ignored
+# - # The format is:
+# - #       TAG = value [value, ...]
+# - # For lists items can also be appended using:
+# - #       TAG += value [value, ...]
+# - # Values that contain spaces should be placed between quotes (" ")
+# - 
+# - #---------------------------------------------------------------------------
+# - # General configuration options
+# - #---------------------------------------------------------------------------
+# - 
+# - # The PROJECT_NAME tag is a single word (or a sequence of words surrounded 
+# - # by quotes) that should identify the project.
+# - 
+# - PROJECT_NAME                        = YAKE
+# - 
+# - # The PROJECT_NUMBER tag can be used to enter a project or revision number. 
+# - # This could be handy for archiving the generated documentation or 
+# - # if some version control system is used.
+# - 
+# - PROJECT_NUMBER                      = 0.5.0-dev
+# - 
+# - # The INPUT tag can be used to specify the files and/or directories that contain 
+# - # documented source files. You may enter file names like "myfile.cpp" or 
+# - # directories like "/usr/src/myproject". Separate the files or directories 
+# - # with spaces.
+# - 
+# - INPUT                               = ../../yake ../../yapp
+# - 
+# - # The OUTPUT_DIRECTORY tag is used to specify the (relative or absolute) 
+# - # base path where the generated documentation will be put. 
+# - # If a relative path is entered, it will be relative to the location 
+# - # where DoxyS was started. If left blank 'doxys_doc' will be used.
+# - 
+# - OUTPUT_DIRECTORY                    = doxys_docs/
+# - 
+# - # If the GENERATE_DOXYS_HELP tag is set to YES, DoxyS will 
+# - # generate help pages for DoxyS itself along with to the project documentation
+# - 
+# - GENERATE_DOXYS_HELP                 = YES
+# - 
+# - # The HTML_FILE_EXTENSION tag can be used to specify the file extension for 
+# - # each generated HTML page (for example: .htm,.php,.asp). If it is left blank 
+# - # DoxyS will generate files with .html extension.
+# - 
+# - HTML_FILE_EXTENSION                 = .html
+# - 
+# - # The CUSTOM_DIR tag is used to specify where the custom directory is. 
+# - # The custom directory is used to place a $#logo.gif#$, $#logo.jpg#$ or 
+# - #  $#logo.png#$. This logo file is used on all the pages. 
+# - # A style sheet file can be placed here if you want a different setup then the default.
+# - # Run DoxyS, copy the style sheet file from the common dir and you are ready to go.
+# - 
+# - CUSTOM_DIR                          = 
+# - 
+# - # The SERVER_STATISTICS tag is used to specify where the server statistics file is.
+# - # If left blank, server statistics is turned off. 
+# - # To use server statistics, you will need a script on a server to collect the data 
+# - # from the static HTML pages. Script can be found at http://www.doxys.dk under Download.
+# - # Make your own script and database.
+# - # Make a database with these filds:
+# - # Id, Definitiontype, Pagename, Pagetype, Projectname, Date, Requestpage
+# - # A script that can receive these posted arguments:
+# - # projectname, definitiontype, pagename, pagetypeand add the date and HTTP_REFERER your self when putting it all into the database.
+# - 
+# - SERVER_STATISTICS                   = 
+# - 
+# - # The HTML_HELP_SERVER_PATH tag is used to specify where the root of the
+# - # HTML files will be placed on the server. Used when generating XML-file 
+# - # for integration with MS.NET.
+# - 
+# - HTML_HELP_SERVER_PATH               = 
+# - 
+# - # Setting the STRIP_CODE_COMMENTS tag to YES (the default) will instruct 
+# - # DoxyS to hide any special comment blocks from generated source code 
+# - # fragments. Normal C and C++ comments will always remain visible.
+# - 
+# - STRIP_CODE_COMMENTS                 = YES
+# - 
+# - #---------------------------------------------------------------------------
+# - # Special options (rarely changed)
+# - #---------------------------------------------------------------------------
+# - 
+# - # If the DELETE_OUTPUT_DIRECTORY tag is set to YES, then the output directory will be 
+# - # deleted before writing the new output. This can save time in some cases
+# - 
+# - DELETE_OUTPUT_DIRECTORY             = YES
+# - 
+# - # If the MS_DOT_NET_INTEGRATION tag is set to YES then a XML file 
+# - # for use with MS Visual Studio .Net will be placed in 'OUT_DIR' 
+# - # 
+# - # How to: Taken from Microsofts homepage. 
+# - # Save the file as 'HelpTest2.xml' in Microsoft Visual Studio .NET/Common7/IDE/HTML/XMLLinks/[LCID], where [LCID] depends upon your language, such as English or French. For example, the English LCID is 1033. 
+# - # If it is not already open, display the Dynamic Help window by pressing CTRL+F1. 
+# - # Notice that two new links appear in the Dynamic Help window. One is under a link group called 'Samples' and is called 'Sample: Intro to Visual Studio .NET' and another link called 'Direct Link to MSDN' is under a custom link group called 'Custom Help.' 
+# - # 
+# - # Creating custom link groups allows you to have special categories in which to display your links. Professors and other academic instructors might, for example, create a custom link group called 'Homework' or 'CS101 Projects.' They could then put links to their topics under the custom link group. IT managers and group leads might want to create a custom link group, for example, named 'Coding Policies' that contains links to Help topics on corporate coding policy. For more information, see Creating Custom Link Groups.
+# - 
+# - MS_DOT_NET_INTEGRATION              = NO
+# - 
+# - # The MS_DOT_NET_INTEGRATION_PATH tag is used to specify where the MS DOT NET integration xml is to be put. 
+# - # Usaualy "/Program Files/Microsoft Visual Studio .NET 2003/Common7/IDE/HTML/XMLLinks/1033" 
+# - # If left empty the xml will be put on documentation root.
+# - 
+# - MS_DOT_NET_INTEGRATION_PATH         = 
+# - 
+# - # If GENERATE_HTMLHELP1 tag is set to YES, then HtmlHelp1 project(hhp) will be generated. 
+# - # Output will be put on documentation root.
+# - 
+# - GENERATE_HTMLHELP1                  = NO
+# - 
+# - # If GENERATE_STATISTICS tag is set to YES, there will be generated a statistics page. 
+# - # Output will be in documentation root/common/statistics.
+# - # Information, warnings, errors and statistics can be found here.
+# - 
+# - GENERATE_STATISTICS                 = YES
+# - 
+# - #---------------------------------------------------------------------------
+# - # Search page options
+# - #---------------------------------------------------------------------------
+# - 
+# - # If the CREATE_SEARCHPAGE tag is set to YES DoxyS will create 
+# - # a searchpage. WARNING, if the project is very large (+500.000 lines), 
+# - # it is recomended to reduce the searchpage by adjusting some of the 
+# - # following options. Other options include using #Mozilla FireFox# browser 
+# - # which seems to execute the Java search-script 3-4 times faster than Opera 
+# - # and Internet Explorer.
+# - 
+# - CREATE_SEARCHPAGE                   = YES
+# - 
+# - # If set to YES DoxyS will include data to search in all the 
+# - # brief descriptions for all types and pages. The brief description 
+# - # is to the first full stop of the description. In case the project 
+# - # is very large setting this option to $NO$ could improve search speed 
+# - # significantly.
+# - 
+# - SEARCH_BRIEF_DESCRIPTION            = YES
+# - 
+# - # If set to YES DoxyS will include data to search in all the functions 
+# - # and macros in the project.
+# - 
+# - SEARCH_FUNCTIONS                    = YES
+# - 
+# - # If set to YES DoxyS will include data to search in all the variables 
+# - # in the project. Tis includes member varibles as well as global variables, 
+# - # but not automatic variables.
+# - 
+# - SEARCH_VARIABLES                    = YES
+# - 
+# - # If set to YES DoxyS will include data to search in all the typedefs, 
+# - # enumerations, enum values, defines etc. Basically all C++ entities which 
+# - # are {not{ covered by the aboveoptions.
+# - 
+# - SEARCH_TYPEDEFS_ETC                 = YES
+# - 
+# - #---------------------------------------------------------------------------
+# - # Specify what is included in the output
+# - #---------------------------------------------------------------------------
+# - 
+# - # If set to YES DoxyS will create Documentation for files. Documentation for files 
+# - # features #included files# and #included by diagrams#, if  $INCLUDE_GRAPH$ and 
+# - # $INCLUDED_BY_GRAPH$ are set to YES.
+# - 
+# - CREATE_DOC_FOR_FILES                = YES
+# - 
+# - # If the CREATE_SOURCECODE_FOR_FILES tag is set to YES and CREATE_DOC_FOR_FILES is set to YES 
+# - # DoxyS will create the tab 'Source' that holds the sourcecode for the hole file.
+# - 
+# - CREATE_SOURCECODE_FOR_FILES         = NO
+# - 
+# - # If the CREATE_SOURCECODE_FOR_MEMBERS tag is set to YES 
+# - # DoxyS will create the tab 'Source' that holds the sourcecode for the member.
+# - 
+# - CREATE_SOURCECODE_FOR_MEMBERS       = YES
+# - 
+# - # If set to YES all private members of a class will be included in the documentation.
+# - 
+# - EXTRACT_PRIVATE                     = YES
+# - 
+# - # If the EXTRACT_PROTECTED tag is set to YES all protected members of a class 
+# - # will be included in the documentation.
+# - 
+# - EXTRACT_PROTECTED                   = YES
+# - 
+# - # If the EXTRACT_STATIC tag is set to YES all static members of a file 
+# - # will be included in the documentation.
+# - 
+# - EXTRACT_STATIC                      = YES
+# - 
+# - # If the EXTRACT_LOCAL_CLASSES tag is set to YES classes (and structs) 
+# - # defined locally in source files will be included in the documentation. 
+# - # If set to NO only classes defined in header files are included.
+# - 
+# - EXTRACT_LOCAL_CLASSES               = YES
+# - 
+# - # If the HIDE_UNDOC_NAMESPACES tag is set to YES, DoxyS will hide all undocumented namespaces.
+# - 
+# - HIDE_UNDOC_NAMESPACES               = NO
+# - 
+# - # If the HIDE_UNDOC_CLASSES tag is set to YES, DoxyS will hide all 
+# - # undocumented classes that are normally visible in the class hierarchy. 
+# - # If set to NO (the default) these classes will be included in the various 
+# - # overviews. This option has no effect if EXTRACT_ALL is enabled.
+# - 
+# - HIDE_UNDOC_CLASSES                  = NO
+# - 
+# - # If set to YES, DoxyS will hide all undocumented functions 
+# - # inside classes, files or namespaces.
+# - 
+# - HIDE_UNDOC_FUNCTIONS                = NO
+# - 
+# - # If set to YES, DoxyS will hide all undocumented variables 
+# - # inside classes, files or namespaces.
+# - 
+# - HIDE_UNDOC_VARIABLES                = NO
+# - 
+# - # If set to YES, DoxyS will hide all undocumented enummerations 
+# - # inside classes, files or namespaces.
+# - 
+# - HIDE_UNDOC_ENUMS                    = NO
+# - 
+# - # If set to YES, DoxyS will hide all undocumented enum values
+# - # inside classes, files or namespaces.
+# - 
+# - HIDE_UNDOC_ENUM_VALUES              = NO
+# - 
+# - # If set to YES, DoxyS will hide all undocumented typedefs 
+# - # inside classes, files or namespaces.
+# - 
+# - HIDE_UNDOC_TYPEDEFS                 = NO
+# - 
+# - # If set to YES, DoxyS will hide all undocumented defines.
+# - 
+# - HIDE_UNDOC_MACROS                   = NO
+# - 
+# - # If set to YES, DoxyS will hide all undocumented defines.
+# - 
+# - HIDE_UNDOC_DEFINES                  = YES
+# - 
+# - # The GENERATE_TODOLIST tag can be used to enable (YES) or 
+# - # disable (NO) the todo list. This list is created by putting 	odo 
+# - # commands in the documentation.
+# - 
+# - GENERATE_TODOLIST                   = YES
+# - 
+# - # The GENERATE_BUGLIST tag can be used to enable (YES) or 
+# - # disable (NO) the bug list. This list is created by putting \bug 
+# - # commands in the documentation.
+# - 
+# - GENERATE_BUGLIST                    = YES
+# - 
+# - # The GENERATE_DEPRECATEDLIST tag can be used to enable (YES) or 
+# - # disable (NO) the deprecated list. This list is created by putting 
+# - # \deprecated commands in the documentation.
+# - 
+# - GENERATE_DEPRECATEDLIST             = YES
+# - 
+# - #---------------------------------------------------------------------------
+# - # Customize how the documentation is generated
+# - #---------------------------------------------------------------------------
+# - 
+# - # If the MEMBER_SAME_FILE_RELATE_TO_CLASSES tag is set to YES DoxyS will relate all free 
+# - # functions, types, defines etc. To the class(es) defined in the same file.
+# - 
+# - MEMBER_SAME_FILE_RELATE_TO_CLASSES  = YES
+# - 
+# - # If the MEMBER_SAME_FILE_RELATE_TO_STRUCTS tag is set to YES DoxyS will relate all free 
+# - # functions, types, defines etc. To the struct(s) defined in the same file.
+# - 
+# - MEMBER_SAME_FILE_RELATE_TO_STRUCTS  = NO
+# - 
+# - # If the FULL_PATH_NAMES tag is set to YES then DoxyS will prepend the full 
+# - # path before files name in the file list and in the header files. If set 
+# - # to NO the shortest path that makes the file name unique will be used.
+# - 
+# - FULL_PATH_NAMES                     = NO
+# - 
+# - # If the FULL_PATH_NAMES tag is set to YES then the STRIP_FROM_PATH tag 
+# - # can be used to strip a user-defined part of the path. Stripping is 
+# - # only done if one of the specified strings matches the left-hand part of 
+# - # the path. It is allowed to use relative paths in the argument list.
+# - 
+# - STRIP_FROM_PATH                     = 
+# - 
+# - # The INTERNAL_DOCS tag determines if documentation 
+# - # that is typed after a \internal command is included. If the tag is set 
+# - # to NO (the default) then the documentation will be excluded. 
+# - # Set it to YES to include the internal documentation.
+# - 
+# - INTERNAL_DOCS                       = NO
+# - 
+# - # Determines whehter documentation 
+# - # that is typed after a \todo command is included. If the tag is set 
+# - # to NO then the documentation will be excluded. 
+# - # Set it to YES to include the internal documentation.
+# - 
+# - TODO_DOCS                           = YES
+# - 
+# - # If the INHERIT_DOCS tag is set to YES (the default) then an undocumented 
+# - # member inherits the documentation from any documented member that it 
+# - # reimplements.
+# - 
+# - INHERIT_DOCS                        = YES
+# - 
+# - # If set to true then member functions (methods)
+# - # of classes will be hidden from all functions tab.
+# - 
+# - HIDE_CLASS_METHODS_IN_OVERVIEW      = NO
+# - 
+# - # For functions: If set to true then the documentation from the 
+# - # declaration (header-file) and from the implementation/definition .
+# - # (cpp-file) are concatenated. Brief description from header is 
+# - # concatenated with brief description from cpp-file and same with.
+# - # main documentation. If set to NO, only one of the two are used 
+# - # prefering the one from the definition/cpp-file.
+# - 
+# - CONCATENATE_DECL_AND_DEFINITION_DOC = YES
+# - 
+# - #---------------------------------------------------------------------------
+# - # Customize layout for pure text projects (ie containing no code)
+# - #---------------------------------------------------------------------------
+# - 
+# - # Mainly for projects that contains no source code, but only pages and directories. 
+# - # The overview, info classes etc. tabs on mainpage and directories will be disabled. 
+# - # Other tabs are not affected, so it's still possible to have source code in the project,  
+# - # but mainpage and directories have only Description tabs displayed.
+# - 
+# - PAGE_DOCUMENTATION_MODE             = NO
+# - 
+# - #---------------------------------------------------------------------------
+# - # Options to control how the input is parsed
+# - #---------------------------------------------------------------------------
+# - 
+# - # If the HIDE_IN_BODY_DOCS tag is set to YES, DoxyS will hide any 
+# - # documentation blocks found inside the body of a function. 
+# - # If set to NO (the default) these blocks will be appended to the 
+# - # function's detailed documentation block.
+# - 
+# - HIDE_IN_BODY_DOCS                   = NO
+# - 
+# - # The TAB_SIZE tag can be used to set the number of spaces in a tab. 
+# - # DoxyS uses this value to replace tabs by spaces in code fragments.
+# - 
+# - TAB_SIZE                            = 4
+# - 
+# - # This tag can be used to specify a number of aliases that acts 
+# - # as commands in the documentation. An alias has the form "name=value". 
+# - # For example adding "sideeffect=\par Side Effects:\n" will allow you to 
+# - # put the command \sideeffect (or @sideeffect) in the documentation, which 
+# - # will result in a user-defined paragraph with heading "Side Effects:". 
+# - # You can put \n's in the value part of an alias to insert newlines.
+# - 
+# - ALIASES                             = 
+# - 
+# - # The ENABLED_SECTIONS tag can be used to enable conditional 
+# - # documentation sections, marked by \if sectionname ... \endif.
+# - 
+# - ENABLED_SECTIONS                    = 
+# - 
+# - # In case all classes in a project start with a common prefix, all 
+# - # classes will be put under the same header in the alphabetical index. 
+# - # The IGNORE_CLASS_PREFIX tag can be used to specify one or more prefixes that 
+# - # should be ignored while generating the index headers.
+# - 
+# - IGNORE_CLASS_PREFIX                 = 
+# - 
+# - #---------------------------------------------------------------------------
+# - # configuration options related to warning and progress messages
+# - #---------------------------------------------------------------------------
+# - 
+# - # The message level that will be printed on the stdout.
+# - # Errors will always be printed on stderr.
+# - # Options avalible:
+# - # Messages Warnings Debug
+# - 
+# - MESSAGE_LEVEL_SCREEN                = Messages Warnings
+# - 
+# - # Prefix messages for the screen.
+# - # Options avalible:
+# - # Messages Warnings Errors Debug
+# - 
+# - OUTPUT_PREFIX_SCREEN                = Warnings Errors
+# - 
+# - # Patterns for the output.
+# - # Options avalible:
+# - # Progress Preprocessor Scanner Generator Docparser Dot Definition Configfile Undocumented Unknown
+# - 
+# - OUTPUT_PATTERNS_SCREEN              = Progress Preprocessor Scanner Generator Docparser Dot Definition Configfile Undocumented Unknown
+# - 
+# - # The MESSAGE_SCREEN_LOGFILE tag can be used to specify a file to which all messages 
+# - # that is shown on the screen should be written. If left blank, no output to log file.
+# - # Use MESSAGE_LEVEL_SCREEN and OUTPUT_PATTERNS_SCREEN to reduce the number of messages.
+# - 
+# - MESSAGE_SCREEN_LOGFILE              = 
+# - 
+# - # The message level that will be writen in the HTML statistics.
+# - # options avalible:
+# - # Messages Warnings Errors Debug
+# - 
+# - MESSAGE_LEVEL_HTML_FILE             = Messages Warnings Errors Debug
+# - 
+# - # Patterns for the output.
+# - # Options avalible:
+# - # Progress Preprocessor Scanner Generator Docparser Dot Definition Configfile Undocumented Unknown
+# - 
+# - OUTPUT_PATTERNS_HTML_FILE           = Progress Preprocessor Scanner Generator Docparser Dot Definition Configfile Undocumented Unknown
+# - 
+# - # With the QUIET tag on, only Progress and Errors will be printed to the screen. 
+# - # Anything else will be as a ' . '.
+# - # Possible values are YES and NO. If left blank NO is used.
+# - 
+# - QUIET                               = YES
+# - 
+# - #---------------------------------------------------------------------------
+# - # Configuration options related to the input files
+# - #---------------------------------------------------------------------------
+# - 
+# - # The IGNORE_FILE_NAME tag can be used to specify a possible textfile in each 
+# - # directory which is searched for files/subdirs to exclude. The default value 
+# - # is 'DoxyS.ignore'. It works like '.cvsignore'. The file is a simple textfile listing 
+# - # one file/subdir per line relative to the directory of the 'DoxyS.ignore' file. 
+# - # Like this: 
+# - # #$file_to_ignore.cpp$#
+# - 
+# - IGNORE_FILE_NAME                    = DoxyS.ignore
+# - 
+# - # If the value of the INPUT tag contains directories, you can use the 
+# - # FILE_PATTERNS tag to specify one or more wildcard pattern (like *.cpp 
+# - # and *.h) to filter out the source-files in the directories. If left 
+# - # blank the following patterns are tested: 
+# - # *.c *.cc *.cxx *.cpp *.c++ *.java *.ii *.ixx *.ipp *.i++ *.inl *.h *.hh *.hxx *.hpp 
+# - # *.h++ *.idl *.odl *.cs *.page *.dir *.dxd *.doc
+# - 
+# - FILE_PATTERNS                       = *.c *.cc *.cxx *.cpp *.c++ *.java *.ii *.ixx *.ipp *.i++ *.inl *.h *.hh *.hxx *.hpp *.h++ *.idl *.odl *.cs *.page *.dir *.dxd *.doc
+# - 
+# - # The RECURSIVE tag can be used to turn specify whether or not subdirectories 
+# - # should be searched for input files as well. Possible values are YES and NO. 
+# - # If left blank YES is used.
+# - 
+# - RECURSIVE                           = YES
+# - 
+# - # The EXCLUDE tag can be used to specify files and/or directories that should 
+# - # excluded from the INPUT source files. This way you can easily exclude a 
+# - # subdirectory from a directory tree whose root is specified with the INPUT tag.
+# - 
+# - EXCLUDE                             = doxys_docs/
+# - 
+# - # The EXCLUDE_SYMLINKS tag can be used select whether or not files or directories 
+# - # that are symbolic links (a Unix filesystem feature) are excluded from the input.
+# - 
+# - EXCLUDE_SYMLINKS                    = NO
+# - 
+# - # If the value of the INPUT tag contains directories, you can use the 
+# - # EXCLUDE_PATTERNS tag to specify one or more wildcard patterns to exclude 
+# - # certain files from those directories.
+# - 
+# - EXCLUDE_PATTERNS                    = 
+# - 
+# - # If the example is not found relatively to current directory, 
+# - # then try to prepend the EXAMPLE_PATH to see if the example is found here!
+# - 
+# - EXAMPLE_PATH                        = 
+# - 
+# - # If the image is not found relatively to current directory, 
+# - # then try to prepend the IMAGE_PATH to see if the image is found here!
+# - 
+# - IMAGE_PATH                          = 
+# - 
+# - # The INPUT_FILTER tag can be used to specify a program that DoxyS should 
+# - # invoke to filter for each input file. DoxyS will invoke the filter program 
+# - # by executing (via popen()) the command: $filter input-file$, where $filter$ 
+# - # is the value of the INPUT_FILTER tag, and $input-file$ is the name of an 
+# - # input file. DoxyS will then use the output that the filter program writes 
+# - # to standard output.
+# - 
+# - INPUT_FILTER                        = 
+# - 
+# - # If the FILTER_SOURCE_FILES tag is set to YES, the input filter (if set using 
+# - # INPUT_FILTER) will be used to filter the input files when producing source 
+# - # files to browse.
+# - 
+# - FILTER_SOURCE_FILES                 = NO
+# - 
+# - #---------------------------------------------------------------------------
+# - # Configuration options related to the HTML layout
+# - #---------------------------------------------------------------------------
+# - 
+# - # The NAVIGATION_CHAR_LENGTH tag is the maximum of charters there must be
+# - # before we are cutting
+# - # This is done to prevent the left menu from taking op to much space
+# - 
+# - NAVIGATION_CHAR_LENGTH              = 25
+# - 
+# - # If the number of entries in an overview table exceeds this number, then the 
+# - # the table will be shown in compact mode. Compact mode means that the table 
+# - # will contain COLS_IN_OVERVIEW_TABLES coloumns in each row and only the definitions 
+# - # name will be shown. The brief description will be be shown via mouse over effect.
+# - 
+# - LIMIT_COMPACT_IN_OVERVIEW_TABLES    = 100
+# - 
+# - # Number of coloumns in all the overview tables in case some of them 
+# - # contains so many elements that they need to swich to compact mode.
+# - 
+# - COLS_IN_OVERVIEW_TABLES             = 4
+# - 
+# - # If the number of entries in an overview table exceeds this number, then the 
+# - # the an alphabetical index will be generated.
+# - 
+# - LIMIT_ALFA_INDEX_IN_OVERVIEW_TABLES = 200
+# - 
+# - # The COMPACT_CHAR_LENGTH tag is the maximum of charters there must be
+# - # before we are cutting the name in compact mode
+# - # This is done to prevent the name from being to long
+# - 
+# - COMPACT_CHAR_LENGTH                 = 25
+# - 
+# - # Enables the info icon in non compact mode (ie. tables with brief description).
+# - # A mouse over will be shown with same type of info as on diagrams. Brief, public members etc.
+# - 
+# - INFO_ON_OVERVIEW_TABLES_NORMAL      = YES
+# - 
+# - # Enables the info icon in compact mode (ie. tables with no brief description).
+# - # A mouse over will be shown with same type of info as on diagrams. Brief, public members etc.
+# - 
+# - INFO_ON_OVERVIEW_TABLES_COMPACT     = YES
+# - 
+# - # If true the brief description is included in the header of the description. 
+# - # If both this tag and INCLUDE_BRIEF_IN_DESCRIPTION are set to NO then brief 
+# - # description will }not} appear on the decription pages.
+# - 
+# - INCLUDE_BRIEF_IN_HEADER             = YES
+# - 
+# - # If true the brief description is repeated in the description section.
+# - # If both this tag and INCLUDE_BRIEF_IN_HEADER are set to NO then brief 
+# - # description will }not} appear on the decription pages.
+# - 
+# - INCLUDE_BRIEF_IN_DESCRIPTION        = YES
+# - 
+# - # If true the desciption will not contain type info.Ex:(Page),(Class),(Namespace).
+# - 
+# - HIDE_TYPE_ON_DESCRIPTION            = NO
+# - 
+# - # Enables the collapse / expand icons on the description page.
+# - # All sections can now be collapsed. See also EXPAND_COLLAPSE_TABLE_SECTIONS_ONLY
+# - 
+# - EXPAND_COLLAPSE_SECTIONS            = YES
+# - 
+# - # Enables the collapse / expand icons on syntax, parameters etc.
+# - # This tag depends on EXPAND_COLLAPSE_SECTIONS is set to YES.
+# - # If this is set to true, then only syntax/parameters, reimplements etc. 
+# - # sections will have expand collapse icons. Description, todo, etc. 
+# - # }cannot} be collapsed.
+# - 
+# - EXPAND_COLLAPSE_TABLE_SECTIONS_ONLY = YES
+# - 
+# - # If set to YES, then included images (and their captions) are centered. 
+# - # Otherwise the images and captions will be left-aligned.
+# - 
+# - CENTER_ALIGN_IMAGES                 = NO
+# - 
+# - #---------------------------------------------------------------------------
+# - # Configuration options related to Left Menu layout
+# - #---------------------------------------------------------------------------
+# - 
+# - # If set to YES then left menu will be generated. 
+# - # If set to NO leftmemu and logo will not be included. 
+# - #  This option disables all left menus in all types of pages and ignores the other SHOW_LEFT_MENU_XXXX.
+# - 
+# - SHOW_LEFT_MENU                      = YES
+# - 
+# - # If set to YES then left menu will be generated for main page. 
+# - # If set to NO leftmemu and logo will not be included
+# - 
+# - SHOW_LEFT_MENU_MAINDIR              = YES
+# - 
+# - # If set to YES then left menu will be generated for search pages. 
+# - # If set to NO leftmemu and logo will not be included
+# - 
+# - SHOW_LEFT_MENU_SEARCH               = YES
+# - 
+# - # If set to YES then left menu will be generated for search pages. 
+# - # If set to NO leftmemu and logo will not be included
+# - 
+# - SHOW_LEFT_MENU_DIRECTORY            = YES
+# - 
+# - # If set to YES then left menu will be generated for the rest of documentation pages (not above). 
+# - # If set to NO leftmemu and logo will not be included
+# - 
+# - SHOW_LEFT_MENU_DOC                  = YES
+# - 
+# - # If set to YES and SHOW_LEFT_MENU set to yes then the logo will be displayed.
+# - 
+# - SHOW_LOGO                           = YES
+# - 
+# - # If set to YES directories will be shown on left menu.
+# - 
+# - LEFT_MENU_DIRECTORIES               = YES
+# - 
+# - # If set to YES pages will be shown on left menu.
+# - 
+# - LEFT_MENU_PAGES                     = YES
+# - 
+# - # If set to YES classes will be shown on left menu.
+# - 
+# - LEFT_MENU_CLASSES                   = YES
+# - 
+# - # If set to YES functions will be shown on left menu.
+# - 
+# - LEFT_MENU_FUNCTIONS                 = NO
+# - 
+# - # If set to YES macros will be shown on left menu.
+# - 
+# - LEFT_MENU_MACROS                    = NO
+# - 
+# - # If set to YES defines will be shown on left menu.
+# - 
+# - LEFT_MENU_DEFINES                   = NO
+# - 
+# - # If set to YES attributes will be shown on left menu.
+# - 
+# - LEFT_MENU_ATTRIBUTES                = NO
+# - 
+# - # If set to YES types will be shown on left menu.
+# - 
+# - LEFT_MENU_TYPES                     = NO
+# - 
+# - # If set to YES units will be shown on left menu.
+# - 
+# - LEFT_MENU_UNITS                     = YES
+# - 
+# - # If set to YES statistics will be shown on left menu.
+# - 
+# - LEFT_MENU_STATISTICS                = YES
+# - 
+# - # If set to YES, a link to statistics will be on the main page. 
+# - # If set to NO then locate the statistics under the common directory.
+# - 
+# - STATISTICS_LINK_ON_MAIN_PAGE        = YES
+# - 
+# - #---------------------------------------------------------------------------
+# - # Configuration options related to header and footer layout
+# - #---------------------------------------------------------------------------
+# - 
+# - # Mainly for projects that contains no source code, but only pages and directories. 
+# - # The header part of pages and directories will be disabled if set to true. 
+# - # This setting can also be used in projects containing code as it's not  
+# - # dependent on PAGE_DOCUMENTATION_MODE.
+# - 
+# - HIDE_HEADER_ON_DIRS_AND_PAGES       = NO
+# - 
+# - # Mainly for projects that contains no source code, but only pages and directories. 
+# - # The footer part of pages and directories will be disabled if set to true. 
+# - # This setting can also be used in projects containing code as it's not  
+# - # dependent on PAGE_DOCUMENTATION_MODE.
+# - 
+# - HIDE_FOOTER_ON_DIRS_AND_PAGES       = NO
+# - 
+# - # The header part will be disabled if set to true. 
+# - # If set to yes you may also whant to set HIDE_HEADER_ON_DIRS_AND_PAGES to yes
+# - 
+# - HIDE_HEADER_ON_CLASS_AND_MEMBERS    = NO
+# - 
+# - # The footer part will be disabled if set to true. 
+# - # If set to yes you may also whant to set HIDE_FOOTER_ON_DIRS_AND_PAGES to yes
+# - 
+# - HIDE_FOOTER_ON_CLASS_AND_MEMBERS    = NO
+# - 
+# - # The header part will be disabled if set to true. 
+# - # If set to yes you may also whant to set HIDE_HEADER_ON_DIRS_AND_PAGES to yes
+# - 
+# - HIDE_HEADER_ON_UNITS                = NO
+# - 
+# - # The footer part will be disabled if set to true. 
+# - # If set to yes you may also whant to set HIDE_FOOTER_ON_DIRS_AND_PAGES to yes
+# - 
+# - HIDE_FOOTER_ON_UNITS                = NO
+# - 
+# - #---------------------------------------------------------------------------
+# - # Configuration options related to the preprocessor   
+# - #---------------------------------------------------------------------------
+# - 
+# - # If the ENABLE_PREPROCESSING tag is set to YES (the default) DoxyS will 
+# - # evaluate all C-preprocessor directives found in the sources and include 
+# - # files.
+# - 
+# - ENABLE_PREPROCESSING                = YES
+# - 
+# - # If the MACRO_EXPANSION tag is set to YES DoxyS will expand all macro 
+# - # names in the source code. If set to NO only conditional 
+# - # compilation will be performed. Macro expansion can be done in a controlled 
+# - # way by setting EXPAND_ONLY_PREDEF to YES (the default).
+# - 
+# - MACRO_EXPANSION                     = YES
+# - 
+# - # If the EXPAND_ONLY_PREDEF and MACRO_EXPANSION tags are both set to YES 
+# - # then the macro expansion is limited to the macros specified with the 
+# - # PREDEFINED and EXPAND_AS_PREDEFINED tags.
+# - 
+# - EXPAND_ONLY_PREDEF                  = NO
+# - 
+# - # If the SEARCH_INCLUDES tag is set to YES (the default) the includes files 
+# - # in the INCLUDE_PATH (see below) will be search if a $\include$ command is found.
+# - 
+# - SEARCH_INCLUDES                     = YES
+# - 
+# - # The INCLUDE_PATH tag can be used to specify one or more directories that 
+# - # contain include files that are not input files but should be processed by 
+# - # the preprocessor.
+# - 
+# - INCLUDE_PATH                        = 
+# - 
+# - # You can use the INCLUDE_FILE_PATTERNS tag to specify one or more wildcard 
+# - # patterns (like *.h and *.hpp) to filter out the header-files in the 
+# - # directories. If left blank, the patterns specified with FILE_PATTERNS will 
+# - # be used.
+# - 
+# - INCLUDE_FILE_PATTERNS               = 
+# - 
+# - # The PREDEFINED tag can be used to specify one or more macro names that 
+# - # are defined before the preprocessor is started (similar to the -D option of 
+# - # gcc). The argument of the tag is a list of macros of the form: name 
+# - # or name=definition (no spaces). If the definition and the = are 
+# - # omitted =1 is assumed.
+# - 
+# - PREDEFINED                          = 
+# - 
+# - # If the MACRO_EXPANSION and EXPAND_ONLY_PREDEF tags are set to YES then 
+# - # this tag can be used to specify a list of macro names that should be expanded. 
+# - # The macro definition that is found in the sources will be used. 
+# - # Use the PREDEFINED tag if you want to use a different macro definition.
+# - 
+# - EXPAND_AS_DEFINED                   = 
+# - 
+# - # If the SKIP_FUNCTION_MACROS tag is set to YES (the default) then 
+# - # DoxyS's preprocessor will remove all function-like macros that are alone 
+# - # on a line, have an all uppercase name, and do not end with a semicolon. Such 
+# - # function macros are typically used for boiler-plate code, and will confuse the 
+# - # parser if not removed.
+# - 
+# - SKIP_FUNCTION_MACROS                = YES
+# - 
+# - #---------------------------------------------------------------------------
+# - # Configuration options related to the dot tool
+# - #---------------------------------------------------------------------------
+# - 
+# - # If set to YES then DoxyS will assume the dot tool is 
+# - # available from the path. This tool is part of Graphviz, a graph visualization 
+# - # toolkit from AT&T and Lucent Bell Labs. The other options in this section 
+# - # have no effect if this option is set to NO.
+# - 
+# - ENABLE_DOT_GRAPHS                   = YES
+# - 
+# - # The tag DOT_PATH can be used to specify the path where the dot tool can be 
+# - # found. If left blank, it is assumed the dot tool can be found on the path.
+# - 
+# - DOT_PATH                            = 
+# - 
+# - # If the CLASS_DIAGRAMS tag is set to YES (the default) DoxyS will 
+# - # generate a inheritance diagram for classes with base or 
+# - # super classes. Setting the tag to NO turns the diagrams off. Note that this 
+# - # option is superceded by the ENABLE_DOT_GRAPHS option below. This is only a fallback. It is 
+# - # recommended to install and use dot, since it yields more powerful graphs.
+# - 
+# - CLASS_DIAGRAMS                      = YES
+# - 
+# - # If set to YES, the inheritance and collaboration graphs will hide 
+# - # inheritance and usage relations if the target is undocumented 
+# - # or is not a class.
+# - 
+# - HIDE_UNDOC_RELATIONS                = YES
+# - 
+# - # If the CLASS_GRAPH and ENABLE_DOT_GRAPHS tags are set to YES then DoxyS 
+# - # will generate a graph for each documented class showing the direct and 
+# - # indirect inheritance relations. Setting this tag to YES will force the 
+# - # the CLASS_DIAGRAMS tag to NO.
+# - 
+# - CLASS_GRAPH                         = YES
+# - 
+# - # If the COLLABORATION_GRAPH and ENABLE_DOT_GRAPHS tags are set to YES then DoxyS 
+# - # will generate a graph for each documented class showing the direct and 
+# - # indirect implementation dependencies (inheritance, containment, and 
+# - # class references variables) of the class with other documented classes.
+# - 
+# - COLLABORATION_GRAPH                 = YES
+# - 
+# - # If the UML_LOOK tag is set to YES DoxyS will generate inheritance and 
+# - # collaboration diagrams in a style similiar to the OMG's Unified Modeling 
+# - # Language.
+# - 
+# - UML_LOOK                            = NO
+# - 
+# - # If set to YES, the inheritance and collaboration graphs will show the 
+# - # relations between templates and their instances.
+# - 
+# - TEMPLATE_RELATIONS                  = YES
+# - 
+# - # If the ENABLE_PREPROCESSING, SEARCH_INCLUDES, INCLUDE_GRAPH, and ENABLE_DOT_GRAPHS 
+# - # tags are set to YES then DoxyS will generate a graph for each documented 
+# - # file showing the direct and indirect include dependencies of the file with 
+# - # other documented files.
+# - 
+# - INCLUDE_GRAPH                       = YES
+# - 
+# - # If the ENABLE_PREPROCESSING, SEARCH_INCLUDES, INCLUDED_BY_GRAPH, and 
+# - # ENABLE_DOT_GRAPHS tags are set to YES then DoxyS will generate a graph for each 
+# - # documented header file showing the documented files that directly or 
+# - # indirectly include this file.
+# - 
+# - INCLUDED_BY_GRAPH                   = YES
+# - 
+# - # If the CALL_GRAPH and ENABLE_DOT_GRAPHS tags are set to YES then DoxyS will 
+# - # generate a call dependency graph for every global function or class method. 
+# - # Note that enabling this option will significantly increase the time of a run. 
+# - # So in most cases it will be better to enable call graphs for selected 
+# - # functions only using the \callgraph command.
+# - 
+# - CALL_GRAPH                          = YES
+# - 
+# - # If the CALL_GRAPH and ENABLE_DOT_GRAPHS tags are set to YES then DoxyS will 
+# - # generate a directory graph for for every directory.
+# - 
+# - DIR_GRAPH                           = YES
+# - 
+# - # If the GRAPHICAL_HIERARCHY and ENABLE_DOT_GRAPHS tags are set to YES then DoxyS 
+# - # will graphical hierarchy of all classes instead of a textual one.
+# - 
+# - GRAPHICAL_HIERARCHY                 = YES
+# - 
+# - # The DOT_IMAGE_FORMAT tag can be used to set the image format of the images 
+# - # generated by dot. Possible values are png, jpg, or gif. 
+# - # If left blank png will be used.
+# - 
+# - DOT_IMAGE_FORMAT                    = png
+# - 
+# - # The DOTFILE_DIRS tag can be used to specify one or more directories that 
+# - # contain dot files that are included in the documentation (see the 
+# - # dotfile command).
+# - 
+# - DOTFILE_DIRS                        = 
+# - 
+# - # The MAX_DOT_GRAPH_WIDTH tag can be used to set the maximum allowed width 
+# - # (in pixels) of the graphs generated by dot. If a graph becomes larger than 
+# - # this value, DoxyS will try to truncate the graph, so that it fits within 
+# - # the specified constraint. Beware that most browsers cannot cope with very 
+# - # large images.
+# - 
+# - MAX_DOT_GRAPH_WIDTH                 = 1024
+# - 
+# - # The MAX_DOT_GRAPH_HEIGHT tag can be used to set the maximum allows height 
+# - # (in pixels) of the graphs generated by dot. If a graph becomes larger than 
+# - # this value, DoxyS will try to truncate the graph, so that it fits within 
+# - # the specified constraint. Beware that most browsers cannot cope with very 
+# - # large images.
+# - 
+# - MAX_DOT_GRAPH_HEIGHT                = 1024
+# - 
+# - # The MAX_DOT_GRAPH_DEPTH tag can be used to set the maximum depth of the 
+# - # graphs generated by dot. A depth value of 3 means that only nodes reachable 
+# - # from the root by following a path via at most 3 edges will be shown. Nodes that 
+# - # lay further from the root node will be omitted. Note that setting this option to 
+# - # 1 or 2 may greatly reduce the computation time needed for large code bases. Also 
+# - # note that a graph may be further truncated if the graph's image dimensions are 
+# - # not sufficient to fit the graph (see MAX_DOT_GRAPH_WIDTH and MAX_DOT_GRAPH_HEIGHT). 
+# - # If 0 is used for the depth value (the default), the graph is not depth-constrained.
+# - 
+# - MAX_DOT_GRAPH_DEPTH                 = 0
+# - 
+# - # If set to YES, then all dot images are centered. 
+# - # Otherwise the images will be left-aligned.
+# - 
+# - CENTER_ALIGN_DOT_IMAGES             = NO
+# - 
+# - # If the DOT_CLEANUP tag is set to YES (the default) DoxyS will 
+# - # remove the intermediate dot files that are used to generate 
+# - # the various graphs.
+# - 
+# - DOT_CLEANUP                         = YES
+# - 
+# - #---------------------------------------------------------------------------
+# - # Language options
+# - #---------------------------------------------------------------------------
+# - 
+# - # The OUTPUT_LANGUAGE tag is used to specify the language in which all 
+# - # documentation generated by DoxyS is written. DoxyS will use this 
+# - # information to generate all constant output in the proper language. 
+# - # The default language is English, other supported languages are: 
+# - # Brazilian, Catalan, Chinese, Chinese-Traditional, Croatian, Czech, Danish, Dutch, 
+# - # Finnish, French, German, Greek, Hungarian, Italian, Japanese, Japanese-en 
+# - # (Japanese with English messages), Korean, Norwegian, Polish, Portuguese, 
+# - # Romanian, Russian, Serbian, Slovak, Slovene, Spanish, Swedish, and Ukrainian.
+# - 
+# - OUTPUT_LANGUAGE                     = English
+# - 
+# - # This tag can be used to specify the encoding used in the generated output. 
+# - # The encoding is not always determined by the language that is chosen, 
+# - # but also whether or not the output is meant for Windows or non-Windows users. 
+# - # In case there is a difference, setting the USE_WINDOWS_ENCODING tag to YES 
+# - # forces the Windows encoding (this is the default for the Windows binary), 
+# - # whereas setting the tag to NO uses a Unix-style encoding (the default for 
+# - # all platforms other than Windows).
+# - 
+# - USE_WINDOWS_ENCODING                = YES
+# - 
+# - 
+# - 
+# - 
+# - 
+# - # - # DoxySfile 0.90b ShortConfig -- Do not remove or edit this line please --
+# - # - 
+# - # - #---------------------------------------------------------------------------
+# - # - # General configuration options
+# - # - #---------------------------------------------------------------------------
+# - # - PROJECT_NAME                        = DefaultProjectName
+# - # - PROJECT_NUMBER                      = 
+# - # - INPUT                               = .
+# - # - OUTPUT_DIRECTORY                    = doxys_docs/
+# - # - GENERATE_DOXYS_HELP                 = YES
+# - # - HTML_FILE_EXTENSION                 = .html
+# - # - CUSTOM_DIR                          = 
+# - # - SERVER_STATISTICS                   = 
+# - # - HTML_HELP_SERVER_PATH               = 
+# - # - STRIP_CODE_COMMENTS                 = YES
+# - # - #---------------------------------------------------------------------------
+# - # - # Special options (rarely changed)
+# - # - #---------------------------------------------------------------------------
+# - # - DELETE_OUTPUT_DIRECTORY             = NO
+# - # - MS_DOT_NET_INTEGRATION              = NO
+# - # - MS_DOT_NET_INTEGRATION_PATH         = 
+# - # - GENERATE_HTMLHELP1                  = NO
+# - # - GENERATE_STATISTICS                 = YES
+# - # - #---------------------------------------------------------------------------
+# - # - # Search page options
+# - # - #---------------------------------------------------------------------------
+# - # - CREATE_SEARCHPAGE                   = YES
+# - # - SEARCH_BRIEF_DESCRIPTION            = YES
+# - # - SEARCH_FUNCTIONS                    = YES
+# - # - SEARCH_VARIABLES                    = YES
+# - # - SEARCH_TYPEDEFS_ETC                 = YES
+# - # - #---------------------------------------------------------------------------
+# - # - # Specify what is included in the output
+# - # - #---------------------------------------------------------------------------
+# - # - CREATE_DOC_FOR_FILES                = YES
+# - # - CREATE_SOURCECODE_FOR_FILES         = NO
+# - # - CREATE_SOURCECODE_FOR_MEMBERS       = YES
+# - # - EXTRACT_PRIVATE                     = YES
+# - # - EXTRACT_PROTECTED                   = YES
+# - # - EXTRACT_STATIC                      = YES
+# - # - EXTRACT_LOCAL_CLASSES               = YES
+# - # - HIDE_UNDOC_NAMESPACES               = NO
+# - # - HIDE_UNDOC_CLASSES                  = NO
+# - # - HIDE_UNDOC_FUNCTIONS                = NO
+# - # - HIDE_UNDOC_VARIABLES                = NO
+# - # - HIDE_UNDOC_ENUMS                    = NO
+# - # - HIDE_UNDOC_ENUM_VALUES              = NO
+# - # - HIDE_UNDOC_TYPEDEFS                 = NO
+# - # - HIDE_UNDOC_MACROS                   = NO
+# - # - HIDE_UNDOC_DEFINES                  = YES
+# - # - GENERATE_TODOLIST                   = YES
+# - # - GENERATE_BUGLIST                    = YES
+# - # - GENERATE_DEPRECATEDLIST             = YES
+# - # - #---------------------------------------------------------------------------
+# - # - # Customize how the documentation is generated
+# - # - #---------------------------------------------------------------------------
+# - # - MEMBER_SAME_FILE_RELATE_TO_CLASSES  = YES
+# - # - MEMBER_SAME_FILE_RELATE_TO_STRUCTS  = NO
+# - # - FULL_PATH_NAMES                     = NO
+# - # - STRIP_FROM_PATH                     = 
+# - # - INTERNAL_DOCS                       = NO
+# - # - TODO_DOCS                           = YES
+# - # - INHERIT_DOCS                        = YES
+# - # - HIDE_CLASS_METHODS_IN_OVERVIEW      = NO
+# - # - CONCATENATE_DECL_AND_DEFINITION_DOC = YES
+# - # - #---------------------------------------------------------------------------
+# - # - # Customize layout for pure text projects (ie containing no code)
+# - # - #---------------------------------------------------------------------------
+# - # - PAGE_DOCUMENTATION_MODE             = NO
+# - # - #---------------------------------------------------------------------------
+# - # - # Options to control how the input is parsed
+# - # - #---------------------------------------------------------------------------
+# - # - HIDE_IN_BODY_DOCS                   = NO
+# - # - TAB_SIZE                            = 4
+# - # - ALIASES                             = 
+# - # - ENABLED_SECTIONS                    = 
+# - # - IGNORE_CLASS_PREFIX                 = 
+# - # - #---------------------------------------------------------------------------
+# - # - # configuration options related to warning and progress messages
+# - # - #---------------------------------------------------------------------------
+# - # - MESSAGE_LEVEL_SCREEN                = Messages Warnings
+# - # - OUTPUT_PREFIX_SCREEN                = Warnings Errors
+# - # - OUTPUT_PATTERNS_SCREEN              = Progress Preprocessor Scanner Generator Docparser Dot Definition Configfile Undocumented Unknown
+# - # - MESSAGE_SCREEN_LOGFILE              = 
+# - # - MESSAGE_LEVEL_HTML_FILE             = Messages Warnings Errors Debug
+# - # - OUTPUT_PATTERNS_HTML_FILE           = Progress Preprocessor Scanner Generator Docparser Dot Definition Configfile Undocumented Unknown
+# - # - QUIET                               = YES
+# - # - #---------------------------------------------------------------------------
+# - # - # Configuration options related to the input files
+# - # - #---------------------------------------------------------------------------
+# - # - IGNORE_FILE_NAME                    = DoxyS.ignore
+# - # - FILE_PATTERNS                       = *.c *.cc *.cxx *.cpp *.c++ *.java *.ii *.ixx *.ipp *.i++ *.inl *.h *.hh *.hxx *.hpp *.h++ *.idl *.odl *.cs *.page *.dir *.dxd *.doc
+# - # - RECURSIVE                           = YES
+# - # - EXCLUDE                             = doxys_docs/
+# - # - EXCLUDE_SYMLINKS                    = NO
+# - # - EXCLUDE_PATTERNS                    = 
+# - # - EXAMPLE_PATH                        = 
+# - # - IMAGE_PATH                          = 
+# - # - INPUT_FILTER                        = 
+# - # - FILTER_SOURCE_FILES                 = NO
+# - # - #---------------------------------------------------------------------------
+# - # - # Configuration options related to the HTML layout
+# - # - #---------------------------------------------------------------------------
+# - # - NAVIGATION_CHAR_LENGTH              = 25
+# - # - LIMIT_COMPACT_IN_OVERVIEW_TABLES    = 100
+# - # - COLS_IN_OVERVIEW_TABLES             = 4
+# - # - LIMIT_ALFA_INDEX_IN_OVERVIEW_TABLES = 200
+# - # - COMPACT_CHAR_LENGTH                 = 25
+# - # - INFO_ON_OVERVIEW_TABLES_NORMAL      = YES
+# - # - INFO_ON_OVERVIEW_TABLES_COMPACT     = YES
+# - # - INCLUDE_BRIEF_IN_HEADER             = YES
+# - # - INCLUDE_BRIEF_IN_DESCRIPTION        = YES
+# - # - HIDE_TYPE_ON_DESCRIPTION            = NO
+# - # - EXPAND_COLLAPSE_SECTIONS            = YES
+# - # - EXPAND_COLLAPSE_TABLE_SECTIONS_ONLY = YES
+# - # - CENTER_ALIGN_IMAGES                 = NO
+# - # - #---------------------------------------------------------------------------
+# - # - # Configuration options related to Left Menu layout
+# - # - #---------------------------------------------------------------------------
+# - # - SHOW_LEFT_MENU                      = YES
+# - # - SHOW_LEFT_MENU_MAINDIR              = YES
+# - # - SHOW_LEFT_MENU_SEARCH               = YES
+# - # - SHOW_LEFT_MENU_DIRECTORY            = YES
+# - # - SHOW_LEFT_MENU_DOC                  = YES
+# - # - SHOW_LOGO                           = YES
+# - # - LEFT_MENU_DIRECTORIES               = YES
+# - # - LEFT_MENU_PAGES                     = YES
+# - # - LEFT_MENU_CLASSES                   = YES
+# - # - LEFT_MENU_FUNCTIONS                 = NO
+# - # - LEFT_MENU_MACROS                    = NO
+# - # - LEFT_MENU_DEFINES                   = NO
+# - # - LEFT_MENU_ATTRIBUTES                = NO
+# - # - LEFT_MENU_TYPES                     = NO
+# - # - LEFT_MENU_UNITS                     = YES
+# - # - LEFT_MENU_STATISTICS                = YES
+# - # - STATISTICS_LINK_ON_MAIN_PAGE        = YES
+# - # - #---------------------------------------------------------------------------
+# - # - # Configuration options related to header and footer layout
+# - # - #---------------------------------------------------------------------------
+# - # - HIDE_HEADER_ON_DIRS_AND_PAGES       = NO
+# - # - HIDE_FOOTER_ON_DIRS_AND_PAGES       = NO
+# - # - HIDE_HEADER_ON_CLASS_AND_MEMBERS    = NO
+# - # - HIDE_FOOTER_ON_CLASS_AND_MEMBERS    = NO
+# - # - HIDE_HEADER_ON_UNITS                = NO
+# - # - HIDE_FOOTER_ON_UNITS                = NO
+# - # - #---------------------------------------------------------------------------
+# - # - # Configuration options related to the preprocessor   
+# - # - #---------------------------------------------------------------------------
+# - # - ENABLE_PREPROCESSING                = YES
+# - # - MACRO_EXPANSION                     = YES
+# - # - EXPAND_ONLY_PREDEF                  = NO
+# - # - SEARCH_INCLUDES                     = YES
+# - # - INCLUDE_PATH                        = 
+# - # - INCLUDE_FILE_PATTERNS               = 
+# - # - PREDEFINED                          = 
+# - # - EXPAND_AS_DEFINED                   = 
+# - # - SKIP_FUNCTION_MACROS                = YES
+# - # - #---------------------------------------------------------------------------
+# - # - # Configuration options related to the dot tool
+# - # - #---------------------------------------------------------------------------
+# - # - ENABLE_DOT_GRAPHS                   = YES
+# - # - DOT_PATH                            = 
+# - # - CLASS_DIAGRAMS                      = YES
+# - # - HIDE_UNDOC_RELATIONS                = YES
+# - # - CLASS_GRAPH                         = YES
+# - # - COLLABORATION_GRAPH                 = YES
+# - # - UML_LOOK                            = NO
+# - # - TEMPLATE_RELATIONS                  = YES
+# - # - INCLUDE_GRAPH                       = YES
+# - # - INCLUDED_BY_GRAPH                   = YES
+# - # - CALL_GRAPH                          = YES
+# - # - DIR_GRAPH                           = YES
+# - # - GRAPHICAL_HIERARCHY                 = YES
+# - # - DOT_IMAGE_FORMAT                    = png
+# - # - DOTFILE_DIRS                        = 
+# - # - MAX_DOT_GRAPH_WIDTH                 = 1024
+# - # - MAX_DOT_GRAPH_HEIGHT                = 1024
+# - # - MAX_DOT_GRAPH_DEPTH                 = 0
+# - # - CENTER_ALIGN_DOT_IMAGES             = NO
+# - # - DOT_CLEANUP                         = YES
+# - # - #---------------------------------------------------------------------------
+# - # - # Language options
+# - # - #---------------------------------------------------------------------------
+# - # - OUTPUT_LANGUAGE                     = English
+# - # - USE_WINDOWS_ENCODING                = YES



From codeandroid at mail.berlios.de  Mon Jul 17 19:46:04 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Mon, 17 Jul 2006 19:46:04 +0200
Subject: [Yake-svn] r1391 - trunk/yake/yapp/vehicle
Message-ID: <200607171746.k6HHk4sI008866@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-17 19:46:03 +0200 (Mon, 17 Jul 2006)
New Revision: 1391

Added:
   trunk/yake/yapp/vehicle/yakeVehicleModelComponent.h
Log:
initial revision

Added: trunk/yake/yapp/vehicle/yakeVehicleModelComponent.h
===================================================================
--- trunk/yake/yapp/vehicle/yakeVehicleModelComponent.h	2006-07-15 14:38:29 UTC (rev 1390)
+++ trunk/yake/yapp/vehicle/yakeVehicleModelComponent.h	2006-07-17 17:46:03 UTC (rev 1391)
@@ -0,0 +1,55 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright ? 2004 The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#ifndef YAKE_VEHICLE_MODEL_COMPONENT_H
+#define YAKE_VEHICLE_MODEL_COMPONENT_H
+
+#include <yapp/vehicle/yakePrerequisites.h>
+
+namespace yake {
+namespace vehicle {
+
+	class YAKE_VEH_API VehicleModelComponent : public model::ModelComponent
+	{
+	private:
+		VehicleModelComponent(const VehicleModelComponent&);
+		VehicleModelComponent& operator=(const VehicleModelComponent&);
+	public:
+		VehicleModelComponent(vehicle::IVehicle*);
+		virtual ~VehicleModelComponent();
+
+		vehicle::IVehicle* getVehicle() const
+		{
+			return vehicle_.get();
+		}
+	private:
+		SharedPtr<vehicle::IVehicle>	vehicle_;
+	};
+
+} // namespace vehicle
+} // namespace yake
+
+#endif



From codeandroid at mail.berlios.de  Wed Jul 19 23:56:34 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Wed, 19 Jul 2006 23:56:34 +0200
Subject: [Yake-svn] r1392 - in trunk/yake: src/yake/input yake/input
Message-ID: <200607192156.k6JLuYTF021648@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-19 23:56:33 +0200 (Wed, 19 Jul 2006)
New Revision: 1392

Modified:
   trunk/yake/src/yake/input/yakeActionMap.cpp
   trunk/yake/yake/input/yakeActionMap.h
Log:
added ConditionConnection,
made registration/deregistration more robust

Modified: trunk/yake/src/yake/input/yakeActionMap.cpp
===================================================================
--- trunk/yake/src/yake/input/yakeActionMap.cpp	2006-07-17 17:46:03 UTC (rev 1391)
+++ trunk/yake/src/yake/input/yakeActionMap.cpp	2006-07-19 21:56:33 UTC (rev 1392)
@@ -451,53 +451,134 @@
 	//-----------------------------------------------------
 	ActionMap::~ActionMap()
 	{
-		for (ActionList::const_iterator it = mEntries.begin(); it != mEntries.end(); ++it)
-		{
-			ActionMapEntry* pEntry = (*it);
-			YAKE_ASSERT( pEntry );
-			YAKE_SAFE_DELETE( pEntry->condition );
-			delete pEntry;
-		}
 		mEntries.clear();
 	}
 
 	//-----------------------------------------------------
-	void ActionMap::reg( const ActionId & actionId, ActionCondition* condition )
+	ConditionConnection ActionMap::reg( const ActionId & actionId, ActionCondition* condition )
 	{
 		YAKE_ASSERT( condition );
-		ActionMapEntry* entry = new ActionMapEntry;
-		entry->condition = condition;
-		entry->actionId  = actionId;
-		mEntries.push_back( entry );
+
+		ActionList::iterator it = mEntries.find( actionId );
+		if (it == mEntries.end())
+		{
+			std::pair<ActionList::iterator,bool> vt = mEntries.insert( std::make_pair( actionId, new ActionMapEntry() ) );
+			YAKE_ASSERT( vt.second );
+			vt.first->second->conditions.push_back( SharedPtr<ActionCondition>(condition));
+		}
+		else
+			it->second->conditions.push_back( SharedPtr<ActionCondition>(condition));
+
+		return ConditionConnection(this,actionId,condition);
 	}
 
 	//-----------------------------------------------------
-	void ActionMap::subscribeToActionId( const ActionId & actionId, const ActionSignal::slot_type & slot )
+	bool operator == (const SharedPtr<ActionCondition>& lhs, const ActionCondition* rhs)
 	{
-		for (ActionList::const_iterator it = mEntries.begin(); it != mEntries.end(); ++it)
-		{
-			ActionMapEntry* pEntry = (*it);
-			YAKE_ASSERT( pEntry );
-			if (pEntry->actionId == actionId)
-			{
-				pEntry->signal.connect( slot );
-				return;
-			}
-		}
+		return lhs.get() == rhs;
 	}
+	//-----------------------------------------------------
+	void ActionMap::unreg( const ActionId& actionId, void* p )
+	{
+		ActionList::const_iterator it = mEntries.find( actionId );
+		YAKE_ASSERT( it != mEntries.end() );
+		if (it == mEntries.end())
+			return;
 
+		ActionCondition* cond = reinterpret_cast<ActionCondition*>(p);
+		YAKE_ASSERT( cond );
+
+		ConditionList& condList = it->second->conditions;
+		ConditionList::iterator itC = std::find(condList.begin(), condList.end(), cond);
+		YAKE_ASSERT( itC != condList.end() );
+		condList.erase( itC );
+	}
+
 	//-----------------------------------------------------
+	SignalConnection ActionMap::subscribeToActionId( const ActionId & actionId, const ActionSignal::slot_type & slot )
+	{
+		ActionList::const_iterator it = mEntries.find( actionId );
+		YAKE_ASSERT( it != mEntries.end() );
+		if (it == mEntries.end())
+			return SignalConnection();
+		ActionMapEntry* pEntry = it->second.get();
+		YAKE_ASSERT( pEntry );
+		return pEntry->signal.connect( slot );
+	}
+
+	//-----------------------------------------------------
 	void ActionMap::update()
 	{
+		// the update loop
+		ActionList dead;
+		std::deque<ActionMapEntry*> triggered;
 		for (ActionList::const_iterator it = mEntries.begin(); it != mEntries.end(); ++it)
 		{
-			ActionMapEntry* pEntry = (*it);
+			ActionMapEntry* pEntry = it->second.get();
 			YAKE_ASSERT( pEntry );
-			YAKE_ASSERT( pEntry->condition );
+			if (!pEntry->alive)
+			{
+				dead.insert( std::make_pair(it->first, it->second) );
+				continue;
+			}
+			const ConditionList& condList = pEntry->conditions;
+			for (ConditionList::const_iterator itC = condList.begin(); itC != condList.end(); ++itC)
+			{
+				if ( (**itC)() )
+				{
+					triggered.push_back( pEntry );
+					break; // ! important. @todo make it possible to subscribe to specific conditions.
+				}
+			}
+		}
 
-			if ( (*pEntry->condition)() )
-				pEntry->signal();
+
+		// remove dead ones
+		ConstVectorIterator<ActionList> itDead( dead );
+		while (itDead.hasMoreElements())
+		{
+			ActionList::iterator itFind = std::find( mEntries.begin(), mEntries.end(), itDead.getNext() );
+			if (itFind != mEntries.end())
+			{
+				mEntries.erase( itFind );
+			}
 		}
+
+		// trigger signals
+		ConstVectorIterator<std::deque<ActionMapEntry*> > itTriggered( triggered );
+		while (itTriggered.hasMoreElements())
+		{
+			itTriggered.getNext()->signal();
+		}
+		triggered.clear();
 	}
+
+	//-----------------------------------------------------
+	// class: ConditionConnection
+	//-----------------------------------------------------
+	ConditionConnection::ConditionConnection(ActionMap* m,const ActionId& id,void* p) : map_(m), data_(p), id_(id)
+	{}
+	ConditionConnection::ConditionConnection(const ConditionConnection& other) : map_(other.map_), data_(other.data_), id_(other.id_)
+	{
+	}
+	ConditionConnection::~ConditionConnection()
+	{
+	}
+	ConditionConnection& ConditionConnection::operator=(const ConditionConnection& rhs)
+	{
+		if (this == &rhs)
+			return *this;
+		map_ = rhs.map_;
+		data_ = rhs.data_;
+		id_ = rhs.id_;
+		return *this;
+	}
+	void ConditionConnection::disconnect()
+	{
+		if (map_ && data_)
+			map_->unreg( id_, data_ );
+		map_ = 0;
+		data_ = 0;
+	}
 }
 }

Modified: trunk/yake/yake/input/yakeActionMap.h
===================================================================
--- trunk/yake/yake/input/yakeActionMap.h	2006-07-17 17:46:03 UTC (rev 1391)
+++ trunk/yake/yake/input/yakeActionMap.h	2006-07-19 21:56:33 UTC (rev 1392)
@@ -174,6 +174,22 @@
 		uint8	mButton;
 	};
 
+	class ActionMap;
+	struct YAKE_INPUT_API ConditionConnection
+	{
+		~ConditionConnection();
+		ConditionConnection(const ConditionConnection&);
+		ConditionConnection& operator=(const ConditionConnection&);
+		void disconnect();
+	private:
+		ConditionConnection(ActionMap*,const ActionId&,void*);
+		friend class ActionMap;
+	private:
+		ActionMap*			map_;
+		ActionId			id_;
+		void*				data_;
+	};
+
 	/** An ActionMap object can handly any number of ActionCondition/ActionId pairs.
 		The update() method has to be regularly called.
 		If an action should be run an ActionSignal is fired which will inform all
@@ -186,23 +202,28 @@
 		~ActionMap();
 
 		typedef Signal1< void(void) > ActionSignal;
-		void reg( const ActionId & actionId, ActionCondition* condition );
-		void subscribeToActionId( const ActionId & actionId, const ActionSignal::slot_type & slot );
+		ConditionConnection reg( const ActionId & actionId, ActionCondition* condition );
+		SignalConnection subscribeToActionId( const ActionId & actionId, const ActionSignal::slot_type & slot );
 		void update();
 
 		static bool loadFromFile(ActionMap& amap, const String& fname, KeyboardDevice* pKeyboard);
 		static bool saveToFile(ActionMap& amap, const String& fname);
+
 	private:
+		friend struct ConditionConnection;
+		void unreg( const ActionId&, void * );
+	private:
 		typedef Vector< ActionId > ActionIdList;
+		typedef std::deque<SharedPtr<ActionCondition> > ConditionList;
 		struct ActionMapEntry {
-			ActionMapEntry() : condition(0), actionId(ACTIONID_USER)
+			ActionMapEntry() : alive(true)
 			{
 			}
-			ActionCondition*	condition;
-			ActionId			actionId;
-			ActionSignal		signal;
+			ConditionList				conditions;
+			ActionSignal				signal;
+			bool						alive;
 		};
-		typedef Vector< ActionMapEntry* > ActionList;
+		typedef AssocVector< ActionId, SharedPtr<ActionMapEntry> > ActionList;
 		ActionList	mEntries;
 	};
 



From codeandroid at mail.berlios.de  Wed Jul 19 23:58:56 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Wed, 19 Jul 2006 23:58:56 +0200
Subject: [Yake-svn] r1393 - trunk/yake/src/yapp/vehicle
Message-ID: <200607192158.k6JLwtrm021819@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-19 23:58:55 +0200 (Wed, 19 Jul 2006)
New Revision: 1393

Modified:
   trunk/yake/src/yapp/vehicle/yakeMountPoint.cpp
   trunk/yake/src/yapp/vehicle/yakeNativeOde.cpp
Log:
various fixes

Modified: trunk/yake/src/yapp/vehicle/yakeMountPoint.cpp
===================================================================
--- trunk/yake/src/yapp/vehicle/yakeMountPoint.cpp	2006-07-19 21:56:33 UTC (rev 1392)
+++ trunk/yake/src/yapp/vehicle/yakeMountPoint.cpp	2006-07-19 21:58:55 UTC (rev 1393)
@@ -43,10 +43,11 @@
 	}
 	MountPoint::~MountPoint()
 	{
-		ConstVectorIterator< MountablePtrList > it( mMountables );
+		MountablePtrList mountables = mMountables;
+		ConstVectorIterator< MountablePtrList > it( mountables );
 		while (it.hasMoreElements())
 			detach( it.getNext() );
-		mMountables.clear();
+		YAKE_ASSERT( mMountables.empty() );
 
 		ConstVectorIterator< MountPointList > itMP( mChildren );
 		while (itMP.hasMoreElements())

Modified: trunk/yake/src/yapp/vehicle/yakeNativeOde.cpp
===================================================================
--- trunk/yake/src/yapp/vehicle/yakeNativeOde.cpp	2006-07-19 21:56:33 UTC (rev 1392)
+++ trunk/yake/src/yapp/vehicle/yakeNativeOde.cpp	2006-07-19 21:58:55 UTC (rev 1393)
@@ -630,10 +630,18 @@
 		YAKE_ASSERT( mpChassis );
 		YAKE_ASSERT( mpWheel );
 		const math::Vector3 chassisDir = mpChassis->getOrientation() * math::Vector3::kUnitZ;
-		const math::Vector3 wheelMovementDir = mpWheel->getBody().getLinearVelocity().normalisedCopy();
-		mSkid = 1. - chassisDir.dotProduct( wheelMovementDir );
-		if (mSkid < 0)
+		const math::Vector3 linVel = mpWheel->getBody().getLinearVelocity();
+		const real linVelf = linVel.length();
+		const math::Vector3 wheelMovementDir = linVel.normalisedCopy();
+		if (linVelf < 0.1) //@todo FIXME should be dependent size...
 			mSkid = 0.;
+		else
+		{
+			mSkid = 1. - fabs( chassisDir.dotProduct( wheelMovementDir ) );
+			if (mSkid < 0)
+				mSkid = 0.;
+		}
+		//std::cout << "skid = " << mSkid << "\n";
 	}
 	real OdeWheel::getRadius() const
 	{
@@ -678,7 +686,7 @@
 			_applyBrakeTq( math::Vector3::kUnitX * mBrakeRatio * 1.5 );
 
 		const real targetVel = tq < 0. ? -40 : 40;
-		_applyMotor( targetVel, - tq * 0.0075 );
+		_applyMotor( targetVel, - tq * 0.1/*@todo this is "dt" dependent*/ );
 	}
 	void OdeWheel::_applyTq( const math::Vector3& torque )
 	{
@@ -691,12 +699,14 @@
 		if (dir.dotProduct(linVel) > 0)
 		{
 			std::cout << "BRK+\n";
-			mpWheel->getBody().addLocalTorque( torque );
+			//mpWheel->getBody().addLocalTorque( torque );
+			mpWheel->getBody().setAngularVelocity( 0.05 * mpWheel->getBody().getAngularVelocity() );
 		}
 		else
 		{
 			std::cout << "BRK-\n";
-			mpWheel->getBody().addLocalTorque( -torque );
+			//mpWheel->getBody().addLocalTorque( torque );
+			mpWheel->getBody().setAngularVelocity( 0.05 * mpWheel->getBody().getAngularVelocity() );
 		}
 	}
 	void OdeWheel::_applyMotor( real velocity, real fmax )



From codeandroid at mail.berlios.de  Wed Jul 19 23:59:28 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Wed, 19 Jul 2006 23:59:28 +0200
Subject: [Yake-svn] r1394 - trunk/yake/src/yapp/samples/misc/car
Message-ID: <200607192159.k6JLxSgZ021919@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-19 23:59:28 +0200 (Wed, 19 Jul 2006)
New Revision: 1394

Modified:
   trunk/yake/src/yapp/samples/misc/car/yakeDemo.cpp
Log:
merged car and jet demos

Modified: trunk/yake/src/yapp/samples/misc/car/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/misc/car/yakeDemo.cpp	2006-07-19 21:58:55 UTC (rev 1393)
+++ trunk/yake/src/yapp/samples/misc/car/yakeDemo.cpp	2006-07-19 21:59:28 UTC (rev 1394)
@@ -12,6 +12,8 @@
 using namespace yake;
 
 const input::ActionId ACTIONID_BRAKE( input::ACTIONID_USER+1, "brake" );
+const input::ActionId ACTIONID_TOGGLE_VEHICLE( input::ACTIONID_USER+2, "toggle_vehicle" );
+const real razorMeshScale = 0.1;
 
 /** Configuration of the application */
 struct TheConfiguration : public raf::ApplicationConfiguration
@@ -44,9 +46,8 @@
 public:
 	TheMainState(raf::Application& owner) :
 		raf::RtMainState(owner),
-		mVehicle(0),
-		mVehicleModel(0),
-		mGround(0)
+		mGround(0),
+		mActive(0)
 	{
 		enableInstantQuitByKey( input::KC_ESCAPE );
 	}
@@ -54,28 +55,6 @@
 	{
 	}
 private:
-	void _createWheelVisual(model::Model& theModel, vehicle::IVehicle& theVehicle, const String& wheelId, graphics::ISceneNode& parentSN)
-	{
-		// scene node + wheel mesh
-		graphics::ISceneNode* pSN = getGraphicalWorld()->createSceneNode();
-		graphics::IEntity* pE = getGraphicalWorld()->createEntity("wheel1.mesh");
-		pE->setCastsShadow( true );
-		pSN->attachEntity( pE );
-		model::ModelMovableLink* pLink = theModel.createLink( theVehicle.getWheelInterface(wheelId), pSN );
-		mCentralController.subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
-
-		// scene node + particle system for smoke...
-		pSN = getGraphicalWorld()->createSceneNode();
-		graphics::IParticleSystem* pPS = getGraphicalWorld()->createParticleSystem("SkidSmoke");
-		mWheelPs[wheelId] = pPS;
-		mEmitterEmissionRate[wheelId] = pPS->getEmissionRate(0);
-		pSN->attachParticleSystem( pPS );
-		pLink = new model::ModelMovableDirectLink();
-		pLink->setSource( theVehicle.getWheelInterface(wheelId) );
-		pLink->subscribeToPositionChanged( pSN ); //position only!
-		theModel.addLink( pLink );
-		mCentralController.subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
-	}
 	void onModelComponent_preInit(const model::ComponentCreationContext& ctx, model::ModelComponent&)
 	{
 		YAKE_LOG("demo: onModelComponent_preInit()");
@@ -149,62 +128,33 @@
 		// materials @todo read from .physics:
 		getPhysicalWorld()->createMaterial( physics::IMaterial::Desc( 0.01f, 0.01f, 0.01f ), "chassis" );
 		getPhysicalWorld()->createMaterial( physics::IMaterial::Desc( 0.01f, 0.2f, 0.01f ), "chassisTop" );
-		getPhysicalWorld()->createMaterial( physics::IMaterial::Desc( 0.01f, 0.25f, 0.01f ), "wheel" );
+		getPhysicalWorld()->createMaterial( physics::IMaterial::Desc( 0.01f, 0.5f, 0.01f ), "wheel" );
 
 		// vehicle(s)
 
 		YAKE_ASSERT( mVehicleSystem.get() );
 		mVehicleSystem->loadTemplates("../../media/vehicles/delorean.xml");
+		mVehicleSystem->loadTemplates("../../media/vehicles/jet.xml");
 
 		// It's possible retrieve the template and make further adjustments to it before
 		// instantiating vehicles.
 		// e.g.: vehicle::VehicleTemplate* tpl = pVS->getTemplate("delorean");
 
-		// instantiate vehicle model (physics + representation containers)
-		mVehicleModel = mModelMgr.createModel("theCar",
-				"physics/empty:name=p"
-				"|graphics/empty:name=g"
-				"|yake/dotVehicle:name=veh;template=delorean;physical=p"
-				);
-		YAKE_ASSERT( mVehicleModel );
-		vehicle::VehicleModelComponent* vehComp = static_cast<vehicle::VehicleModelComponent*>(mVehicleModel->getComponentByTag("veh"));
-		YAKE_ASSERT( vehComp );
-		mVehicle = vehComp->getVehicle();
-		YAKE_ASSERT( mVehicle );
+		// sky box
+		getGraphicalWorld()->setSkyBox("Examples/SpaceSkyBox");
 
-		//mVehicle->enableDebugGeometry( *getGraphicalWorld() );
+		// create car
+		mCar.reset( new Car() );
+		mCar->init(mCentralController,mModelMgr,*getGraphicalWorld(),*mVehicleSystem);
 
-		// create visuals
-		// - ship body
-		graphics::ISceneNode* pSN = getGraphicalWorld()->createSceneNode("root");
-		graphics::IEntity* pE = getGraphicalWorld()->createEntity("delorean.mesh");
-		pE->setCastsShadow( true );
-		pSN->attachEntity( pE );
-		//pSN->setScale( Vector3::kUnitScale * razorMeshScale );
-		model::Graphical* pG = dynamic_cast<model::Graphical*>(mVehicleModel->getComponentByTag("g"));
-		YAKE_ASSERT( pG );
-		pG->addSceneNode(pSN, "delorean_root");
-
-		// - wheel visuals
-		if (mVehicle->getWheelInterface("leftFrontWheel"))
-		{
-			_createWheelVisual( *mVehicleModel, *mVehicle, "leftFrontWheel", *pSN );
-			_createWheelVisual( *mVehicleModel, *mVehicle, "rightFrontWheel", *pSN );
-			_createWheelVisual( *mVehicleModel, *mVehicle, "leftRearWheel", *pSN );
-			_createWheelVisual( *mVehicleModel, *mVehicle, "rightRearWheel", *pSN );
-		}
-
-		// create visual <-> physics links
-		model::ModelMovableLink* pLink = mVehicleModel->createLink( mVehicle->getChassisMovable(), pSN );
-		mCentralController.subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
-
-		// sky box
-		getGraphicalWorld()->setSkyBox("Examples/SpaceSkyBox");
+		// create Jet
+		mJet.reset( new Jet() );
+		mJet->init(mCentralController,mModelMgr,*getGraphicalWorld(),*mVehicleSystem);
 	}
 	virtual void onDestroyScene()
 	{
-		mVehicleModel = 0;
-		mVehicle = 0;
+		mCar.reset();
+		mJet.reset();
 
 		mModelMgr.clear();
 		mVehicleSystem.reset();
@@ -214,114 +164,548 @@
 	virtual void onEnter()
 	{
 		RtMainState::onEnter();
-		using namespace input;
 
-		// front wheel controls
+		mActionMap.reg( ACTIONID_TOGGLE_VEHICLE,
+			new input::KeyboardActionCondition( getApp().getKeyboard(), input::KC_T, input::KAM_RELEASED ) );
+		mActionMap.subscribeToActionId( ACTIONID_TOGGLE_VEHICLE, boost::bind(&TheMainState::toggleVehicle,this) );
 
-		mActionMap.reg( ACTIONID_LEFT,
-			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_LEFT, KAM_CONTINUOUS ) );
-		mActionMap.subscribeToActionId( ACTIONID_LEFT, boost::bind(&TheMainState::onFrontWheelLeft,this) );
-
-		mActionMap.reg( ACTIONID_RIGHT,
-			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_RIGHT, KAM_CONTINUOUS ) );
-		mActionMap.subscribeToActionId( ACTIONID_RIGHT, boost::bind(&TheMainState::onFrontWheelRight,this) );
-
-		mActionMap.reg( ACTIONID_FORWARD,
-			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_UP, KAM_CONTINUOUS ) );
-		mActionMap.subscribeToActionId( ACTIONID_FORWARD, boost::bind(&TheMainState::onForward,this) );
-
-		mActionMap.reg( ACTIONID_BRAKE,
-			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_DOWN, KAM_CONTINUOUS ) );
-		mActionMap.subscribeToActionId( ACTIONID_BRAKE, boost::bind(&TheMainState::onReverse,this) );
-
-		//mActionMap.reg( ACTIONID_UP,
-		//	new input::KeyboardActionCondition( getApp().getKeyboard(), KC_PGUP, KAM_CONTINUOUS ) );
-		//mActionMap.subscribeToActionId( ACTIONID_UP, boost::bind(&TheMainState::onUp,this) );
+		YAKE_ASSERT( !mActive );
+		mActive = mCar.get();
+		mActive->onEnter(mActionMap,getApp().getKeyboard());
 	}
 	virtual void onExit()
 	{
+		YAKE_ASSERT( mActive );
+		if (mActive)
+		{
+			mActive->onExit();
+			mActive = 0;
+		}
+
 		RtMainState::onExit();
 	}
 	virtual void onFrame(const real timeElapsed)
 	{
 		mActionMap.update();
 
-		vehicle::IEnginePtrList engines = mVehicle->getEngineInterfaces();
-		ConstDequeIterator< vehicle::IEnginePtrList > itEngine( engines );
-		while (itEngine.hasMoreElements())
+		mCentralController.triggerPhysicsUpdateSignal(0,timeElapsed);
+		mCentralController.triggerGraphicsUpdateSignal(0,timeElapsed);
+
+		if (mCar)
+			mCar->onFrame( timeElapsed );
+		if (mJet)
+			mJet->onFrame( timeElapsed );
+		if (mActive)
 		{
-			vehicle::IEngine* pEngine = itEngine.getNext();
-			pEngine->setInputSignal( pEngine->getInputSignal() - timeElapsed * 1.7 );
+			getDefaultCamera()->lookAt(mActive->getPosition());
 		}
+	}
+private:
+	model::Model*						mGround;
 
-		real steering0 = 0;
-		real braking0 = 0;
+	model::ModelManager					mModelMgr;
+	model::CentralControllerBase		mCentralController;
+	SharedPtr<vehicle::IVehicleSystem>	mVehicleSystem;
 
-		ConstDequeIterator< ActionIdList > itAction( mActiveActions );
-		while (itAction.hasMoreElements())
+	input::ActionMap					mActionMap;
+
+	struct GoVehicleBase
+	{
+		virtual ~GoVehicleBase() {}
+		virtual Vector3 getPosition() const = 0;
+		virtual void onEnter(input::ActionMap& actionMap, input::KeyboardDevice* keyboard) = 0;
+		virtual void onExit()
 		{
-			const input::ActionId activeId = itAction.getNext();
-			if (activeId == input::ACTIONID_FORWARD)
-				mVehicle->getEngineInterface("main")->setInputSignal(1.);
-			else if (activeId == ACTIONID_BRAKE)
-				braking0 = 1.;
-			else if (activeId == input::ACTIONID_LEFT)
-				steering0 -= real(0.7);
-			else if (activeId == input::ACTIONID_RIGHT)
-				steering0 += real(0.7);
+			for( SignalConnectionList::iterator it = mInputSignalConnections.begin(); it != mInputSignalConnections.end(); ++it )
+				it->disconnect();
+			mInputSignalConnections.clear();
+
+			for( ConditionConnectionList::iterator it = mInputConditionConnections.begin(); it != mInputConditionConnections.end(); ++it )
+				it->disconnect();
+			mInputConditionConnections.clear();
 		}
-		mVehicle->setSteering( 0, steering0 );
-		mVehicle->getWheelInterface("leftFrontWheel")->brake(braking0);
-		mVehicle->getWheelInterface("rightFrontWheel")->brake(braking0);
+		virtual void onFrame(const real timeElapsed) = 0;
+		void addInputSignalConnection(const SignalConnection& conn)
+		{
+			mInputSignalConnections.push_back( conn );
+		}
+		void addInputConditionConnection(const input::ConditionConnection& conn)
+		{
+			mInputConditionConnections.push_back( conn );
+		}
+	private:
+		typedef std::deque<SignalConnection> SignalConnectionList;
+		SignalConnectionList	mInputSignalConnections;
+		typedef std::deque<input::ConditionConnection> ConditionConnectionList;
+		ConditionConnectionList	mInputConditionConnections;
+	};
+	struct Car : public GoVehicleBase
+	{
+		Car() : mModel(0), mVehicle(0)
+		{}
+		~Car()
+		{
+			destroy();
+		}
+		virtual Vector3 getPosition() const
+		{
+			YAKE_ASSERT( mVehicle );
+			return mVehicle->getChassisPosition();
+		}
 
-		mVehicle->updateSimulation( timeElapsed );
-		//mVehicleModel->updatePhysics( timeElapsed );
+		void init(model::CentralControllerBase& centralController,model::ModelManager& modelMgr,graphics::IWorld& gworld,vehicle::IVehicleSystem& vehSys)
+		{
+			// instantiate vehicle model (physics + representation containers)
+			YAKE_ASSERT( !mModel );
+			mModel = modelMgr.createModel("theCar",
+					"physics/empty:name=p"
+					"|graphics/empty:name=g"
+					"|yake/dotVehicle:name=veh;template=delorean;physical=p"
+					);
+			YAKE_ASSERT( mModel );
+			vehicle::VehicleModelComponent* vehComp = static_cast<vehicle::VehicleModelComponent*>(mModel->getComponentByTag("veh"));
+			YAKE_ASSERT( vehComp );
+			mVehicle = vehComp->getVehicle();
+			YAKE_ASSERT( mVehicle );
 
-		ConstDequeIterator< WheelPsMap > itWheel( mWheelPs );
-		while (itWheel.hasMoreElements())
+			// create visuals
+
+			model::Graphical* pG = dynamic_cast<model::Graphical*>(mModel->getComponentByTag("g"));
+			YAKE_ASSERT( pG );
+
+			//mVehicle->enableDebugGeometry( *getGraphicalWorld() );
+
+			// create visuals
+			// - ship body
+			graphics::ISceneNode* pSN = gworld.createSceneNode("root");
+			graphics::IEntity* pE = gworld.createEntity("delorean.mesh");
+			pE->setCastsShadow( true );
+			pSN->attachEntity( pE );
+			//pSN->setScale( Vector3::kUnitScale * razorMeshScale );
+			pG->addSceneNode(pSN, "delorean_root");
+
+			// - wheel visuals
+			if (mVehicle->getWheelInterface("leftFrontWheel"))
+			{
+				_createCarWheelVisual( centralController, gworld, "leftFrontWheel", *pSN );
+				_createCarWheelVisual( centralController, gworld, "rightFrontWheel", *pSN );
+				_createCarWheelVisual( centralController, gworld, "leftRearWheel", *pSN );
+				_createCarWheelVisual( centralController, gworld, "rightRearWheel", *pSN );
+			}
+
+			// create visual <-> physics links
+			model::ModelMovableLink* pLink = mModel->createLink( mVehicle->getChassisMovable(), pSN );
+			centralController.subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
+		}
+		void destroy()
 		{
-			const String wheelId = itWheel.getNext().first;
-			mWheelPs[ wheelId ]->setEmissionRate( 0, mEmitterEmissionRate[wheelId] * mVehicle->getWheelInterface( wheelId )->getSkid() );
+			//@todo
+			mModel = 0;
+			mVehicle = 0;
 		}
+		virtual void onEnter(input::ActionMap& actionMap, input::KeyboardDevice* keyboard)
+		{
+			using namespace input;
 
-		getDefaultCamera()->lookAt(mVehicle->getChassisPosition());
-		//mVehicleModel->updateGraphics( timeElapsed );
+			// front wheel controls
 
-		mCentralController.triggerPhysicsUpdateSignal(0,timeElapsed);
-		mCentralController.triggerGraphicsUpdateSignal(0,timeElapsed);
+			this->addInputConditionConnection(
+				actionMap.reg( ACTIONID_LEFT,
+					new input::KeyboardActionCondition( keyboard, KC_LEFT, KAM_CONTINUOUS ) ) );
+			this->addInputSignalConnection(
+				actionMap.subscribeToActionId( ACTIONID_LEFT, boost::bind(&Car::onFrontWheelLeft,this) ) );
 
-		mActiveActions.clear();
-	}
-protected:
-	void onForward()
-	{ mActiveActions.insert( input::ACTIONID_FORWARD ); }
-	void onReverse()
-	{ mActiveActions.insert( ACTIONID_BRAKE ); }
-	void onUp()
-	{ mActiveActions.insert( input::ACTIONID_UP ); }
-	void onFrontWheelLeft()
-	{ mActiveActions.insert( input::ACTIONID_LEFT ); }
-	void onFrontWheelRight()
-	{ mActiveActions.insert( input::ACTIONID_RIGHT ); }
-private:
-private:
-	model::Model*			mGround;
-	vehicle::IVehicle*		mVehicle;
-	model::Model*			mVehicleModel;
-	typedef AssocVector<String,real> EmitterRealMap;
-	EmitterRealMap			mEmitterMinVel;
-	EmitterRealMap			mEmitterMaxVel;
-	EmitterRealMap			mEmitterEmissionRate;
-	typedef AssocVector<String,graphics::IParticleSystem*> WheelPsMap;
-	WheelPsMap				mWheelPs;
-	input::ActionMap		mActionMap;
+			this->addInputConditionConnection(
+				actionMap.reg( ACTIONID_RIGHT,
+					new input::KeyboardActionCondition( keyboard, KC_RIGHT, KAM_CONTINUOUS ) ) );
+			this->addInputSignalConnection(
+				actionMap.subscribeToActionId( ACTIONID_RIGHT, boost::bind(&Car::onFrontWheelRight,this) ) );
 
-	typedef std::set<input::ActionId> ActionIdList;
-	ActionIdList			mActiveActions;
+			this->addInputConditionConnection(
+				actionMap.reg( ACTIONID_FORWARD,
+					new input::KeyboardActionCondition( keyboard, KC_UP, KAM_CONTINUOUS ) ) );
+			this->addInputSignalConnection(
+				actionMap.subscribeToActionId( ACTIONID_FORWARD, boost::bind(&Car::onForward,this) ) );
 
-	model::ModelManager					mModelMgr;
-	model::CentralControllerBase		mCentralController;
-	SharedPtr<vehicle::IVehicleSystem>	mVehicleSystem;
+			this->addInputConditionConnection(
+				actionMap.reg( ACTIONID_BRAKE,
+					new input::KeyboardActionCondition( keyboard, KC_DOWN, KAM_CONTINUOUS ) ) );
+			this->addInputSignalConnection(
+				actionMap.subscribeToActionId( ACTIONID_BRAKE, boost::bind(&Car::onReverse,this) ) );
+		}
+		void onExit()
+		{
+			GoVehicleBase::onExit();
+		}
+		virtual void onFrame(const real timeElapsed)
+		{
+			vehicle::IEnginePtrList engines = mVehicle->getEngineInterfaces();
+			ConstDequeIterator< vehicle::IEnginePtrList > itEngine( engines );
+			while (itEngine.hasMoreElements())
+			{
+				vehicle::IEngine* pEngine = itEngine.getNext();
+				pEngine->setInputSignal( pEngine->getInputSignal() - timeElapsed * 1.7 );
+			}
+
+			real steering0 = 0;
+			real braking0 = 0;
+
+			ConstDequeIterator< ActionIdList > itAction( mActiveActions );
+			while (itAction.hasMoreElements())
+			{
+				const input::ActionId activeId = itAction.getNext();
+				if (activeId == input::ACTIONID_FORWARD)
+					mVehicle->getEngineInterface("main")->setInputSignal(1.);
+				else if (activeId == ACTIONID_BRAKE)
+					braking0 = 1.;
+				else if (activeId == input::ACTIONID_LEFT)
+					steering0 -= real(0.7);
+				else if (activeId == input::ACTIONID_RIGHT)
+					steering0 += real(0.7);
+			}
+			mVehicle->setSteering( 0, steering0 );
+			mVehicle->getWheelInterface("leftFrontWheel")->brake(braking0);
+			mVehicle->getWheelInterface("rightFrontWheel")->brake(braking0);
+
+			mVehicle->updateSimulation( timeElapsed );
+
+			ConstDequeIterator< WheelPsMap > itWheel( mWheelPs );
+			while (itWheel.hasMoreElements())
+			{
+				const String wheelId = itWheel.getNext().first;
+				mWheelPs[ wheelId ]->setEmissionRate( 0, mEmitterEmissionRate[wheelId] * mVehicle->getWheelInterface( wheelId )->getSkid() );
+			}
+
+			mActiveActions.clear();
+		}
+	private:
+		vehicle::IVehicle*		mVehicle;
+		model::Model*			mModel;
+		typedef AssocVector<String,real> EmitterRealMap;
+		EmitterRealMap			mEmitterMinVel;
+		EmitterRealMap			mEmitterMaxVel;
+		EmitterRealMap			mEmitterEmissionRate;
+		typedef AssocVector<String,graphics::IParticleSystem*> WheelPsMap;
+		WheelPsMap				mWheelPs;
+
+		typedef std::set<input::ActionId> ActionIdList;
+		ActionIdList			mActiveActions;
+
+	private:
+		void onForward()
+		{ mActiveActions.insert( input::ACTIONID_FORWARD ); }
+		void onReverse()
+		{ mActiveActions.insert( ACTIONID_BRAKE ); }
+		void onUp()
+		{ mActiveActions.insert( input::ACTIONID_UP ); }
+		void onFrontWheelLeft()
+		{ mActiveActions.insert( input::ACTIONID_LEFT ); }
+		void onFrontWheelRight()
+		{ mActiveActions.insert( input::ACTIONID_RIGHT ); }
+		void _createCarWheelVisual(model::CentralControllerBase& centralController, graphics::IWorld& gworld, const String& wheelId, graphics::ISceneNode& parentSN)
+		{
+			YAKE_ASSERT( mModel );
+			YAKE_ASSERT( mVehicle );
+
+			// scene node + wheel mesh
+			graphics::ISceneNode* pSN = gworld.createSceneNode();
+			graphics::IEntity* pE = gworld.createEntity("wheel1.mesh");
+			pE->setCastsShadow( true );
+			pSN->attachEntity( pE );
+
+			model::ModelMovableLink* pLink = mModel->createLink( mVehicle->getWheelInterface(wheelId), pSN );
+			centralController.subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
+
+			// scene node + particle system for smoke...
+			pSN = gworld.createSceneNode();
+			graphics::IParticleSystem* pPS = gworld.createParticleSystem("SkidSmoke");
+			mWheelPs[wheelId] = pPS;
+			mEmitterEmissionRate[wheelId] = pPS->getEmissionRate(0);
+			pSN->attachParticleSystem( pPS );
+
+			pLink = new model::ModelMovableDirectLink();
+			pLink->setSource( mVehicle->getWheelInterface(wheelId) );
+			pLink->subscribeToPositionChanged( pSN ); //position only!
+			mModel->addLink( pLink );
+			centralController.subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
+		}
+	};
+
+	struct Jet : public GoVehicleBase
+	{
+		Jet() : mModel(0), mVehicle(0)
+		{}
+		~Jet()
+		{
+			destroy();
+		}
+		virtual Vector3 getPosition() const
+		{
+			YAKE_ASSERT( mVehicle );
+			return mVehicle->getChassisPosition();
+		}
+		void init(model::CentralControllerBase& centralController,model::ModelManager& modelMgr,graphics::IWorld& gworld,vehicle::IVehicleSystem& vehSys)
+		{
+			YAKE_ASSERT( !mModel );
+			mModel = modelMgr.createModel("theJet",
+					"physics/empty:name=p"
+					"|graphics/empty:name=g"
+					"|yake/dotVehicle:name=veh;template=jet;physical=p"
+					);
+			YAKE_ASSERT( mModel );
+			vehicle::VehicleModelComponent* vehComp = static_cast<vehicle::VehicleModelComponent*>(mModel->getComponentByTag("veh"));
+			YAKE_ASSERT( vehComp );
+			mVehicle = vehComp->getVehicle();
+			YAKE_ASSERT( mVehicle );
+
+			mVehicle->translate(Vector3(-30,0,30));
+
+			// create visuals
+
+			model::Graphical* pG = dynamic_cast<model::Graphical*>(mModel->getComponentByTag("g"));
+			YAKE_ASSERT( pG );
+
+			// - ship body
+			graphics::ISceneNode* pSN = gworld.createSceneNode();
+			pSN->attachEntity( gworld.createEntity("razor.mesh") );
+			pSN->setScale( math::Vector3::kUnitScale * razorMeshScale );
+			pG->addSceneNode(pSN,"root");
+
+			YAKE_LOG( "Creating thruster visuals" );
+			// - thruster visuals
+			_createThrusterVisual( centralController, gworld, "left", "left", *pSN );
+			_createThrusterVisual( centralController, gworld, "right", "right", *pSN );
+			_createThrusterVisual( centralController, gworld, "front", "backward", *pSN );
+			_createThrusterVisual( centralController, gworld, "rear", "forward", *pSN );
+			_createThrusterVisual( centralController, gworld, "bottom", "upward", *pSN );
+			_createThrusterVisual( centralController, gworld, "top", "downward", *pSN );
+
+			// - wheel visuals
+			if (mVehicle->getWheelInterface("frontWheel"))
+			{
+				_createWheelVisual( centralController, gworld, "frontWheel", *pSN );
+				_createWheelVisual( centralController, gworld, "leftRearWheel", *pSN );
+				_createWheelVisual( centralController, gworld, "rightRearWheel", *pSN );
+			}
+
+			// create visual <-> physics links
+			model::ModelMovableLink* pLink = mModel->createLink( mVehicle->getChassisMovable(), pSN );
+			centralController.subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
+		}
+		void destroy()
+		{
+			//@todo
+			mModel = 0;
+			mVehicle = 0;
+		}
+		virtual void onEnter(input::ActionMap& actionMap, input::KeyboardDevice* keyboard)
+		{
+			using namespace input;
+
+			// front wheel controls
+
+			this->addInputConditionConnection(
+				actionMap.reg( ACTIONID_LEFT,
+					new input::KeyboardActionCondition( keyboard, KC_COMMA, KAM_CONTINUOUS ) ) );
+			this->addInputSignalConnection(
+				actionMap.subscribeToActionId( ACTIONID_LEFT, boost::bind(&Jet::onFrontWheelLeft,this) ) );
+
+			this->addInputConditionConnection(
+				actionMap.reg( ACTIONID_RIGHT,
+					new input::KeyboardActionCondition( keyboard, KC_PERIOD, KAM_CONTINUOUS ) ) );
+			this->addInputSignalConnection(
+				actionMap.subscribeToActionId( ACTIONID_RIGHT, boost::bind(&Jet::onFrontWheelRight,this) ) );
+
+			// thruster controls
+
+			this->addInputConditionConnection(
+				actionMap.reg( ACTIONID_STRAFE_LEFT,
+					new input::KeyboardActionCondition( keyboard, KC_LEFT, KAM_CONTINUOUS ) ) );
+			this->addInputSignalConnection(
+				actionMap.subscribeToActionId( ACTIONID_STRAFE_LEFT, boost::bind(&Jet::onStrafeLeft,this) ) );
+
+			this->addInputConditionConnection(
+				actionMap.reg( ACTIONID_STRAFE_RIGHT,
+					new input::KeyboardActionCondition( keyboard, KC_RIGHT, KAM_CONTINUOUS ) ) );
+			this->addInputSignalConnection(
+				actionMap.subscribeToActionId( ACTIONID_STRAFE_RIGHT, boost::bind(&Jet::onStrafeRight,this) ) );
+
+			this->addInputConditionConnection(
+				actionMap.reg( ACTIONID_FORWARD,
+					new input::KeyboardActionCondition( keyboard, KC_UP, KAM_CONTINUOUS ) ) );
+			this->addInputSignalConnection(
+				actionMap.subscribeToActionId( ACTIONID_FORWARD, boost::bind(&Jet::onForward,this) ) );
+
+			this->addInputConditionConnection(
+				actionMap.reg( ACTIONID_REVERSE,
+					new input::KeyboardActionCondition( keyboard, KC_DOWN, KAM_CONTINUOUS ) ) );
+			this->addInputSignalConnection(
+				actionMap.subscribeToActionId( ACTIONID_REVERSE, boost::bind(&Jet::onReverse,this) ) );
+
+			this->addInputConditionConnection(
+				actionMap.reg( ACTIONID_UP,
+					new input::KeyboardActionCondition( keyboard, KC_PGUP, KAM_CONTINUOUS ) ) );
+			this->addInputSignalConnection(
+				actionMap.subscribeToActionId( ACTIONID_UP, boost::bind(&Jet::onUp,this) ) );
+
+			this->addInputConditionConnection(
+				actionMap.reg( ACTIONID_DOWN,
+					new input::KeyboardActionCondition( keyboard, KC_PGDOWN, KAM_CONTINUOUS ) ) );
+			this->addInputSignalConnection(
+				actionMap.subscribeToActionId( ACTIONID_DOWN, boost::bind(&Jet::onDown,this) ) );
+		}
+		virtual void onExit()
+		{
+			GoVehicleBase::onExit();
+		}
+		virtual void onFrame(const real timeElapsed)
+		{
+			vehicle::IEnginePtrList engines = mVehicle->getEngineInterfaces();
+			ConstDequeIterator< vehicle::IEnginePtrList > itEngine( engines );
+			while (itEngine.hasMoreElements())
+			{
+				vehicle::IEngine* pEngine = itEngine.getNext();
+				pEngine->setInputSignal( std::max(0., pEngine->getInputSignal() - timeElapsed * 1.7) );
+			}
+
+			real steering0 = 0;
+
+			ConstDequeIterator< ActionIdList > itAction( mActiveActions );
+			while (itAction.hasMoreElements())
+			{
+				const input::ActionId activeId = itAction.getNext();
+				if (activeId == input::ACTIONID_STRAFE_LEFT)
+					mVehicle->getEngineInterface("right")->setInputSignal(1.);
+				else if (activeId == input::ACTIONID_STRAFE_RIGHT)
+					mVehicle->getEngineInterface("left")->setInputSignal(1.);
+				else if (activeId == input::ACTIONID_FORWARD)
+					mVehicle->getEngineInterface("forward")->setInputSignal(1.);
+				else if (activeId == input::ACTIONID_REVERSE)
+					mVehicle->getEngineInterface("backward")->setInputSignal(1.);
+				else if (activeId == input::ACTIONID_UP)
+					mVehicle->getEngineInterface("upward")->setInputSignal(1.);
+				else if (activeId == input::ACTIONID_DOWN)
+					mVehicle->getEngineInterface("downward")->setInputSignal(1.);
+				else if (activeId == input::ACTIONID_LEFT)
+					steering0 -= 0.3;
+				else if (activeId == input::ACTIONID_RIGHT)
+					steering0 += 0.3;
+			}
+			mVehicle->setSteering( 0, steering0 );
+
+			mVehicle->updateSimulation( timeElapsed );
+
+			_updateThrusterPs();
+
+			mActiveActions.clear();
+		}
+	private:
+		vehicle::IVehicle*		mVehicle;
+		model::Model*			mModel;
+
+		typedef AssocVector<String,real> EmitterRealMap;
+		EmitterRealMap			mEmitterMinVel;
+		EmitterRealMap			mEmitterMaxVel;
+		EmitterRealMap			mEmitterEmissionRate;
+		typedef AssocVector<String,graphics::IParticleSystem*> ThrusterPsMap;
+		ThrusterPsMap			mThrusterPs;
+		input::ActionMap		mActionMap;
+
+		typedef std::set<input::ActionId> ActionIdList;
+		ActionIdList			mActiveActions;
+
+	private:
+		void onStrafeLeft()
+		{ mActiveActions.insert( input::ACTIONID_STRAFE_LEFT ); }
+		void onStrafeRight()
+		{ mActiveActions.insert( input::ACTIONID_STRAFE_RIGHT ); }
+		void onForward()
+		{ mActiveActions.insert( input::ACTIONID_FORWARD ); }
+		void onReverse()
+		{ mActiveActions.insert( input::ACTIONID_REVERSE ); }
+		void onUp()
+		{ mActiveActions.insert( input::ACTIONID_UP ); }
+		void onDown()
+		{ mActiveActions.insert( input::ACTIONID_DOWN ); }
+		void onFrontWheelLeft()
+		{ mActiveActions.insert( input::ACTIONID_LEFT ); }
+		void onFrontWheelRight()
+		{ mActiveActions.insert( input::ACTIONID_RIGHT ); }
+		void _createThrusterVisual(model::CentralControllerBase& centralController, graphics::IWorld& gworld, const String& mtPtId, const String& engineId, graphics::ISceneNode& parentSN)
+		{
+			graphics::ISceneNode* pSN = parentSN.createChildNode( mtPtId );
+
+			graphics::IParticleSystem* pPS = gworld.createParticleSystem("thruster2");
+			pSN->attachParticleSystem( pPS );
+
+			YAKE_ASSERT( mModel );
+			YAKE_ASSERT( mVehicle );
+			model::ModelMovableLink* pLink = mModel->createLink( mVehicle->getMountPoint(mtPtId), pSN );
+			centralController.subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
+
+			_regThrusterPs( engineId, *pPS );
+		}
+		void _createWheelVisual(model::CentralControllerBase& centralController, graphics::IWorld& gworld, const String& wheelId, graphics::ISceneNode& parentSN)
+		{
+			graphics::ISceneNode* pSN = gworld.createSceneNode();
+			graphics::IEntity* pE = gworld.createEntity("sphere_d1.mesh");
+			pSN->attachEntity( pE );
+			const math::Vector3 scale = math::Vector3::kUnitScale * 2.f * mVehicle->getWheelInterface(wheelId)->getRadius();
+			pSN->setScale( scale );
+
+			YAKE_ASSERT( mModel );
+			YAKE_ASSERT( mVehicle );
+			model::ModelMovableLink* pLink = mModel->createLink( mVehicle->getWheelInterface(wheelId), pSN );
+			centralController.subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
+		}
+		void _regThrusterPs(const String& engineId, graphics::IParticleSystem& ps)
+		{
+			mEmitterMinVel[ engineId ] = ps.getMinVelocity(0);
+			mEmitterMaxVel[ engineId ] = ps.getMaxVelocity(0);
+			mEmitterEmissionRate[ engineId ] = ps.getEmissionRate(0);
+			mThrusterPs[ engineId ] = &ps;
+		}
+		void _updateThrusterPs()
+		{
+			ConstDequeIterator< ThrusterPsMap > itM( mThrusterPs );
+			while (itM.hasMoreElements())
+			{
+				std::pair<String,graphics::IParticleSystem*> p = itM.getNext();
+				const String mtPtId = p.first;
+				graphics::IParticleSystem* ps = p.second;
+				const real throttle = mVehicle->getEngineInterface(mtPtId)->getInputSignal();
+
+				real rate = throttle * mEmitterEmissionRate[ mtPtId ];
+				ps->setEmissionRate( 0, rate );
+				std::cout << "r=" << rate << " t=" << throttle << "\n";
+
+				real vel = throttle * mEmitterMaxVel[ mtPtId ];
+				ps->setMaxVelocity( 0, vel );
+
+				vel = throttle * mEmitterMinVel[ mtPtId ];
+				ps->setMinVelocity( 0, vel );
+			}
+		}
+	};
+	SharedPtr<Jet>				mJet;
+	SharedPtr<Car>				mCar;
+	GoVehicleBase*				mActive;
+	void toggleVehicle()
+	{
+		// 1st time
+		if (!mActive)
+			mActive = mCar.get();
+		else
+			mActive->onExit();
+
+		// toggle
+		if (mActive == static_cast<GoVehicleBase*>(mJet.get()))
+			mActive = mCar.get();
+		else
+			mActive = mJet.get();
+
+		mActive->onEnter(mActionMap,getApp().getKeyboard());
+	}
 };
 
 /** The mighty application itself! */



From codeandroid at mail.berlios.de  Thu Jul 20 00:00:17 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Thu, 20 Jul 2006 00:00:17 +0200
Subject: [Yake-svn] r1395 - trunk/yake/src/yake/plugins/graphicsOgre
Message-ID: <200607192200.k6JM0HL5022085@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-20 00:00:14 +0200 (Thu, 20 Jul 2006)
New Revision: 1395

Modified:
   trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreNode.cpp
Log:
handle yet another OGRE exception

Modified: trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreNode.cpp
===================================================================
--- trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreNode.cpp	2006-07-19 21:59:28 UTC (rev 1394)
+++ trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreNode.cpp	2006-07-19 22:00:14 UTC (rev 1395)
@@ -47,7 +47,13 @@
 		if (ogreid.empty())
 			ogreid = uniqueName::create( "sn_" );
 		mName = ogreid;
-		mSceneNode = static_cast< Ogre::SceneNode* >( mSceneMgr->getRootSceneNode()->createChild( ogreid ) );
+		try {
+			mSceneNode = static_cast< Ogre::SceneNode* >( mSceneMgr->getRootSceneNode()->createChild( ogreid ) );
+		}
+		catch (Ogre::Exception& e)
+		{
+			YAKE_EXCEPT(String("Ogre Exception: ") + e.getFullDescription());
+		}
 		YAKE_ASSERT( mSceneNode ).warning("Couldn't create a scene node!");
 
 		mSceneNode->setPosition( 0, 0, 0 );



From codeandroid at mail.berlios.de  Thu Jul 20 00:06:05 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Thu, 20 Jul 2006 00:06:05 +0200
Subject: [Yake-svn] r1396 - in trunk/yake/src/yapp/samples/misc: . vehicle
Message-ID: <200607192206.k6JM6565022618@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-20 00:06:04 +0200 (Thu, 20 Jul 2006)
New Revision: 1396

Added:
   trunk/yake/src/yapp/samples/misc/vehicle/
   trunk/yake/src/yapp/samples/misc/vehicle/yakeDemo.cpp
Removed:
   trunk/yake/src/yapp/samples/misc/car/
   trunk/yake/src/yapp/samples/misc/vehicle/yakeDemo.cpp
Log:
merged car and jet demos

Copied: trunk/yake/src/yapp/samples/misc/vehicle (from rev 1347, trunk/yake/src/yapp/samples/misc/car)

Deleted: trunk/yake/src/yapp/samples/misc/vehicle/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/misc/car/yakeDemo.cpp	2006-06-20 08:05:16 UTC (rev 1347)
+++ trunk/yake/src/yapp/samples/misc/vehicle/yakeDemo.cpp	2006-07-19 22:06:04 UTC (rev 1396)
@@ -1,321 +0,0 @@
-#include <yapp/samples/misc/car/yakePCH.h>
-#include <yake/audio/yakeAudio.h>
-#include <yapp/raf/yakeRaf.h>
-#include <yake/model/model.h>
-#include <yake/model/model_link.h>
-#include <yapp/vehicle/yakeVehicle.h>
-#include <yake/input/yakeInput.h>
-
-// temporary stuff (until factory registration issues have been sorted out):
-#include <yapp/vehicle/yakeNativeOde.h>
-
-using namespace yake;
-
-const input::ActionId ACTIONID_BRAKE( input::ACTIONID_USER+1, "brake" );
-
-/** Configuration of the application */
-struct TheConfiguration : public raf::ApplicationConfiguration
-{
-	virtual StringVector getLibraries()
-	{ return MakeStringVector() << "graphicsOgre" << "inputOgre" << "physicsOde"; }
-
-	//virtual StringVector getScriptingSystems()
-	//{ return MakeStringVector() << "lua"; }
-
-	virtual StringVector getGraphicsSystems()
-	{ return MakeStringVector() << "ogre3d"; }
-
-	virtual StringVector getInputSystems()
-	{ return MakeStringVector() << "ogre"; }
-
-	virtual StringVector getPhysicsSystems()
-	{ return MakeStringVector() << "ode"; }
-};
-
-class VehicleHumanInputController
-{
-public:
-	void setVehicle(vehicle::IVehicle*);
-};
-
-/** Main application state */
-class TheMainState : public raf::RtMainState
-{
-public:
-	TheMainState(raf::Application& owner) :
-		raf::RtMainState(owner),
-		mVehicle(0),
-		mComplex(0),
-		mGround(0)
-	{
-		enableInstantQuitByKey( input::KC_ESCAPE );
-	}
-	~TheMainState()
-	{
-	}
-private:
-	typedef Signal2<void(const uint32,const real)> GraphicsUpdateSignal;
-	GraphicsUpdateSignal	graphicsUpdateSig_;
-	void subscribeToGraphicsUpdate(const GraphicsUpdateSignal::slot_type& slot)
-	{
-		graphicsUpdateSig_.connect(slot);
-	}
-	void _triggerGraphicsUpdate(const uint32 si, const real dt)
-	{
-		graphicsUpdateSig_(si,dt);
-	}
-	void _createWheelVisual(const String& wheelId, graphics::ISceneNode& parentSN)
-	{
-		// scene node + wheel mesh
-		graphics::ISceneNode* pSN = getGraphicalWorld()->createSceneNode();
-		graphics::IEntity* pE = getGraphicalWorld()->createEntity("wheel1.mesh");
-		pE->setCastsShadow( true );
-		pSN->attachEntity( pE );
-		model::ModelMovableLink* pLink = mComplex->createLink( mVehicle->getWheelInterface(wheelId), pSN );
-		this->subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
-
-		// scene node + particle system for smoke...
-		pSN = getGraphicalWorld()->createSceneNode();
-		graphics::IParticleSystem* pPS = getGraphicalWorld()->createParticleSystem("SkidSmoke");
-		mWheelPs[wheelId] = pPS;
-		mEmitterEmissionRate[wheelId] = pPS->getEmissionRate(0);
-		pSN->attachParticleSystem( pPS );
-		pLink = new model::ModelMovableDirectLink();
-		pLink->setSource( mVehicle->getWheelInterface(wheelId) );
-		pLink->subscribeToPositionChanged( pSN ); //position only!
-		mComplex->addLink( pLink );
-		this->subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
-	}
-protected:
-	virtual void onCreateScene()
-	{
-		YAKE_LOG_INFORMATION("Creating scene");
-
-		// create a light
-		graphics::ILight* pLight = getGraphicalWorld()->createLight();
-		pLight->setType( graphics::ILight::LT_DIRECTIONAL );
-		pLight->setDirection( Vector3(0,-1,1) );
-		getGraphicalWorld()->createSceneNode("lightnode0")->attachLight( pLight );
-
-		getGraphicalWorld()->setShadowsEnabled( true );
-
-		// position camera and look at the ninja
-		getDefaultCamera()->setNearClipDistance( 1 );
-		getDefaultCamera()->setFixedYawAxis(Vector3::kUnitY);
-		getDefaultCamera()->setPosition(Vector3(7,4,-7));
-
-		//
-		getPhysicalWorld()->setGlobalGravity(Vector3(0,-9.81,0));
-
-		// create ground
-		mGround = new model::Model();
-		{
-			const real groundHeight = -2;
-			// visual
-			graphics::ISceneNode* pGroundSN = getGraphicalWorld()->createSceneNode();
-			graphics::IEntity* pGroundE = getGraphicalWorld()->createEntity("plane_1x1.mesh");
-			pGroundE->setMaterial("box");
-			pGroundE->setCastsShadow( false );
-			pGroundSN->attachEntity( pGroundE );
-			pGroundSN->setScale( Vector3(200,1,200) );
-			pGroundSN->setPosition( Vector3(0,groundHeight,0) );
-
-			model::Graphical* pG = new model::Graphical();
-			pG->addSceneNode( pGroundSN, "groundSN" );
-			mGround->addComponent( pG );
-
-			// physical
-			physics::IActorPtr pGroundPlane = getPhysicalWorld()->createActor( physics::ACTOR_STATIC );
-			pGroundPlane->createShape( physics::IShape::PlaneDesc( Vector3(0,1,0), groundHeight ) );
-
-			model::Physical* pP = new model::Physical();
-			pP->addActor( pGroundPlane, "groundPlane" );
-			mGround->addComponent( pP );
-		}
-
-		// create vehicle container (e.g. for graphical objects and links)
-		mComplex = new model::Model();
-		model::Graphical* pG = new model::Graphical();
-		mComplex->addComponent( pG, "g" );
-		model::Physical* pP = new model::Physical();
-		mComplex->addComponent( pP, "p" );
-
-		// materials @todo read from .physics:
-		getPhysicalWorld()->createMaterial( physics::IMaterial::Desc( 0.01f, 0.01f, 0.01f ), "chassis" );
-		getPhysicalWorld()->createMaterial( physics::IMaterial::Desc( 0.01f, 0.2f, 0.01f ), "chassisTop" );
-		getPhysicalWorld()->createMaterial( physics::IMaterial::Desc( 0.01f, 0.25f, 0.01f ), "wheel" );
-
-		// vehicle
-		SharedPtr<vehicle::IVehicleSystem> pVS = //create<vehicle::IVehicleSystem>("generic");
-			SharedPtr<vehicle::IVehicleSystem>(new vehicle::GenericVehicleSystem());
-
-		pVS->loadTemplates("../../media/vehicles/delorean.xml");
-
-		// It's possible retrieve the template and make further adjustments to it before
-		// instantiating vehicles.
-		// e.g.: vehicle::VehicleTemplate* tpl = pVS->getTemplate("delorean");
-
-		// instantiate
-		mVehicle = pVS->create("delorean", *getPhysicalWorld(), *pP );
-
-		//mVehicle->enableDebugGeometry( *getGraphicalWorld() );
-
-		// create visuals
-		// - ship body
-		graphics::ISceneNode* pSN = getGraphicalWorld()->createSceneNode("root");
-		graphics::IEntity* pE = getGraphicalWorld()->createEntity("delorean.mesh");
-		pE->setCastsShadow( true );
-		pSN->attachEntity( pE );
-		//pSN->setScale( Vector3::kUnitScale * razorMeshScale );
-		pG->addSceneNode(pSN, "delorean_root");
-
-		// - wheel visuals
-		if (mVehicle->getWheelInterface("leftFrontWheel"))
-		{
-			_createWheelVisual( "leftFrontWheel", *pSN );
-			_createWheelVisual( "rightFrontWheel", *pSN );
-			_createWheelVisual( "leftRearWheel", *pSN );
-			_createWheelVisual( "rightRearWheel", *pSN );
-		}
-
-		// create visual <-> physics links
-		model::ModelMovableLink* pLink = mComplex->createLink( mVehicle->getChassisMovable(), pSN );
-		this->subscribeToGraphicsUpdate( Bind2(&model::ModelMovableLink::update,pLink) );
-
-		// sky box
-		getGraphicalWorld()->setSkyBox("Examples/SpaceSkyBox");
-	}
-	virtual void onDestroyScene()
-	{
-		YAKE_SAFE_DELETE( mGround );
-
-		YAKE_SAFE_DELETE( mComplex );
-		YAKE_SAFE_DELETE( mVehicle );
-	}
-	virtual void onEnter()
-	{
-		RtMainState::onEnter();
-		using namespace input;
-
-		// front wheel controls
-
-		mActionMap.reg( ACTIONID_LEFT,
-			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_LEFT, KAM_CONTINUOUS ) );
-		mActionMap.subscribeToActionId( ACTIONID_LEFT, boost::bind(&TheMainState::onFrontWheelLeft,this) );
-
-		mActionMap.reg( ACTIONID_RIGHT,
-			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_RIGHT, KAM_CONTINUOUS ) );
-		mActionMap.subscribeToActionId( ACTIONID_RIGHT, boost::bind(&TheMainState::onFrontWheelRight,this) );
-
-		mActionMap.reg( ACTIONID_FORWARD,
-			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_UP, KAM_CONTINUOUS ) );
-		mActionMap.subscribeToActionId( ACTIONID_FORWARD, boost::bind(&TheMainState::onForward,this) );
-
-		mActionMap.reg( ACTIONID_BRAKE,
-			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_DOWN, KAM_CONTINUOUS ) );
-		mActionMap.subscribeToActionId( ACTIONID_BRAKE, boost::bind(&TheMainState::onReverse,this) );
-
-		//mActionMap.reg( ACTIONID_UP,
-		//	new input::KeyboardActionCondition( getApp().getKeyboard(), KC_PGUP, KAM_CONTINUOUS ) );
-		//mActionMap.subscribeToActionId( ACTIONID_UP, boost::bind(&TheMainState::onUp,this) );
-	}
-	virtual void onExit()
-	{
-	}
-	virtual void onFrame(const real timeElapsed)
-	{
-		mActionMap.update();
-
-		vehicle::IEnginePtrList engines = mVehicle->getEngineInterfaces();
-		ConstDequeIterator< vehicle::IEnginePtrList > itEngine( engines );
-		while (itEngine.hasMoreElements())
-		{
-			vehicle::IEngine* pEngine = itEngine.getNext();
-			pEngine->setInputSignal( pEngine->getInputSignal() - timeElapsed * 1.7 );
-		}
-
-		real steering0 = 0;
-		real braking0 = 0;
-
-		ConstDequeIterator< ActionIdList > itAction( mActiveActions );
-		while (itAction.hasMoreElements())
-		{
-			const input::ActionId activeId = itAction.getNext();
-			if (activeId == input::ACTIONID_FORWARD)
-				mVehicle->getEngineInterface("main")->setInputSignal(1.);
-			else if (activeId == ACTIONID_BRAKE)
-				braking0 = 1.;
-			else if (activeId == input::ACTIONID_LEFT)
-				steering0 -= real(0.7);
-			else if (activeId == input::ACTIONID_RIGHT)
-				steering0 += real(0.7);
-		}
-		mVehicle->setSteering( 0, steering0 );
-		mVehicle->getWheelInterface("leftFrontWheel")->brake(braking0);
-		mVehicle->getWheelInterface("rightFrontWheel")->brake(braking0);
-
-		mVehicle->updateSimulation( timeElapsed );
-		//mComplex->updatePhysics( timeElapsed );
-
-		ConstDequeIterator< WheelPsMap > itWheel( mWheelPs );
-		while (itWheel.hasMoreElements())
-		{
-			const String wheelId = itWheel.getNext().first;
-			mWheelPs[ wheelId ]->setEmissionRate( 0, mEmitterEmissionRate[wheelId] * mVehicle->getWheelInterface( wheelId )->getSkid() );
-		}
-
-		getDefaultCamera()->lookAt(mVehicle->getChassisPosition());
-		//mComplex->updateGraphics( timeElapsed );
-
-		this->_triggerGraphicsUpdate(0,timeElapsed);
-
-		mActiveActions.clear();
-	}
-protected:
-	void onForward()
-	{ mActiveActions.insert( input::ACTIONID_FORWARD ); }
-	void onReverse()
-	{ mActiveActions.insert( ACTIONID_BRAKE ); }
-	void onUp()
-	{ mActiveActions.insert( input::ACTIONID_UP ); }
-	void onFrontWheelLeft()
-	{ mActiveActions.insert( input::ACTIONID_LEFT ); }
-	void onFrontWheelRight()
-	{ mActiveActions.insert( input::ACTIONID_RIGHT ); }
-private:
-private:
-	model::Model*			mGround;
-	vehicle::IVehicle*		mVehicle;
-	model::Model*			mComplex;
-	typedef AssocVector<String,real> EmitterRealMap;
-	EmitterRealMap			mEmitterMinVel;
-	EmitterRealMap			mEmitterMaxVel;
-	EmitterRealMap			mEmitterEmissionRate;
-	typedef AssocVector<String,graphics::IParticleSystem*> WheelPsMap;
-	WheelPsMap				mWheelPs;
-	input::ActionMap		mActionMap;
-
-	typedef std::set<input::ActionId> ActionIdList;
-	ActionIdList			mActiveActions;
-};
-
-/** The mighty application itself! */
-class TheApp : public raf::ExampleApplication<TheConfiguration>
-{
-public:
-	TheApp() {}
-protected:
-	virtual raf::MainState* createMainState()
-	{
-		return new TheMainState(*this);
-	}
-};
-
-int main( int argc, char** argv )
-{
-	// Use default executor for convenience.
-	// It's always possible to manually execute TheApp::initialise() etc.
-	TheApp theApp;
-	return (raf::runApplication( theApp )) ? 0 : 1;
-}
-

Copied: trunk/yake/src/yapp/samples/misc/vehicle/yakeDemo.cpp (from rev 1395, trunk/yake/src/yapp/samples/misc/car/yakeDemo.cpp)



From codeandroid at mail.berlios.de  Thu Jul 20 00:06:53 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Thu, 20 Jul 2006 00:06:53 +0200
Subject: [Yake-svn] r1397 - in trunk/yake/yapp/samples: base misc
Message-ID: <200607192206.k6JM6rp3022735@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-20 00:06:53 +0200 (Thu, 20 Jul 2006)
New Revision: 1397

Added:
   trunk/yake/yapp/samples/misc/vehicle/
Removed:
   trunk/yake/yapp/samples/base/vehicle/
   trunk/yake/yapp/samples/misc/car/
Log:
merged car and jet demos

Copied: trunk/yake/yapp/samples/misc/vehicle (from rev 1347, trunk/yake/yapp/samples/misc/car)



From codeandroid at mail.berlios.de  Thu Jul 20 00:07:12 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Thu, 20 Jul 2006 00:07:12 +0200
Subject: [Yake-svn] r1398 - in trunk/yake/scripts/msvc8/samples: base misc
Message-ID: <200607192207.k6JM7C2t022784@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-20 00:07:11 +0200 (Thu, 20 Jul 2006)
New Revision: 1398

Added:
   trunk/yake/scripts/msvc8/samples/misc/sampleVehicle.vcproj
Removed:
   trunk/yake/scripts/msvc8/samples/base/sampleVehicle.vcproj
   trunk/yake/scripts/msvc8/samples/misc/sampleCar.vcproj
Log:
merged car and jet demos

Deleted: trunk/yake/scripts/msvc8/samples/base/sampleVehicle.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/base/sampleVehicle.vcproj	2006-07-19 22:06:53 UTC (rev 1397)
+++ trunk/yake/scripts/msvc8/samples/base/sampleVehicle.vcproj	2006-07-19 22:07:11 UTC (rev 1398)
@@ -1,219 +0,0 @@
-<?xml version="1.0" encoding="Windows-1252"?>
-<VisualStudioProject
-	ProjectType="Visual C++"
-	Version="8,00"
-	Name="sampleVehicle"
-	ProjectGUID="{B9A9E534-6EB6-4667-B91B-74B930636F5E}"
-	Keyword="Win32Proj"
-	>
-	<Platforms>
-		<Platform
-			Name="Win32"
-		/>
-	</Platforms>
-	<ToolFiles>
-	</ToolFiles>
-	<Configurations>
-		<Configuration
-			Name="Debug|Win32"
-			OutputDirectory="../../../../common/bin/debug"
-			IntermediateDirectory="../../../../common/obj/debug/$(ProjectName)"
-			ConfigurationType="1"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				Optimization="0"
-				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
-				PreprocessorDefinitions="WIN32;_DEBUG;_CONSOLE"
-				MinimalRebuild="true"
-				BasicRuntimeChecks="3"
-				RuntimeLibrary="3"
-				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
-				PrecompiledHeaderThrough="yapp/samples/base/vehicle/yakePCH.h"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="4"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib vehicle.lib"
-				OutputFile="$(OutDir)/$(ProjectName).exe"
-				LinkIncremental="2"
-				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/lib"
-				GenerateDebugInformation="true"
-				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
-				SubSystem="1"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-		<Configuration
-			Name="Release|Win32"
-			OutputDirectory="../../../../common/bin/release"
-			IntermediateDirectory="../../../../common/obj/release/$(ProjectName)"
-			ConfigurationType="1"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
-				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE"
-				RuntimeLibrary="2"
-				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="0"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="3"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib vehicle.lib"
-				OutputFile="$(OutDir)/$(ProjectName).exe"
-				LinkIncremental="1"
-				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"
-				GenerateDebugInformation="false"
-				SubSystem="1"
-				OptimizeReferences="2"
-				EnableCOMDATFolding="2"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-	</Configurations>
-	<References>
-	</References>
-	<Files>
-		<Filter
-			Name="inc"
-			>
-			<File
-				RelativePath="..\..\..\..\yapp\samples\common\yakeHelper.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\..\..\yapp\samples\base\vehicle\yakePCH.h"
-				>
-			</File>
-		</Filter>
-		<Filter
-			Name="src"
-			>
-			<File
-				RelativePath="..\..\..\..\src\yapp\samples\base\vehicle\yakeDemo.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\..\..\src\yapp\samples\base\vehicle\yakePCH.cpp"
-				>
-				<FileConfiguration
-					Name="Debug|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
-			</File>
-		</Filter>
-	</Files>
-	<Globals>
-	</Globals>
-</VisualStudioProject>

Deleted: trunk/yake/scripts/msvc8/samples/misc/sampleCar.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/misc/sampleCar.vcproj	2006-07-19 22:06:53 UTC (rev 1397)
+++ trunk/yake/scripts/msvc8/samples/misc/sampleCar.vcproj	2006-07-19 22:07:11 UTC (rev 1398)
@@ -1,228 +0,0 @@
-<?xml version="1.0" encoding="Windows-1252"?>
-<VisualStudioProject
-	ProjectType="Visual C++"
-	Version="8,00"
-	Name="sampleCar"
-	ProjectGUID="{EE77E955-42BD-47A4-BDC6-D92759F45D01}"
-	Keyword="Win32Proj"
-	>
-	<Platforms>
-		<Platform
-			Name="Win32"
-		/>
-	</Platforms>
-	<ToolFiles>
-	</ToolFiles>
-	<Configurations>
-		<Configuration
-			Name="Debug|Win32"
-			OutputDirectory="../../../../common/bin/debug"
-			IntermediateDirectory="../../../../common/obj/debug/$(ProjectName)"
-			ConfigurationType="1"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				Optimization="0"
-				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
-				PreprocessorDefinitions="WIN32;_DEBUG;_CONSOLE"
-				MinimalRebuild="true"
-				BasicRuntimeChecks="3"
-				RuntimeLibrary="3"
-				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
-				PrecompiledHeaderThrough="yapp/samples/misc/car/yakePCH.h"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="4"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib vehicle.lib"
-				OutputFile="$(OutDir)/$(ProjectName).exe"
-				LinkIncremental="2"
-				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/lib"
-				GenerateDebugInformation="true"
-				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
-				SubSystem="1"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-		<Configuration
-			Name="Release|Win32"
-			OutputDirectory="../../../../common/bin/release"
-			IntermediateDirectory="../../../../common/obj/release/$(ProjectName)"
-			ConfigurationType="1"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
-				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE"
-				RuntimeLibrary="2"
-				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
-				PrecompiledHeaderThrough="yapp/samples/misc/car/yakePCH.h"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="3"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib vehicle.lib"
-				OutputFile="$(OutDir)/$(ProjectName).exe"
-				LinkIncremental="1"
-				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"
-				GenerateDebugInformation="false"
-				SubSystem="1"
-				OptimizeReferences="2"
-				EnableCOMDATFolding="2"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-	</Configurations>
-	<References>
-	</References>
-	<Files>
-		<Filter
-			Name="inc"
-			>
-			<File
-				RelativePath="..\..\..\..\yapp\samples\common\yakeHelper.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\..\..\yapp\samples\misc\car\yakePCH.h"
-				>
-			</File>
-		</Filter>
-		<Filter
-			Name="src"
-			>
-			<File
-				RelativePath="..\..\..\..\src\yapp\samples\misc\car\yakeDemo.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\..\..\src\yapp\samples\misc\car\yakePCH.cpp"
-				>
-				<FileConfiguration
-					Name="Debug|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
-				<FileConfiguration
-					Name="Release|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
-			</File>
-		</Filter>
-	</Files>
-	<Globals>
-	</Globals>
-</VisualStudioProject>

Copied: trunk/yake/scripts/msvc8/samples/misc/sampleVehicle.vcproj (from rev 1347, trunk/yake/scripts/msvc8/samples/misc/sampleCar.vcproj)
===================================================================
--- trunk/yake/scripts/msvc8/samples/misc/sampleCar.vcproj	2006-06-20 08:05:16 UTC (rev 1347)
+++ trunk/yake/scripts/msvc8/samples/misc/sampleVehicle.vcproj	2006-07-19 22:07:11 UTC (rev 1398)
@@ -0,0 +1,228 @@
+<?xml version="1.0" encoding="Windows-1252"?>
+<VisualStudioProject
+	ProjectType="Visual C++"
+	Version="8,00"
+	Name="sampleVehicle"
+	ProjectGUID="{EE77E955-42BD-47A4-BDC6-D92759F45D01}"
+	Keyword="Win32Proj"
+	>
+	<Platforms>
+		<Platform
+			Name="Win32"
+		/>
+	</Platforms>
+	<ToolFiles>
+	</ToolFiles>
+	<Configurations>
+		<Configuration
+			Name="Debug|Win32"
+			OutputDirectory="../../../../common/bin/debug"
+			IntermediateDirectory="../../../../common/obj/debug/$(ProjectName)"
+			ConfigurationType="1"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				Optimization="0"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
+				PreprocessorDefinitions="WIN32;_DEBUG;_CONSOLE"
+				MinimalRebuild="true"
+				BasicRuntimeChecks="3"
+				RuntimeLibrary="3"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="2"
+				PrecompiledHeaderThrough="yapp/samples/misc/vehicle/yakePCH.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="4"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib vehicle.lib"
+				OutputFile="$(OutDir)/$(ProjectName).exe"
+				LinkIncremental="2"
+				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/lib"
+				GenerateDebugInformation="true"
+				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
+				SubSystem="1"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+		<Configuration
+			Name="Release|Win32"
+			OutputDirectory="../../../../common/bin/release"
+			IntermediateDirectory="../../../../common/obj/release/$(ProjectName)"
+			ConfigurationType="1"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
+				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE"
+				RuntimeLibrary="2"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="2"
+				PrecompiledHeaderThrough="yapp/samples/misc/vehicle/yakePCH.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="3"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib vehicle.lib"
+				OutputFile="$(OutDir)/$(ProjectName).exe"
+				LinkIncremental="1"
+				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"
+				GenerateDebugInformation="false"
+				SubSystem="1"
+				OptimizeReferences="2"
+				EnableCOMDATFolding="2"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+	</Configurations>
+	<References>
+	</References>
+	<Files>
+		<Filter
+			Name="inc"
+			>
+			<File
+				RelativePath="..\..\..\..\yapp\samples\common\yakeHelper.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\..\..\yapp\samples\misc\vehicle\yakePCH.h"
+				>
+			</File>
+		</Filter>
+		<Filter
+			Name="src"
+			>
+			<File
+				RelativePath="..\..\..\..\src\yapp\samples\misc\vehicle\yakeDemo.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\..\..\src\yapp\samples\misc\vehicle\yakePCH.cpp"
+				>
+				<FileConfiguration
+					Name="Debug|Win32"
+					>
+					<Tool
+						Name="VCCLCompilerTool"
+						UsePrecompiledHeader="1"
+					/>
+				</FileConfiguration>
+				<FileConfiguration
+					Name="Release|Win32"
+					>
+					<Tool
+						Name="VCCLCompilerTool"
+						UsePrecompiledHeader="1"
+					/>
+				</FileConfiguration>
+			</File>
+		</Filter>
+	</Files>
+	<Globals>
+	</Globals>
+</VisualStudioProject>



From codeandroid at mail.berlios.de  Thu Jul 20 00:08:01 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Thu, 20 Jul 2006 00:08:01 +0200
Subject: [Yake-svn] r1399 - trunk/yake/scripts/msvc8
Message-ID: <200607192208.k6JM81Yr022859@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-20 00:08:01 +0200 (Thu, 20 Jul 2006)
New Revision: 1399

Modified:
   trunk/yake/scripts/msvc8/yake.sln
Log:
merged car and jet demos

Modified: trunk/yake/scripts/msvc8/yake.sln
===================================================================
--- trunk/yake/scripts/msvc8/yake.sln	2006-07-19 22:07:11 UTC (rev 1398)
+++ trunk/yake/scripts/msvc8/yake.sln	2006-07-19 22:08:01 UTC (rev 1399)
@@ -134,8 +134,6 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "samplePhysicsDemo", "samples\physics\samplePhysicsDemo.vcproj", "{3DA99679-404B-44C7-9267-C97D066F3D96}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleCar", "samples\misc\sampleCar.vcproj", "{EE77E955-42BD-47A4-BDC6-D92759F45D01}"
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRoServer", "samples\net\sampleRoServer.vcproj", "{547611C2-43E2-4678-B8E9-92CF69770C40}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRoClient", "samples\net\sampleRoClient.vcproj", "{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}"
@@ -144,6 +142,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleModel1", "samples\model\sampleModel1.vcproj", "{920E5CA3-620C-43C3-986C-5A6F9397F6DA}"
 EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleVehicle", "samples\misc\sampleVehicle.vcproj", "{EE77E955-42BD-47A4-BDC6-D92759F45D01}"
+EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) = preSolution
 		Debug|Win32 = Debug|Win32
@@ -272,10 +272,6 @@
 		{3DA99679-404B-44C7-9267-C97D066F3D96}.Debug|Win32.Build.0 = Debug|Win32
 		{3DA99679-404B-44C7-9267-C97D066F3D96}.Release|Win32.ActiveCfg = Release|Win32
 		{3DA99679-404B-44C7-9267-C97D066F3D96}.Release|Win32.Build.0 = Release|Win32
-		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Debug|Win32.ActiveCfg = Debug|Win32
-		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Debug|Win32.Build.0 = Debug|Win32
-		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Release|Win32.ActiveCfg = Release|Win32
-		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Release|Win32.Build.0 = Release|Win32
 		{547611C2-43E2-4678-B8E9-92CF69770C40}.Debug|Win32.ActiveCfg = Debug|Win32
 		{547611C2-43E2-4678-B8E9-92CF69770C40}.Debug|Win32.Build.0 = Debug|Win32
 		{547611C2-43E2-4678-B8E9-92CF69770C40}.Release|Win32.ActiveCfg = Release|Win32
@@ -292,6 +288,10 @@
 		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Debug|Win32.Build.0 = Debug|Win32
 		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Release|Win32.ActiveCfg = Release|Win32
 		{920E5CA3-620C-43C3-986C-5A6F9397F6DA}.Release|Win32.Build.0 = Release|Win32
+		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Debug|Win32.ActiveCfg = Debug|Win32
+		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Debug|Win32.Build.0 = Debug|Win32
+		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Release|Win32.ActiveCfg = Release|Win32
+		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Release|Win32.Build.0 = Release|Win32
 	EndGlobalSection
 	GlobalSection(SolutionProperties) = preSolution
 		HideSolutionNode = FALSE



From codeandroid at mail.berlios.de  Thu Jul 20 00:08:41 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Thu, 20 Jul 2006 00:08:41 +0200
Subject: [Yake-svn] r1400 - trunk/yake/src/yapp/samples/misc/vehicle
Message-ID: <200607192208.k6JM8fAv022927@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-20 00:08:41 +0200 (Thu, 20 Jul 2006)
New Revision: 1400

Modified:
   trunk/yake/src/yapp/samples/misc/vehicle/yakeDemo.cpp
   trunk/yake/src/yapp/samples/misc/vehicle/yakePCH.cpp
Log:
merged car and jet demos

Modified: trunk/yake/src/yapp/samples/misc/vehicle/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/misc/vehicle/yakeDemo.cpp	2006-07-19 22:08:01 UTC (rev 1399)
+++ trunk/yake/src/yapp/samples/misc/vehicle/yakeDemo.cpp	2006-07-19 22:08:41 UTC (rev 1400)
@@ -1,4 +1,4 @@
-#include <yapp/samples/misc/car/yakePCH.h>
+#include <yapp/samples/misc/vehicle/yakePCH.h>
 #include <yake/audio/yakeAudio.h>
 #include <yapp/raf/yakeRaf.h>
 #include <yake/model/model.h>

Modified: trunk/yake/src/yapp/samples/misc/vehicle/yakePCH.cpp
===================================================================
--- trunk/yake/src/yapp/samples/misc/vehicle/yakePCH.cpp	2006-07-19 22:08:01 UTC (rev 1399)
+++ trunk/yake/src/yapp/samples/misc/vehicle/yakePCH.cpp	2006-07-19 22:08:41 UTC (rev 1400)
@@ -1 +1 @@
-#include <yapp/samples/misc/car/yakePCH.h>
+#include <yapp/samples/misc/vehicle/yakePCH.h>



From codeandroid at mail.berlios.de  Thu Jul 20 00:09:36 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Thu, 20 Jul 2006 00:09:36 +0200
Subject: [Yake-svn] r1401 - trunk/yake/common/media/vehicles
Message-ID: <200607192209.k6JM9a36023055@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-20 00:09:36 +0200 (Thu, 20 Jul 2006)
New Revision: 1401

Modified:
   trunk/yake/common/media/vehicles/jet.xml
Log:
fix values

Modified: trunk/yake/common/media/vehicles/jet.xml
===================================================================
--- trunk/yake/common/media/vehicles/jet.xml	2006-07-19 22:08:41 UTC (rev 1400)
+++ trunk/yake/common/media/vehicles/jet.xml	2006-07-19 22:09:36 UTC (rev 1401)
@@ -31,7 +31,7 @@
 			<direction x="0" y="0" z="1" />
 		</mountPoint>
 		<engine name="backward" type="MountedThruster" mountPoint="front">
-			<forces min="0." max="10." dieOff="4" rise="8" />
+			<forces min="0." max="20." dieOff="4" rise="8" />
 		</engine>
 		<!-- rear thruster -->
 		<mountPoint name="rear">
@@ -47,7 +47,7 @@
 			<direction x="0" y="-1" z="0" />
 		</mountPoint>
 		<engine name="upward" type="MountedThruster" mountPoint="bottom">
-			<forces min="0." max="250." dieOff="10" rise="20" />
+			<forces min="0." max="500." dieOff="10" rise="20" />
 		</engine>
 		<!-- bottom (downward) thruster -->
 		<mountPoint name="top">
@@ -62,13 +62,13 @@
 		<axle name="rear" />
 		<!-- wheels - one in front for steering, two at the rear end -->
 		<steeringGroup index="0" />
-		<wheel name="frontWheel" axle="front" steeringGroup="0" radius="2.0" mass="0.1" massIsRelativeToChassis="yes" suspensionSpring="100" suspensionDamping="20">
+		<wheel name="frontWheel" axle="front" steeringGroup="0" radius="1.0" mass="0.05" massIsRelativeToChassis="yes" suspensionSpring="100" suspensionDamping="20">
 			<position x="0" y="-3" z="5.5" />
 		</wheel>
-		<wheel name="leftRearWheel" axle="rear" radius="2.0" mass="0.1" massIsRelativeToChassis="yes" suspensionSpring="150" suspensionDamping="20">
+		<wheel name="leftRearWheel" axle="rear" radius="1.0" mass="0.05" massIsRelativeToChassis="yes" suspensionSpring="150" suspensionDamping="20">
 			<position x="-3" y="-3" z="-3" />
 		</wheel>
-		<wheel name="rightRearWheel" axle="rear" radius="2.0" mass="0.1" massIsRelativeToChassis="yes" suspensionSpring="150" suspensionDamping="20">
+		<wheel name="rightRearWheel" axle="rear" radius="1.0" mass="0.05" massIsRelativeToChassis="yes" suspensionSpring="150" suspensionDamping="20">
 			<position x="3" y="-3" z="-3" />
 		</wheel>
 	</vehicleTemplate>



From codeandroid at mail.berlios.de  Wed Jul 26 20:56:06 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Wed, 26 Jul 2006 20:56:06 +0200
Subject: [Yake-svn] r1402 - trunk/yake/src/yake/model
Message-ID: <200607261856.k6QIu62S007826@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-26 20:56:00 +0200 (Wed, 26 Jul 2006)
New Revision: 1402

Added:
   trunk/yake/src/yake/model/yakeModelComponent.cpp
Modified:
   trunk/yake/src/yake/model/yakeGraphicalCreator.cpp
   trunk/yake/src/yake/model/yakeLinkCreator.cpp
   trunk/yake/src/yake/model/yakeModelManager.cpp
   trunk/yake/src/yake/model/yakePhysicalCreator.cpp
Log:
cleaned up interfaces for model and component creation contexts

Modified: trunk/yake/src/yake/model/yakeGraphicalCreator.cpp
===================================================================
--- trunk/yake/src/yake/model/yakeGraphicalCreator.cpp	2006-07-19 22:09:36 UTC (rev 1401)
+++ trunk/yake/src/yake/model/yakeGraphicalCreator.cpp	2006-07-26 18:56:00 UTC (rev 1402)
@@ -56,7 +56,7 @@
 	void GraphicalFromDotSceneCreator::create(const ComponentCreationContext& ctx, const StringMap& params)
 	{
 		// Verify validity of creation context
-		graphics::IWorld* pGWorld = ctx.gworld_;
+		graphics::IWorld* pGWorld = ctx.getGraphicalWorld();
 		YAKE_ASSERT( pGWorld );
 		if (!pGWorld)
 			return;
@@ -69,11 +69,7 @@
 			return;
 		const String fn = itParam->second;
 
-		itParam = params.find("name");
-		YAKE_ASSERT(itParam != params.end()).debug("Missing parameter 'name'.");
-		if (itParam == params.end())
-			return;
-		const String name = itParam->second;
+		const String name = ctx.getName().empty() ? uniqueName::create("graphical_") : ctx.getName();
 
 		// Read dotscene file into DOM
 
@@ -83,15 +79,15 @@
 
 		// Parse DOM and create graphical objects
 
-		data::parser::dotscene::DotSceneParser* parser = ctx.dotSceneParser_;
+		data::parser::dotscene::DotSceneParser* parser = ctx.getDotSceneParser();
 		if (!parser)
 			parser = defaultParser_.get();
 		YAKE_ASSERT( parser );
 
 		Graphical* pGraphical = new Graphical(/**ctx.model_*/);
-		ctx.sigPreInit_(ctx,*pGraphical);
+		ctx.sigPreInit(ctx,*pGraphical);
 
-		const String namePrefix = _T("model:") + ctx.model_->getName() + _T("/")  // model
+		const String namePrefix = _T("model:") + ctx.getModel().getName() + _T("/")  // model
 									+ (name.empty() ? _T("") : (name + _T("/"))); // component
 
 		DotSceneListener dotSceneListener( *pGraphical, namePrefix );
@@ -112,8 +108,8 @@
 		conn3.disconnect();
 		conn4.disconnect();
 
-		ctx.sigPostInit_(ctx,*pGraphical);
-		ctx.model_->addComponent( pGraphical, name );
+		ctx.sigPostInit(ctx,*pGraphical);
+		ctx.getModel().addComponent( pGraphical, name );
 	}
 
 	//-----------------------------------------------------
@@ -137,14 +133,9 @@
 	{
 		// Extract parameters
 
-		StringMap::const_iterator itParam = params.find("name");
-		YAKE_ASSERT(itParam != params.end()).debug("Missing parameter 'name'.");
-		if (itParam == params.end())
-			return;
-		const String name = itParam->second;
+		const String name = ctx.getName().empty() ? uniqueName::create("graphical_") : ctx.getName();
 
-		YAKE_ASSERT( ctx.model_ );
-		ctx.model_->addComponent( new Graphical(), name );
+		ctx.getModel().addComponent( new Graphical(), name );
 	}
 } // namespace model
 } // namespace yake

Modified: trunk/yake/src/yake/model/yakeLinkCreator.cpp
===================================================================
--- trunk/yake/src/yake/model/yakeLinkCreator.cpp	2006-07-19 22:09:36 UTC (rev 1401)
+++ trunk/yake/src/yake/model/yakeLinkCreator.cpp	2006-07-26 18:56:00 UTC (rev 1402)
@@ -64,7 +64,8 @@
 		// Parse DOM and create graphical objects
 
 		DotLinkLoader dotLinkLoader;
-		if (!dotLinkLoader.load( *ser.getDocumentNode(), *ctx.model_, *ctx.centralController_ ))
+		YAKE_ASSERT(ctx.getCentralController());
+		if (!dotLinkLoader.load( *ser.getDocumentNode(), ctx.getModel(), *ctx.getCentralController() ))
 		{
 			//@todo Report error!
 		}

Added: trunk/yake/src/yake/model/yakeModelComponent.cpp
===================================================================
--- trunk/yake/src/yake/model/yakeModelComponent.cpp	2006-07-19 22:09:36 UTC (rev 1401)
+++ trunk/yake/src/yake/model/yakeModelComponent.cpp	2006-07-26 18:56:00 UTC (rev 1402)
@@ -0,0 +1,84 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#include "yake/model/pch.h"
+#include "yake/model/prerequisites.h"
+#include "yake/model/model.h"
+
+namespace yake {
+namespace model {
+
+	ComponentCreationContext::ComponentCreationContext(ModelCreationContext& modelCtx, const String& name) : 
+		modelCtx_(modelCtx),
+		name_(name)
+	{}
+	const String& ComponentCreationContext::getName() const
+	{
+		return name_;
+	}
+	Model& ComponentCreationContext::getModel() const
+	{
+		YAKE_ASSERT( modelCtx_.model_ )(name_).fatal("Cannot dereference 0 model.");
+		return *modelCtx_.model_;
+	}
+	graphics::IWorld* ComponentCreationContext::getGraphicalWorld() const
+	{
+		return modelCtx_.gworld_;
+	}
+	physics::IWorld* ComponentCreationContext::getPhysicalWorld() const
+	{
+		return modelCtx_.pworld_;
+	}
+	CentralControllerBase* ComponentCreationContext::getCentralController() const
+	{
+		return modelCtx_.centralController_;
+	}
+	data::parser::dotscene::DotSceneParser* ComponentCreationContext::getDotSceneParser() const
+	{
+		return modelCtx_.dotSceneParser_;
+	}
+	data::parser::xode::XODEParser* ComponentCreationContext::getXODEParser() const
+	{
+		return modelCtx_.xodeParser_;
+	}
+	bool ComponentCreationContext::getParamValue(const String& key, boost::any& out) const
+	{
+		ModelCreationContext::ParamMap::const_iterator it = modelCtx_.params_.find(key);
+		if (it == modelCtx_.params_.end())
+			return false;
+		out = it->second;
+		return true;
+	}
+	void ComponentCreationContext::sigPreInit(const ComponentCreationContext& compCtx,ModelComponent& comp) const
+	{
+		modelCtx_.sigPreInitComponent_(compCtx,comp);
+	}
+	void ComponentCreationContext::sigPostInit(const ComponentCreationContext& compCtx,ModelComponent& comp) const
+	{
+		modelCtx_.sigPostInitComponent_(compCtx,comp);
+	}
+} // namespace model
+} // namespace yake

Modified: trunk/yake/src/yake/model/yakeModelManager.cpp
===================================================================
--- trunk/yake/src/yake/model/yakeModelManager.cpp	2006-07-19 22:09:36 UTC (rev 1401)
+++ trunk/yake/src/yake/model/yakeModelManager.cpp	2006-07-26 18:56:00 UTC (rev 1402)
@@ -41,11 +41,11 @@
 	{
 		return sigModelCreatedSignal_.connect(slot);
 	}
-	SignalConnection ModelManager::subscribeToPreCreateModelComponent(const PreCreateModelComponent::slot_type& slot)
+	SignalConnection ModelManager::subscribeToPreCreateComponent(const PreCreateModelComponent::slot_type& slot)
 	{
 		return sigPreCreateModelComponent_.connect(slot);
 	}
-	SignalConnection ModelManager::subscribeToPostCreateModelComponent(const PostCreateModelComponent::slot_type& slot)
+	SignalConnection ModelManager::subscribeToPostCreateComponent(const PostCreateModelComponent::slot_type& slot)
 	{
 		return sigPostCreateModelComponent_.connect(slot);
 	}
@@ -53,13 +53,13 @@
 	{
 		return sigModelInitializedSignal_.connect(slot);
 	}
-	SignalConnection ModelManager::subscribeToComponentPreInitializeSignal(const ComponentPreInitializeSignal::slot_type& slot)
+	SignalConnection ModelManager::subscribeToPreInitializeComponentSignal(const PreInitializeComponentSignal::slot_type& slot)
 	{
-		return ctx_.sigPreInit_.connect( slot );
+		return modelCtx_.sigPreInitComponent_.connect( slot );
 	}
-	SignalConnection ModelManager::subscribeToComponentPostInitializeSignal(const ComponentPostInitializeSignal::slot_type& slot)
+	SignalConnection ModelManager::subscribeToPostInitializeComponentSignal(const PostInitializeComponentSignal::slot_type& slot)
 	{
-		return ctx_.sigPostInit_.connect( slot );
+		return modelCtx_.sigPostInitComponent_.connect( slot );
 	}
 	namespace detail {
 		void extractParams(const String& params, StringMap& out)
@@ -102,9 +102,9 @@
 		Model* m = new Model();
 		m->setName( modelName );
 		models_.insert( std::make_pair(modelName,SharedPtr<Model>(m)) );
-		ctx_.model_ = m;
+		modelCtx_.model_ = m;
 
-		sigModelCreatedSignal_(*m,ctx_);
+		sigModelCreatedSignal_(*m,modelCtx_);
 
 		// Create components (if any)
 		ConstVectorIterator<ModelComponentDescList> itCompDesc(compDescList);
@@ -127,12 +127,14 @@
 			}
 #endif
 
-			sigPreCreateModelComponent_(*m,ctx_,type);
-			creatorMgr_.create( type, ctx_, params );
-			sigPostCreateModelComponent_(*m,ctx_,type);
+			ComponentCreationContext compCtx( modelCtx_, name );
+
+			sigPreCreateModelComponent_(*m,compCtx,type);
+			creatorMgr_.create( type, compCtx, params );
+			sigPostCreateModelComponent_(*m,compCtx,type);
 		}
-		ctx_.model_ = 0;
-		sigModelInitializedSignal_(*m,ctx_);
+		modelCtx_.model_ = 0;
+		sigModelInitializedSignal_(*m,modelCtx_);
 		return m;
 	}
 	/// graphics/dotScene:name=gfx;file=bla.scene|physics/dotXODE...
@@ -175,30 +177,30 @@
 	}
 	void ModelManager::setCreationContext_GraphicalWorld(graphics::IWorld* w)
 	{
-		ctx_.gworld_ = w;
+		modelCtx_.gworld_ = w;
 	}
 	void ModelManager::setCreationContext_PhysicalWorld(physics::IWorld* w)
 	{
-		ctx_.pworld_ = w;
+		modelCtx_.pworld_ = w;
 	}
 	void ModelManager::setCreationContext_CentralController(CentralControllerBase* c)
 	{
-		ctx_.centralController_ = c;
+		modelCtx_.centralController_ = c;
 	}
 	void ModelManager::setCreationContext_DotSceneParser(data::parser::dotscene::DotSceneParser* parser)
 	{
-		ctx_.dotSceneParser_ = parser;
+		modelCtx_.dotSceneParser_ = parser;
 	}
 	void ModelManager::setCreationContext_XODEParser(data::parser::xode::XODEParser* parser)
 	{
-		ctx_.xodeParser_ = parser;
+		modelCtx_.xodeParser_ = parser;
 	}
 	void ModelManager::setCreationContext_NamedParameter(const String& name, const boost::any& value)
 	{
 		YAKE_ASSERT( !name.empty() );
 		if (name.empty())
 			return;
-		ctx_.params_[ name ] = value;
+		modelCtx_.params_[ name ] = value;
 	}
 
 } // namespace model

Modified: trunk/yake/src/yake/model/yakePhysicalCreator.cpp
===================================================================
--- trunk/yake/src/yake/model/yakePhysicalCreator.cpp	2006-07-19 22:09:36 UTC (rev 1401)
+++ trunk/yake/src/yake/model/yakePhysicalCreator.cpp	2006-07-26 18:56:00 UTC (rev 1402)
@@ -55,7 +55,7 @@
 	void PhysicalFromXODECreator::create(const ComponentCreationContext& ctx, const StringMap& params)
 	{
 		// Verify validity of creation context
-		physics::IWorld* pPWorld = ctx.pworld_;
+		physics::IWorld* pPWorld = ctx.getPhysicalWorld();
 		YAKE_ASSERT( pPWorld );
 		if (!pPWorld)
 			return;
@@ -68,11 +68,7 @@
 			return;
 		const String fn = itParam->second;
 
-		itParam = params.find("name");
-		YAKE_ASSERT(itParam != params.end()).debug("Missing parameter 'name'.");
-		if (itParam == params.end())
-			return;
-		const String name = itParam->second;
+		const String name = ctx.getName().empty() ? uniqueName::create("physical_") : ctx.getName();
 
 		// Read XML file into DOM
 
@@ -82,31 +78,39 @@
 
 		// Parse DOM and create graphical objects
 
-		data::parser::xode::XODEParser* xodeparser = ctx.xodeParser_;
+		data::parser::xode::XODEParser* xodeparser = ctx.getXODEParser();
 		if (!xodeparser)
 			xodeparser = defaultParser_.get();
 		YAKE_ASSERT( xodeparser );
 
 		Physical* pPhysical = new Physical(/**ctx.model_*/);
-		ctx.sigPreInit_(ctx,*pPhysical);
+		ctx.sigPreInit(ctx,*pPhysical);
 
-		const String namePrefix = _T("model:") + ctx.model_->getName() + _T("/")  // model
+		const String namePrefix = _T("model:") + ctx.getModel().getName() + _T("/")  // model
 									+ (name.empty() ? _T("") : (name + _T("/"))); // component
 		XODEListener xodeListener( *pPhysical, pPWorld, namePrefix );
 
 		SignalConnection conn1 = xodeparser->subscribeToBodySignal( Bind1( &XODEListener::processBody, &xodeListener ) );
 		SignalConnection conn2 = xodeparser->subscribeToGeomSignal( Bind1( &XODEListener::processGeom, &xodeListener ) );
+		SignalConnection conn3 = xodeparser->subscribeToMassSignal( Bind1( &XODEListener::processMass, &xodeListener ) );
+		SignalConnection conn4 = xodeparser->subscribeToJointSignal( Bind1( &XODEListener::processJoint, &xodeListener ) );
+		SignalConnection conn5 = xodeparser->subscribeToMaterialSignal( Bind1( &XODEListener::processMaterial, &xodeListener ) );
+		SignalConnection conn6 = xodeparser->subscribeToParseEndedSignal( Bind0( &XODEListener::postprocess, &xodeListener ) );
 
 		if (!xodeparser->load( ser.getDocumentNode() ))
 		{
 			YAKE_SAFE_DELETE( pPhysical );
 		}
 
+		conn6.disconnect();
+		conn5.disconnect();
+		conn4.disconnect();
+		conn3.disconnect();
 		conn2.disconnect();
 		conn1.disconnect();
 
-		ctx.sigPostInit_(ctx,*pPhysical);
-		ctx.model_->addComponent( pPhysical, name );
+		ctx.sigPostInit(ctx,*pPhysical);
+		ctx.getModel().addComponent( pPhysical, name );
 	}
 
 	//-----------------------------------------------------
@@ -129,14 +133,9 @@
 	{
 		// Extract parameters
 
-		StringMap::const_iterator itParam = params.find("name");
-		YAKE_ASSERT(itParam != params.end()).debug("Missing parameter 'name'.");
-		if (itParam == params.end())
-			return;
-		const String name = itParam->second;
+		const String name = ctx.getName().empty() ? uniqueName::create("physical_") : ctx.getName();
 
-		YAKE_ASSERT( ctx.model_ );
-		ctx.model_->addComponent( new Physical(), name );
+		ctx.getModel().addComponent( new Physical(), name );
 	}
 } // namespace model
 } // namespace yake



From codeandroid at mail.berlios.de  Wed Jul 26 21:02:04 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Wed, 26 Jul 2006 21:02:04 +0200
Subject: [Yake-svn] r1403 - trunk/yake/yake/model
Message-ID: <200607261902.k6QJ24pA008873@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-26 21:00:43 +0200 (Wed, 26 Jul 2006)
New Revision: 1403

Modified:
   trunk/yake/yake/model/model.h
   trunk/yake/yake/model/model_component.h
Log:
cleaned up interfaces for model and component creation contexts

Modified: trunk/yake/yake/model/model.h
===================================================================
--- trunk/yake/yake/model/model.h	2006-07-26 18:56:00 UTC (rev 1402)
+++ trunk/yake/yake/model/model.h	2006-07-26 19:00:43 UTC (rev 1403)
@@ -158,19 +158,19 @@
 
 		/** @name Signals (in order that they are called in) */
 		//@{
-		typedef Signal2<void(Model&,const ComponentCreationContext&)> ModelCreatedSignal;
+		typedef Signal2<void(Model&,const ModelCreationContext&)> ModelCreatedSignal;
 		typedef Signal3<void(Model&,const ComponentCreationContext&,const String&)> PreCreateModelComponent;
+		typedef ModelCreationContext::ComponentPreInitializeSignal PreInitializeComponentSignal;
+		typedef ModelCreationContext::ComponentPostInitializeSignal PostInitializeComponentSignal;
 		typedef Signal3<void(Model&,const ComponentCreationContext&,const String&)> PostCreateModelComponent;
-		typedef Signal2<void(Model&,const ComponentCreationContext&)> ModelInitializedSignal;
+		typedef Signal2<void(Model&,const ModelCreationContext&)> ModelInitializedSignal;
+
 		SignalConnection subscribeToModelCreatedSignal(const ModelCreatedSignal::slot_type&);
-		SignalConnection subscribeToPreCreateModelComponent(const PreCreateModelComponent::slot_type&);
-		SignalConnection subscribeToPostCreateModelComponent(const PostCreateModelComponent::slot_type&);
+		 SignalConnection subscribeToPreCreateComponent(const PreCreateModelComponent::slot_type&);
+		  SignalConnection subscribeToPreInitializeComponentSignal(const PreInitializeComponentSignal::slot_type&);
+		  SignalConnection subscribeToPostInitializeComponentSignal(const PostInitializeComponentSignal::slot_type&);
+		 SignalConnection subscribeToPostCreateComponent(const PostCreateModelComponent::slot_type&);
 		SignalConnection subscribeToModelInitializedSignal(const ModelInitializedSignal::slot_type&);
-
-		typedef ComponentCreationContext::ComponentPreInitializeSignal ComponentPreInitializeSignal;
-		typedef ComponentCreationContext::ComponentPostInitializeSignal ComponentPostInitializeSignal;
-		SignalConnection subscribeToComponentPreInitializeSignal(const ComponentPreInitializeSignal::slot_type&);
-		SignalConnection subscribeToComponentPostInitializeSignal(const ComponentPostInitializeSignal::slot_type&);
 		//@}
 
 	private:
@@ -178,7 +178,7 @@
 		ModelManager& operator=(const ModelManager&);
 	private:
 		ComponentCreatorManager		creatorMgr_;
-		ComponentCreationContext	ctx_;
+		ModelCreationContext		modelCtx_;
 
 		typedef AssocVector<String,SharedPtr<Model> > ModelList;
 		ModelList					models_;

Modified: trunk/yake/yake/model/model_component.h
===================================================================
--- trunk/yake/yake/model/model_component.h	2006-07-26 18:56:00 UTC (rev 1402)
+++ trunk/yake/yake/model/model_component.h	2006-07-26 19:00:43 UTC (rev 1403)
@@ -43,10 +43,13 @@
 namespace model {
 	//@todo move into private header:
 	struct CentralControllerBase;
+
+	struct ComponentCreationContext;
 	/** @remarks Do *NOT* rely on the existence of the members of this structure!
 				Always access them through ModelManager!
+		@todo Clear this up. Hide it!
 	*/
-	struct ComponentCreationContext
+	struct ModelCreationContext
 	{
 		Model*					model_;
 		graphics::IWorld*		gworld_;
@@ -62,10 +65,10 @@
 
 		typedef Signal2<void(const ComponentCreationContext&,ModelComponent&)> ComponentPreInitializeSignal;
 		typedef ComponentPreInitializeSignal ComponentPostInitializeSignal;
-		ComponentPreInitializeSignal	sigPreInit_;
-		ComponentPostInitializeSignal	sigPostInit_;
+		ComponentPreInitializeSignal	sigPreInitComponent_;
+		ComponentPostInitializeSignal	sigPostInitComponent_;
 
-		ComponentCreationContext() : 
+		ModelCreationContext() : 
 			model_(0),
 			gworld_(0),
 			pworld_(0),
@@ -75,6 +78,47 @@
 		{}
 	};
 
+	/** Contextual information on component creation time.
+	*/
+	struct ComponentCreationContext
+	{
+		ComponentCreationContext(ModelCreationContext& modelCtx, const String& name = "");
+
+		const String& getName() const;
+
+		Model& getModel() const;
+		graphics::IWorld* getGraphicalWorld() const;
+		physics::IWorld* getPhysicalWorld() const;
+		CentralControllerBase* getCentralController() const;
+
+		data::parser::dotscene::DotSceneParser* getDotSceneParser() const;
+		data::parser::xode::XODEParser* getXODEParser() const;
+
+		bool getParamValue(const String&,boost::any&) const;
+
+		template<typename OutT>
+		bool getParamValueAs(const String&,OutT&) const
+		{
+			ModelCreationContext::ParamMap::const_iterator it = modelCtx_.params_.find(key);
+			if (it == modelCtx_.params_.end())
+				return false;
+			try {
+				out = boost::any_cast<OutT>(it->second);
+			}
+			catch (boost::bad_any_cast&)
+			{
+				return false;
+			}
+			return true;
+		}
+
+		void sigPreInit(const ComponentCreationContext&,ModelComponent&) const;
+		void sigPostInit(const ComponentCreationContext&,ModelComponent&) const;
+	private:
+		ModelCreationContext&			modelCtx_;
+		String							name_;
+	};
+
 	struct YAKE_MODEL_API ModelComponent //: public Clonable<ModelComponent>
 	{
 		ModelComponent() {}



From codeandroid at mail.berlios.de  Wed Jul 26 21:06:13 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Wed, 26 Jul 2006 21:06:13 +0200
Subject: [Yake-svn] r1404 - trunk/yake/yake/base/templates
Message-ID: <200607261906.k6QJ6D8r010329@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-26 21:06:11 +0200 (Wed, 26 Jul 2006)
New Revision: 1404

Modified:
   trunk/yake/yake/base/templates/yakeSignals.h
Log:
added BindX and fixed Bind0 for MSVC8

Modified: trunk/yake/yake/base/templates/yakeSignals.h
===================================================================
--- trunk/yake/yake/base/templates/yakeSignals.h	2006-07-26 19:00:43 UTC (rev 1403)
+++ trunk/yake/yake/base/templates/yakeSignals.h	2006-07-26 19:06:11 UTC (rev 1404)
@@ -63,7 +63,8 @@
 
 #if defined( YAKE_SIGNALS_USE_BOOST )
 #	pragma message("Yake signal config: yake.base.templates.signals.boost")
-#	if YAKE_COMPILER == COMPILER_MSVC && YAKE_COMP_VER > 1300
+#	define BindX boost::bind
+#	if YAKE_COMPILER == COMPILER_MSVC && YAKE_COMP_VER == 1300
 #		define Bind0( METHOD, OBJECT ) boost::bind( METHOD, OBJECT, _1 )
 #	else
 #		define Bind0( METHOD, OBJECT ) boost::bind( METHOD, OBJECT )



From codeandroid at mail.berlios.de  Wed Jul 26 21:06:43 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Wed, 26 Jul 2006 21:06:43 +0200
Subject: [Yake-svn] r1405 - trunk/yake/yake/base/native/win32
Message-ID: <200607261906.k6QJ6hbh010452@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-26 21:06:39 +0200 (Wed, 26 Jul 2006)
New Revision: 1405

Modified:
   trunk/yake/yake/base/native/win32/yakeConfig.h
Log:
use WIN32_LEAN_AND_MEAN to reduce include overhead

Modified: trunk/yake/yake/base/native/win32/yakeConfig.h
===================================================================
--- trunk/yake/yake/base/native/win32/yakeConfig.h	2006-07-26 19:06:11 UTC (rev 1404)
+++ trunk/yake/yake/base/native/win32/yakeConfig.h	2006-07-26 19:06:39 UTC (rev 1405)
@@ -32,6 +32,7 @@
 //============================================================================
 // Yake
 #include <yake/base/native/yakeNative.h>
+#define WIN32_LEAN_AND_MEAN
 #include <windows.h>
 #include <yake/base/native/win32/yakeUndefine.h>
 



From codeandroid at mail.berlios.de  Wed Jul 26 21:07:11 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Wed, 26 Jul 2006 21:07:11 +0200
Subject: [Yake-svn] r1406 - in trunk/yake/src/yake: base/native/win32 data
Message-ID: <200607261907.k6QJ7BT4010559@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-26 21:07:07 +0200 (Wed, 26 Jul 2006)
New Revision: 1406

Modified:
   trunk/yake/src/yake/base/native/win32/yakeConfig.cpp
   trunk/yake/src/yake/data/yakeXMLSerializer.cpp
Log:
use WIN32_LEAN_AND_MEAN to reduce include overhead

Modified: trunk/yake/src/yake/base/native/win32/yakeConfig.cpp
===================================================================
--- trunk/yake/src/yake/base/native/win32/yakeConfig.cpp	2006-07-26 19:06:39 UTC (rev 1405)
+++ trunk/yake/src/yake/base/native/win32/yakeConfig.cpp	2006-07-26 19:07:07 UTC (rev 1406)
@@ -28,6 +28,8 @@
 //============================================================================
 //    IMPLEMENTATION HEADERS
 //============================================================================
+#define STRICT
+#define WIN32_LEAN_AND_MEAN
 #include <windows.h>
 #include <yake/base/yakePCH.h>
 #include <yake/base/native/win32/yakeConfig.h>

Modified: trunk/yake/src/yake/data/yakeXMLSerializer.cpp
===================================================================
--- trunk/yake/src/yake/data/yakeXMLSerializer.cpp	2006-07-26 19:06:39 UTC (rev 1405)
+++ trunk/yake/src/yake/data/yakeXMLSerializer.cpp	2006-07-26 19:07:07 UTC (rev 1406)
@@ -26,6 +26,9 @@
 */
 #include <yake/data/yakePCH.h>
 #include <yake/data/yakeXMLSerializer.h>
+
+#define STRICT
+#define WIN32_LEAN_AND_MEAN
 #include <dependencies/tinyxml/tinyxml.h>
 
 namespace yake {



From codeandroid at mail.berlios.de  Wed Jul 26 21:36:11 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Wed, 26 Jul 2006 21:36:11 +0200
Subject: [Yake-svn] r1407 - in trunk/yake: src/yake/samples/model/dotScene
	src/yapp/samples/misc/vehicle src/yapp/vehicle yake/model
Message-ID: <200607261936.k6QJaB6N032179@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-26 21:36:09 +0200 (Wed, 26 Jul 2006)
New Revision: 1407

Modified:
   trunk/yake/src/yake/samples/model/dotScene/demo.cpp
   trunk/yake/src/yapp/samples/misc/vehicle/yakeDemo.cpp
   trunk/yake/src/yapp/vehicle/yakeVehicleModelComponentCreator.cpp
   trunk/yake/yake/model/model_component.h
Log:
cleaned up interfaces for model and component creation contexts

Modified: trunk/yake/src/yake/samples/model/dotScene/demo.cpp
===================================================================
--- trunk/yake/src/yake/samples/model/dotScene/demo.cpp	2006-07-26 19:07:07 UTC (rev 1406)
+++ trunk/yake/src/yake/samples/model/dotScene/demo.cpp	2006-07-26 19:36:09 UTC (rev 1407)
@@ -137,8 +137,8 @@
 		modelMgr.setCreationContext_CentralController( this );
 
 		// just for demo purposes:
-		modelMgr.subscribeToComponentPreInitializeSignal( Bind2(&TheApp::onModelComponent_preInit,this) );
-		modelMgr.subscribeToComponentPostInitializeSignal( Bind2(&TheApp::onModelComponent_postInit,this) );
+		modelMgr.subscribeToPreInitializeComponentSignal( Bind2(&TheApp::onModelComponent_preInit,this) );
+		modelMgr.subscribeToPostInitializeComponentSignal( Bind2(&TheApp::onModelComponent_postInit,this) );
 
 		// create models :)
 

Modified: trunk/yake/src/yapp/samples/misc/vehicle/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/misc/vehicle/yakeDemo.cpp	2006-07-26 19:07:07 UTC (rev 1406)
+++ trunk/yake/src/yapp/samples/misc/vehicle/yakeDemo.cpp	2006-07-26 19:36:09 UTC (rev 1407)
@@ -78,8 +78,8 @@
 		mModelMgr.setCreationContext_NamedParameter("vehicleSystem",static_cast<vehicle::IVehicleSystem*>(mVehicleSystem.get()));
 
 		// set up model component creation hooks.
-		mModelMgr.subscribeToComponentPreInitializeSignal( Bind2(&TheMainState::onModelComponent_preInit,this) );
-		mModelMgr.subscribeToComponentPostInitializeSignal( Bind2(&TheMainState::onModelComponent_postInit,this) );
+		mModelMgr.subscribeToPreInitializeComponentSignal( Bind2(&TheMainState::onModelComponent_preInit,this) );
+		mModelMgr.subscribeToPostInitializeComponentSignal( Bind2(&TheMainState::onModelComponent_postInit,this) );
 
 
 

Modified: trunk/yake/src/yapp/vehicle/yakeVehicleModelComponentCreator.cpp
===================================================================
--- trunk/yake/src/yapp/vehicle/yakeVehicleModelComponentCreator.cpp	2006-07-26 19:07:07 UTC (rev 1406)
+++ trunk/yake/src/yapp/vehicle/yakeVehicleModelComponentCreator.cpp	2006-07-26 19:36:09 UTC (rev 1407)
@@ -54,22 +54,18 @@
 	void VehicleModelComponentCreator::create(const model::ComponentCreationContext& ctx, const StringMap& params)
 	{
 		// Verify validity of creation context
-		physics::IWorld* pPWorld = ctx.pworld_;
+		physics::IWorld* pPWorld = ctx.getPhysicalWorld();
 		YAKE_ASSERT( pPWorld );
 		if (!pPWorld)
 			return;
 
 		// Extract parameters
 
+		const String name = ctx.getName();
+
 		StringMap::const_iterator itParam = params.find("file");
 		const String fn = (itParam == params.end()) ? "" : itParam->second;
 
-		itParam = params.find("name");
-		YAKE_ASSERT(itParam != params.end()).debug("Missing parameter 'name'.");
-		if (itParam == params.end())
-			return;
-		const String name = itParam->second;
-
 		itParam = params.find("physical");
 		YAKE_ASSERT(itParam != params.end()).debug("Missing parameter 'physical'.");
 		if (itParam == params.end())
@@ -86,17 +82,9 @@
 
 		IVehicleSystem* vehSys = 0;
 		{
-			model::ComponentCreationContext::ParamMap::const_iterator it = ctx.params_.find("vehicleSystem");
-			YAKE_ASSERT(it != ctx.params_.end()).debug("Missing context parameter 'vehicleSystem'.");
-			if (it == ctx.params_.end())
+			const bool success = ctx.getParamValueAs<vehicle::IVehicleSystem*>("vehicleSystem",vehSys);
+			YAKE_ASSERT( success )(name).debug("Failed to retrieve IVehicleSystem interface from context parameter!");
 				return;
-			try {
-				vehSys = boost::any_cast<vehicle::IVehicleSystem*>(it->second);
-			} catch (boost::bad_any_cast& e)
-			{
-				YAKE_ASSERT( 0 )(name).debug(String("Failed to retrieve IVehicleSystem interface from context parameter! (") + e.what() + ")");
-				return;
-			}
 			YAKE_ASSERT( vehSys )(name).debug("IVehicleSystem interface not set.");
 			if (!vehSys)
 				return;
@@ -113,9 +101,7 @@
 
 		// Retrieve 'Physical'
 
-		YAKE_ASSERT( ctx.model_ );
-
-		model::Physical* pPhysical = dynamic_cast<model::Physical*>(ctx.model_->getComponentByTag(physicalTag));
+		model::Physical* pPhysical = dynamic_cast<model::Physical*>(ctx.getModel().getComponentByTag(physicalTag));
 		YAKE_ASSERT( pPhysical )(physicalTag)(name).debug("Failed to retrieve Physical.");
 
 		// Instantiate template vehicle
@@ -129,7 +115,7 @@
 		VehicleModelComponent* c = new VehicleModelComponent(pVehicle);
 		YAKE_ASSERT( c );
 
-		ctx.model_->addComponent( c, name );
+		ctx.getModel().addComponent( c, name );
 
 		return;
 	}

Modified: trunk/yake/yake/model/model_component.h
===================================================================
--- trunk/yake/yake/model/model_component.h	2006-07-26 19:07:07 UTC (rev 1406)
+++ trunk/yake/yake/model/model_component.h	2006-07-26 19:36:09 UTC (rev 1407)
@@ -80,7 +80,7 @@
 
 	/** Contextual information on component creation time.
 	*/
-	struct ComponentCreationContext
+	struct YAKE_MODEL_API ComponentCreationContext
 	{
 		ComponentCreationContext(ModelCreationContext& modelCtx, const String& name = "");
 
@@ -97,7 +97,7 @@
 		bool getParamValue(const String&,boost::any&) const;
 
 		template<typename OutT>
-		bool getParamValueAs(const String&,OutT&) const
+		bool getParamValueAs(const String& key,OutT& out) const
 		{
 			ModelCreationContext::ParamMap::const_iterator it = modelCtx_.params_.find(key);
 			if (it == modelCtx_.params_.end())



From codeandroid at mail.berlios.de  Wed Jul 26 21:37:04 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Wed, 26 Jul 2006 21:37:04 +0200
Subject: [Yake-svn] r1408 - trunk/yake/documentation/manual
Message-ID: <200607261937.k6QJb4vk032288@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-26 21:37:01 +0200 (Wed, 26 Jul 2006)
New Revision: 1408

Removed:
   trunk/yake/documentation/manual/YakeManual-Components.xml
   trunk/yake/documentation/manual/YakeManual-Introduction.xml
   trunk/yake/documentation/manual/YakeManual-QuickStartGuide.xml
   trunk/yake/documentation/manual/YakeManual.xml
Log:
deprecated (replaced by a seperate project)

Deleted: trunk/yake/documentation/manual/YakeManual-Components.xml
===================================================================
--- trunk/yake/documentation/manual/YakeManual-Components.xml	2006-07-26 19:36:09 UTC (rev 1407)
+++ trunk/yake/documentation/manual/YakeManual-Components.xml	2006-07-26 19:37:01 UTC (rev 1408)
@@ -1,128 +0,0 @@
-<article>
-	<title>yake::base</title>
-	<articleinfo>
-		<title>yake::base</title>
-	</articleinfo>
-	<section>
-		<title>Overview</title>
-		<para>Yake::base is, as the name implies, the basis for everything else that makes up Yake and Yapp.
-		It provides functionality in a wide range of applications, from templates (Signals, Containers, meta programming helpers, factories etc) to
-		common base interfaces (Movable etc) or data access (e.g. streams) and more.
-		</para>
-		<para>A few of the more complex concepts will be described in more depth as they are often used and/or essential for
-		effective use of Yake. For example, abstract factory plugins.
-		</para>
-		<para>[TODO]
-		</para>
-	</section>
-</article>
-<article>
-	<title>Components</title>
-	<articleinfo>
-		<title>Components</title>
-	</articleinfo>
-	<section>
-		<title>Introduction and Design</title>
-		<subtitle>What are components? And what part do they play in the whole?</subtitle>
-		<para>Components are the core elements of Yake. Component loosely defines a collection of functionality.
-		The concrete implementation can be very different. Many components are abstract components, i.e.
-		they (additionally) provide abstract interfaces so that they are independent of underlying APIs.
-		</para>
-		<para>For example, the graphics component provides interfaces which have to be implemented for a specific
-		API in order to be usable. Often these implementations reside in dynamic link libraries (i.e. a DLL on windows,
-		.so on Linux). For example, the graphicsOGRE plugin is an implementation of the graphics interfaces
-		using OGRE (Object-oriented Graphics Rendering Engine, http://www.ogre3d.org).
-		</para>
-	</section>
-	<section>
-		<title>yake::graphics /todo</title>
-		<subtitle>Get seen!</subtitle>
-	</section>
-	<section>
-		<title>yake::physics /todo</title>
-	</section>
-	<section>
-		<title>yake::vfs /todo</title>
-		<subtitle>Virtual File System</subtitle>
-	</section>
-	<section>
-		<title>yake::data</title>
-		<subtitle>Storage, Parsing, Interpreting</subtitle>
-		<para>yake::data is mainly about parsing and interpreting. If you want to know more about data access or transfer please
-		refer to the documentation of yake::vfs ( virtual file systems, local and remote ), yake::network or yake::base( for basic streams ).
-		</para>
-		<section>
-			<title>DOM Serializer - yake::data::dom</title>
-			<para>The DOM (Document Object Model) serializer interfaces allow serialization (reading/writing) of (typically hierarchically) structured data.
-			</para>
-			<section>
-				<title>Storage format independence</title>
-				<para>Concrete serializer implementations can provide different storage methods. For example,
-				the yake::data::dom::xml::XmlSerializer provides the means to parse text based XML files.
-				Other implementations may use a binary storage format or streamed data access.
-				</para>
-				<para>Of course, they can be implemented in plugins and registered to the serializer factory at runtime.
-				</para>
-				<para>Please refer to the Yake API documentation to find out more about the existing core serializers.
-				</para>
-			</section>
-		</section>
-		<section>
-			<title>Parser - yake::data::parser</title>
-			<para>Parsers create structured data for use with interpreters.
-			</para>
-			<para>For example, the DotSceneParser uses a DOM tree (see yake::data DOM Serializer) to read data using the
-			dotScene description format. User applications can subscribe to signals and/or query the parser in order to
-			create the graphical objects that represent the scene (see yake::graphics for more information on the graphics
-			interfaces).
-			</para>
-		</section>
-		<section>
-			<title>Interpreter</title>
-			<para>An interpreter is any kind of code that subscribes to a parser and creates concrete objects from the
-			logic data provided by the parser.
-			</para>
-			<para>For example, a GraphicsSceneInterpreter may be used to actually create the graphical scene from the data
-			provided by a dotSceneParser.
-			</para>
-		</section>
-	</section>
-	<section>
-		<title>yake::scripting</title>
-		<subtitle>Customization/Modding without recompiling your application!</subtitle>
-		<section><title>Virtual Machines</title>
-			<para>Virtual machines execute script code. In Yake they are represented by an abstract interface(yake::scripting::IVM)
-			and they are created by scripting systems (yake::scripting::IScriptingSystem). For each scripting language there needs
-			to be a specialized scripting system which is capable of creating specialized scripting objects (virtual machines and scripts).
-			</para>
-			<para>Generally it should be possible to create any number of virtual machines.
-			</para>
-		</section>
-		<section><title>Scripts</title>
-			<para>Scripts represent the scripting language dependent code that is fed to virtual machine to be executed >:)
-			For example, for the Lua scripting virtual machines this can either represent source code or precompiled byte code.
-			</para>
-			<para>Possible script types (derived from yake::scripting::IScript) include procedural scripts
-			(created from a string at runtime, for example) and scripts read from a data source (like from a file).
-			</para>
-		</section>
-		<section><title>Binder</title>
-			<para>The binder interface is used to bind objects, classes, functions, variables etc to a scripting virtual machine.
-				The binder implementation decides what to bind (which classes, objects, free functions etc).
-				There can be any amount of binders. The application logic has to decide when to use which binder, i.e. what features
-				it wants to be bound to a specific VM. For example, the VM used to run GUI scripts may not need access to the physics system.
-				Of course, that's just an example to illustrate the point.
-			</para>
-		</section>
-	</section>
-	<section>
-		<title>yake::audio</title>
-		<subtitle>Get heard!</subtitle>
-		<para>The audio system is pretty straight-forward. Worlds are made up of sources, occluders and listeners.
-		The exact feature set depends on the implementation (3D support, etc).
-		</para>
-		<para>Sources are any kind of audible objects. Listeners do what their name implies. They often represent the ears
-		of the player in a game, for example.
-		</para>
-	</section>
-</article>
\ No newline at end of file

Deleted: trunk/yake/documentation/manual/YakeManual-Introduction.xml
===================================================================
--- trunk/yake/documentation/manual/YakeManual-Introduction.xml	2006-07-26 19:36:09 UTC (rev 1407)
+++ trunk/yake/documentation/manual/YakeManual-Introduction.xml	2006-07-26 19:37:01 UTC (rev 1408)
@@ -1,80 +0,0 @@
-<article>
-	<title>Introduction</title>
-	<articleinfo>
-		<title>Introduction</title>
-	</articleinfo>
-	<toc></toc>
-	<sect1>
-		<title>Introduction</title>
-		<para>Yake is a light-weight and powerful, object-oriented and cross-platform application framework written in C++.  While originally targetted towards games other types of applications can also benefit from Yake.  We, the Yake developers, think that an additional dependency to a project should be as non-intrusive as possible. That approach enables developers to decide at any time whether to use the whole or just a subset of Yake&apos;s functionality.</para>
-	</sect1>
-	<sect1>
-		<title>Features</title>
-		<para>Yake 0.1 provides functionality in the following areas: </para>
-		<itemizedlist>
-			<listitem>
-				<para>functionality for math, containers, signals, factories, ...</para>
-			</listitem>
-			<listitem>
-				<para>system interfaces with any amount of pluggable implementations for graphics, physics, scripting and input systems</para>
-			</listitem>
-		</itemizedlist>
-		<para>Yake 0.2 will add the following features:</para>
-		<itemizedlist>
-			<listitem>
-				<para>specialized systems for GUI and VFS</para>
-			</listitem>
-			<listitem>
-				<para>system interfaces with any amount of pluggable implementations for audio and collision detection systems</para>
-			</listitem>
-			<listitem>
-				<para>serialization and persistance</para>
-			</listitem>
-			<listitem>
-				<para>room for future optimizations (containers, converters, ...)</para>
-			</listitem>
-		</itemizedlist>
-		<para>Yake 0.3 adds these features:</para>
-		<itemizedlist>
-			<listitem>
-				<para>system interfaces with any amount of pluggable implementations for network system</para>
-			</listitem>
-			<listitem>
-				<para>resource management</para>
-			</listitem>
-			<listitem>
-				<para>reflection (static, dynamic)</para>
-			</listitem>
-			<listitem>
-				<para>replication (distributed networked objects)</para>
-			</listitem>
-		</itemizedlist>
-		<para>Currently the following <emphasis role="bold">plugins</emphasis> exist and are maintained by the Yake Team. They can be replaced by other implementations or you can run them in parallel if you really want to.
-		</para>
-		<itemizedlist>
-			<listitem>
-				<para>graphics system: based on OGRE (Object-Oriented Graphics Rendering Engine), a cross-platform  multi-purpose rendering engine.</para>
-			</listitem>
-			<listitem>
-				<para>audio system: based on OpenAL++</para>
-			</listitem>
-			<listitem>
-				<para>physics system: based on OpenDE (Open Dynamics Engine)</para>
-			</listitem>
-			<listitem>
-				<para>scripting system: based on Lua and Luabind</para>
-			</listitem>
-			<listitem>
-				<para>input system: based on OGRE</para>
-			</listitem>
-		</itemizedlist>
-	</sect1>
-	<sect1>
-		<title>About this manual</title>
-		<para>The latest version of this manual can be found at http://yake.org.</para>
-		<para>As it is now, this manual is work-in-progress. It is not (yet) intended to document each and  every feature. We started to work on the most pressing things first, mainly Yake&apos;s architecture  and Quick Start Guides to different, often used feature sets.</para>
-		<para>This manual is intended to serve as a reference in addition to the Yake API Documentation and the samples  shipping with Yake. </para>
-		<para>That said, have fun :)</para>
-		<para>The Yake Team</para>
-	</sect1>
-</article>

Deleted: trunk/yake/documentation/manual/YakeManual-QuickStartGuide.xml
===================================================================
--- trunk/yake/documentation/manual/YakeManual-QuickStartGuide.xml	2006-07-26 19:36:09 UTC (rev 1407)
+++ trunk/yake/documentation/manual/YakeManual-QuickStartGuide.xml	2006-07-26 19:37:01 UTC (rev 1408)
@@ -1,88 +0,0 @@
-<article>
-	<title>Quick Start Guide</title>
-	<articleinfo>
-		<title>Quick Start Guide</title>
-	</articleinfo>
-	<sect1>
-		<title>Obtaining the sources</title>
-		<para>Please visit http://yake.org for current information on how to obtain the sources to Yake.
-		</para>
-		<para>In general, there are three possibilities:
-			<itemizedlist>
-				<listitem>Major releases (e.g. yake 0.3): Introduces major features, may include major changes. Generally stable code base.</listitem>
-				<listitem>Minor releases (e.g. yake 0.3.1): Mainly bug fixes and smaller changes.</listitem>
-				<listitem>Unstable snapshots (e.g. yake 0.4-dev): Introduces major features and/or changes but code may still be in experimental stage. No guarantees for anything :)</listitem>
-			</itemizedlist>
-			The source code is released in archived files on http://yake.org or can be obtained through CVS. Please visit the website for more detailed information
-			on how to access the Yake CVS repository.
-		</para>
-	</sect1>
-	<sect1>
-		<title>Dependencies</title>
-		<para>The Yake <emphasis role="bold">core</emphasis> libraries (e.g. base, graphics, scripting, ...) depend on the following external libraries/products:
-			<itemizedlist>
-				<listitem>boost (headers only): available through http://boost.org</listitem>
-				<listitem>ttl (headers only): available through http://tinytl.sourceforge.net</listitem>
-				<listitem>Loki (headers only) [to be removed as it gets "boostified"]</listitem>
-				<listitem>TinyXML: available through http://www.grinninglizard.com/tinyxml</listitem>
-			</itemizedlist>
-			For each release, at least each major release, a dependency package is available.
-			This normally includes stripped down versions of the above libraries.
-		</para>
-		<para>Certain <emphasis role="bold">plugins</emphasis> have special requirements regarding external libraries.
-		For example, the graphicsOGRE plugin requires OGRE (http://www.ogre3d.org).</para>
-		<para>The file (YAKEROOT)/dependencies/DEPENDENCIES has more information on how the directory structure is expected to be layed out in order
-		for those plugins to compile without any modifications to the project/build settings.
-		</para>
-		<para>From time to time we may provide <emphasis role="bold">prebuilt</emphasis> libraries for the dependencies as it can be quite tedious to compile all these
-		yourself. There are disadvantages to this approach, though: You are dependent on the build environment we used to compile the libraries.
-		For example, if we build the libraries using VC7.1 + STLport 4.6 you'll have a big problem (not to say it's plain impossible) to use them
-		in a project that uses either the MS STL or another version of STLport.
-		</para>
-		<para>We certainly won't be able to provide libraries for each and
-		every combination of compiler and STL and other dependencies. We expect the user attempting to use Yake either adhere to these restrictions or have enough knowledge to compile the dependencies
-		themselves. All these dependencies are established projects, meaning they come with good to very good documentation and detailed
-		installation instructions. Furtheremore there are many forums and mailing lists dealing with (nearly) any possible issue that can be encountered during a build.
-		</para>
-	</sect1>
-	<sect1>
-		<title>Building Yake</title>
-		<para>Please note that this chapter is just a quick introduction. We expect the developer
-		attempting to use Yake to know how to use the build tools of his choice.
-		</para>
-		<sect2>
-			<title>Windows (using VC7.1)</title>
-			<orderedlist>
-				<listitem>Extract the sources into a folder of your choice, let's call it YAKEHOME.</listitem>
-				<listitem>Extract the dependencies package into YAKEHOME. Verify correct extraction (mainly that files are in the correct folders)!</listitem>
-				<listitem>Open the solution file YAKEHOME/scripts/yake.sln in the VC7.1 IDE.</listitem>
-				<listitem>Right-click on the solution in the solution explorer and choose "Build All" or "Batch build".</listitem>
-				<listitem>If the build process was successful you will find the import libraries located in YAKEHOME/common/lib/[debug|release], the dynamic link libraries as well as the sample executables in YAKEHOME/common/bin/[debug|release].</listitem>
-			</orderedlist>
-		</sect2>
-		<sect2>
-			<title>Windows (using Visual C++ 2003 Toolkit)</title>
-			<para>Makefiles are not yet available. We are currently investigating how to support this option. There is a certain amount
-			of maintenance effort involved. We try to find an automated way to generate makefiles from existing solution files (.sln) (or an alternative build system).
-			</para>
-		</sect2>
-		<sect2>
-			<title>Other platforms (Linux, MacOS X)</title>
-			<para>Officially supported build environments for Linux will be available soon.
-			</para>
-			<para>As no member of the Yake team has access to MacOS X we cannot provide ready-to-use build tools for the time being.
-			Contributions are welcome.
-			</para>
-		</sect2>
-	</sect1>
-	<sect1>
-		<title>The Samples</title>
-		<para>The samples are mostly short and self-explaining. They are documented in code and we are generally careful to provide
-		code that is easy to understand. There are a few samples which demonstrate more complicated techniques which
-		may not be obvious at just a quick glance. At least, it can be easier to grasp with a short amount of documentation to
-		them.</para>
-		<sect2>
-			<title>Registry Samples /todo</title>
-		</sect2>
-	</sect1>
-</article>

Deleted: trunk/yake/documentation/manual/YakeManual.xml
===================================================================
--- trunk/yake/documentation/manual/YakeManual.xml	2006-07-26 19:36:09 UTC (rev 1407)
+++ trunk/yake/documentation/manual/YakeManual.xml	2006-07-26 19:37:01 UTC (rev 1408)
@@ -1,17 +0,0 @@
-<?xml version="1.0" encoding="windows-1252"?>
-<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
-               "http://www.altova.com/schemas/docbook/docbookx.dtd" [
-               <!ENTITY introduction SYSTEM "YakeManual-Introduction.xml">
-               <!ENTITY quickstartguide SYSTEM "YakeManual-QuickStartGuide.xml">
-               <!ENTITY components SYSTEM "YakeManual-Components.xml">
-]>
-<?xml-stylesheet type="text/xsl" href="http://www.altova.com/stylesheets/docbook/xhtml/docbook.xsl"?>
-<book>
-	<bookinfo>
-		<title>YAKE Manual</title>
-		<subtitle>Cross-platform, lightweight application and game framework</subtitle>
-	</bookinfo>
-	&introduction;
-	&quickstartguide;
-	&components;
-</book>
\ No newline at end of file



From codeandroid at mail.berlios.de  Wed Jul 26 21:37:37 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Wed, 26 Jul 2006 21:37:37 +0200
Subject: [Yake-svn] r1409 - trunk/yake/documentation/manual
Message-ID: <200607261937.k6QJbbY0032416@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-26 21:37:36 +0200 (Wed, 26 Jul 2006)
New Revision: 1409

Removed:
   trunk/yake/documentation/manual/README
Log:
superfluous file - contained no real information

Deleted: trunk/yake/documentation/manual/README
===================================================================
--- trunk/yake/documentation/manual/README	2006-07-26 19:37:01 UTC (rev 1408)
+++ trunk/yake/documentation/manual/README	2006-07-26 19:37:36 UTC (rev 1409)
@@ -1,2 +0,0 @@
-
-The information on http//www.yake.org/wiki is more uptodate.
\ No newline at end of file



From codeandroid at mail.berlios.de  Wed Jul 26 23:45:44 2006
From: codeandroid at mail.berlios.de (codeandroid at BerliOS)
Date: Wed, 26 Jul 2006 23:45:44 +0200
Subject: [Yake-svn] r1410 - trunk/yake/scripts/msvc8
Message-ID: <200607262145.k6QLjipW022600@sheep.berlios.de>

Author: codeandroid
Date: 2006-07-26 23:45:44 +0200 (Wed, 26 Jul 2006)
New Revision: 1410

Modified:
   trunk/yake/scripts/msvc8/model.vcproj
   trunk/yake/scripts/msvc8/yake.sln
Log:


Modified: trunk/yake/scripts/msvc8/model.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/model.vcproj	2006-07-26 19:37:36 UTC (rev 1409)
+++ trunk/yake/scripts/msvc8/model.vcproj	2006-07-26 21:45:44 UTC (rev 1410)
@@ -244,6 +244,10 @@
 				>
 			</File>
 			<File
+				RelativePath="..\..\src\yake\model\yakeModelComponent.cpp"
+				>
+			</File>
+			<File
 				RelativePath="..\..\src\yake\model\yakeModelComponentContainer.cpp"
 				>
 			</File>

Modified: trunk/yake/scripts/msvc8/yake.sln
===================================================================
--- trunk/yake/scripts/msvc8/yake.sln	2006-07-26 19:37:36 UTC (rev 1409)
+++ trunk/yake/scripts/msvc8/yake.sln	2006-07-26 21:45:44 UTC (rev 1410)
@@ -9,8 +9,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "graphicsOGRE", "plugins\graphics\graphicsOgre.vcproj", "{A2C2A0B2-2EB0-4254-891D-FE93466809CF}"
 	ProjectSection(ProjectDependencies) = postProject
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "physics", "physics.vcproj", "{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}"
@@ -20,8 +20,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "physicsODE", "plugins\physics\physicsODE.vcproj", "{2F5124AA-56BD-4909-811A-E79901978C86}"
 	ProjectSection(ProjectDependencies) = postProject
+		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
 		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
-		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "input", "input.vcproj", "{1AF3930A-4E72-4455-AFD0-6B78684105CD}"
@@ -31,8 +31,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "inputOGRE", "plugins\input\inputOgre.vcproj", "{A1A2FE19-7B7E-42F1-808B-8FA5B6AA697E}"
 	ProjectSection(ProjectDependencies) = postProject
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 		{1AF3930A-4E72-4455-AFD0-6B78684105CD} = {1AF3930A-4E72-4455-AFD0-6B78684105CD}
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "scripting", "scripting.vcproj", "{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}"
@@ -42,8 +42,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "scriptingLua", "plugins\scripting\scriptingLua.vcproj", "{41CEA11B-9678-43E5-B2F4-754944D7B461}"
 	ProjectSection(ProjectDependencies) = postProject
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "data", "data.vcproj", "{77A59B89-C2B3-429C-8317-ADE0D046CC3B}"
@@ -53,8 +53,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "scriptingBindingsLua", "plugins\scripting\scriptingLuaBindings.vcproj", "{CA63F621-0912-4551-B51A-7BD18F491181}"
 	ProjectSection(ProjectDependencies) = postProject
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 		{41CEA11B-9678-43E5-B2F4-754944D7B461} = {41CEA11B-9678-43E5-B2F4-754944D7B461}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "audio", "audio.vcproj", "{42BB6F78-B04C-4968-AA5E-271DC45BEFBB}"
@@ -74,26 +74,26 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "graphicsBindingsLua", "plugins\scripting\graphicsLuaBindings.vcproj", "{2D5E8A7F-96DA-4CC5-BFC8-430916ACF18A}"
 	ProjectSection(ProjectDependencies) = postProject
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
+		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
 		{41CEA11B-9678-43E5-B2F4-754944D7B461} = {41CEA11B-9678-43E5-B2F4-754944D7B461}
-		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "baseBindingsLua", "plugins\scripting\baseLuaBindings.vcproj", "{3867E9A4-41F3-4969-B0A8-40757BCB6C29}"
 	ProjectSection(ProjectDependencies) = postProject
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 		{41CEA11B-9678-43E5-B2F4-754944D7B461} = {41CEA11B-9678-43E5-B2F4-754944D7B461}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "yapp", "yapp.vcproj", "{F1116FDF-65C1-4788-AC1F-F339279B937A}"
 	ProjectSection(ProjectDependencies) = postProject
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
+		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
+		{42BB6F78-B04C-4968-AA5E-271DC45BEFBB} = {42BB6F78-B04C-4968-AA5E-271DC45BEFBB}
+		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
 		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
-		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
-		{42BB6F78-B04C-4968-AA5E-271DC45BEFBB} = {42BB6F78-B04C-4968-AA5E-271DC45BEFBB}
-		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "raf", "raf.vcproj", "{6D6DD5E8-3B81-4C98-B460-B434DEE23EE2}"
@@ -107,6 +107,7 @@
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "vehicle", "vehicle.vcproj", "{EAEC3A1F-2888-4EAC-869D-BFA70FD56A65}"
 	ProjectSection(ProjectDependencies) = postProject
 		{F1116FDF-65C1-4788-AC1F-F339279B937A} = {F1116FDF-65C1-4788-AC1F-F339279B937A}
+		{6BB1D3EF-8836-4D23-BE24-340D310D9913} = {6BB1D3EF-8836-4D23-BE24-340D310D9913}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "object", "object.vcproj", "{CD73E4D1-5832-4DC1-8E65-06052BBD6F49}"
@@ -124,8 +125,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "terrainPhysMgr", "plugins\physics\terrainPhysMgr.vcproj", "{6FC81A1C-0463-45EB-94F9-F7D084E3C169}"
 	ProjectSection(ProjectDependencies) = postProject
+		{2F5124AA-56BD-4909-811A-E79901978C86} = {2F5124AA-56BD-4909-811A-E79901978C86}
 		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
-		{2F5124AA-56BD-4909-811A-E79901978C86} = {2F5124AA-56BD-4909-811A-E79901978C86}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "model", "model.vcproj", "{6BB1D3EF-8836-4D23-BE24-340D310D9913}"



