From codeandroid at berlios.de  Sun Mar  5 02:11:29 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 02:11:29 +0100
Subject: [Yake-svn] r1208 - in trunk/yake/yake/base: . native native/win32
Message-ID: <200603050111.k251BT5h023212@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 02:11:22 +0100 (Sun, 05 Mar 2006)
New Revision: 1208

Modified:
   trunk/yake/yake/base/native/win32/yakeConfig.h
   trunk/yake/yake/base/native/win32/yakeProcessor.h
   trunk/yake/yake/base/native/yakeNative.h
   trunk/yake/yake/base/yakeCriticalSection.h
   trunk/yake/yake/base/yakeProcessor.h
Log:
removed namespace base

Modified: trunk/yake/yake/base/native/win32/yakeConfig.h
===================================================================
--- trunk/yake/yake/base/native/win32/yakeConfig.h	2006-02-12 16:08:15 UTC (rev 1207)
+++ trunk/yake/yake/base/native/win32/yakeConfig.h	2006-03-05 01:11:22 UTC (rev 1208)
@@ -40,8 +40,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace native
 {
 namespace win32
@@ -51,7 +49,6 @@
 
 } // win32
 } // native
-} // base
 } // yake
 
 #endif // YAKE_BASE_NATIVE_WIN32_CONFIG_H

Modified: trunk/yake/yake/base/native/win32/yakeProcessor.h
===================================================================
--- trunk/yake/yake/base/native/win32/yakeProcessor.h	2006-02-12 16:08:15 UTC (rev 1207)
+++ trunk/yake/yake/base/native/win32/yakeProcessor.h	2006-03-05 01:11:22 UTC (rev 1208)
@@ -15,8 +15,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 
 // Options:
 ///////////
@@ -159,7 +157,6 @@
 	bool WriteInfoTextFile(const char *strFilename);
 };
 
-} // base
 } // yake
 
 #endif
\ No newline at end of file

Modified: trunk/yake/yake/base/native/yakeNative.h
===================================================================
--- trunk/yake/yake/base/native/yakeNative.h	2006-02-12 16:08:15 UTC (rev 1207)
+++ trunk/yake/yake/base/native/yakeNative.h	2006-03-05 01:11:22 UTC (rev 1208)
@@ -43,8 +43,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace native
 {
 
@@ -85,7 +83,6 @@
 YAKE_BASE_NATIVE_API char* getApplicationDir();
 
 } // native
-} // base
 } // yake
 
 #endif // YAKE_BASE_NATIVE_NATIVE_H

Modified: trunk/yake/yake/base/yakeCriticalSection.h
===================================================================
--- trunk/yake/yake/base/yakeCriticalSection.h	2006-02-12 16:08:15 UTC (rev 1207)
+++ trunk/yake/yake/base/yakeCriticalSection.h	2006-03-05 01:11:22 UTC (rev 1208)
@@ -57,7 +57,7 @@
 
 // Data
 private:
-	base::native::CriticalSectionHandle mHandle;
+	native::CriticalSectionHandle mHandle;
 };
 
 } // yake

Modified: trunk/yake/yake/base/yakeProcessor.h
===================================================================
--- trunk/yake/yake/base/yakeProcessor.h	2006-02-12 16:08:15 UTC (rev 1207)
+++ trunk/yake/yake/base/yakeProcessor.h	2006-03-05 01:11:22 UTC (rev 1208)
@@ -44,8 +44,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 
 class Processor
 {
@@ -153,7 +151,6 @@
   Info   mInfo;
 };
 
-} // base
 } // yake
 
 #endif // YAKE_BASE_PROCESSOR_H



From codeandroid at berlios.de  Sun Mar  5 02:12:11 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 02:12:11 +0100
Subject: [Yake-svn] r1209 - in trunk/yake/src/yake/base: . native/win32
Message-ID: <200603050112.k251CBC7023444@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 02:12:02 +0100 (Sun, 05 Mar 2006)
New Revision: 1209

Modified:
   trunk/yake/src/yake/base/native/win32/yakeConfig.cpp
   trunk/yake/src/yake/base/native/win32/yakeCriticalSection.cpp
   trunk/yake/src/yake/base/native/win32/yakeDebug.cpp
   trunk/yake/src/yake/base/native/win32/yakeLibrary.cpp
   trunk/yake/src/yake/base/yakeCriticalSection.cpp
Log:
removed namespace base

Modified: trunk/yake/src/yake/base/native/win32/yakeConfig.cpp
===================================================================
--- trunk/yake/src/yake/base/native/win32/yakeConfig.cpp	2006-03-05 01:11:22 UTC (rev 1208)
+++ trunk/yake/src/yake/base/native/win32/yakeConfig.cpp	2006-03-05 01:12:02 UTC (rev 1209)
@@ -38,8 +38,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace native
 {
 namespace win32
@@ -49,14 +47,13 @@
 
 } // win32
 } // native
-} // base
 } // yake
 
 #ifdef DLL_BUILD
 BOOL WINAPI DllMain( HINSTANCE hInstance, DWORD dwReason, LPVOID )
 {
 	if( dwReason == DLL_PROCESS_ATTACH )
-		yake::base::native::win32::g_hInstance = hInstance;
+		yake::native::win32::g_hInstance = hInstance;
 
 	return TRUE;
 }

Modified: trunk/yake/src/yake/base/native/win32/yakeCriticalSection.cpp
===================================================================
--- trunk/yake/src/yake/base/native/win32/yakeCriticalSection.cpp	2006-03-05 01:11:22 UTC (rev 1208)
+++ trunk/yake/src/yake/base/native/win32/yakeCriticalSection.cpp	2006-03-05 01:12:02 UTC (rev 1209)
@@ -36,8 +36,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace native
 {
 
@@ -69,5 +67,4 @@
 }
 
 } // native
-} // base
 } // yake
\ No newline at end of file

Modified: trunk/yake/src/yake/base/native/win32/yakeDebug.cpp
===================================================================
--- trunk/yake/src/yake/base/native/win32/yakeDebug.cpp	2006-03-05 01:11:22 UTC (rev 1208)
+++ trunk/yake/src/yake/base/native/win32/yakeDebug.cpp	2006-03-05 01:12:02 UTC (rev 1209)
@@ -42,8 +42,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace native
 {
 
@@ -179,5 +177,4 @@
 
 
 } // native
-} // base
 } // yake

Modified: trunk/yake/src/yake/base/native/win32/yakeLibrary.cpp
===================================================================
--- trunk/yake/src/yake/base/native/win32/yakeLibrary.cpp	2006-03-05 01:11:22 UTC (rev 1208)
+++ trunk/yake/src/yake/base/native/win32/yakeLibrary.cpp	2006-03-05 01:12:02 UTC (rev 1209)
@@ -42,8 +42,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace native
 {
 
@@ -77,5 +75,4 @@
 
 
 } // native
-} // base
 } // yake

Modified: trunk/yake/src/yake/base/yakeCriticalSection.cpp
===================================================================
--- trunk/yake/src/yake/base/yakeCriticalSection.cpp	2006-03-05 01:11:22 UTC (rev 1208)
+++ trunk/yake/src/yake/base/yakeCriticalSection.cpp	2006-03-05 01:12:02 UTC (rev 1209)
@@ -42,7 +42,7 @@
 CriticalSection::CriticalSection()
 {
 	YAKE_DECLARE_FUNCTION( CriticalSection )
-	mHandle = base::native::criticalSection_Create();
+	mHandle = native::criticalSection_Create();
 
 	if( 0 == mHandle )
 		YAKE_EXCEPT( "Couldn't create critical section." );
@@ -51,18 +51,18 @@
 CriticalSection::~CriticalSection()
 {
 	if( 0 != mHandle )
-		base::native::criticalSection_Delete( mHandle );
+		native::criticalSection_Delete( mHandle );
 }
 
 
 void CriticalSection::enter()
 {
-	yake::base::native::criticalSection_Enter( mHandle );
+	native::criticalSection_Enter( mHandle );
 }
 
 void CriticalSection::leave()
 {
-	yake::base::native::criticalSection_Leave( mHandle );
+	native::criticalSection_Leave( mHandle );
 }
 
 } // yake



From codeandroid at berlios.de  Sun Mar  5 02:17:34 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 02:17:34 +0100
Subject: [Yake-svn] r1210 - trunk/yake/src/yapp
Message-ID: <200603050117.k251HYc7024482@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 02:16:31 +0100 (Sun, 05 Mar 2006)
New Revision: 1210

Removed:
   trunk/yake/src/yapp/statemachine/
Log:
deprecated



From codeandroid at berlios.de  Sun Mar  5 02:19:52 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 02:19:52 +0100
Subject: [Yake-svn] r1211 - trunk/yake/yapp
Message-ID: <200603050119.k251Jq4p024889@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 02:19:39 +0100 (Sun, 05 Mar 2006)
New Revision: 1211

Removed:
   trunk/yake/yapp/statemachine/
Log:
deprecated



From codeandroid at berlios.de  Sun Mar  5 19:29:33 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:29:33 +0100
Subject: [Yake-svn] r1212 - in trunk/yake/src/yake/samples: . ent ent/sampleEntFsm
Message-ID: <200603051829.k25ITXBj026469@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:29:22 +0100 (Sun, 05 Mar 2006)
New Revision: 1212

Added:
   trunk/yake/src/yake/samples/ent/
   trunk/yake/src/yake/samples/ent/sampleEntFsm/
   trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp
Log:
initial revision

Added: trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp
===================================================================
--- trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp	2006-03-05 01:19:39 UTC (rev 1211)
+++ trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp	2006-03-05 18:29:22 UTC (rev 1212)
@@ -0,0 +1,81 @@
+//#include "yake/base/yakePrerequisites.h"
+#include "yake/base/yake.h"
+#include "yake/ent/ent.h"
+#include "yake/plugins//entLua/entLua.h"
+
+using namespace yake;
+
+namespace exapp {
+	// Commonly used states for this application's objects.
+	const std::string ksAwakening = "awakening";
+	const std::string ksAlive = "alive";
+	const std::string ksDead = "dead";
+	
+	/** Listens to object manager and initializes newly created objects by adding
+		a Lua VM, adding default states and transitions to the state machine etc.
+	*/
+	struct ExampleAppObjectMgrListener : public object::ObjectManagerListener
+	{
+		ExampleAppObjectMgrListener(scripting::IScriptingSystem& scriptingSys) : scriptingSys_(scriptingSys)
+		{}
+		virtual void onObjectCreated(object::Object* obj)
+		{
+			scripting::IVM* vm = scriptingSys_.createVM();
+			YAKE_ASSERT( vm );
+
+			obj->attachVM(vm,"main");
+		}
+		virtual void onObjectInitialized(object::Object* obj)
+		{
+			obj->addFsmState(ksAwakening);
+			obj->addFsmState(ksAlive);
+			obj->addFsmState(ksDead);
+
+			obj->addFsmTransition(ksAwakening,"spawn",ksAlive);
+			obj->addFsmTransition(ksAlive,"die",ksDead);
+
+			obj->setFsmState(ksAwakening);
+		}
+	private:
+		scripting::IScriptingSystem&	scriptingSys_;
+	};
+} // namespace exapp
+
+int main(int argc, char* argv[])
+{
+
+	// Create the scripting system we want to use (Lua).
+	SharedPtr<scripting::IScriptingSystem> luaSys = templates::create<scripting::IScriptingSystem>("lua");
+	YAKE_ASSERT( luaSys.get() );
+
+	// Create an object manager which manages creation, initialization and destruction of objects.
+	object::ObjectManager objMgr;
+
+	// Create & attach the listener which handles the connection to the Lua VM and the bindings.
+	object::LuaObjectManagerListener luaFmsObjListener(*luaSys);
+	objMgr.attachListener( &luaFmsObjListener, "luaFsm", object::ObjectManager::kKeepOwnership );
+
+	// Example listener which sets the objects up for our example application :)
+	// The listener adds default states and transitions to the object's state machine, for example.
+	SharedPtr<exapp::ExampleAppObjectMgrListener> exappObjInitializer( new exapp::ExampleAppObjectMgrListener(*luaSys) );
+	objMgr.attachListener( exappObjInitializer.get(), "exapp_listener", object::ObjectManager::kKeepOwnership );
+
+	// Let's create an object.
+	object::Object* o = objMgr.makeObject();
+	YAKE_ASSERT( o );
+
+	// NB At this point the FSM is set up by the exapp listener!
+
+	// Do some processing:
+	o->processFsmEvent("spawn");
+	objMgr.tick(); // triggers o->tick()
+	objMgr.tick();
+	o->processFsmEvent("die");
+
+	//@todo use scheduler for yield/resume functionality. (code in prototype is in fsm2_lua.cpp)
+	//o->getVM().resume();
+
+	exappObjInitializer.reset();
+	luaSys.reset();
+}
+



From codeandroid at berlios.de  Sun Mar  5 19:40:19 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:40:19 +0100
Subject: [Yake-svn] r1220 - trunk/yake/yake/prop
Message-ID: <200603051840.k25IeJWF030954@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:40:01 +0100 (Sun, 05 Mar 2006)
New Revision: 1220

Added:
   trunk/yake/yake/prop/yakeProperty.h
Log:
initial revision

Added: trunk/yake/yake/prop/yakeProperty.h
===================================================================
--- trunk/yake/yake/prop/yakeProperty.h	2006-03-05 18:39:30 UTC (rev 1219)
+++ trunk/yake/yake/prop/yakeProperty.h	2006-03-05 18:40:01 UTC (rev 1220)
@@ -0,0 +1,10 @@
+#ifndef YAKE_PROPERTY_H
+#define YAKE_PROPERTY_H
+
+#include "yake/prop/prerequisites.h"
+#include "yake/prop/prop_def.h"
+#include "yake/prop/prop.h"
+#include "yake/prop/prop_holder.h"
+#include "yake/prop/rtti_class.h"
+
+#endif



From codeandroid at berlios.de  Sun Mar  5 19:40:57 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:40:57 +0100
Subject: [Yake-svn] r1221 - trunk/yake/yake/scripting
Message-ID: <200603051840.k25IevXa031168@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:40:39 +0100 (Sun, 05 Mar 2006)
New Revision: 1221

Modified:
   trunk/yake/yake/scripting/yakeScriptingSystem.h
Log:
removed namespace base

Modified: trunk/yake/yake/scripting/yakeScriptingSystem.h
===================================================================
--- trunk/yake/yake/scripting/yakeScriptingSystem.h	2006-03-05 18:40:01 UTC (rev 1220)
+++ trunk/yake/yake/scripting/yakeScriptingSystem.h	2006-03-05 18:40:39 UTC (rev 1221)
@@ -38,7 +38,6 @@
 #endif
 
 namespace yake {
-	using namespace base;
 namespace scripting {
 	class IVM;
 }
@@ -49,6 +48,7 @@
 			To detect whether the scripting VM language is compatible, check the language of its creator
 			system and the description string and the version!
 	*/
+/*
 	class YAKE_SCRIPTING_API ScriptingRegistrationManager
 	{
 	protected:
@@ -57,7 +57,7 @@
 		void subscribeToRegisterScriptBindingsSignal( const RegisterScriptBindingsSignal::slot_type & slot );
 		void registerScriptBindings( scripting::IVM* pVM );
 	};
-
+*/
 namespace scripting {
 
 	class IScriptingSystem;



From codeandroid at berlios.de  Sun Mar  5 19:30:30 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:30:30 +0100
Subject: [Yake-svn] r1213 - in trunk/yake/src/yake: . ent
Message-ID: <200603051830.k25IUUAD026956@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:30:24 +0100 (Sun, 05 Mar 2006)
New Revision: 1213

Added:
   trunk/yake/src/yake/ent/
   trunk/yake/src/yake/ent/component.cpp
   trunk/yake/src/yake/ent/component_holder.cpp
   trunk/yake/src/yake/ent/object.cpp
   trunk/yake/src/yake/ent/object_listener.cpp
   trunk/yake/src/yake/ent/object_mgr.cpp
   trunk/yake/src/yake/ent/object_mgr_listener.cpp
   trunk/yake/src/yake/ent/pch.cpp
   trunk/yake/src/yake/ent/vm_holder.cpp
Log:
initial revision

Added: trunk/yake/src/yake/ent/component.cpp
===================================================================
--- trunk/yake/src/yake/ent/component.cpp	2006-03-05 18:29:22 UTC (rev 1212)
+++ trunk/yake/src/yake/ent/component.cpp	2006-03-05 18:30:24 UTC (rev 1213)
@@ -0,0 +1,10 @@
+#include "yake/ent/pch.h"
+#include "yake/ent/ent.h"
+
+namespace yake {
+namespace object {
+
+	IMPL_CLASS_RTTI(Co)
+} // namespace object
+} // namespace yake
+

Added: trunk/yake/src/yake/ent/component_holder.cpp
===================================================================
--- trunk/yake/src/yake/ent/component_holder.cpp	2006-03-05 18:29:22 UTC (rev 1212)
+++ trunk/yake/src/yake/ent/component_holder.cpp	2006-03-05 18:30:24 UTC (rev 1213)
@@ -0,0 +1,21 @@
+#include "yake/ent/pch.h"
+#include "yake/ent/ent.h"
+
+namespace yake {
+namespace object {
+
+	void CoHolder::addCo(const CoTag& tag, Co* co)
+	{
+		if (getCo(tag))
+			return; //@todo throw instead?
+		components_.insert( std::make_pair(tag, co) );
+	}
+	Co* CoHolder::getCo(const CoTag& tag) const
+	{
+		TagCoMap::const_iterator itFind = components_.find(tag);
+		return ((itFind == components_.end()) ? 0 : itFind->second);
+	}
+
+} // namespace object
+} // namespace yake
+

Added: trunk/yake/src/yake/ent/object.cpp
===================================================================
--- trunk/yake/src/yake/ent/object.cpp	2006-03-05 18:29:22 UTC (rev 1212)
+++ trunk/yake/src/yake/ent/object.cpp	2006-03-05 18:30:24 UTC (rev 1213)
@@ -0,0 +1,38 @@
+#include "yake/ent/pch.h"
+#include "yake/ent/ent.h"
+
+namespace yake {
+namespace object {
+
+	IMPL_CLASS_RTTI(Object)
+
+	void Object::processFsmEvent(const fsm_event_type& evt)
+	{
+		m_.processEventCb(evt,boost::bind(&Object::onEnter,this,_1,_2),boost::bind(&Object::onExit,this,_1,_2));
+		listeners_fsmEventHandled(*this,m_,evt);
+	}
+	void Object::addFsmState(const fsm_state_type& state)
+	{
+		m_.addState(state);
+	}
+	void Object::addFsmTransition(const fsm_state_type& from, const fsm_event_type& evt, const fsm_state_type& to)
+	{
+		m_.addTransition(from,evt,to);
+	}
+	void Object::setFsmState(const fsm_state_type& state)
+	{
+		m_.setState(state);
+	}
+	void Object::onEnter(const object_fsm& fsm, const object_fsm::state_type& state)
+	{
+		//std::cout << "object.state.enter '" << state << "'\n";
+		listeners_fsmEnterState(*this,fsm,state);
+	}
+	void Object::onExit(const object_fsm& fsm, const object_fsm::state_type& state)
+	{
+		//std::cout << "object.state.exit '" << state << "'\n";
+		listeners_fsmExitState(*this,fsm,state);
+	}
+
+}
+}
\ No newline at end of file

Added: trunk/yake/src/yake/ent/object_listener.cpp
===================================================================
--- trunk/yake/src/yake/ent/object_listener.cpp	2006-03-05 18:29:22 UTC (rev 1212)
+++ trunk/yake/src/yake/ent/object_listener.cpp	2006-03-05 18:30:24 UTC (rev 1213)
@@ -0,0 +1,8 @@
+#include "yake/ent/pch.h"
+#include "yake/ent/ent.h"
+
+namespace yake {
+namespace object {
+
+}
+}
\ No newline at end of file

Added: trunk/yake/src/yake/ent/object_mgr.cpp
===================================================================
--- trunk/yake/src/yake/ent/object_mgr.cpp	2006-03-05 18:29:22 UTC (rev 1212)
+++ trunk/yake/src/yake/ent/object_mgr.cpp	2006-03-05 18:30:24 UTC (rev 1213)
@@ -0,0 +1,69 @@
+#include "yake/ent/pch.h"
+#include "yake/ent/ent.h"
+
+namespace yake {
+namespace object {
+
+	Object* ObjectManager::makeObject()
+	{
+		Object* obj = new Object();
+		assert( obj );
+		objs_.push_back( obj );
+
+		listeners_onObjectCreated(obj);
+
+		obj->init();
+
+		listeners_onObjectInitialized(obj);
+
+		return obj;
+	}
+	void ObjectManager::destroyObject(Object* obj)
+	{
+		assert( obj );
+
+		listeners_onDestroyObject( obj );
+		//obj->shutdown();
+
+		object_ptr_list::iterator it = std::find(objs_.begin(),objs_.end(),obj);
+		if (it != objs_.end())
+			objs_.erase( it );
+
+		delete obj;
+	}
+	void ObjectManager::tick()
+	{
+		yake::ConstVectorIterator<object_ptr_list> it(objs_);
+		while (it.hasMoreElements())
+			it.getNext()->tick();
+	}
+	void ObjectManager::listeners_onObjectCreated(Object* obj)
+	{
+		assert( obj );
+		if (!obj)
+			return;
+		yake::ConstVectorIterator<listener_mgr_type::listener_list> it(listeners_);
+		while (it.hasMoreElements())
+			it.getNext().first->onObjectCreated(obj);
+	}
+	void ObjectManager::listeners_onObjectInitialized(Object* obj)
+	{
+		assert( obj );
+		if (!obj)
+			return;
+		yake::ConstVectorIterator<listener_mgr_type::listener_list> it(listeners_);
+		while (it.hasMoreElements())
+			it.getNext().first->onObjectInitialized(obj);
+	}
+	void ObjectManager::listeners_onDestroyObject(Object* obj)
+	{
+		assert( obj );
+		if (!obj)
+			return;
+		yake::ConstVectorIterator<listener_mgr_type::listener_list> it(listeners_);
+		while (it.hasMoreElements())
+			it.getNext().first->onDestroyObject(obj);
+	}
+
+}
+}
\ No newline at end of file

Added: trunk/yake/src/yake/ent/object_mgr_listener.cpp
===================================================================
--- trunk/yake/src/yake/ent/object_mgr_listener.cpp	2006-03-05 18:29:22 UTC (rev 1212)
+++ trunk/yake/src/yake/ent/object_mgr_listener.cpp	2006-03-05 18:30:24 UTC (rev 1213)
@@ -0,0 +1,8 @@
+#include "yake/ent/pch.h"
+#include "yake/ent/ent.h"
+
+namespace yake {
+namespace object {
+
+}
+}
\ No newline at end of file

Added: trunk/yake/src/yake/ent/pch.cpp
===================================================================
--- trunk/yake/src/yake/ent/pch.cpp	2006-03-05 18:29:22 UTC (rev 1212)
+++ trunk/yake/src/yake/ent/pch.cpp	2006-03-05 18:30:24 UTC (rev 1213)
@@ -0,0 +1 @@
+#include "yake/ent/pch.h"

Added: trunk/yake/src/yake/ent/vm_holder.cpp
===================================================================
--- trunk/yake/src/yake/ent/vm_holder.cpp	2006-03-05 18:29:22 UTC (rev 1212)
+++ trunk/yake/src/yake/ent/vm_holder.cpp	2006-03-05 18:30:24 UTC (rev 1213)
@@ -0,0 +1,59 @@
+#include "yake/ent/pch.h"
+#include "yake/ent/ent.h"
+
+namespace yake {
+namespace object {
+
+	VMHolder::~VMHolder()
+	{
+		ConstVectorIterator<VmMap> it(vms_);
+		while (it.hasMoreElements())
+		{
+			VmMap::value_type& v = it.getNext();
+			if (v.second)
+				delete v.second;
+		}
+		vms_.clear();
+	}
+	bool VMHolder::attachVM(scripting::IVM* vm,const std::string& tag)
+	{
+		YAKE_ASSERT(vm)(tag).debug("null vm");
+		if (!vm)
+			return false;
+		YAKE_ASSERT( !tag.empty() )(tag).debug("invalid tag");
+		if (tag.empty())
+			return false;
+		VmMap::const_iterator it = vms_.find(tag);
+		YAKE_ASSERT( it == vms_.end() )(tag).debug("tag already used.");
+		if (vms_.end() != it)
+			return false;
+		vms_.insert( VmMap::value_type(tag,vm) );
+		return true;
+	}
+	scripting::IVM* VMHolder::detachVM(const std::string &tag)
+	{
+		YAKE_ASSERT( !tag.empty() )(tag).debug("invalid tag");
+		if (tag.empty())
+			return 0;
+		VmMap::iterator it = vms_.find(tag);
+		YAKE_ASSERT( it != vms_.end() )(tag).debug("tag not found.");
+		if (vms_.end() == it)
+			return 0;
+		scripting::IVM* vm = it->second;
+		vms_.erase(tag);
+		return vm;
+	}
+	scripting::IVM* VMHolder::getVM(const std::string &tag) const
+	{
+		YAKE_ASSERT( !tag.empty() )(tag).debug("invalid tag");
+		if (tag.empty())
+			return 0;
+		VmMap::const_iterator it = vms_.find(tag);
+		YAKE_ASSERT( it != vms_.end() )(tag).debug("tag not found.");
+		if (vms_.end() == it)
+			return 0;
+		return it->second;
+	}
+
+}
+}
\ No newline at end of file



From codeandroid at berlios.de  Sun Mar  5 19:31:03 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:31:03 +0100
Subject: [Yake-svn] r1214 - in trunk/yake/src/yake/plugins: . entLua
Message-ID: <200603051831.k25IV3jj027375@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:31:02 +0100 (Sun, 05 Mar 2006)
New Revision: 1214

Added:
   trunk/yake/src/yake/plugins/entLua/
   trunk/yake/src/yake/plugins/entLua/entLua.cpp
Log:
initial revision

Added: trunk/yake/src/yake/plugins/entLua/entLua.cpp
===================================================================
--- trunk/yake/src/yake/plugins/entLua/entLua.cpp	2006-03-05 18:30:24 UTC (rev 1213)
+++ trunk/yake/src/yake/plugins/entLua/entLua.cpp	2006-03-05 18:31:02 UTC (rev 1214)
@@ -0,0 +1,101 @@
+#include "yake/base/yake.h"
+#include "yake/plugins/entLua/entLua.h"
+#include "yake/plugins/scriptingLua/ScriptingSystemLua.h"
+
+#define LUABIND_NO_HEADERS_ONLY
+#include <luabind/luabind.hpp>
+
+namespace yake {
+namespace object {
+	namespace detail {
+		void executeOfTable_2(scripting::IVM& vm, const std::string& tbl1name, const std::string& tbl2name, const std::string& fn)
+		{
+			try {
+				scripting::LuaVM& luaVM = static_cast<scripting::LuaVM&>(vm);
+				lua_State* luaState = luaVM.getLuaState();
+				YAKE_ASSERT( luaState );
+
+				luabind::object tbl1 = luabind::globals(luaState)[tbl1name.c_str()];
+				if (luabind::type(tbl1) == LUA_TNIL)
+					//if (!tbl1)
+				{
+					std::cerr << "vm error: could not find table '" << tbl1name << "'.\n";
+					return;
+				}
+				assert( luabind::type(tbl1) == LUA_TTABLE );
+
+				luabind::object tbl2 = tbl1[tbl2name.c_str()];
+				if (luabind::type(tbl2) == LUA_TNIL)
+					//if (!tbl2)
+				{
+					std::cerr << "vm error: could not find table '" << tbl1name << "." << tbl2name << "'.\n";
+					return;
+				}
+				assert( luabind::type(tbl2) == LUA_TTABLE );
+
+				luabind::object fnObj = tbl2[fn.c_str()];
+				assert( luabind::type(fnObj) == LUA_TFUNCTION );
+
+				fnObj();
+			}
+			catch (...)
+			{
+				YAKE_EXCEPT("executeOfTable_2(): Bad cast! VM is not a Lua VM!");
+			}
+		}
+	}
+
+	LuaFsmObjectListener::LuaFsmObjectListener(scripting::IScriptingSystem& scriptingSystem) :
+		scriptingSystem_(scriptingSystem)
+	{
+		startScript_.reset( scriptingSystem_.createScriptFromFile("../o_test.lua") );
+		YAKE_ASSERT( startScript_.get() );
+	}
+	void LuaFsmObjectListener::onInit(Object& obj)
+	{
+		//YAKE_ASSERT( obj.getFsmVM() );
+		obj.getFsmVM()->execute("print('initializing...')");
+		obj.getFsmVM()->execute( startScript_.get() );
+
+		//std::cout << "vm: exec start_main()\n";
+		//@todo make sure "main()" exists
+		//obj.getVM().execute("start_main()");
+
+		obj.getFsmVM()->execute("c = coroutine.create(main)\ncoroutine.resume(c,1)");
+	}
+	void LuaFsmObjectListener::onTick(Object& obj)
+	{
+		obj.getFsmVM()->execute("event.on_tick()");
+		obj.getFsmVM()->execute("state." + obj.getCurrentFsmState() + ".on_tick()");
+	}
+	void LuaFsmObjectListener::onFsmEventHandled(Object& obj, const object_fsm&, const object_fsm::event_type& evt)
+	{
+		if (evt == "spawn")
+			obj.getFsmVM()->execute("event.on_spawn()");
+		else if (evt == "die")
+			obj.getFsmVM()->execute("event.on_die()");
+	}
+	void LuaFsmObjectListener::onFsmEnterState(Object& obj,/*const std::string& fsmName, */const object_fsm&, const object_fsm::state_type& state)
+	{
+		scripting::IVM* vm = obj.getFsmVM();
+		YAKE_ASSERT( vm );
+		detail::executeOfTable_2(*vm,"state",state,"on_enter");
+	}
+	void LuaFsmObjectListener::onFsmExitState(Object& obj,/*const std::string& fsmName, */const object_fsm&, const object_fsm::state_type& state)
+	{
+		scripting::IVM* vm = obj.getFsmVM();
+		YAKE_ASSERT( vm );
+		detail::executeOfTable_2(*vm,"state",state,"on_exit");
+	}
+	LuaObjectManagerListener::LuaObjectManagerListener(scripting::IScriptingSystem& scriptingSystem) :
+		fsmListener_(scriptingSystem)
+	{
+	}
+	void LuaObjectManagerListener::onObjectCreated(Object* obj)
+	{
+		YAKE_ASSERT( obj );
+		obj->attachListener( &fsmListener_, "lua_listener", object_listener_mgr::kKeepOwnership );
+	}
+}
+} // namespace yake
+



From codeandroid at berlios.de  Sun Mar  5 19:31:53 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:31:53 +0100
Subject: [Yake-svn] r1216 - in trunk/yake/src/yake/base/native: Linux win32
Message-ID: <200603051831.k25IVrFY027952@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:31:52 +0100 (Sun, 05 Mar 2006)
New Revision: 1216

Modified:
   trunk/yake/src/yake/base/native/Linux/yakeTime.cpp
   trunk/yake/src/yake/base/native/win32/yakeTime.cpp
Log:
removed namespace base

Modified: trunk/yake/src/yake/base/native/Linux/yakeTime.cpp
===================================================================
--- trunk/yake/src/yake/base/native/Linux/yakeTime.cpp	2006-03-05 18:31:23 UTC (rev 1215)
+++ trunk/yake/src/yake/base/native/Linux/yakeTime.cpp	2006-03-05 18:31:52 UTC (rev 1216)
@@ -48,9 +48,6 @@
 
 namespace yake
 {
-namespace base
-{
-
 namespace native
 {
 
@@ -125,6 +122,4 @@
 	}
 	
 } // timer
-
-} // base
 } // yake

Modified: trunk/yake/src/yake/base/native/win32/yakeTime.cpp
===================================================================
--- trunk/yake/src/yake/base/native/win32/yakeTime.cpp	2006-03-05 18:31:23 UTC (rev 1215)
+++ trunk/yake/src/yake/base/native/win32/yakeTime.cpp	2006-03-05 18:31:52 UTC (rev 1216)
@@ -45,8 +45,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace native
 {
 
@@ -96,5 +94,4 @@
 
 
 } // native
-} // base
 } // yake
\ No newline at end of file



From codeandroid at berlios.de  Sun Mar  5 19:31:25 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:31:25 +0100
Subject: [Yake-svn] r1215 - trunk/yake/src/yake/plugins/baseLuaBindings
Message-ID: <200603051831.k25IVPw2027770@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:31:23 +0100 (Sun, 05 Mar 2006)
New Revision: 1215

Modified:
   trunk/yake/src/yake/plugins/baseLuaBindings/yakeLuaBinder.cpp
Log:
removed namespace base

Modified: trunk/yake/src/yake/plugins/baseLuaBindings/yakeLuaBinder.cpp
===================================================================
--- trunk/yake/src/yake/plugins/baseLuaBindings/yakeLuaBinder.cpp	2006-03-05 18:31:02 UTC (rev 1214)
+++ trunk/yake/src/yake/plugins/baseLuaBindings/yakeLuaBinder.cpp	2006-03-05 18:31:23 UTC (rev 1215)
@@ -174,15 +174,15 @@
 				[
 				    //def("createTimer", &yake::base::timer::createTimer())
 				    class_< Timer >( "Timer" )
-				    .def( "reset", &yake::base::Timer::reset )
-				    .def( "getMilliseconds", &yake::base::Timer::getMilliseconds )
-				    .def( "getSeconds", &yake::base::Timer::getSeconds )
+					 .def( "reset", &yake::Timer::reset )
+				    .def( "getMilliseconds", &yake::Timer::getMilliseconds )
+				    .def( "getSeconds", &yake::Timer::getSeconds )
 				];
 
 				module( YAKE_BASE_MODULE )
 				[
 				    //def( "createTimer", &yake::base::timer::createTimer )
-				    def( "getTime", &yake::base::native::getTime )
+				    def( "getTime", &yake::native::getTime )
 				];
 
 				// Log



From codeandroid at berlios.de  Sun Mar  5 19:32:40 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:32:40 +0100
Subject: [Yake-svn] r1217 - in trunk/yake/yake/base: . mpl templates
Message-ID: <200603051832.k25IWeAG028236@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:32:28 +0100 (Sun, 05 Mar 2006)
New Revision: 1217

Modified:
   trunk/yake/yake/base/mpl/null_type.h
   trunk/yake/yake/base/mpl/sequences.h
   trunk/yake/yake/base/mpl/yakeAbstractFactory.h
   trunk/yake/yake/base/mpl/yakeAlgorithms.h
   trunk/yake/yake/base/mpl/yakeBuildArguments.h
   trunk/yake/yake/base/mpl/yakeFunctions.h
   trunk/yake/yake/base/mpl/yakeInheritLinear.h
   trunk/yake/yake/base/mpl/yakeInheritMultiple.h
   trunk/yake/yake/base/mpl/yakeLambda.h
   trunk/yake/yake/base/templates/yakeManager.h
   trunk/yake/yake/base/templates/yakeManager.inl
   trunk/yake/yake/base/templates/yakePointer.h
   trunk/yake/yake/base/templates/yakeRegistry.h
   trunk/yake/yake/base/yakeTimer.h
Log:
removed namespace base

Modified: trunk/yake/yake/base/mpl/null_type.h
===================================================================
--- trunk/yake/yake/base/mpl/null_type.h	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/mpl/null_type.h	2006-03-05 18:32:28 UTC (rev 1217)
@@ -35,15 +35,12 @@
 
 namespace yake
 {
-namespace base
-{
 namespace mpl
 {
 
 typedef boost::mpl::empty_base null_type;
 
 } // mpl
-} // base
 } // yake
 
 

Modified: trunk/yake/yake/base/mpl/sequences.h
===================================================================
--- trunk/yake/yake/base/mpl/sequences.h	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/mpl/sequences.h	2006-03-05 18:32:28 UTC (rev 1217)
@@ -40,15 +40,12 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace mpl
 {
 
 namespace sequences = boost::mpl;
 
 } // mpl
-} // base
 } // yake
 
 #endif // _YAKE_BASE_MPL_SEQUENCES_H_

Modified: trunk/yake/yake/base/mpl/yakeAbstractFactory.h
===================================================================
--- trunk/yake/yake/base/mpl/yakeAbstractFactory.h	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/mpl/yakeAbstractFactory.h	2006-03-05 18:32:28 UTC (rev 1217)
@@ -42,8 +42,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace mpl
 {
 
@@ -116,7 +114,6 @@
 };
 
 } // mpl
-} // base
 } // yake
 
 #endif // YAKE_BASE_MPL_ABSTRACTFACTORY_H

Modified: trunk/yake/yake/base/mpl/yakeAlgorithms.h
===================================================================
--- trunk/yake/yake/base/mpl/yakeAlgorithms.h	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/mpl/yakeAlgorithms.h	2006-03-05 18:32:28 UTC (rev 1217)
@@ -37,15 +37,12 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace mpl
 {
 
 namespace algorithms = boost::mpl;
 
 } // mpl
-} // base
 } // yake
 
 #endif // YAKE_BASE_MPL_ALGORITHM_H

Modified: trunk/yake/yake/base/mpl/yakeBuildArguments.h
===================================================================
--- trunk/yake/yake/base/mpl/yakeBuildArguments.h	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/mpl/yakeBuildArguments.h	2006-03-05 18:32:28 UTC (rev 1217)
@@ -81,7 +81,7 @@
 #define YAKE_ARGUMENTS( number ) YAKE_ITER_ARG_##number ( YAKE_ARGUMENT )
 
 // const T2& t2, const T1& t1, const T0& t0
-#define YAKE_ARGUMENTS_ONE_FREE_0 yake::base::mpl::null_type Null = yake::base::mpl::null_type()
+#define YAKE_ARGUMENTS_ONE_FREE_0 yake::mpl::null_type Null = yake::mpl::null_type()
 #define YAKE_ARGUMENTS_ONE_FREE_1 YAKE_ITER_ARG_1( YAKE_ARGUMENT )
 #define YAKE_ARGUMENTS_ONE_FREE_2 YAKE_ITER_ARG_2( YAKE_ARGUMENT )
 #define YAKE_ARGUMENTS_ONE_FREE_3 YAKE_ITER_ARG_3( YAKE_ARGUMENT )

Modified: trunk/yake/yake/base/mpl/yakeFunctions.h
===================================================================
--- trunk/yake/yake/base/mpl/yakeFunctions.h	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/mpl/yakeFunctions.h	2006-03-05 18:32:28 UTC (rev 1217)
@@ -38,15 +38,12 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace mpl
 {
 
 namespace functions = boost::mpl;
 
 } // mpl
-} // base
 } // yake
 
 #endif // YAKE_BASE_MPL_FUNCTIONS_H

Modified: trunk/yake/yake/base/mpl/yakeInheritLinear.h
===================================================================
--- trunk/yake/yake/base/mpl/yakeInheritLinear.h	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/mpl/yakeInheritLinear.h	2006-03-05 18:32:28 UTC (rev 1217)
@@ -38,8 +38,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace mpl
 {
 
@@ -48,7 +46,6 @@
 {}; 
 
 } // mpl
-} // base
 } // yake
 
 #endif // YAKE_BASE_MPL_INHERITLINEAR_H

Modified: trunk/yake/yake/base/mpl/yakeInheritMultiple.h
===================================================================
--- trunk/yake/yake/base/mpl/yakeInheritMultiple.h	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/mpl/yakeInheritMultiple.h	2006-03-05 18:32:28 UTC (rev 1217)
@@ -41,8 +41,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace mpl
 {
 namespace detail
@@ -91,7 +89,6 @@
 {};
 
 } // mpl
-} // base
 } // yake
 
 #endif // YAKE_BASE_MPL_INHERITMULTIPLE_H

Modified: trunk/yake/yake/base/mpl/yakeLambda.h
===================================================================
--- trunk/yake/yake/base/mpl/yakeLambda.h	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/mpl/yakeLambda.h	2006-03-05 18:32:28 UTC (rev 1217)
@@ -37,15 +37,12 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace mpl
 {
 
 namespace lambda = boost::mpl;
 
 } // mpl
-} // base
 } // yake
 
 #endif // YAKE_BASE_MPL_LAMBDA_H

Modified: trunk/yake/yake/base/templates/yakeManager.h
===================================================================
--- trunk/yake/yake/base/templates/yakeManager.h	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/templates/yakeManager.h	2006-03-05 18:32:28 UTC (rev 1217)
@@ -43,8 +43,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace templates
 {
 
@@ -55,7 +53,7 @@
 template< typename Identifier_, class Value_ >
 struct DefaultManagerError
 {      
-YAKE_DECLARE_CLASS( yake::base::templates::DefaultManagerError<> )
+YAKE_DECLARE_CLASS( yake::templates::DefaultManagerError<> )
     static Value_ OnUnknownType( Identifier_ )
     {
       YAKE_EXCEPT( "Unknown Type." );
@@ -92,7 +90,7 @@
 	>
 	struct Map : ManagerErrorPolicy_< Identifier_, Value_ >
 	{
-		YAKE_DECLARE_CLASS( yake::base::templates::DefaultFunctionsNames::Map<> )
+		YAKE_DECLARE_CLASS( yake::templates::DefaultFunctionsNames::Map<> )
 		// Class
 		virtual ~Map() {}
 
@@ -114,7 +112,7 @@
 	template< typename Identifier_ >
 	struct Vector
 	{
-	YAKE_DECLARE_CLASS( yake::base::templates::DefaultFunctionsNames::Vector<> )
+	YAKE_DECLARE_CLASS( yake::templates::DefaultFunctionsNames::Vector<> )
 		// Class
 		virtual ~Vector() {}
 
@@ -143,7 +141,7 @@
 	>
 	struct Map : ManagerErrorPolicy_< Identifier_, Value_ >
 	{
-		YAKE_DECLARE_CLASS( yake::base::templates::RegisterFunctionsNames::Map<> )
+		YAKE_DECLARE_CLASS( yake::templates::RegisterFunctionsNames::Map<> )
 		// Class
 		virtual ~Map() {}
 
@@ -164,7 +162,7 @@
 	template< typename Identifier_ >
 	struct Vector
 	{
-	YAKE_DECLARE_CLASS( yake::base::templates::RegisterFunctionsNames::Vector<> )
+	YAKE_DECLARE_CLASS( yake::templates::RegisterFunctionsNames::Vector<> )
 		// Class
 		virtual ~Vector() {}
 
@@ -218,7 +216,6 @@
 };
 
 } // templates
-} // base
 } // yake
 
 // Include inline implementation.

Modified: trunk/yake/yake/base/templates/yakeManager.inl
===================================================================
--- trunk/yake/yake/base/templates/yakeManager.inl	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/templates/yakeManager.inl	2006-03-05 18:32:28 UTC (rev 1217)
@@ -30,8 +30,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace templates
 {
 
@@ -137,5 +135,4 @@
 }
 
 } // templates
-} // base
 } // yake

Modified: trunk/yake/yake/base/templates/yakePointer.h
===================================================================
--- trunk/yake/yake/base/templates/yakePointer.h	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/templates/yakePointer.h	2006-03-05 18:32:28 UTC (rev 1217)
@@ -147,219 +147,7 @@
 			return ::boost::weak_ptr<T>::expired();
 		}
 	};
-	
 
-/*namespace PointerConfigs
-{
-  struct Standard
-  {
-    template< typename T >
-    struct LifeTimePolicy
-    {
-      static void OnPreCreate( const T* notValidYet )     {}
-      static void OnPostCreate( const T* validNow )       {}
-      static void OnPreRelease( const T* stillValid )     {}
-      static void OnPostRelease( const T* invalidNow )    {}
-    };
-
-    template< typename T >
-    struct SafetyPolicy
-    {
-      YAKE_DECLARE_CLASS( yake::base::PointerConfigs::Standard::SafetyPolicy<> )
-      static void Check( const T* instance )              
-			{ 
-				YAKE_DECLARE_FUNCTION( Check ) 
-				if( 0 == instance ) 
-					YAKE_EXCEPT( "Null pointer detected." );
-			}
-    };
-  };
-
-  struct Fast
-  {
-    template< typename T >
-    struct LifeTimePolicy
-    {
-      static void OnPreCreate( const T* notValidYet )     {}
-      static void OnPostCreate( const T* validNow )       {}
-      static void OnPreRelease( const T* stillValid )     {}
-      static void OnPostRelease( const T* invalidNow )    {}
-    };
-
-    template< typename T >
-    struct SafetyPolicy
-    {
-      static void Check( const T* instance )              {}
-    };
-  };
-};
-
-template< typename T, typename Config_ = PointerConfigs::Standard >
-class Pointer
-{
-YAKE_DECLARE_CLASS( yake::base::templates::Pointer<> )
-public:
-  typedef Config_ Config;
-  typedef Pointer< T, Config > Self;
-
-  Pointer() : instance_( 0 )                                                    
-	{}
-
-  template< typename U, typename UConfig >
-	Pointer( const Pointer< U, UConfig >& pointer )                             
-	{ 
-		BOOST_MPL_ASSERT_IS_SAME( Config, UConfig ); 
-		instance_ = yake::base::templates::PolymorphicCast< T, U >::execute( Pointer< U, UConfig >::GetInstancePointer( pointer ) ); 
-		AddReference_(); 
-	}
-
-  Pointer( const Self& pointer ) : instance_( pointer.instance_ )               
-	{ AddReference_(); }
-
-  ~Pointer()
-	{ Release_(); }
-
-  template< typename U, typename UConfig >
-	Self& operator=( const Pointer< U, UConfig >& pointer )                     
-	{ 
-		BOOST_MPL_ASSERT_IS_SAME( Config, UConfig ); 
-		if( instance_ != Pointer< U, UConfig >::GetInstancePointer( pointer ) ) 
-		{ 
-				Release_(); 
-				instance_ = yake::base::templates::PolymorphicCast< T, U >::execute( Pointer< U, UConfig >::GetInstancePointer( pointer ) ); 
-				AddReference_(); 
-		} 
-		return *this; 
-	}
-  
-	Self& operator=( const Self& pointer )                                        
-	{ 
-		if( instance_ != pointer.instance_ ) 
-		{ 
-			Release_(); 
-			instance_ = pointer.instance_; 
-			AddReference_(); 
-		} 
-		return *this; 
-	}
-
-  bool operator==( const Self& pointer ) const
-	{ return instance_ == pointer.instance_; }
-  
-	bool operator!=( const Self& pointer ) const
-	{ return instance_ != pointer.instance_; }
-
-  T* operator->() const
-	{ Config::SafetyPolicy< T >::Check( instance_ ); return instance_; }
-
-  T& operator*() const      
-	{ Config::SafetyPolicy< T >::Check( instance_ ); return *instance_; }
-
-  static const Self NULL_POINTER;
-
-  static void Release( Self& pointer )             
-	{ pointer.Release_(); }
-
-  static T* GetInstancePointer( const Self& pointer )     
-	{ return pointer.instance_; }
-
-#define FUNCTION( number ) \
-  YAKE_TYPES( number ) \
-  static Pointer< T, Config > create( YAKE_ARGUMENTS( number ) ) \
-  { \
-    YAKE_DECLARE_FUNCTION( create ) \
-	  int8* rawMemory = static_cast< int8* >( operator new( REFERENCE_COUNT_SIZE + sizeof( T ) ) ); \
-	  T* instance = reinterpret_cast< T* >( rawMemory + REFERENCE_COUNT_SIZE ); \
-    try \
-    { \
-      Config::LifeTimePolicy< T >::OnPreCreate( instance ); \
-		  new( instance ) T ( YAKE_USE_ARGUMENTS( number ) ); \
-      Config::LifeTimePolicy< T >::OnPostCreate( instance ); \
-	  } \
-	  catch( ... ) \
-	  { \
-		  operator delete( rawMemory ); \
-		  throw; \
-	  } \
-		return Pointer< T, Config >( instance, yake::base::templates::NullType() ); \
-  }
-YAKE_IMPLEMENT_FUNCTION( FUNCTION )
-#undef FUNCTION
-
-private:
-  enum { REFERENCE_COUNT_SIZE = ALIGN( sizeof( int ) ) };
-
-	Pointer( T* instance, yake::base::templates::NullType nullType ) : instance_( instance )  { SetReferenceCount_( 1 ); }
-
-  void AddReference_()                                                          
-	{ 
-		if( !instance_ ) return; 
-		SetReferenceCount_( GetReferenceCount_() + 1 ); 
-	}
-
-  void Release_()                                                               
-	{ 
-		YAKE_DECLARE_FUNCTION( Release ) 
-		if( instance_ ) 
-		{ 
-			SetReferenceCount_( GetReferenceCount_() - 1 ); 
-			if( GetReferenceCount_() == 0 ) 
-			{ 
-				Config::LifeTimePolicy< T >::OnPreRelease( instance_ ); 
-				void* base = GetBasePointer_(); 
-				instance_->~T(); 
-				operator delete( base ); 
-				Config::LifeTimePolicy< T >::OnPostRelease( instance_ ); 
-			} 
-			instance_ = 0; 
-		} 
-	}
-
-	void* GetBasePointer_() const                                                 
-	{ 
-		if( !instance_ ) return 0; 
-		return reinterpret_cast< int8* >( yake::base::templates::getBasePointer( instance_ ) ) - REFERENCE_COUNT_SIZE; 
-	}
-
-  void SetReferenceCount_( int referenceCount )                                 
-	{
-		if( !instance_ ) return; 
-		*reinterpret_cast< int* >( GetBasePointer_() ) = referenceCount; 
-	}
-
-  int GetReferenceCount_() const                                                
-	{ 
-		if( !instance_ ) return 0; 
-		return *reinterpret_cast< int* >( GetBasePointer_() ); 
-	}
-
-	T* instance_;
-};
-
-template< typename T, typename Config >
-const Pointer< T, Config > Pointer< T, Config >::NULL_POINTER;
-
-
-template< typename T, typename Config, typename U, typename UConfig >
-bool operator==( const Pointer< T, Config >& pointer1, const Pointer< U, UConfig >& pointer2 )  { BOOST_MPL_ASSERT_IS_SAME( Config, UConfig ); return Pointer< T, Config >::GetInstancePointer( pointer1 ) == Pointer< U, UConfig >::GetInstancePointer( pointer2 ); }
-
-template< typename T, typename Config, typename U, typename UConfig >
-bool operator!=( const Pointer< T, Config >& pointer1, const Pointer< U, UConfig >& pointer2 )  { BOOST_MPL_ASSERT_IS_SAME( Config, UConfig ); return Pointer< T, Config >::GetInstancePointer( pointer1 ) != Pointer< U, UConfig >::GetInstancePointer( pointer2 ); }
-
-#define FUNCTION( number ) \
-	YAKE_TYPES_ONE_FREE( number ) \
-  Pointer< T > Create( YAKE_ARGUMENTS( number ) ) \
-	{ return Pointer< T >::Create( YAKE_USE_ARGUMENTS( number ) ); }
-YAKE_IMPLEMENT_FUNCTION( FUNCTION )
-#undef FUNCTION
-
-#define FUNCTION( number ) \
-	YAKE_TYPES_TWO_FREE( number ) \
-  Pointer< T > Create( YAKE_ARGUMENTS( number ) ) \
-	{ return Pointer< T, TT >::Create( YAKE_USE_ARGUMENTS( number ) ); }
-YAKE_IMPLEMENT_FUNCTION( FUNCTION )
-#undef FUNCTION*/
-
 } // yake
 
 #endif // YAKE_BASE_TEMPLATES_POINTER_H

Modified: trunk/yake/yake/base/templates/yakeRegistry.h
===================================================================
--- trunk/yake/yake/base/templates/yakeRegistry.h	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/templates/yakeRegistry.h	2006-03-05 18:32:28 UTC (rev 1217)
@@ -46,8 +46,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace templates
 {
 
@@ -72,7 +70,7 @@
 template <class ConfigClass>
 class Registry : public Manager< typename ConfigClass::Id, SharedPtr< typename ConfigClass::ICreator >, RegisterFunctionsNames >
 {
-YAKE_DECLARE_CLASS( yake::base::templates::Registry )
+YAKE_DECLARE_CLASS( yake::templates::Registry )
 public: // types
   typedef ConfigClass Config;
   typedef typename Config::Base Base;
@@ -113,7 +111,7 @@
 // Note: this macro has to be used inside the class declaration.
 #define YAKE_DECLARE_REGISTRY() \
   public: \
-    typedef yake::base::templates::Registry< RegistryConfig > RegistryType; \
+    typedef yake::templates::Registry< RegistryConfig > RegistryType; \
     static RegistryType& getRegistry();
 
 // Note: you have to use DECLARE_REGISTRY() before.
@@ -157,7 +155,6 @@
 	} // nameless
 
 } // templates
-} // base
 } // yake
 
 // Declares a registry for types with an empty constructor.

Modified: trunk/yake/yake/base/yakeTimer.h
===================================================================
--- trunk/yake/yake/base/yakeTimer.h	2006-03-05 18:31:52 UTC (rev 1216)
+++ trunk/yake/yake/base/yakeTimer.h	2006-03-05 18:32:28 UTC (rev 1217)
@@ -41,8 +41,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 
 class Timer;
 
@@ -71,7 +69,6 @@
 	virtual real getSeconds() = 0;
 };
 
-} // base
 } // yake
 
 #endif // YAKE_BASE_TIMER_H



From codeandroid at berlios.de  Sun Mar  5 19:33:22 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:33:22 +0100
Subject: [Yake-svn] r1218 - trunk/yake/yake/base
Message-ID: <200603051833.k25IXMpb028770@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:33:21 +0100 (Sun, 05 Mar 2006)
New Revision: 1218

Added:
   trunk/yake/yake/base/yakeTaggedListenerManager.h
Log:
initial revision

Added: trunk/yake/yake/base/yakeTaggedListenerManager.h
===================================================================
--- trunk/yake/yake/base/yakeTaggedListenerManager.h	2006-03-05 18:32:28 UTC (rev 1217)
+++ trunk/yake/yake/base/yakeTaggedListenerManager.h	2006-03-05 18:33:21 UTC (rev 1218)
@@ -0,0 +1,45 @@
+#ifndef YAKE_TAGGED_LISTENER_MANAGER_H
+#define YAKE_TAGGED_LISTENER_MANAGER_H
+
+namespace yake {
+
+	template<typename T_listener>
+	struct ListenerManager
+	{
+		virtual ~ListenerManager() {}
+		typedef T_listener listener_type;
+		enum AttachMode
+		{
+			kTransferOwnership = 0,
+			kKeepOwnership = 1
+		};
+		void attachListener(listener_type*,const std::string& tag = "",const AttachMode mode = kTransferOwnership);
+
+		//listener_type* detachListener(listener_type*);
+		//listener_type* detachListener(const std::string& tag);
+
+		//void destroyListener(listener_type*);
+		//void destroyListener(const std::string& tag);
+
+		listener_type* getListener(const std::string& tag) const;
+	protected:
+		typedef std::map<std::string,listener_type*> tag_listener_map;
+		tag_listener_map	listenerMap_;
+
+		typedef std::deque<std::pair<listener_type*,AttachMode> > listener_list;
+		listener_list		listeners_;
+	};
+	/** @todo implement iterator and const_iterator.
+	*/
+	template<typename T_listener>
+	void ListenerManager<T_listener>::attachListener(T_listener* listener,const std::string& tag,const AttachMode mode)
+	{
+		assert( listener );
+		listeners_.push_back( listener_list::value_type(listener,mode) );
+		if (!tag.empty()) //@todo add check for existing tag!
+			listenerMap_[ tag ] = listener;
+	}
+
+} // namespace yake
+
+#endif



From codeandroid at berlios.de  Sun Mar  5 19:39:38 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:39:38 +0100
Subject: [Yake-svn] r1219 - in trunk/yake/yake: . ent prop statemachine
Message-ID: <200603051839.k25IdcnQ030695@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:39:30 +0100 (Sun, 05 Mar 2006)
New Revision: 1219

Added:
   trunk/yake/yake/ent/
   trunk/yake/yake/ent/component.h
   trunk/yake/yake/ent/component_holder.h
   trunk/yake/yake/ent/ent.h
   trunk/yake/yake/ent/object.h
   trunk/yake/yake/ent/object_listener.h
   trunk/yake/yake/ent/object_mgr.h
   trunk/yake/yake/ent/object_mgr_listener.h
   trunk/yake/yake/ent/pch.h
   trunk/yake/yake/ent/prerequisites.h
   trunk/yake/yake/ent/vm_holder.h
   trunk/yake/yake/prop/
   trunk/yake/yake/prop/prerequisites.h
   trunk/yake/yake/prop/prop.h
   trunk/yake/yake/prop/prop_def.h
   trunk/yake/yake/prop/prop_holder.h
   trunk/yake/yake/prop/rtti_class.h
   trunk/yake/yake/statemachine/
   trunk/yake/yake/statemachine/fsm_core.h
Log:
initial revision

Added: trunk/yake/yake/ent/component.h
===================================================================
--- trunk/yake/yake/ent/component.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/ent/component.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,28 @@
+#ifndef YAKE_OBJECT_COMPONENT_H
+#define YAKE_OBJECT_COMPONENT_H
+
+#include "yake/ent/prerequisites.h"
+#include "yake/prop/yakeProperty.h"
+
+namespace yake {
+namespace object {
+
+	struct Co;
+
+#define DECL_CO(CLASS,DESC) \
+	DECL_CLASS_RTTI(CLASS,DESC) \
+public: \
+	static CLASS* cast(::yake::object::Co*);
+
+	struct YAKE_ENT_API Co : public PropHolder<Co>
+	{
+		virtual ~Co() {}
+
+		DECL_CO(Co,"Component base")
+	public:
+	};
+
+} // namespace object
+} // namespace yake
+
+#endif

Added: trunk/yake/yake/ent/component_holder.h
===================================================================
--- trunk/yake/yake/ent/component_holder.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/ent/component_holder.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,25 @@
+#ifndef YAKE_OBJECT_COMPONENT_HOLDER_H
+#define YAKE_OBJECT_COMPONENT_HOLDER_H
+
+#include "prerequisites.h"
+
+namespace yake {
+namespace object {
+
+	typedef std::string CoTag;
+	struct YAKE_ENT_API CoHolder
+	{
+		// operations
+		void addCo(const CoTag&, Co*);
+		Co* removeCo(const Co*);
+		Co* removeCo(const CoTag&);
+		Co* getCo(const CoTag&) const;
+	private:
+		typedef std::map<CoTag,Co*> TagCoMap;
+		TagCoMap	components_;
+	};
+
+} // namespace object
+} // namespace yake
+
+#endif

Added: trunk/yake/yake/ent/ent.h
===================================================================
--- trunk/yake/yake/ent/ent.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/ent/ent.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,12 @@
+#ifndef YAKE_ENT_H
+#define YAKE_ENT_H
+
+#include "yake/ent/prerequisites.h"
+#include "yake/ent/component.h"
+#include "yake/ent/component_holder.h"
+#include "yake/ent/object_listener.h"
+#include "yake/ent/object.h"
+#include "yake/ent/object_mgr.h"
+#include "yake/ent/object_mgr_listener.h"
+
+#endif

Added: trunk/yake/yake/ent/object.h
===================================================================
--- trunk/yake/yake/ent/object.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/ent/object.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,60 @@
+#ifndef YAKE_OBJECT_H
+#define YAKE_OBJECT_H
+
+#include "yake/ent/prerequisites.h"
+#include "yake/ent/object_listener.h"
+#include "yake/ent/vm_holder.h"
+
+namespace yake {
+namespace object {
+
+#define DECL_GO(CLASS,DESC) \
+	DECL_CLASS_RTTI(CLASS,DESC) \
+public: \
+	static CLASS* cast(::yake::object::Co*);
+
+	struct YAKE_ENT_API Object : public CoHolder, public VMHolder, public yake::PropHolder<Object>, public object_listener_mgr
+	{
+		DECL_GO(Object,"Object/Entity base")
+		Object() {}
+		virtual ~Object() {}
+
+		typedef object_fsm::state_type fsm_state_type;
+		typedef object_fsm::event_type fsm_event_type;
+
+		// operations
+		void init()
+		{
+			listeners_init(*this);
+		}
+		void tick()
+		{
+			listeners_tick(*this);
+		}
+		void addFsmState(const fsm_state_type&);
+		void addFsmTransition(const fsm_state_type&, const fsm_event_type&, const fsm_state_type&);
+		void setFsmState(const fsm_state_type&);
+		void processFsmEvent(const fsm_event_type& evt);
+		const fsm_state_type& getCurrentFsmState() const
+		{ return m_.current(); }
+
+
+		scripting::IVM* getFsmVM() const
+		{
+			 return this->getVM("main");
+		}
+		// signals
+		typedef boost::signal<void(const std::string&,scripting::IVM*)> VmInitializedSignal;
+		boost::signals::connection subscribeToVmInitialized(const VmInitializedSignal::slot_type&);
+
+	private:
+		void onEnter(const object_fsm&, const object_fsm::state_type& state);
+		void onExit(const object_fsm&, const object_fsm::state_type& state);
+	private:
+		object_fsm			m_;
+	};
+
+} // namespace object
+} // namespace yake
+
+#endif

Added: trunk/yake/yake/ent/object_listener.h
===================================================================
--- trunk/yake/yake/ent/object_listener.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/ent/object_listener.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,58 @@
+#ifndef YAKE_OBJECT_LISTENER_H
+#define YAKE_OBJECT_LISTENER_H
+
+#include "yake/ent/prerequisites.h"
+
+namespace yake {
+namespace object {
+
+	struct Object;
+	struct YAKE_ENT_API object_listener
+	{
+		virtual ~object_listener() {}
+		virtual void onTick(Object&) {}
+		virtual void onInit(Object&) {}
+		virtual void onFsmEventHandled(Object&, const object_fsm&, const object_fsm::event_type&) {}
+		virtual void onFsmEnterState(Object&,/*const std::string& fsmName, */const object_fsm&, const object_fsm::state_type&) {}
+		virtual void onFsmExitState(Object&,/*const std::string& fsmName, */const object_fsm&, const object_fsm::state_type&) {}
+	};
+
+	struct YAKE_ENT_API object_listener_mgr : public ListenerManager<object_listener>
+	{
+	protected:
+		void listeners_init(Object& obj)
+		{
+			yake::ConstVectorIterator<listener_list> it(listeners_);
+			while (it.hasMoreElements())
+				it.getNext().first->onInit(obj);
+		}
+		void listeners_tick(Object& obj)
+		{
+			yake::ConstVectorIterator<listener_list> it(listeners_);
+			while (it.hasMoreElements())
+				it.getNext().first->onTick(obj);
+		}
+		void listeners_fsmEventHandled(Object& obj,/*const std::string& fsmName, */const object_fsm& fsm, const object_fsm::event_type& evt)
+		{
+			yake::ConstVectorIterator<listener_list> it(listeners_);
+			while (it.hasMoreElements())
+				it.getNext().first->onFsmEventHandled(obj,fsm,evt);
+		}
+		void listeners_fsmEnterState(Object& obj,/*const std::string& fsmName, */const object_fsm& fsm, const object_fsm::state_type& state)
+		{
+			yake::ConstVectorIterator<listener_list> it(listeners_);
+			while (it.hasMoreElements())
+				it.getNext().first->onFsmEnterState(obj,fsm,state);
+		}
+		void listeners_fsmExitState(Object& obj,/*const std::string& fsmName, */const object_fsm& fsm, const object_fsm::state_type& state)
+		{
+			yake::ConstVectorIterator<listener_list> it(listeners_);
+			while (it.hasMoreElements())
+				it.getNext().first->onFsmExitState(obj,fsm,state);
+		}
+	};
+
+} // namespace object
+} // namespace yake
+
+#endif

Added: trunk/yake/yake/ent/object_mgr.h
===================================================================
--- trunk/yake/yake/ent/object_mgr.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/ent/object_mgr.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,30 @@
+#ifndef YAKE_OBJECTMANAGER_H
+#define YAKE_OBJECTMANAGER_H
+
+#include "yake/ent/prerequisites.h"
+#include "yake/ent/object.h"
+#include "yake/ent/object_mgr_listener.h"
+
+namespace yake {
+namespace object {
+
+	struct YAKE_ENT_API ObjectManager : public ListenerManager<ObjectManagerListener>
+	{
+		// operations
+		Object* makeObject();
+		void destroyObject(Object*);
+		void tick();
+	protected:
+		typedef ListenerManager<ObjectManagerListener> listener_mgr_type;
+		void listeners_onObjectCreated(Object* obj);
+		void listeners_onObjectInitialized(Object* obj);
+		void listeners_onDestroyObject(Object* obj);
+	private:
+		typedef std::deque<Object*> object_ptr_list;
+		object_ptr_list	objs_;
+	};
+
+} // namespace object
+} // namespace yake
+
+#endif

Added: trunk/yake/yake/ent/object_mgr_listener.h
===================================================================
--- trunk/yake/yake/ent/object_mgr_listener.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/ent/object_mgr_listener.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,21 @@
+#ifndef YAKE_OBJECTMANAGERLISTENER_H
+#define YAKE_OBJECTMANAGERLISTENER_H
+
+#include "yake/ent/prerequisites.h"
+#include "yake/ent/object.h"
+
+namespace yake {
+namespace object {
+
+	struct YAKE_ENT_API ObjectManagerListener
+	{
+		virtual ~ObjectManagerListener() {}
+		virtual void onObjectCreated(Object*) {}
+		virtual void onObjectInitialized(Object*) {}
+		virtual void onDestroyObject(Object*) {}
+	};
+
+} // namespace object
+} // namespace yake
+
+#endif

Added: trunk/yake/yake/ent/pch.h
===================================================================
--- trunk/yake/yake/ent/pch.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/ent/pch.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,7 @@
+#ifndef YAKE_OBJECT_PCH_H
+#define YAKE_OBJECT_PCH_H
+
+#include "yake/base/yake.h"
+#include <boost/bind.hpp>
+
+#endif

Added: trunk/yake/yake/ent/prerequisites.h
===================================================================
--- trunk/yake/yake/ent/prerequisites.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/ent/prerequisites.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,23 @@
+#ifndef YAKE_OBJECT_PREREQUISITES_H
+#define YAKE_OBJECT_PREREQUISITES_H
+
+#include "yake/prop/yakeProperty.h"
+#include "yake/statemachine/fsm_core.h"
+#include "yake/base/yakeTaggedListenerManager.h"
+#include "yake/base/templates/yakeVector.h"
+
+#if defined(YAKE_ENT_EXPORTS)
+#	define YAKE_ENT_API DLLEXPORT
+#else
+#	define YAKE_ENT_API DLLIMPORT
+#endif
+
+namespace yake {
+namespace object {
+
+	typedef fsm::machine<std::string,std::string> object_fsm;
+
+} // namespace object
+} // namespace yake
+
+#endif

Added: trunk/yake/yake/ent/vm_holder.h
===================================================================
--- trunk/yake/yake/ent/vm_holder.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/ent/vm_holder.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,42 @@
+#ifndef YAKE_ENT_VMHOLDER_H
+#define YAKE_ENT_VMHOLDER_H
+
+#include "yake/ent/prerequisites.h"
+#include "yake/ent/object_listener.h"
+
+namespace yake {
+namespace scripting {
+	class IVM;
+	class IScriptingSystem;
+}
+namespace object {
+
+	struct YAKE_ENT_API VMHolder
+	{
+		VMHolder() {}
+		virtual ~VMHolder();
+
+		// operations
+
+		/** Warning: Currently ownership is not transferred! */
+		bool attachVM(scripting::IVM*,const std::string& tag);
+		scripting::IVM* detachVM(const std::string& tag);
+		scripting::IVM* getVM(const std::string& tag) const;
+
+		// signals
+		typedef boost::signal<void(const std::string&,scripting::IVM*)> VmAttachedSignal;
+		boost::signals::connection subsribeToVmAttached(const VmAttachedSignal::slot_type&);
+		typedef boost::signal<void(const std::string&,scripting::IVM*)> VmDetachedSignal;
+		boost::signals::connection subscribeToVmDetached(const VmDetachedSignal::slot_type&);
+	private:
+		VmAttachedSignal					sigAttached_;
+		VmDetachedSignal					sigDetached_;
+		typedef std::map<std::string,scripting::IVM*> VmMap;
+		VmMap									vms_;
+	};
+
+
+} // namespace object
+} // namespace yake
+
+#endif

Added: trunk/yake/yake/prop/prerequisites.h
===================================================================
--- trunk/yake/yake/prop/prerequisites.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/prop/prerequisites.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,23 @@
+#ifndef YAKE_PROP_PREREQUISITES_H
+#define YAKE_PROP_PREREQUISITES_H
+
+//#include "../common/prerequisites.h"
+#include "yake/base/yakePrerequisites.h"
+#include <string>
+#include <map>
+#include <set>
+#include <deque>
+#include <vector>
+#include <algorithm>
+#include <boost/any.hpp>
+#include <cassert>
+#include <boost/signal.hpp>
+#include <boost/any.hpp>
+
+namespace yake {
+
+
+
+} // namespace yake
+
+#endif
\ No newline at end of file

Added: trunk/yake/yake/prop/prop.h
===================================================================
--- trunk/yake/yake/prop/prop.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/prop/prop.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,86 @@
+#ifndef YAKE_PROP_H
+#define YAKE_PROP_H
+
+#include "prerequisites.h"
+
+namespace yake {
+
+	struct Prop
+	{
+	public:
+		friend struct PropDef;
+
+		template<typename T>
+		bool setValue(const T& v)
+		{
+			try {
+				boost::any_cast<T>(value_); // <- test for type mismatch!
+				value_ = v;
+				return true;
+			} 
+			catch (boost::bad_any_cast&)
+			{
+				std::cout << "Prop::setValue() ERROR: type mismatch. '" << def_.type() << "' expected, got '" << typeid(v).name() << "'\n";
+				return false;
+			}
+		}
+		template<typename T>
+		bool getValue(T& v) const
+		{
+			try {
+				v = boost::any_cast<T>(value_);
+				return true;
+			} 
+			catch (boost::bad_any_cast&)
+			{
+				return false;
+			}
+		}
+		void setValue(const boost::any& value) // @todo Unsafe! Fix this somehow!
+		{ value_ = value; }
+		const PropDef& def() const
+		{ return def_; }
+	private:
+		Prop();
+		Prop(const PropDef& def, const boost::any& defaultValue) :
+		value_(defaultValue), def_(def)
+		{}
+	private:
+		boost::any				value_;
+		const PropDef&			def_;
+	};
+	typedef std::vector<Prop> PropList;
+
+
+	typedef std::map<std::string,Prop*> StringPropPtrMap;
+	inline std::ostream& operator << (std::ostream& out, const StringPropPtrMap& props)
+	{
+		out << "properties=(\n";
+		for (StringPropPtrMap::const_iterator it = props.begin(); it != props.end(); ++it)
+		{
+			out << "      '" << it->first << "' : '" << it->second->def().type() << "' = ";
+			const std::string type = it->second->def().type();
+			/*if (type == "struct vector3")
+			{
+				vector3 v;
+				it->second->getValue<vector3>(v);
+				out << v;
+			}
+			else*/ if (type == "int")
+			{
+				int v;
+				it->second->getValue<int>(v);
+				out << v;
+			}
+			else
+				out << "(unhandled value type)";
+			out << "\n";
+		}
+		out << "   )\n";
+		return out;
+	}
+
+
+} // namespace yake
+
+#endif

Added: trunk/yake/yake/prop/prop_def.h
===================================================================
--- trunk/yake/yake/prop/prop_def.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/prop/prop_def.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,61 @@
+#ifndef YAKE_PROP_DEF_H
+#define YAKE_PROP_DEF_H
+
+#include "prerequisites.h"
+
+namespace yake {
+
+	struct Prop;
+	struct PropDef
+	{
+		PropDef() {}
+		PropDef(const PropDef& other) :
+		name_(other.name_),
+			description_(other.description_),
+			type_(other.type_),
+			defaultValue_(other.defaultValue_)
+		{}
+		PropDef& operator = (const PropDef& rhs)
+		{
+			name_ = rhs.name_;
+			description_ = rhs.description_;
+			type_ = rhs.type_;
+			defaultValue_ = rhs.defaultValue_;
+			return *this;
+		}
+		template<typename T>
+		PropDef(const std::string& name, const std::string& desc, const T& defaultValue) :
+		name_(name),
+			description_(desc),
+			defaultValue_(defaultValue),
+			type_(typeid(T).name())
+		{
+		}
+		std::string name() const
+		{ return name_; }
+		std::string description() const;
+		std::string type() const
+		{ return type_; }
+		Prop* create() const;
+		boost::any getDefaultValue() const
+		{ return defaultValue_; }
+	private:
+		std::string		name_;
+		std::string		description_;
+		std::string		type_;
+		boost::any		defaultValue_;
+	};
+	inline std::ostream& operator << (std::ostream& out, const PropDef& propdef)
+	{
+		out << "PropDef(name='" << propdef.name() << "', type='" << propdef.type() << "')";
+		return out;
+	}
+} // namespace yake
+
+	#include "prop.h"
+namespace yake {
+	inline Prop* PropDef::create() const
+	{ return new Prop(*this,defaultValue_); }
+} // namespace yake
+
+#endif
\ No newline at end of file

Added: trunk/yake/yake/prop/prop_holder.h
===================================================================
--- trunk/yake/yake/prop/prop_holder.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/prop/prop_holder.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,101 @@
+#ifndef YAKE_PROP_HOLDER_H
+#define YAKE_PROP_HOLDER_H
+
+#include "prerequisites.h"
+#include <iostream> // std::cout for warnings
+
+namespace yake {
+
+	struct RttiClass;
+	template<typename T>
+	struct PropHolder
+	{
+		PropHolder()
+		{
+			//if (!ms_cls)
+			//	ms_cls = new RttiClass();
+		}
+		virtual ~PropHolder() {}
+
+		virtual RttiClass* isA() const = 0;
+
+		template<typename T>
+		bool getValue(const std::string& name, T& retValue) const
+		{
+			StringPropPtrMap::const_iterator it = props_.find(name);
+			if (it == props_.end())
+				return false;
+			assert( it->second );
+			return it->second->getValue<T>(retValue);
+		}
+		template<typename T>
+		bool setValue(const std::string& name, const T& value)
+		{
+			StringPropPtrMap::iterator it = props_.find(name);
+			if (it == props_.end())
+				return false;
+			assert( it->second );
+			return it->second->setValue<T>(value);
+		}
+
+		std::ostream& dump(std::ostream& out) const
+		{
+			out << "object(type='" << isA()->name() << "')\n";
+			out << "   " << props_;
+			return out;
+		}
+
+		void init()
+		{
+			initProps( *isA(), props_ );
+		}
+	private:
+		void initProps(const RttiClass& cls, StringPropPtrMap& props)
+		{
+			const RttiClass::ParentClassList& parentClsList = cls.getParents();
+			RttiClass::ParentClassList::const_iterator itClsEnd = parentClsList.end();
+			for (RttiClass::ParentClassList::const_iterator itCls = parentClsList.begin(); itCls != itClsEnd; ++itCls)
+				initProps(**itCls, props);
+
+			const PropDefMap& defs = cls.getPropDefs();
+			PropDefMap::const_iterator itDefEnd = defs.end();
+			for (PropDefMap::const_iterator itDef = defs.begin(); itDef != itDefEnd; ++itDef)
+			{
+				const PropDef& def = itDef->second;
+				if (def.name().empty())
+				{
+					std::cout << "warning: empty property name in class '" << cls.name() << "'. skipping.\n";
+					continue;
+				}
+				StringPropPtrMap::const_iterator itFind = props.find(def.name());
+				if (itFind == props.end())
+				{
+					props[ def.name() ] = def.create();
+				}
+				else
+				{
+					const PropDef& baseDef = itFind->second->def();
+					std::cout << "warning: class '" << cls.name() << "' attempts to override inherited property '" << def.name() << "'\n";
+					if (def.type() == baseDef.type())
+					{
+						std::cout << "  => override of default value accepted.\n";
+						itFind->second->setValue( def.getDefaultValue() );
+					}
+					else
+					{
+						std::cout << "  => type mismatch. could not override default value.\n";
+					}
+				}
+			}
+		}
+
+		//static const RttiClass* getRttiClass();
+	private:
+		//static RttiClass* ms_cls; // @todo make it auto_ptr
+		StringPropPtrMap		props_;
+	};
+	//template<typename T> RttiClass PropHolder<T>::ms_cls = 0;
+
+} // namespace yake
+
+#endif

Added: trunk/yake/yake/prop/rtti_class.h
===================================================================
--- trunk/yake/yake/prop/rtti_class.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/prop/rtti_class.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,195 @@
+#ifndef YAKE_PROP_RTTI_CLASS_H
+#define YAKE_PROP_RTTI_CLASS_H
+
+#include "prerequisites.h"
+#include <sstream>
+
+namespace yake {
+
+	typedef std::vector<PropDef> PropDefList;
+	typedef std::map<std::string,PropDef> PropDefMap;
+	struct RttiClass;
+	struct RttiClassTemplate;
+	struct RttiClassMgr;
+	typedef std::set<const RttiClass*> RttiClassConstPtrSet;
+	struct RttiClass
+	{
+	public:
+		// "Class c'tor"
+		RttiClass(const std::string& name) : name_(name) {}
+		RttiClass(const std::string& name, const std::string& parent0) : 
+		name_(name) 
+		{
+			addParent( parent0 );
+		}
+		RttiClass(const std::string& name, const std::string& parent0, const std::string& parent1) : 
+		name_(name) 
+		{
+			addParent( parent0 );
+			addParent( parent1 );
+		}
+		// "ClassTemplate c'tor"
+		RttiClass(const std::string& name, const RttiClass& orig) :
+		name_(name),
+			props_(orig.props_),
+			parents_(orig.parents_),
+			parentNames_(orig.parentNames_),
+			parentPtrs_(orig.parentPtrs_)
+		{
+		}
+		std::string name() const
+		{ return name_; }
+
+		typedef RttiClassConstPtrSet ParentClassList;
+		const ParentClassList& getParents() const
+		{ return parentPtrs_;  }
+
+		typedef std::deque<std::string> StringList;
+		const StringList& getParentNames() const
+		{
+			return parentNames_;
+		}
+
+		void addParent(const std::string& clsName)
+		{
+			assert( !clsName.empty() );
+			assert( parents_.find(clsName) == parents_.end() );
+			parents_[ clsName ] = 0;
+			parentNames_.push_back( clsName );
+		}
+
+		const PropDefMap& getPropDefs() const
+		{ return props_; }
+		void add(const PropDef&);
+
+		//void setName_(const std::string& name) { name_ = name; }
+	private:
+		friend struct RttiClassMgr;
+		void setParent(const std::string& clsName, RttiClass* cls)
+		{
+			assert( cls );
+			assert( !clsName.empty() );
+			assert( parents_.find(clsName) != parents_.end() );
+			parents_[ clsName ] = cls;
+			parentPtrs_.insert(cls);
+		}
+	private:
+		std::string						name_;
+		PropDefMap						props_;
+
+		typedef std::map<std::string,RttiClass*> ParentClassMap;
+		ParentClassMap					parents_;
+		StringList						parentNames_;
+		ParentClassList				parentPtrs_;
+	};
+	inline std::ostream& operator << (std::ostream& out, const RttiClass& cls)
+	{
+		out << "RttiClass(name='" << cls.name() << "')\n";
+		for (RttiClass::StringList::const_iterator itClsName = cls.getParentNames().begin();  itClsName != cls.getParentNames().end(); ++itClsName)
+			out << "   inherits from '" << *itClsName << "' (name)\n";
+		for (RttiClassConstPtrSet::const_iterator itCls = cls.getParents().begin(); itCls != cls.getParents().end(); ++itCls)
+			out << "   inherits from '" << (*itCls)->name() << "' (ptr)\n";
+		for (PropDefMap::const_iterator it = cls.getPropDefs().begin(); it != cls.getPropDefs().end(); ++it)
+		{
+			out << "   property '" << it->first.c_str() << "' = " << it->second.type() << "\n";
+		}
+		return out;
+	}
+
+	struct RttiException : public std::exception
+	{
+		RttiException(const std::string& msg, const std::string& loc = "", const char* file = 0, const int line = 0)
+		{
+			std::stringstream out;
+			out << "RttiException:\n";
+			out << "  Reason: " << msg << "\n";
+			if (!loc.empty())
+				out << "  Location: " << loc << "\n";
+			if (file)
+				out << "  File: " << file << "@" << line << "\n";
+			msg_ = out.str();
+		}
+		const char* what() const
+		{ return msg_.c_str(); }
+	private:
+		std::string		msg_;
+	};
+#define THROW_RTTI(MSG) \
+	throw RttiException(MSG,"",__FILE__,__LINE__)
+#define THROW_RTTI_LOC(MSG,LOC) \
+	throw RttiException(MSG,LOC,__FILE__,__LINE__)
+
+	struct RttiClassMgr
+	{
+		// insert into existing hierarchy
+		void insert(RttiClass*) throw(RttiException);
+		void erase(RttiClass*) throw(RttiException);
+		RttiClass* get(const std::string&) const throw() ;
+	private:
+		typedef std::map<std::string,RttiClass*> StringClassPtrMap;
+		StringClassPtrMap	classes_;
+	};
+	inline RttiClass* RttiClassMgr::get(const std::string& clsName) const
+	{
+		StringClassPtrMap::const_iterator it = classes_.find(clsName);
+		return (it == classes_.end()) ? 0 : it->second;
+	}
+	inline void RttiClassMgr::insert(RttiClass* cls)
+	{
+		assert( cls );
+		if (!cls)
+			THROW_RTTI_LOC("Null class pointer.","RttiClassMgr::insert");
+		const std::string clsName = cls->name();
+		if (clsName.empty())
+			THROW_RTTI_LOC("Empty class name.","RttiClassMgr::insert");
+		StringClassPtrMap::const_iterator it = classes_.find(clsName);
+		if (it != classes_.end())
+			THROW_RTTI_LOC("Entry for this class name already exists!","RttiClassMgr::insert");
+
+		// find parents and other referenced objects
+		const RttiClass::StringList& parentNames = cls->getParentNames();
+		if (!parentNames.empty())
+		{
+			for (RttiClass::StringList::const_iterator itName = parentNames.begin(); itName != parentNames.end(); ++itName)
+			{
+				RttiClass* parentCls = get(*itName);
+				if (parentCls)
+					cls->setParent(*itName,parentCls);
+				else
+					THROW_RTTI_LOC("Parent class not registered!","RttiClassMgr::insert");
+			}
+		}
+
+		// finally insert
+		classes_.insert( std::make_pair(clsName,cls) );
+
+		// post-process
+	}
+	inline void RttiClass::add(const PropDef & propdef)
+	{
+		props_[ propdef.name() ] = propdef;
+	}
+
+	#define DECL_CLASS_RTTI(CLASS,DESC) \
+	public: \
+		static std::string clsName()  \
+		{ return std::string( #CLASS ); } \
+		static std::string clsDescription()  \
+		{ return std::string( DESC ); } \
+		static ::yake::RttiClass* cls() \
+		{ return &ms_cls; } \
+		virtual ::yake::RttiClass* isA() const \
+		{ return &ms_cls; } \
+	private: \
+		static ::yake::RttiClass ms_cls; \
+	public:
+
+	#define IMPL_CLASS_RTTI(CLASS) \
+		::yake::RttiClass CLASS::ms_cls( CLASS::clsName() );
+
+	#define IMPL_CLASS_RTTI_1(CLASS,PARENT1) \
+		::yake::RttiClass CLASS::ms_cls( CLASS::clsName(), PARENT1 );
+
+} // namespace yake
+
+#endif

Added: trunk/yake/yake/statemachine/fsm_core.h
===================================================================
--- trunk/yake/yake/statemachine/fsm_core.h	2006-03-05 18:33:21 UTC (rev 1218)
+++ trunk/yake/yake/statemachine/fsm_core.h	2006-03-05 18:39:30 UTC (rev 1219)
@@ -0,0 +1,265 @@
+#ifndef FSM_CORE_H
+#define FSM_CORE_H
+
+#include <cassert> // assert()
+#include <string>
+#include <iostream> // std::cout in debug mode
+#include <map>
+
+// If defined the initial state is a null state.
+// What a null state is and whether a state is a null state
+// is determined by two templated functions for which specializations
+// may or may not be needed depending on the target type.
+// Specializations for common built-in and STL types are provided.
+// The functions are: get_null_state<>(), is_state_null<>(..).
+//
+// If not defined, the initial state will be set to whatever the constructor
+// of the state type sets it to.
+//
+// The initial state can be set to any state already registered with the machine
+// using machine<>::setState(..).
+//
+
+#define FSM_USE_NULL_STATE
+
+namespace fsm {
+#if defined(FSM_USE_NULL_STATE)
+	template<typename state_type_>
+	const state_type_& get_null_state();
+
+	template<typename state_type_>
+	inline bool is_state_null(const state_type_& state)
+	{
+		return (state == get_null_state<state_type_>());
+	}
+
+	template<>
+	inline const int& get_null_state()
+	{
+		static int ms_null = 0xffffffff;
+		return ms_null;
+	}
+	template<>
+	inline const unsigned char& get_null_state()
+	{
+		static unsigned char ms_null = 0xff;
+		return ms_null;
+	}
+	template<>
+	inline const std::string& get_null_state()
+	{
+		static std::string ms_null = "null";
+		return ms_null;
+	}
+#endif
+	template<typename T1>
+	struct do_nothing_on_one
+	{
+		void operator()(const T1&)
+		{}
+	};
+	template<typename T1, typename T2>
+	struct do_nothing_on_two
+	{
+		void operator()(const T1&,const T2&)
+		{}
+	};
+
+	template<typename _state_type, typename _event_type>
+	struct machine
+	{
+		// types
+		typedef _state_type state_type;
+		typedef _event_type event_type;
+		typedef machine machine_type;
+
+		typedef do_nothing_on_one<state_type> do_nothing_state_op;
+		typedef do_nothing_on_two<machine_type,state_type> do_nothing_op;
+
+		// construction
+#if defined(FSM_USE_NULL_STATE)
+		machine() : 
+			curr_(get_null_state<state_type>()) 
+#else
+		machine()
+#endif
+		{}
+
+		// operations
+		void addState(const state_type&);
+		//? void addEvent(const event_type);
+		void addTransition(const state_type&, const event_type&, const state_type&);
+		void setState(const state_type&);
+
+		void clear();
+
+		size_t numStates() const;
+		size_t numOffgoingTransitions(const state_type&) const; // off-going transitions for source state
+		const state_type& current() const;
+
+#ifdef _DEBUG
+		void dump(std::ostream& out) const
+		{
+			out << "machine<>::dump()\n";
+			out << "  current = '" << curr_ << "'\n";
+			for (state_map::const_iterator it = states_.begin(); it != states_.end(); ++it)
+			{
+				out << "  state '" << it->first << "'\n";
+				const event_state_map& evt2state = it->second.offgoing_transitions;
+				for (event_state_map::const_iterator itT = evt2state.begin(); itT != evt2state.end(); ++itT)
+				{
+					out << "    event '" << itT->first << "' -> state '" << itT->second << "'\n";
+				}
+			}
+		}
+#endif
+
+		std::pair<bool,std::string> validate();
+
+		void processEvent(const event_type& evt)
+		{
+			do_nothing_op do_nothing;
+			processEventCb(evt, do_nothing, do_nothing);
+		}
+
+		template<typename enter_state_op_t, typename exit_state_op_t>
+		void processEventCb(const event_type& evt, enter_state_op_t& enterOp, exit_state_op_t& exitOp)
+		{
+			const state_map::const_iterator it = states_.find( curr_ );
+			if (it == states_.end())
+			{
+				std::cerr << "error: machine<>::processEventCb():\n   invalid current state.\n\n";
+				return;
+			}
+			const event_state_map& evt2state = it->second.offgoing_transitions;
+			const event_state_map::const_iterator itFindTransition = evt2state.find(evt);
+			if (itFindTransition == evt2state.end())
+			{
+				std::cerr << "error: machine<>::processEventCb():\n   transition not found! (evt=" << evt << ", src=" << it->first << ")\n\n";
+				return;
+			}
+			exitOp(*this,curr_);
+			curr_ = itFindTransition->second;
+			enterOp(*this,curr_);
+		}
+
+	private:
+		// @todo hash_map<> or AssocVector<>
+		typedef std::map<event_type,state_type> event_state_map;
+		struct state_e
+		{
+			event_state_map offgoing_transitions;
+			//void* userdata;
+		};
+		typedef std::map<state_type,state_e> state_map;
+		state_map		states_;
+		state_type		curr_;
+	};
+	template<typename _state_type, typename _event_type>
+	void machine<_state_type,_event_type>::setState(const state_type& dest)
+	{
+		const state_map::const_iterator it = states_.find( dest );
+		if (it == states_.end())
+		{
+			std::cerr << "error: machine<>::setState():\n   unregistered state.\n\n";
+			return;
+		}
+		curr_ = dest;
+	}
+	template<typename _state_type, typename _event_type>
+	const _state_type& machine<_state_type,_event_type>::current() const
+	{
+		return curr_;
+	}
+	template<typename _state_type, typename _event_type>
+	void machine<_state_type,_event_type>::clear()
+	{
+#if defined(FSM_USE_NULL_STATE)
+		curr_ = get_null_state<state_type>();
+#else
+		curr_ = state_type();
+#endif
+		states_.clear();
+	}
+#if 0 // alternative implementation
+	template<typename _state_type, typename _event_type>
+	void machine<_state_type,_event_type>::processEvent(const event_type& evt)
+	{
+		const state_map::const_iterator it = states_.find( curr_ );
+		if (it == states_.end())
+		{
+			std::cerr << "error: machine<>::processEvent():\n   invalid current state.\n\n";
+			return;
+		}
+		const event_state_map& evt2state = it->second.offgoing_transitions;
+		const event_state_map::const_iterator itFindTransition = evt2state.find(evt);
+		if (itFindTransition == evt2state.end())
+		{
+			std::cerr << "error: machine<>::processEvent():\n   transition not found! (evt=" << evt << ", src=" << it->first << ")\n\n";
+			return;
+		}
+		curr_ = itFindTransition->second;
+	}
+#endif
+	template<typename _state_type, typename _event_type>
+	void machine<_state_type,_event_type>::addState(const state_type& state)
+	{
+		state_map::iterator it = states_.find( state );
+		if (it == states_.end())
+		{
+			states_.insert( state_map::value_type(state,state_e()) );
+			return;
+		}
+#ifdef _DEBUG
+		std::cerr << "error: machine<>::addState():\n   state already exists!\n\n";
+#endif
+	}
+	template<typename _state_type, typename _event_type>
+	void machine<_state_type,_event_type>::addTransition(const state_type& src, const event_type& evt, const state_type& dest)
+	{
+		if (src == dest) // @todo Allow this !? Optionally? Shouldn't do much harm...
+		{
+			std::cerr << "error: machine<>::addTransition():\n   source and destination are identical!\n\n";
+			return;
+		}
+		state_map::iterator it = states_.find( src );
+		if (it == states_.end())
+		{
+			std::cerr << "error: machine<>::addTransition():\n   unregistered source state!\n\n";
+			return;
+		}
+		{
+			const state_map::const_iterator itDest = states_.find( dest );
+			if (itDest == states_.end())
+			{
+				std::cerr << "error: machine<>::addTransition():\n   unregistered destination state!\n\n";
+				return;
+			}
+		}
+		event_state_map& evt2state = it->second.offgoing_transitions;
+#ifdef _DEBUG
+		if (evt2state.find(evt) != evt2state.end())
+		{
+			std::cerr << "error: machine<>::addTransition():\n   transition for this combination of source and event already exists!\n\n";
+			return;
+		}
+#endif
+		evt2state.insert( event_state_map::value_type( evt, dest) );
+#ifdef _DEBUG
+		std::cout << "machine<>::addTransition(): from=" << src << " evt=" << evt << " dest=" << dest << "\n";
+#endif
+	}
+	template<typename _state_type, typename _event_type>
+	size_t machine<_state_type,_event_type>::numStates() const
+	{
+		return states_.size();
+	}
+	template<typename _state_type, typename _event_type>
+	size_t machine<_state_type,_event_type>::numOffgoingTransitions(const state_type& src) const
+	{
+		const state_map::const_iterator it = states_.find( src );
+		return ( (it == states_.end()) ? 0 : it->second.offgoing_transitions.size() );
+	}
+} // namespace fsm
+
+#endif



From codeandroid at berlios.de  Sun Mar  5 19:41:42 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:41:42 +0100
Subject: [Yake-svn] r1222 - trunk/yake/src/yake/ent
Message-ID: <200603051841.k25IfgVI031790@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:41:06 +0100 (Sun, 05 Mar 2006)
New Revision: 1222

Modified:
   trunk/yake/src/yake/ent/vm_holder.cpp
Log:
no ownership transfer for now

Modified: trunk/yake/src/yake/ent/vm_holder.cpp
===================================================================
--- trunk/yake/src/yake/ent/vm_holder.cpp	2006-03-05 18:40:39 UTC (rev 1221)
+++ trunk/yake/src/yake/ent/vm_holder.cpp	2006-03-05 18:41:06 UTC (rev 1222)
@@ -6,6 +6,8 @@
 
 	VMHolder::~VMHolder()
 	{
+		YAKE_ASSERT( vms_.empty() );
+		/*
 		ConstVectorIterator<VmMap> it(vms_);
 		while (it.hasMoreElements())
 		{
@@ -13,6 +15,7 @@
 			if (v.second)
 				delete v.second;
 		}
+		*/
 		vms_.clear();
 	}
 	bool VMHolder::attachVM(scripting::IVM* vm,const std::string& tag)



From codeandroid at berlios.de  Sun Mar  5 19:42:07 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:42:07 +0100
Subject: [Yake-svn] r1223 - trunk/yake/src/yake/samples/ent/sampleEntFsm
Message-ID: <200603051842.k25Ig79l032078@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:41:51 +0100 (Sun, 05 Mar 2006)
New Revision: 1223

Modified:
   trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp
Log:
destroy VM as ownership is not transferred anymore

Modified: trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp
===================================================================
--- trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp	2006-03-05 18:41:06 UTC (rev 1222)
+++ trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp	2006-03-05 18:41:51 UTC (rev 1223)
@@ -25,6 +25,12 @@
 
 			obj->attachVM(vm,"main");
 		}
+		virtual void onDestroyObject(object::Object* obj)
+		{
+			scripting::IVM* vm = obj->detachVM("main");
+			YAKE_ASSERT( vm );
+			delete vm;
+		}
 		virtual void onObjectInitialized(object::Object* obj)
 		{
 			obj->addFsmState(ksAwakening);



From codeandroid at berlios.de  Sun Mar  5 19:42:35 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:42:35 +0100
Subject: [Yake-svn] r1224 - trunk/yake/src/yake/samples/net/roserver
Message-ID: <200603051842.k25IgZjD032335@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:42:33 +0100 (Sun, 05 Mar 2006)
New Revision: 1224

Modified:
   trunk/yake/src/yake/samples/net/roserver/demo.cpp
Log:
improved threaded handling

Modified: trunk/yake/src/yake/samples/net/roserver/demo.cpp
===================================================================
--- trunk/yake/src/yake/samples/net/roserver/demo.cpp	2006-03-05 18:41:51 UTC (rev 1223)
+++ trunk/yake/src/yake/samples/net/roserver/demo.cpp	2006-03-05 18:42:33 UTC (rev 1224)
@@ -19,7 +19,10 @@
 
 		COUTLN("waiting for key press...");
 		while (!_kbhit())
+		{
+			serverApp.step();
 			net::native::sleep(10);
+		}
 		_getch();
 
 		COUTLN("stopping...");



From codeandroid at berlios.de  Sun Mar  5 19:43:49 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:43:49 +0100
Subject: [Yake-svn] r1225 - trunk/yake/src/yapp/samples/base/statemachine
Message-ID: <200603051843.k25IhnCN032549@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:43:42 +0100 (Sun, 05 Mar 2006)
New Revision: 1225

Modified:
   trunk/yake/src/yapp/samples/base/statemachine/yakeDemo.cpp
Log:
added transition

Modified: trunk/yake/src/yapp/samples/base/statemachine/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/base/statemachine/yakeDemo.cpp	2006-03-05 18:42:33 UTC (rev 1224)
+++ trunk/yake/src/yapp/samples/base/statemachine/yakeDemo.cpp	2006-03-05 18:43:42 UTC (rev 1225)
@@ -174,7 +174,7 @@
 						));
 
 	// transition "dead" -> "afterlife" [ Note: using member functions! ]
-	theHero.getCharacterMachine().addTransition( "dead", "afterlife", new state::Transition(boost::bind(Hero::transToAfterLife,&theHero)) );
+	theHero.getCharacterMachine().addTransition( "dead", "afterlife", new state::Transition(boost::bind(&Hero::transToAfterLife,&theHero)) );
 
 	// transition "alive" -> "alive"
 	theHero.getCharacterMachine().addTransition( "alive", "alive", new state::Transition(boost::bind(&transAliveReset)) );



From codeandroid at berlios.de  Sun Mar  5 19:45:18 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:45:18 +0100
Subject: [Yake-svn] r1226 - trunk/yake/yake/graphics
Message-ID: <200603051845.k25IjI25000476@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:45:02 +0100 (Sun, 05 Mar 2006)
New Revision: 1226

Modified:
   trunk/yake/yake/graphics/yakeGraphicsSystem.h
Log:
removed namespace base

Modified: trunk/yake/yake/graphics/yakeGraphicsSystem.h
===================================================================
--- trunk/yake/yake/graphics/yakeGraphicsSystem.h	2006-03-05 18:43:42 UTC (rev 1225)
+++ trunk/yake/yake/graphics/yakeGraphicsSystem.h	2006-03-05 18:45:02 UTC (rev 1226)
@@ -41,8 +41,8 @@
 namespace yake {
 namespace graphics {
 
-	using namespace yake::base::mpl;
-	using namespace yake::base::templates;
+	using namespace yake::mpl;
+	using namespace yake::templates;
 
 	//struct SceneSerializer
 	//{



From codeandroid at berlios.de  Sun Mar  5 19:48:13 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 5 Mar 2006 19:48:13 +0100
Subject: [Yake-svn] r1227 - trunk/yake/scripts/msvc8
Message-ID: <200603051848.k25ImDnj002106@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-05 19:48:11 +0100 (Sun, 05 Mar 2006)
New Revision: 1227

Modified:
   trunk/yake/scripts/msvc8/yapp.vcproj
Log:
removed state machine (deprecated - statemachine can now be found in /yake)

Modified: trunk/yake/scripts/msvc8/yapp.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/yapp.vcproj	2006-03-05 18:45:02 UTC (rev 1226)
+++ trunk/yake/scripts/msvc8/yapp.vcproj	2006-03-05 18:48:11 UTC (rev 1227)
@@ -679,18 +679,6 @@
 			</File>
 		</Filter>
 		<Filter
-			Name="statemachine"
-			>
-			<File
-				RelativePath="..\..\src\yapp\statemachine\yakeFiniteStateMachine.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yapp\statemachine\yakeFiniteStateMachine.h"
-				>
-			</File>
-		</Filter>
-		<Filter
 			Name="trigger"
 			>
 			<File



From codeandroid at berlios.de  Sun Mar 12 19:32:20 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:32:20 +0100
Subject: [Yake-svn] r1228 - trunk/yake/documentation/api
Message-ID: <200603121832.k2CIWKeK013636@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:32:17 +0100 (Sun, 12 Mar 2006)
New Revision: 1228

Added:
   trunk/yake/documentation/api/DoxySfile
Log:
initial revision

Added: trunk/yake/documentation/api/DoxySfile
===================================================================
--- trunk/yake/documentation/api/DoxySfile	2006-03-05 18:48:11 UTC (rev 1227)
+++ trunk/yake/documentation/api/DoxySfile	2006-03-12 18:32:17 UTC (rev 1228)
@@ -0,0 +1,183 @@
+# DoxySfile 0.87b
+
+#---------------------------------------------------------------------------
+# General configuration options
+#---------------------------------------------------------------------------
+PROJECT_NAME                        = Yake
+PROJECT_NUMBER                      = 
+#INPUT                               = yake/base/math yake/base/mpl yake/base/native yake/base/templates yake/base
+#INPUT                               = yake/audio yake/data yake/ent yake/file yake/graphics yake/input yake/net yake/object yake/physics yake/prop yake/scripting yake/statemachine
+#INPUT                               = yake/base
+INPUT                               = yake/base/math yake/base/mpl yake/base/native yake/base/templates yake/base yake/audio yake/data yake/ent yake/file yake/graphics yake/input yake/net yake/object yake/physics yake/prop yake/scripting yake/statemachine
+OUTPUT_DIRECTORY                    = documentation/api/html
+GENERATE_DOXYS_HELP                 = YES
+HTML_FILE_EXTENSION                 = .html
+CUSTOM_DIR                          = 
+SERVER_STATISTICS                   = 
+HTML_HELP_SERVER_PATH               = 
+STRIP_CODE_COMMENTS                 = YES
+#---------------------------------------------------------------------------
+# Special options (rarely changed)
+#---------------------------------------------------------------------------
+DELETE_OUTPUT_DIRECTORY             = YES
+MS_DOT_NET_INTEGRATION              = NO
+MS_DOT_NET_INTEGRATION_PATH         = 
+GENERATE_HTMLHELP1                  = NO
+GENERATE_STATISTICS                 = NO
+#---------------------------------------------------------------------------
+# Search page options
+#---------------------------------------------------------------------------
+CREATE_SEARCHPAGE                   = YES
+SEARCH_BRIEF_DESCRIPTION            = YES
+SEARCH_FUNCTIONS                    = YES
+SEARCH_VARIABLES                    = YES
+SEARCH_TYPEDEFS_ETC                 = YES
+#---------------------------------------------------------------------------
+# Specify what is included in the output
+#---------------------------------------------------------------------------
+CREATE_DOC_FOR_FILES                = YES
+CREATE_SOURCECODE_FOR_FILES         = NO
+CREATE_SOURCECODE_FOR_MEMBERS       = NO
+EXTRACT_PRIVATE                     = NO
+EXTRACT_PROTECTED                   = YES
+EXTRACT_STATIC                      = YES
+EXTRACT_LOCAL_CLASSES               = YES
+HIDE_UNDOC_NAMESPACES               = NO
+HIDE_UNDOC_CLASSES                  = NO
+HIDE_UNDOC_FUNCTIONS                = NO
+HIDE_UNDOC_VARIABLES                = NO
+HIDE_UNDOC_ENUMS                    = NO
+HIDE_UNDOC_ENUM_VALUES              = NO
+HIDE_UNDOC_TYPEDEFS                 = NO
+HIDE_UNDOC_MACROS                   = NO
+HIDE_UNDOC_DEFINES                  = YES
+GENERATE_TODOLIST                   = YES
+GENERATE_BUGLIST                    = YES
+GENERATE_DEPRECATEDLIST             = YES
+#---------------------------------------------------------------------------
+# Customize how the documentation is generated
+#---------------------------------------------------------------------------
+MEMBER_SAME_FILE_RELATE_TO_CLASSES  = YES
+MEMBER_SAME_FILE_RELATE_TO_STRUCTS  = NO
+FULL_PATH_NAMES                     = NO
+STRIP_FROM_PATH                     = 
+INTERNAL_DOCS                       = NO
+TODO_DOCS                           = YES
+INHERIT_DOCS                        = YES
+HIDE_CLASS_METHODS_IN_OVERVIEW      = NO
+#---------------------------------------------------------------------------
+# Customize layout for pure text projects (ie containing no code)
+#---------------------------------------------------------------------------
+PAGE_DOCUMENTATION_MODE             = NO
+#---------------------------------------------------------------------------
+# Options to control how the input is parsed
+#---------------------------------------------------------------------------
+HIDE_IN_BODY_DOCS                   = YES
+TAB_SIZE                            = 3
+ALIASES                             = 
+ENABLED_SECTIONS                    = 
+IGNORE_CLASS_PREFIX                 = 
+#---------------------------------------------------------------------------
+# configuration options related to warning and progress messages
+#---------------------------------------------------------------------------
+QUIET                               = NO
+WARNINGS                            = YES
+WARN_IF_UNDOCUMENTED                = NO
+WARN_IF_DOC_ERROR                   = YES
+WARN_FORMAT                         = "$file:$line: $text"
+WARN_LOGFILE                        = 
+#---------------------------------------------------------------------------
+# Configuration options related to the input files
+#---------------------------------------------------------------------------
+IGNORE_FILE_NAME                    = DoxyS.ignore
+FILE_PATTERNS                       = *.inl *.h *.hh *.hxx *.hpp *.h++ 
+RECURSIVE                           = NO
+EXCLUDE                             = doxys_docs/ yake/reflection/ yake/samples
+EXCLUDE_SYMLINKS                    = NO
+EXCLUDE_PATTERNS                    = 
+EXAMPLE_PATH                        = 
+IMAGE_PATH                          = 
+INPUT_FILTER                        = 
+FILTER_SOURCE_FILES                 = NO
+#---------------------------------------------------------------------------
+# Configuration options related to the HTML layout
+#---------------------------------------------------------------------------
+NAVIGATION_CHAR_LENGTH              = 25
+LIMIT_COMPACT_IN_OVERVIEW_TABLES    = 100
+COLS_IN_OVERVIEW_TABLES             = 4
+LIMIT_ALFA_INDEX_IN_OVERVIEW_TABLES = 200
+COMPACT_CHAR_LENGTH                 = 25
+INFO_ON_OVERVIEW_TABLES_NORMAL      = YES
+INFO_ON_OVERVIEW_TABLES_COMPACT     = YES
+INCLUDE_BRIEF_IN_HEADER             = YES
+INCLUDE_BRIEF_IN_DESCRIPTION        = YES
+HIDE_TYPE_ON_DESCRIPTION            = NO
+EXPAND_COLLAPSE_SECTIONS            = YES
+EXPAND_COLLAPSE_TABLE_SECTIONS_ONLY = YES
+CENTER_ALIGN_IMAGES                 = NO
+#---------------------------------------------------------------------------
+# Configuration options related to Left Menu layout
+#---------------------------------------------------------------------------
+SHOW_LEFT_MENU                      = YES
+SHOW_LEFT_MENU_MAINDIR              = YES
+SHOW_LEFT_MENU_SEARCH               = YES
+SHOW_LEFT_MENU_DIRECTORY            = YES
+SHOW_LEFT_MENU_DOC                  = YES
+SHOW_LOGO                           = YES
+LEFT_MENU_DIRECTORIES               = YES
+LEFT_MENU_PAGES                     = YES
+LEFT_MENU_CLASSES                   = YES
+LEFT_MENU_FUNCTIONS                 = NO
+LEFT_MENU_MACROS                    = NO
+LEFT_MENU_DEFINES                   = NO
+LEFT_MENU_ATTRIBUTES                = NO
+LEFT_MENU_TYPES                     = NO
+LEFT_MENU_UNITS                     = YES
+#---------------------------------------------------------------------------
+# Configuration options related to header and footer layout
+#---------------------------------------------------------------------------
+HIDE_HEADER_ON_DIRS_AND_PAGES       = NO
+HIDE_FOOTER_ON_DIRS_AND_PAGES       = NO
+HIDE_HEADER_ON_CLASS_AND_MEMBERS    = NO
+HIDE_FOOTER_ON_CLASS_AND_MEMBERS    = NO
+HIDE_HEADER_ON_UNITS                = NO
+HIDE_FOOTER_ON_UNITS                = NO
+#---------------------------------------------------------------------------
+# Configuration options related to the preprocessor   
+#---------------------------------------------------------------------------
+ENABLE_PREPROCESSING                = YES
+MACRO_EXPANSION                     = YES
+EXPAND_ONLY_PREDEF                  = NO
+SEARCH_INCLUDES                     = NO
+INCLUDE_PATH                        = 
+INCLUDE_FILE_PATTERNS               = 
+PREDEFINED                          = 
+EXPAND_AS_DEFINED                   = 
+SKIP_FUNCTION_MACROS                = YES
+#---------------------------------------------------------------------------
+# Configuration options related to the dot tool
+#---------------------------------------------------------------------------
+ENABLE_DOT_GRAPHS                   = YES
+DOT_PATH                            = 
+CLASS_DIAGRAMS                      = YES
+HIDE_UNDOC_RELATIONS                = YES
+CLASS_GRAPH                         = YES
+COLLABORATION_GRAPH                 = YES
+UML_LOOK                            = NO
+TEMPLATE_RELATIONS                  = YES
+INCLUDE_GRAPH                       = YES
+INCLUDED_BY_GRAPH                   = YES
+CALL_GRAPH                          = YES
+GRAPHICAL_HIERARCHY                 = YES
+DOT_IMAGE_FORMAT                    = png
+DOTFILE_DIRS                        = 
+MAX_DOT_GRAPH_WIDTH                 = 1024
+MAX_DOT_GRAPH_HEIGHT                = 1024
+MAX_DOT_GRAPH_DEPTH                 = 0
+CENTER_ALIGN_DOT_IMAGES             = NO
+DOT_CLEANUP                         = YES
+#---------------------------------------------------------------------------
+# Language options
+#---------------------------------------------------------------------------
+OUTPUT_LANGUAGE                     = English
+USE_WINDOWS_ENCODING                = YES



From codeandroid at berlios.de  Sun Mar 12 19:33:02 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:33:02 +0100
Subject: [Yake-svn] r1229 - trunk/yake/documentation/api
Message-ID: <200603121833.k2CIX2pQ014087@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:33:00 +0100 (Sun, 12 Mar 2006)
New Revision: 1229

Modified:
   trunk/yake/documentation/api/makeDocs.cmd
Log:
now using doxys

Modified: trunk/yake/documentation/api/makeDocs.cmd
===================================================================
--- trunk/yake/documentation/api/makeDocs.cmd	2006-03-12 18:32:17 UTC (rev 1228)
+++ trunk/yake/documentation/api/makeDocs.cmd	2006-03-12 18:33:00 UTC (rev 1229)
@@ -1,5 +1,7 @@
 @echo off
 echo Building YAKE API Reference...
-echo NOTE: You need to have doxygen.exe in your path!
-cd ..\..
-doxygen documentation\api\api.cfg
+REM echo NOTE: You need to have doxygen.exe in your path!
+echo NOTE: You need to have doxys[.exe] in your path!
+pushd ..\..
+doxys documentation\api\DoxySfile
+popd



From codeandroid at berlios.de  Sun Mar 12 19:45:26 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:45:26 +0100
Subject: [Yake-svn] r1230 - trunk/yake/yake/prop
Message-ID: <200603121845.k2CIjQlG018432@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:45:19 +0100 (Sun, 12 Mar 2006)
New Revision: 1230

Modified:
   trunk/yake/yake/prop/prop_holder.h
Log:
renamed template parameter

Modified: trunk/yake/yake/prop/prop_holder.h
===================================================================
--- trunk/yake/yake/prop/prop_holder.h	2006-03-12 18:33:00 UTC (rev 1229)
+++ trunk/yake/yake/prop/prop_holder.h	2006-03-12 18:45:19 UTC (rev 1230)
@@ -19,23 +19,23 @@
 
 		virtual RttiClass* isA() const = 0;
 
-		template<typename T>
-		bool getValue(const std::string& name, T& retValue) const
+		template<typename T_value>
+		bool getValue(const std::string& name, T_value& retValue) const
 		{
 			StringPropPtrMap::const_iterator it = props_.find(name);
 			if (it == props_.end())
 				return false;
 			assert( it->second );
-			return it->second->getValue<T>(retValue);
+			return it->second->getValue<T_value>(retValue);
 		}
-		template<typename T>
-		bool setValue(const std::string& name, const T& value)
+		template<typename T_value>
+		bool setValue(const std::string& name, const T_value& value)
 		{
 			StringPropPtrMap::iterator it = props_.find(name);
 			if (it == props_.end())
 				return false;
 			assert( it->second );
-			return it->second->setValue<T>(value);
+			return it->second->setValue<T_value>(value);
 		}
 
 		std::ostream& dump(std::ostream& out) const



From codeandroid at berlios.de  Sun Mar 12 19:45:55 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:45:55 +0100
Subject: [Yake-svn] r1231 - trunk/yake/yake/prop
Message-ID: <200603121845.k2CIjtDA018553@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:45:53 +0100 (Sun, 12 Mar 2006)
New Revision: 1231

Modified:
   trunk/yake/yake/prop/rtti_class.h
Log:
disable warning

Modified: trunk/yake/yake/prop/rtti_class.h
===================================================================
--- trunk/yake/yake/prop/rtti_class.h	2006-03-12 18:45:19 UTC (rev 1230)
+++ trunk/yake/yake/prop/rtti_class.h	2006-03-12 18:45:53 UTC (rev 1231)
@@ -119,6 +119,8 @@
 #define THROW_RTTI_LOC(MSG,LOC) \
 	throw RttiException(MSG,LOC,__FILE__,__LINE__)
 
+#pragma warning(push)
+#pragma warning(disable: 4290) // C4290: C++ exception specification ignored except to indicate a function is not __declspec(nothrow)
 	struct RttiClassMgr
 	{
 		// insert into existing hierarchy
@@ -129,6 +131,7 @@
 		typedef std::map<std::string,RttiClass*> StringClassPtrMap;
 		StringClassPtrMap	classes_;
 	};
+#pragma warning(pop)
 	inline RttiClass* RttiClassMgr::get(const std::string& clsName) const
 	{
 		StringClassPtrMap::const_iterator it = classes_.find(clsName);



From codeandroid at berlios.de  Sun Mar 12 19:47:25 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:47:25 +0100
Subject: [Yake-svn] r1232 - trunk/yake/yake/prop
Message-ID: <200603121847.k2CIlPmV019127@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:47:24 +0100 (Sun, 12 Mar 2006)
New Revision: 1232

Modified:
   trunk/yake/yake/prop/prop.h
   trunk/yake/yake/prop/prop_def.h
Log:
readonly properties

Modified: trunk/yake/yake/prop/prop.h
===================================================================
--- trunk/yake/yake/prop/prop.h	2006-03-12 18:45:53 UTC (rev 1231)
+++ trunk/yake/yake/prop/prop.h	2006-03-12 18:47:24 UTC (rev 1232)
@@ -41,13 +41,13 @@
 		const PropDef& def() const
 		{ return def_; }
 	private:
-		Prop();
-		Prop(const PropDef& def, const boost::any& defaultValue) :
-		value_(defaultValue), def_(def)
+		Prop(const PropDef& def, const boost::any& defaultValue, const bool readOnly) :
+		value_(defaultValue), def_(def), readOnly_(readOnly)
 		{}
 	private:
 		boost::any				value_;
 		const PropDef&			def_;
+		bool						readOnly_;
 	};
 	typedef std::vector<Prop> PropList;
 

Modified: trunk/yake/yake/prop/prop_def.h
===================================================================
--- trunk/yake/yake/prop/prop_def.h	2006-03-12 18:45:53 UTC (rev 1231)
+++ trunk/yake/yake/prop/prop_def.h	2006-03-12 18:47:24 UTC (rev 1232)
@@ -8,7 +8,7 @@
 	struct Prop;
 	struct PropDef
 	{
-		PropDef() {}
+		PropDef(const bool readOnly = false) : readOnly_(readOnly) {}
 		PropDef(const PropDef& other) :
 		name_(other.name_),
 			description_(other.description_),
@@ -24,11 +24,12 @@
 			return *this;
 		}
 		template<typename T>
-		PropDef(const std::string& name, const std::string& desc, const T& defaultValue) :
+		PropDef(const std::string& name, const std::string& desc, const T& defaultValue, const bool readOnly = false) :
 		name_(name),
 			description_(desc),
 			defaultValue_(defaultValue),
-			type_(typeid(T).name())
+			type_(typeid(T).name()),
+			readOnly_(readOnly)
 		{
 		}
 		std::string name() const
@@ -44,6 +45,7 @@
 		std::string		description_;
 		std::string		type_;
 		boost::any		defaultValue_;
+		bool				readOnly_;
 	};
 	inline std::ostream& operator << (std::ostream& out, const PropDef& propdef)
 	{
@@ -55,7 +57,7 @@
 	#include "prop.h"
 namespace yake {
 	inline Prop* PropDef::create() const
-	{ return new Prop(*this,defaultValue_); }
+	{ return new Prop(*this,defaultValue_,readOnly_); }
 } // namespace yake
 
 #endif
\ No newline at end of file



From codeandroid at berlios.de  Sun Mar 12 19:48:27 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:48:27 +0100
Subject: [Yake-svn] r1233 - trunk/yake/yake/base
Message-ID: <200603121848.k2CImRRh019389@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:48:24 +0100 (Sun, 12 Mar 2006)
New Revision: 1233

Modified:
   trunk/yake/yake/base/yakeMovable.h
Log:
absolute namespace

Modified: trunk/yake/yake/base/yakeMovable.h
===================================================================
--- trunk/yake/yake/base/yakeMovable.h	2006-03-12 18:47:24 UTC (rev 1232)
+++ trunk/yake/yake/base/yakeMovable.h	2006-03-12 18:48:24 UTC (rev 1233)
@@ -31,9 +31,7 @@
 //    IMPLEMENTATION HEADERS
 //============================================================================
 // Standard headers
-#ifndef YAKE_BASE_PREREQUISITES_H
-#	include "yakePrerequisites.h"
-#endif
+#include "yakePrerequisites.h"
 // Yake
 
 //============================================================================
@@ -41,7 +39,7 @@
 //============================================================================
 namespace yake {
 
-	using namespace math;
+	using namespace ::yake::math;
 /** Interface for movable objects and basic implementation of
 	methods for convenience (like translate()).
 



From codeandroid at berlios.de  Sun Mar 12 19:48:46 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:48:46 +0100
Subject: [Yake-svn] r1234 - trunk/yake/yake/base
Message-ID: <200603121848.k2CImkK3019478@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:48:35 +0100 (Sun, 12 Mar 2006)
New Revision: 1234

Modified:
   trunk/yake/yake/base/yakeTaggedListenerManager.h
Log:
initial revision

Modified: trunk/yake/yake/base/yakeTaggedListenerManager.h
===================================================================
--- trunk/yake/yake/base/yakeTaggedListenerManager.h	2006-03-12 18:48:24 UTC (rev 1233)
+++ trunk/yake/yake/base/yakeTaggedListenerManager.h	2006-03-12 18:48:35 UTC (rev 1234)
@@ -34,11 +34,27 @@
 	template<typename T_listener>
 	void ListenerManager<T_listener>::attachListener(T_listener* listener,const std::string& tag,const AttachMode mode)
 	{
-		assert( listener );
+		YAKE_ASSERT( listener );
+		if (!listener)
+			return;
 		listeners_.push_back( listener_list::value_type(listener,mode) );
-		if (!tag.empty()) //@todo add check for existing tag!
-			listenerMap_[ tag ] = listener;
+		if (!tag.empty())
+		{
+			tag_listener_map::const_iterator it = listenerMap_.find(tag);
+			YAKE_ASSERT( it == listenerMap_.end() );
+			if (it != listenerMap_.end())
+				listenerMap_.insert( tag_listener_map::value_type( tag, listener ) );
+		}
 	}
+	template<typename T_listener>
+	typename ListenerManager<T_listener>::listener_type* ListenerManager<T_listener>::getListener(const std::string& tag) const
+	{
+			tag_listener_map::const_iterator it = listenerMap_.find(tag);
+			YAKE_ASSERT( it != listenerMap_.end() );
+			if (it == listenerMap_.end())
+				return 0;
+			return it->second;
+	}
 
 } // namespace yake
 



From codeandroid at berlios.de  Sun Mar 12 19:49:55 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:49:55 +0100
Subject: [Yake-svn] r1235 - trunk/yake/documentation/api
Message-ID: <200603121849.k2CIntDm019788@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:49:52 +0100 (Sun, 12 Mar 2006)
New Revision: 1235

Added:
   trunk/yake/documentation/api/docMainPage.h
Log:
initial revision

Added: trunk/yake/documentation/api/docMainPage.h
===================================================================
--- trunk/yake/documentation/api/docMainPage.h	2006-03-12 18:48:35 UTC (rev 1234)
+++ trunk/yake/documentation/api/docMainPage.h	2006-03-12 18:49:52 UTC (rev 1235)
@@ -0,0 +1,27 @@
+/** \mainpage "YAKE 0.5.0 API"
+
+!!! YAKE 0.5.0 API Documentation
+
+
+!! What is this?
+
+This is the API documentation for YAKE. It contains specifications for each class, method and variable which can be used in code you write.
+
+!! Where do I start?
+
+The API documentation is most useful as a reference to YAKE. It is not intended to be a guide which introduces you to developing software with YAKE.
+If you know your way around YAKE the reference documentation will become handy and you will want to make use of it.
+
+To get started with the concepts and basics of YAKE you should refer to the more discussive material in the manual and tutorials.
+You find these in the Wiki (http://www.yake.org/wiki). If you don't find what you search either in the Wiki or the API reference then
+you may want to try out the community features and get in contact with YAKE's developers and users. Information on forums, IRC and other ways of contact can be found at the YAKE website (http://www.yake.org).
+
+
+
+
+
+Copyright (C) The YAKE Team
+
+Permission is granted to make and distribute verbatim copies of this API documentation provided the copyright notice and this permission notice are preserved on all copies.
+
+*/



From codeandroid at berlios.de  Sun Mar 12 19:53:24 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:53:24 +0100
Subject: [Yake-svn] r1236 - trunk/yake/yake/audio
Message-ID: <200603121853.k2CIrO3R021962@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:53:07 +0100 (Sun, 12 Mar 2006)
New Revision: 1236

Modified:
   trunk/yake/yake/audio/yakeAudible.h
   trunk/yake/yake/audio/yakeAudioSystem.h
Log:
clean up

Modified: trunk/yake/yake/audio/yakeAudible.h
===================================================================
--- trunk/yake/yake/audio/yakeAudible.h	2006-03-12 18:49:52 UTC (rev 1235)
+++ trunk/yake/yake/audio/yakeAudible.h	2006-03-12 18:53:07 UTC (rev 1236)
@@ -30,8 +30,6 @@
 #include <yake/audio/yakeAudioPrerequisites.h>
 
 namespace yake {
-	using namespace base;
-	using namespace base::templates;
 namespace audio {
 	/** High level audio object
 	*/

Modified: trunk/yake/yake/audio/yakeAudioSystem.h
===================================================================
--- trunk/yake/yake/audio/yakeAudioSystem.h	2006-03-12 18:49:52 UTC (rev 1235)
+++ trunk/yake/yake/audio/yakeAudioSystem.h	2006-03-12 18:53:07 UTC (rev 1236)
@@ -30,8 +30,6 @@
 #include <yake/audio/yakeAudioPrerequisites.h>
 
 namespace yake {
-	using namespace base;
-	using namespace base::templates;
 namespace audio {
 
 	/** 



From codeandroid at berlios.de  Sun Mar 12 19:55:11 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:55:11 +0100
Subject: [Yake-svn] r1237 - trunk/yake/yake/ent
Message-ID: <200603121855.k2CItBcE022457@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:54:42 +0100 (Sun, 12 Mar 2006)
New Revision: 1237

Modified:
   trunk/yake/yake/ent/component.h
   trunk/yake/yake/ent/component_holder.h
   trunk/yake/yake/ent/object.h
   trunk/yake/yake/ent/object_listener.h
   trunk/yake/yake/ent/object_mgr.h
   trunk/yake/yake/ent/object_mgr_listener.h
   trunk/yake/yake/ent/pch.h
   trunk/yake/yake/ent/prerequisites.h
   trunk/yake/yake/ent/vm_holder.h
Log:
renamed namespace,
next development state

Modified: trunk/yake/yake/ent/component.h
===================================================================
--- trunk/yake/yake/ent/component.h	2006-03-12 18:53:07 UTC (rev 1236)
+++ trunk/yake/yake/ent/component.h	2006-03-12 18:54:42 UTC (rev 1237)
@@ -1,19 +1,25 @@
-#ifndef YAKE_OBJECT_COMPONENT_H
-#define YAKE_OBJECT_COMPONENT_H
+#ifndef YAKE_ENT_OBJECT_COMPONENT_H
+#define YAKE_ENT_OBJECT_COMPONENT_H
 
 #include "yake/ent/prerequisites.h"
 #include "yake/prop/yakeProperty.h"
 
 namespace yake {
-namespace object {
+namespace ent {
 
 	struct Co;
 
 #define DECL_CO(CLASS,DESC) \
 	DECL_CLASS_RTTI(CLASS,DESC) \
 public: \
-	static CLASS* cast(::yake::object::Co*);
+	static CLASS* cast(::yake::ent::Co*);
 
+#define IMPL_CO(CLASS) \
+	IMPL_CLASS_RTTI(CLASS)
+
+#define IMPL_CO_1(CLASS,PARENT1) \
+	IMPL_CLASS_RTTI_1(CLASS,PARENT1)
+
 	struct YAKE_ENT_API Co : public PropHolder<Co>
 	{
 		virtual ~Co() {}
@@ -22,7 +28,7 @@
 	public:
 	};
 
-} // namespace object
+} // namespace ent
 } // namespace yake
 
 #endif

Modified: trunk/yake/yake/ent/component_holder.h
===================================================================
--- trunk/yake/yake/ent/component_holder.h	2006-03-12 18:53:07 UTC (rev 1236)
+++ trunk/yake/yake/ent/component_holder.h	2006-03-12 18:54:42 UTC (rev 1237)
@@ -1,10 +1,10 @@
-#ifndef YAKE_OBJECT_COMPONENT_HOLDER_H
-#define YAKE_OBJECT_COMPONENT_HOLDER_H
+#ifndef YAKE_ENT_COMPONENT_HOLDER_H
+#define YAKE_ENT_COMPONENT_HOLDER_H
 
 #include "prerequisites.h"
 
 namespace yake {
-namespace object {
+namespace ent {
 
 	typedef std::string CoTag;
 	struct YAKE_ENT_API CoHolder
@@ -19,7 +19,7 @@
 		TagCoMap	components_;
 	};
 
-} // namespace object
+} // namespace ent
 } // namespace yake
 
 #endif

Modified: trunk/yake/yake/ent/object.h
===================================================================
--- trunk/yake/yake/ent/object.h	2006-03-12 18:53:07 UTC (rev 1236)
+++ trunk/yake/yake/ent/object.h	2006-03-12 18:54:42 UTC (rev 1237)
@@ -1,36 +1,77 @@
-#ifndef YAKE_OBJECT_H
-#define YAKE_OBJECT_H
+#ifndef YAKE_ENT_OBJECT_H
+#define YAKE_ENT_OBJECT_H
 
 #include "yake/ent/prerequisites.h"
 #include "yake/ent/object_listener.h"
 #include "yake/ent/vm_holder.h"
 
 namespace yake {
-namespace object {
+namespace ent {
 
-#define DECL_GO(CLASS,DESC) \
+#define DECL_OBJECT(CLASS,DESC) \
 	DECL_CLASS_RTTI(CLASS,DESC) \
 public: \
-	static CLASS* cast(::yake::object::Co*);
+	static ::yake::ent::Object* create(const ObjectId& id) \
+	{ \
+		::yake::ent::Object* obj = new CLASS(); \
+		obj->setId(id); \
+		return obj; \
+	} \
+	static void destroy(::yake::ent::Object* o) { if(o) delete o; } \
+	static CLASS* cast(::yake::ent::Object*);
 
-	struct YAKE_ENT_API Object : public CoHolder, public VMHolder, public yake::PropHolder<Object>, public object_listener_mgr
+#define IMPL_OBJECT(CLASS) \
+	IMPL_CLASS_RTTI(CLASS) \
+	CLASS* CLASS::cast(::yake::ent::Object* obj) \
+	{ \
+		return (obj ? ((obj->isA() == CLASS::cls()) ? dynamic_cast<CLASS*>(obj) : 0 ) : 0); \
+	}
+
+	struct YAKE_ENT_API Object : public yake::PropHolder<Object>, public ObjectListenerManager
 	{
-		DECL_GO(Object,"Object/Entity base")
+		DECL_OBJECT(Object,"Object")
 		Object() {}
 		virtual ~Object() {}
 
-		typedef object_fsm::state_type fsm_state_type;
-		typedef object_fsm::event_type fsm_event_type;
+		// id operations
+		void setId(const ObjectId& id);
+		const ObjectId& getId() const;
+		const ObjectId& id() const
+		{ return id_; }
 
 		// operations
 		void init()
 		{
 			listeners_init(*this);
+			onInit();
 		}
 		void tick()
 		{
 			listeners_tick(*this);
+			onTick();
 		}
+	protected:
+		virtual void onInit() {}
+		virtual void onTick() {}
+	private:
+		ObjectId				id_;
+	};
+
+	struct YAKE_ENT_API Entity : public Object, public CoHolder, public VMHolder
+	{
+		DECL_OBJECT(Entity,"Entity")
+		Entity() {}
+		virtual ~Entity() {}
+
+		typedef object_fsm::state_type fsm_state_type;
+		typedef object_fsm::event_type fsm_event_type;
+
+		// id operations
+		void setId(const ObjectId& id);
+		const ObjectId& getId() const;
+
+		// FSM operations
+
 		void addFsmState(const fsm_state_type&);
 		void addFsmTransition(const fsm_state_type&, const fsm_event_type&, const fsm_state_type&);
 		void setFsmState(const fsm_state_type&);
@@ -38,11 +79,12 @@
 		const fsm_state_type& getCurrentFsmState() const
 		{ return m_.current(); }
 
-
+		// VM operations
 		scripting::IVM* getFsmVM() const
 		{
 			 return this->getVM("main");
 		}
+
 		// signals
 		typedef boost::signal<void(const std::string&,scripting::IVM*)> VmInitializedSignal;
 		boost::signals::connection subscribeToVmInitialized(const VmInitializedSignal::slot_type&);
@@ -54,7 +96,7 @@
 		object_fsm			m_;
 	};
 
-} // namespace object
+} // namespace ent
 } // namespace yake
 
 #endif

Modified: trunk/yake/yake/ent/object_listener.h
===================================================================
--- trunk/yake/yake/ent/object_listener.h	2006-03-12 18:53:07 UTC (rev 1236)
+++ trunk/yake/yake/ent/object_listener.h	2006-03-12 18:54:42 UTC (rev 1237)
@@ -1,15 +1,15 @@
-#ifndef YAKE_OBJECT_LISTENER_H
-#define YAKE_OBJECT_LISTENER_H
+#ifndef YAKE_ENT_OBJECTLISTENER_H
+#define YAKE_ENT_OBJECTLISTENER_H
 
 #include "yake/ent/prerequisites.h"
 
 namespace yake {
-namespace object {
+namespace ent {
 
 	struct Object;
-	struct YAKE_ENT_API object_listener
+	struct YAKE_ENT_API ObjectListener
 	{
-		virtual ~object_listener() {}
+		virtual ~ObjectListener() {}
 		virtual void onTick(Object&) {}
 		virtual void onInit(Object&) {}
 		virtual void onFsmEventHandled(Object&, const object_fsm&, const object_fsm::event_type&) {}
@@ -17,7 +17,7 @@
 		virtual void onFsmExitState(Object&,/*const std::string& fsmName, */const object_fsm&, const object_fsm::state_type&) {}
 	};
 
-	struct YAKE_ENT_API object_listener_mgr : public ListenerManager<object_listener>
+	struct YAKE_ENT_API ObjectListenerManager : public ListenerManager<ObjectListener>
 	{
 	protected:
 		void listeners_init(Object& obj)
@@ -52,7 +52,7 @@
 		}
 	};
 
-} // namespace object
+} // namespace ent
 } // namespace yake
 
 #endif

Modified: trunk/yake/yake/ent/object_mgr.h
===================================================================
--- trunk/yake/yake/ent/object_mgr.h	2006-03-12 18:53:07 UTC (rev 1236)
+++ trunk/yake/yake/ent/object_mgr.h	2006-03-12 18:54:42 UTC (rev 1237)
@@ -1,30 +1,44 @@
-#ifndef YAKE_OBJECTMANAGER_H
-#define YAKE_OBJECTMANAGER_H
+#ifndef YAKE_ENT_OBJECTMANAGER_H
+#define YAKE_ENT_OBJECTMANAGER_H
 
 #include "yake/ent/prerequisites.h"
 #include "yake/ent/object.h"
 #include "yake/ent/object_mgr_listener.h"
 
 namespace yake {
-namespace object {
+namespace ent {
 
+	typedef object::ResultCode RegistrationResultCode;
+	typedef std::pair<RegistrationResultCode,ClassId> RegistrationResult;
+
 	struct YAKE_ENT_API ObjectManager : public ListenerManager<ObjectManagerListener>
 	{
 		// operations
-		Object* makeObject();
+		Object* makeObject(const ClassId clsId);
+		Object* makeObject(const std::string strClsId);
 		void destroyObject(Object*);
 		void tick();
+
+		template<typename T>
+		inline RegistrationResult registerClass(const std::string& name)
+		{
+			return objMgr_.registerClass(name,&T::create,&T::destroy);
+		}
 	protected:
+		//
 		typedef ListenerManager<ObjectManagerListener> listener_mgr_type;
 		void listeners_onObjectCreated(Object* obj);
 		void listeners_onObjectInitialized(Object* obj);
 		void listeners_onDestroyObject(Object* obj);
 	private:
 		typedef std::deque<Object*> object_ptr_list;
-		object_ptr_list	objs_;
+		object_ptr_list						objs_;
+
+		typedef object::ObjectManager<Object> obj_mgr_type;
+		obj_mgr_type							objMgr_;
 	};
 
-} // namespace object
+} // namespace ent
 } // namespace yake
 
 #endif

Modified: trunk/yake/yake/ent/object_mgr_listener.h
===================================================================
--- trunk/yake/yake/ent/object_mgr_listener.h	2006-03-12 18:53:07 UTC (rev 1236)
+++ trunk/yake/yake/ent/object_mgr_listener.h	2006-03-12 18:54:42 UTC (rev 1237)
@@ -1,11 +1,11 @@
-#ifndef YAKE_OBJECTMANAGERLISTENER_H
-#define YAKE_OBJECTMANAGERLISTENER_H
+#ifndef YAKE_ENT_OBJECTMANAGERLISTENER_H
+#define YAKE_ENT_OBJECTMANAGERLISTENER_H
 
 #include "yake/ent/prerequisites.h"
 #include "yake/ent/object.h"
 
 namespace yake {
-namespace object {
+namespace ent {
 
 	struct YAKE_ENT_API ObjectManagerListener
 	{
@@ -15,7 +15,7 @@
 		virtual void onDestroyObject(Object*) {}
 	};
 
-} // namespace object
+} // namespace ent
 } // namespace yake
 
 #endif

Modified: trunk/yake/yake/ent/pch.h
===================================================================
--- trunk/yake/yake/ent/pch.h	2006-03-12 18:53:07 UTC (rev 1236)
+++ trunk/yake/yake/ent/pch.h	2006-03-12 18:54:42 UTC (rev 1237)
@@ -1,5 +1,5 @@
-#ifndef YAKE_OBJECT_PCH_H
-#define YAKE_OBJECT_PCH_H
+#ifndef YAKE_ENT_PCH_H
+#define YAKE_ENT_PCH_H
 
 #include "yake/base/yake.h"
 #include <boost/bind.hpp>

Modified: trunk/yake/yake/ent/prerequisites.h
===================================================================
--- trunk/yake/yake/ent/prerequisites.h	2006-03-12 18:53:07 UTC (rev 1236)
+++ trunk/yake/yake/ent/prerequisites.h	2006-03-12 18:54:42 UTC (rev 1237)
@@ -5,6 +5,7 @@
 #include "yake/statemachine/fsm_core.h"
 #include "yake/base/yakeTaggedListenerManager.h"
 #include "yake/base/templates/yakeVector.h"
+#include "yake/object/yakeObjects.h"
 
 #if defined(YAKE_ENT_EXPORTS)
 #	define YAKE_ENT_API DLLEXPORT
@@ -13,11 +14,19 @@
 #endif
 
 namespace yake {
-namespace object {
+namespace ent {
 
 	typedef fsm::machine<std::string,std::string> object_fsm;
+	typedef object::ObjectId<object::default_objectid_traits> ObjectId;
+	typedef ObjectId::ClassId ClassId;
 
-} // namespace object
+	struct ClsEntry
+	{
+		RttiClass* cls;
+	};
+	typedef object::ClassAndObjectIdManager<ClsEntry> ClassAndObjectIdManager;
+
+} // namespace ent
 } // namespace yake
 
 #endif

Modified: trunk/yake/yake/ent/vm_holder.h
===================================================================
--- trunk/yake/yake/ent/vm_holder.h	2006-03-12 18:53:07 UTC (rev 1236)
+++ trunk/yake/yake/ent/vm_holder.h	2006-03-12 18:54:42 UTC (rev 1237)
@@ -9,7 +9,7 @@
 	class IVM;
 	class IScriptingSystem;
 }
-namespace object {
+namespace ent {
 
 	struct YAKE_ENT_API VMHolder
 	{
@@ -36,7 +36,7 @@
 	};
 
 
-} // namespace object
+} // namespace ent
 } // namespace yake
 
 #endif



From codeandroid at berlios.de  Sun Mar 12 19:55:50 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:55:50 +0100
Subject: [Yake-svn] r1238 - trunk/yake/src/yake/ent
Message-ID: <200603121855.k2CItoGc022635@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:55:48 +0100 (Sun, 12 Mar 2006)
New Revision: 1238

Modified:
   trunk/yake/src/yake/ent/component.cpp
   trunk/yake/src/yake/ent/component_holder.cpp
   trunk/yake/src/yake/ent/object.cpp
   trunk/yake/src/yake/ent/object_listener.cpp
   trunk/yake/src/yake/ent/object_mgr.cpp
   trunk/yake/src/yake/ent/object_mgr_listener.cpp
   trunk/yake/src/yake/ent/vm_holder.cpp
Log:
renamed namespace,
next development state

Modified: trunk/yake/src/yake/ent/component.cpp
===================================================================
--- trunk/yake/src/yake/ent/component.cpp	2006-03-12 18:54:42 UTC (rev 1237)
+++ trunk/yake/src/yake/ent/component.cpp	2006-03-12 18:55:48 UTC (rev 1238)
@@ -2,7 +2,7 @@
 #include "yake/ent/ent.h"
 
 namespace yake {
-namespace object {
+namespace ent {
 
 	IMPL_CLASS_RTTI(Co)
 } // namespace object

Modified: trunk/yake/src/yake/ent/component_holder.cpp
===================================================================
--- trunk/yake/src/yake/ent/component_holder.cpp	2006-03-12 18:54:42 UTC (rev 1237)
+++ trunk/yake/src/yake/ent/component_holder.cpp	2006-03-12 18:55:48 UTC (rev 1238)
@@ -2,7 +2,7 @@
 #include "yake/ent/ent.h"
 
 namespace yake {
-namespace object {
+namespace ent {
 
 	void CoHolder::addCo(const CoTag& tag, Co* co)
 	{

Modified: trunk/yake/src/yake/ent/object.cpp
===================================================================
--- trunk/yake/src/yake/ent/object.cpp	2006-03-12 18:54:42 UTC (rev 1237)
+++ trunk/yake/src/yake/ent/object.cpp	2006-03-12 18:55:48 UTC (rev 1238)
@@ -2,37 +2,47 @@
 #include "yake/ent/ent.h"
 
 namespace yake {
-namespace object {
+namespace ent {
 
-	IMPL_CLASS_RTTI(Object)
+	IMPL_OBJECT(Object)
 
-	void Object::processFsmEvent(const fsm_event_type& evt)
+	void Object::setId(const ObjectId& id)
 	{
-		m_.processEventCb(evt,boost::bind(&Object::onEnter,this,_1,_2),boost::bind(&Object::onExit,this,_1,_2));
+		id_ = id;
+	}
+	const ObjectId& Object::getId() const
+	{
+		return id_;
+	}
+
+	IMPL_OBJECT(Entity)
+
+	void Entity::processFsmEvent(const fsm_event_type& evt)
+	{
+		m_.processEventCb(evt,boost::bind(&Entity::onEnter,this,_1,_2),boost::bind(&Entity::onExit,this,_1,_2));
 		listeners_fsmEventHandled(*this,m_,evt);
 	}
-	void Object::addFsmState(const fsm_state_type& state)
+	void Entity::addFsmState(const fsm_state_type& state)
 	{
 		m_.addState(state);
 	}
-	void Object::addFsmTransition(const fsm_state_type& from, const fsm_event_type& evt, const fsm_state_type& to)
+	void Entity::addFsmTransition(const fsm_state_type& from, const fsm_event_type& evt, const fsm_state_type& to)
 	{
 		m_.addTransition(from,evt,to);
 	}
-	void Object::setFsmState(const fsm_state_type& state)
+	void Entity::setFsmState(const fsm_state_type& state)
 	{
 		m_.setState(state);
 	}
-	void Object::onEnter(const object_fsm& fsm, const object_fsm::state_type& state)
+	void Entity::onEnter(const object_fsm& fsm, const object_fsm::state_type& state)
 	{
-		//std::cout << "object.state.enter '" << state << "'\n";
+		//std::cout << "Entity.state.enter '" << state << "'\n";
 		listeners_fsmEnterState(*this,fsm,state);
 	}
-	void Object::onExit(const object_fsm& fsm, const object_fsm::state_type& state)
+	void Entity::onExit(const object_fsm& fsm, const object_fsm::state_type& state)
 	{
-		//std::cout << "object.state.exit '" << state << "'\n";
+		//std::cout << "Entity.state.exit '" << state << "'\n";
 		listeners_fsmExitState(*this,fsm,state);
 	}
-
 }
 }
\ No newline at end of file

Modified: trunk/yake/src/yake/ent/object_listener.cpp
===================================================================
--- trunk/yake/src/yake/ent/object_listener.cpp	2006-03-12 18:54:42 UTC (rev 1237)
+++ trunk/yake/src/yake/ent/object_listener.cpp	2006-03-12 18:55:48 UTC (rev 1238)
@@ -2,7 +2,7 @@
 #include "yake/ent/ent.h"
 
 namespace yake {
-namespace object {
+namespace ent {
 
 }
 }
\ No newline at end of file

Modified: trunk/yake/src/yake/ent/object_mgr.cpp
===================================================================
--- trunk/yake/src/yake/ent/object_mgr.cpp	2006-03-12 18:54:42 UTC (rev 1237)
+++ trunk/yake/src/yake/ent/object_mgr.cpp	2006-03-12 18:55:48 UTC (rev 1238)
@@ -2,12 +2,19 @@
 #include "yake/ent/ent.h"
 
 namespace yake {
-namespace object {
+namespace ent {
 
-	Object* ObjectManager::makeObject()
+	Object* ObjectManager::makeObject(const std::string strClsId)
 	{
-		Object* obj = new Object();
-		assert( obj );
+		YAKE_ASSERT( !strClsId.empty() )(strClsId);
+		std::pair<object::ResultCode,ClassId> ret = objMgr_.getClassId(strClsId);
+		YAKE_ASSERT( ret.first == object::RC_OK )(ret.first)(ret.second);
+		return makeObject( ret.second );
+	}
+	Object* ObjectManager::makeObject(const ClassId clsId)
+	{
+		Object* obj = objMgr_.createObject(clsId);
+		YAKE_ASSERT( obj )(clsId);
 		objs_.push_back( obj );
 
 		listeners_onObjectCreated(obj);
@@ -20,7 +27,7 @@
 	}
 	void ObjectManager::destroyObject(Object* obj)
 	{
-		assert( obj );
+		YAKE_ASSERT( obj );
 
 		listeners_onDestroyObject( obj );
 		//obj->shutdown();
@@ -29,7 +36,7 @@
 		if (it != objs_.end())
 			objs_.erase( it );
 
-		delete obj;
+		objMgr_.destroyObject( obj );
 	}
 	void ObjectManager::tick()
 	{

Modified: trunk/yake/src/yake/ent/object_mgr_listener.cpp
===================================================================
--- trunk/yake/src/yake/ent/object_mgr_listener.cpp	2006-03-12 18:54:42 UTC (rev 1237)
+++ trunk/yake/src/yake/ent/object_mgr_listener.cpp	2006-03-12 18:55:48 UTC (rev 1238)
@@ -2,7 +2,7 @@
 #include "yake/ent/ent.h"
 
 namespace yake {
-namespace object {
+namespace ent {
 
 }
 }
\ No newline at end of file

Modified: trunk/yake/src/yake/ent/vm_holder.cpp
===================================================================
--- trunk/yake/src/yake/ent/vm_holder.cpp	2006-03-12 18:54:42 UTC (rev 1237)
+++ trunk/yake/src/yake/ent/vm_holder.cpp	2006-03-12 18:55:48 UTC (rev 1238)
@@ -2,7 +2,7 @@
 #include "yake/ent/ent.h"
 
 namespace yake {
-namespace object {
+namespace ent {
 
 	VMHolder::~VMHolder()
 	{



From codeandroid at berlios.de  Sun Mar 12 19:56:31 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:56:31 +0100
Subject: [Yake-svn] r1239 - trunk/yake/src/yake/plugins/entLua
Message-ID: <200603121856.k2CIuVOn022759@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:56:19 +0100 (Sun, 12 Mar 2006)
New Revision: 1239

Modified:
   trunk/yake/src/yake/plugins/entLua/entLua.cpp
Log:
renamed namespace,
next development state

Modified: trunk/yake/src/yake/plugins/entLua/entLua.cpp
===================================================================
--- trunk/yake/src/yake/plugins/entLua/entLua.cpp	2006-03-12 18:55:48 UTC (rev 1238)
+++ trunk/yake/src/yake/plugins/entLua/entLua.cpp	2006-03-12 18:56:19 UTC (rev 1239)
@@ -6,7 +6,7 @@
 #include <luabind/luabind.hpp>
 
 namespace yake {
-namespace object {
+namespace ent {
 	namespace detail {
 		void executeOfTable_2(scripting::IVM& vm, const std::string& tbl1name, const std::string& tbl2name, const std::string& fn)
 		{
@@ -48,44 +48,60 @@
 	LuaFsmObjectListener::LuaFsmObjectListener(scripting::IScriptingSystem& scriptingSystem) :
 		scriptingSystem_(scriptingSystem)
 	{
-		startScript_.reset( scriptingSystem_.createScriptFromFile("../o_test.lua") );
+		startScript_.reset( scriptingSystem_.createScriptFromFile("../../media/scripts/o_fsm_test.lua") );
 		YAKE_ASSERT( startScript_.get() );
 	}
 	void LuaFsmObjectListener::onInit(Object& obj)
 	{
-		//YAKE_ASSERT( obj.getFsmVM() );
-		obj.getFsmVM()->execute("print('initializing...')");
-		obj.getFsmVM()->execute( startScript_.get() );
+		Entity* ent = Entity::cast(&obj);
+		if (ent)
+		{
+			YAKE_ASSERT( ent->getFsmVM() );
+			ent->getFsmVM()->execute("print('initializing...')");
+			ent->getFsmVM()->execute( startScript_.get() );
 
-		//std::cout << "vm: exec start_main()\n";
-		//@todo make sure "main()" exists
-		//obj.getVM().execute("start_main()");
-
-		obj.getFsmVM()->execute("c = coroutine.create(main)\ncoroutine.resume(c,1)");
+			ent->getFsmVM()->execute("c = coroutine.create(main)\ncoroutine.resume(c,1)");
+		}
 	}
 	void LuaFsmObjectListener::onTick(Object& obj)
 	{
-		obj.getFsmVM()->execute("event.on_tick()");
-		obj.getFsmVM()->execute("state." + obj.getCurrentFsmState() + ".on_tick()");
+		Entity* ent = Entity::cast(&obj);
+		if (ent)
+		{
+			ent->getFsmVM()->execute("event.on_tick()");
+			ent->getFsmVM()->execute("state." + ent->getCurrentFsmState() + ".on_tick()");
+		}
 	}
 	void LuaFsmObjectListener::onFsmEventHandled(Object& obj, const object_fsm&, const object_fsm::event_type& evt)
 	{
-		if (evt == "spawn")
-			obj.getFsmVM()->execute("event.on_spawn()");
-		else if (evt == "die")
-			obj.getFsmVM()->execute("event.on_die()");
+		Entity* ent = Entity::cast(&obj);
+		if (ent)
+		{
+			if (evt == "spawn")
+				ent->getFsmVM()->execute("event.on_spawn()");
+			else if (evt == "die")
+				ent->getFsmVM()->execute("event.on_die()");
+		}
 	}
 	void LuaFsmObjectListener::onFsmEnterState(Object& obj,/*const std::string& fsmName, */const object_fsm&, const object_fsm::state_type& state)
 	{
-		scripting::IVM* vm = obj.getFsmVM();
-		YAKE_ASSERT( vm );
-		detail::executeOfTable_2(*vm,"state",state,"on_enter");
+		Entity* ent = Entity::cast(&obj);
+		if (ent)
+		{
+			scripting::IVM* vm = ent->getFsmVM();
+			YAKE_ASSERT( vm );
+			detail::executeOfTable_2(*vm,"state",state,"on_enter");
+		}
 	}
 	void LuaFsmObjectListener::onFsmExitState(Object& obj,/*const std::string& fsmName, */const object_fsm&, const object_fsm::state_type& state)
 	{
-		scripting::IVM* vm = obj.getFsmVM();
-		YAKE_ASSERT( vm );
-		detail::executeOfTable_2(*vm,"state",state,"on_exit");
+		Entity* ent = Entity::cast(&obj);
+		if (ent)
+		{
+			scripting::IVM* vm = ent->getFsmVM();
+			YAKE_ASSERT( vm );
+			detail::executeOfTable_2(*vm,"state",state,"on_exit");
+		}
 	}
 	LuaObjectManagerListener::LuaObjectManagerListener(scripting::IScriptingSystem& scriptingSystem) :
 		fsmListener_(scriptingSystem)
@@ -93,9 +109,13 @@
 	}
 	void LuaObjectManagerListener::onObjectCreated(Object* obj)
 	{
-		YAKE_ASSERT( obj );
-		obj->attachListener( &fsmListener_, "lua_listener", object_listener_mgr::kKeepOwnership );
+		Entity* ent = Entity::cast(obj);
+		if (ent)
+		{
+			YAKE_ASSERT( ent );
+			ent->attachListener( &fsmListener_, "lua_listener", ObjectListenerManager::kKeepOwnership );
+		}
 	}
-}
+} // namespace ent
 } // namespace yake
 



From codeandroid at berlios.de  Sun Mar 12 19:56:56 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:56:56 +0100
Subject: [Yake-svn] r1240 - in trunk/yake/yake: graphics input physics
Message-ID: <200603121856.k2CIuuov022868@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:56:50 +0100 (Sun, 12 Mar 2006)
New Revision: 1240

Modified:
   trunk/yake/yake/graphics/yakeGeometryAccess.h
   trunk/yake/yake/graphics/yakeGraphicalWorld.h
   trunk/yake/yake/graphics/yakeGraphicsSystem.h
   trunk/yake/yake/input/yakeActionMap.h
   trunk/yake/yake/physics/yakePhysicsActor.h
   trunk/yake/yake/physics/yakePhysicsAffectors.h
   trunk/yake/yake/physics/yakePhysicsAvatar.h
   trunk/yake/yake/physics/yakePhysicsBody.h
   trunk/yake/yake/physics/yakePhysicsBodyGroup.h
   trunk/yake/yake/physics/yakePhysicsJoint.h
   trunk/yake/yake/physics/yakePhysicsMaterial.h
   trunk/yake/yake/physics/yakePhysicsPrerequisites.h
   trunk/yake/yake/physics/yakePhysicsShape.h
   trunk/yake/yake/physics/yakePhysicsSystem.h
   trunk/yake/yake/physics/yakePhysicsWorld.h
Log:
removed 'using' statements

Modified: trunk/yake/yake/graphics/yakeGeometryAccess.h
===================================================================
--- trunk/yake/yake/graphics/yakeGeometryAccess.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/graphics/yakeGeometryAccess.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -35,11 +35,11 @@
 //============================================================================
 //    INTERFACE STRUCTURES / UTILITY CLASSES
 //============================================================================
-using namespace yake::base::mpl;
-using namespace yake::base::templates;
-using namespace yake::math;
 
 namespace yake {
+	using namespace ::yake::mpl;
+	using namespace ::yake::templates;
+	using namespace ::yake::math;
 namespace graphics {
 
 /*

Modified: trunk/yake/yake/graphics/yakeGraphicalWorld.h
===================================================================
--- trunk/yake/yake/graphics/yakeGraphicalWorld.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/graphics/yakeGraphicalWorld.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -40,8 +40,6 @@
 
 
 namespace yake {
-	using namespace math;
-	using namespace base::templates;
 namespace graphics {
 
 	/**

Modified: trunk/yake/yake/graphics/yakeGraphicsSystem.h
===================================================================
--- trunk/yake/yake/graphics/yakeGraphicsSystem.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/graphics/yakeGraphicsSystem.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -41,8 +41,8 @@
 namespace yake {
 namespace graphics {
 
-	using namespace yake::mpl;
-	using namespace yake::templates;
+	using namespace ::yake::mpl;
+	using namespace ::yake::templates;
 
 	//struct SceneSerializer
 	//{

Modified: trunk/yake/yake/input/yakeActionMap.h
===================================================================
--- trunk/yake/yake/input/yakeActionMap.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/input/yakeActionMap.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -32,9 +32,6 @@
 #endif
 
 namespace yake {
-
-using namespace base;
-
 namespace input {
 
 	class ActionIdRegistry;

Modified: trunk/yake/yake/physics/yakePhysicsActor.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsActor.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/physics/yakePhysicsActor.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -32,8 +32,7 @@
 #endif
 
 namespace yake {
-	using namespace base;
-	using namespace math;
+	using namespace ::yake::math;
 namespace physics {
 
 	class IActorListener

Modified: trunk/yake/yake/physics/yakePhysicsAffectors.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsAffectors.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/physics/yakePhysicsAffectors.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -32,7 +32,6 @@
 #endif
 
 namespace yake {
-	using namespace base;
 namespace physics {
 
 	/** A generic body affector. Basically defines the interface, factory and implements

Modified: trunk/yake/yake/physics/yakePhysicsAvatar.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsAvatar.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/physics/yakePhysicsAvatar.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -32,9 +32,7 @@
 #endif
 
 namespace yake {
-	using namespace base;
-	using namespace base::templates;
-	using namespace math;
+	using namespace ::yake::math;
 namespace physics {
 
 	class YAKE_PHYSICS_API IAvatarListener

Modified: trunk/yake/yake/physics/yakePhysicsBody.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsBody.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/physics/yakePhysicsBody.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -32,9 +32,7 @@
 #endif
 
 namespace yake {
-	using namespace base;
-	using namespace base::templates;
-	using namespace math;
+	using namespace ::yake::math;
 namespace physics {
 
 	enum ReferenceFrame {

Modified: trunk/yake/yake/physics/yakePhysicsBodyGroup.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsBodyGroup.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/physics/yakePhysicsBodyGroup.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -32,9 +32,6 @@
 #endif
 
 namespace yake {
-	using namespace base;
-	using namespace base::templates;
-	using namespace math;
 namespace physics {
 
 	class IBody;

Modified: trunk/yake/yake/physics/yakePhysicsJoint.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsJoint.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/physics/yakePhysicsJoint.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -32,9 +32,6 @@
 #endif
 
 namespace yake {
-	using namespace base;
-	using namespace base::templates;
-	using namespace math;
 namespace physics {
 
 	/**

Modified: trunk/yake/yake/physics/yakePhysicsMaterial.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsMaterial.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/physics/yakePhysicsMaterial.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -32,9 +32,6 @@
 #endif
 
 namespace yake {
-	using namespace base;
-	using namespace base::templates;
-	using namespace math;
 namespace physics {
 
 	class YAKE_PHYSICS_API IMaterial

Modified: trunk/yake/yake/physics/yakePhysicsPrerequisites.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsPrerequisites.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/physics/yakePhysicsPrerequisites.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -72,8 +72,6 @@
 			}
 		};
 
-	using namespace base;
-	using namespace math;
 namespace physics {
 	typedef ::yake::uint32 TriangleMeshId;
 	const TriangleMeshId kTriangleMeshIdNone = 0xFFFFFFFF;

Modified: trunk/yake/yake/physics/yakePhysicsShape.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsShape.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/physics/yakePhysicsShape.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -32,9 +32,6 @@
 #endif
 
 namespace yake {
-	using namespace base;
-	using namespace base::templates;
-	using namespace math;
 namespace physics {
 
 	/**

Modified: trunk/yake/yake/physics/yakePhysicsSystem.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsSystem.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/physics/yakePhysicsSystem.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -53,9 +53,6 @@
 	*/
 
 namespace yake {
-	using namespace base;
-	using namespace base::templates;
-	using namespace math;
 namespace physics {
 
 	class YAKE_PHYSICS_API IPhysicsSystem

Modified: trunk/yake/yake/physics/yakePhysicsWorld.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsWorld.h	2006-03-12 18:56:19 UTC (rev 1239)
+++ trunk/yake/yake/physics/yakePhysicsWorld.h	2006-03-12 18:56:50 UTC (rev 1240)
@@ -45,8 +45,7 @@
 #endif
 
 namespace yake {
-	using namespace base;
-	using namespace math;
+	using namespace ::yake::math;
 namespace physics {
 
 	class YAKE_PHYSICS_API IWorld



From codeandroid at berlios.de  Sun Mar 12 19:57:45 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:57:45 +0100
Subject: [Yake-svn] r1241 - trunk/yake/src/yake/samples/ent/sampleEntFsm
Message-ID: <200603121857.k2CIvja7023040@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:57:42 +0100 (Sun, 12 Mar 2006)
New Revision: 1241

Modified:
   trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp
Log:
added object/entity class registration,
split Object into Object and Entity

Modified: trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp
===================================================================
--- trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp	2006-03-12 18:56:50 UTC (rev 1240)
+++ trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp	2006-03-12 18:57:42 UTC (rev 1241)
@@ -1,7 +1,7 @@
 //#include "yake/base/yakePrerequisites.h"
 #include "yake/base/yake.h"
 #include "yake/ent/ent.h"
-#include "yake/plugins//entLua/entLua.h"
+#include "yake/plugins/entLua/entLua.h"
 
 using namespace yake;
 
@@ -14,37 +14,55 @@
 	/** Listens to object manager and initializes newly created objects by adding
 		a Lua VM, adding default states and transitions to the state machine etc.
 	*/
-	struct ExampleAppObjectMgrListener : public object::ObjectManagerListener
+	struct ExampleAppObjectMgrListener : public ent::ObjectManagerListener
 	{
 		ExampleAppObjectMgrListener(scripting::IScriptingSystem& scriptingSys) : scriptingSys_(scriptingSys)
 		{}
-		virtual void onObjectCreated(object::Object* obj)
+		virtual void onObjectCreated(ent::Object* obj)
 		{
 			scripting::IVM* vm = scriptingSys_.createVM();
 			YAKE_ASSERT( vm );
 
-			obj->attachVM(vm,"main");
+			ent::Entity* ent = ent::Entity::cast(obj);
+			YAKE_ASSERT( ent );
+			ent->attachVM(vm,"main");
 		}
-		virtual void onDestroyObject(object::Object* obj)
+		virtual void onDestroyObject(ent::Object* obj)
 		{
-			scripting::IVM* vm = obj->detachVM("main");
+			ent::Entity* ent = ent::Entity::cast(obj);
+			YAKE_ASSERT( ent );
+
+			scripting::IVM* vm = ent->detachVM("main");
 			YAKE_ASSERT( vm );
 			delete vm;
 		}
-		virtual void onObjectInitialized(object::Object* obj)
+		virtual void onObjectInitialized(ent::Object* obj)
 		{
-			obj->addFsmState(ksAwakening);
-			obj->addFsmState(ksAlive);
-			obj->addFsmState(ksDead);
+			ent::Entity* ent = ent::Entity::cast(obj);
+			YAKE_ASSERT( ent );
 
-			obj->addFsmTransition(ksAwakening,"spawn",ksAlive);
-			obj->addFsmTransition(ksAlive,"die",ksDead);
+			// Add default FSM states and transitions:
 
-			obj->setFsmState(ksAwakening);
+			ent->addFsmState(ksAwakening);
+			ent->addFsmState(ksAlive);
+			ent->addFsmState(ksDead);
+
+			ent->addFsmTransition(ksAwakening,"spawn",ksAlive);
+			ent->addFsmTransition(ksAlive,"die",ksDead);
+
+			// Set initial state:
+
+			ent->setFsmState(ksAwakening);
 		}
 	private:
 		scripting::IScriptingSystem&	scriptingSys_;
 	};
+
+	struct SimpleGraphicsCo : public ent::Co
+	{
+		DECL_CO(SimpleGraphicsCo,"SimpleGraphicsCo")
+	};
+	IMPL_CO_1(SimpleGraphicsCo,"Co")
 } // namespace exapp
 
 int main(int argc, char* argv[])
@@ -55,32 +73,59 @@
 	YAKE_ASSERT( luaSys.get() );
 
 	// Create an object manager which manages creation, initialization and destruction of objects.
-	object::ObjectManager objMgr;
+	ent::ObjectManager objMgr;
 
 	// Create & attach the listener which handles the connection to the Lua VM and the bindings.
-	object::LuaObjectManagerListener luaFmsObjListener(*luaSys);
-	objMgr.attachListener( &luaFmsObjListener, "luaFsm", object::ObjectManager::kKeepOwnership );
+	ent::LuaObjectManagerListener luaFmsObjListener(*luaSys);
+	objMgr.attachListener( &luaFmsObjListener, "luaFsm", ent::ObjectManager::kKeepOwnership );
 
 	// Example listener which sets the objects up for our example application :)
 	// The listener adds default states and transitions to the object's state machine, for example.
 	SharedPtr<exapp::ExampleAppObjectMgrListener> exappObjInitializer( new exapp::ExampleAppObjectMgrListener(*luaSys) );
-	objMgr.attachListener( exappObjInitializer.get(), "exapp_listener", object::ObjectManager::kKeepOwnership );
+	objMgr.attachListener( exappObjInitializer.get(), "exapp_listener", ent::ObjectManager::kKeepOwnership );
 
+	// Register object class
+	ent::RegistrationResult ret = objMgr.registerClass<ent::Entity>("Entity");
+	YAKE_ASSERT( ret.first == object::RC_OK );
+
 	// Let's create an object.
-	object::Object* o = objMgr.makeObject();
+	//ent::Object* o = objMgr.makeObject(ret.second); // create by ClassId
+	ent::Object* o = objMgr.makeObject("Entity"); // create by class name
 	YAKE_ASSERT( o );
+	ent::Entity* e = ent::Entity::cast(o); // cast to Entity*
+	YAKE_ASSERT( e );
 
-	// NB At this point the FSM is set up by the exapp listener!
+	// NB At this point the FSM has been set up by the exapp listener!
 
-	// Do some processing:
-	o->processFsmEvent("spawn");
+	// Do some FSM event processing:
+	e->processFsmEvent("spawn");
 	objMgr.tick(); // triggers o->tick()
 	objMgr.tick();
-	o->processFsmEvent("die");
+	e->processFsmEvent("die");
 
 	//@todo use scheduler for yield/resume functionality. (code in prototype is in fsm2_lua.cpp)
-	//o->getVM().resume();
+	//e->getVM().resume();
 
+	// Let's have some fun with components
+	/*
+	RttiClassMgr clsMgr;
+	clsMgr.insert( ent::Object::cls() );
+	clsMgr.insert( ent::Co::cls() );
+	exapp::SimpleGraphicsCo::cls()->add( PropDef("position","position",Vector3(0,0,0)) );
+	clsMgr.insert( exapp::SimpleGraphicsCo::cls() );
+
+	e->addCo("gfx",new exapp::SimpleGraphicsCo());
+	e->getCo("gfx")->init();
+	if (!e->getCo("gfx")->setValue("position",Vector3(10,0,0)))
+		std::cerr << "could not set position\n";
+	Vector3 pos(0,0,0);
+	if (e->getCo("gfx")->getValue<Vector3>("position",pos))
+		std::cout << "position=" << pos << "\n";
+	else
+		std::cerr << "could not get position\n";
+	*/
+	// clean up
+
 	exappObjInitializer.reset();
 	luaSys.reset();
 }



From codeandroid at berlios.de  Sun Mar 12 19:58:07 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:58:07 +0100
Subject: [Yake-svn] r1242 - trunk/yake/yake/object
Message-ID: <200603121858.k2CIw7Oi023083@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:58:05 +0100 (Sun, 12 Mar 2006)
New Revision: 1242

Modified:
   trunk/yake/yake/object/ObjectManager.h
Log:
added callbacks

Modified: trunk/yake/yake/object/ObjectManager.h
===================================================================
--- trunk/yake/yake/object/ObjectManager.h	2006-03-12 18:57:42 UTC (rev 1241)
+++ trunk/yake/yake/object/ObjectManager.h	2006-03-12 18:58:05 UTC (rev 1242)
@@ -88,6 +88,9 @@
 		void destroyObject(object_type*);
 		void destroyAllObjects();
 
+	protected:
+		virtual void onObjectCreated(object_type*) {}
+		virtual void onDestroyObject(object_type*) {}
 	private:
 		uint8 determineClassIdBitsForRange(const ClassId min, const ClassId max) const;
 



From codeandroid at berlios.de  Sun Mar 12 19:59:01 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 19:59:01 +0100
Subject: [Yake-svn] r1243 - in trunk/yake/yake/plugins: . entLua
Message-ID: <200603121859.k2CIx1wJ023441@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 19:59:00 +0100 (Sun, 12 Mar 2006)
New Revision: 1243

Added:
   trunk/yake/yake/plugins/entLua/
   trunk/yake/yake/plugins/entLua/entLua.h
Log:
initial revision

Added: trunk/yake/yake/plugins/entLua/entLua.h
===================================================================
--- trunk/yake/yake/plugins/entLua/entLua.h	2006-03-12 18:58:05 UTC (rev 1242)
+++ trunk/yake/yake/plugins/entLua/entLua.h	2006-03-12 18:59:00 UTC (rev 1243)
@@ -0,0 +1,40 @@
+#ifndef YAKE_ENTLUA_H
+#define YAKE_ENTLUA_H
+
+#if defined(YAKE_ENTLUA_EXPORTS)
+#	define YAKE_ENTLUA_API DLLEXPORT
+#else
+#	define YAKE_ENTLUA_API DLLIMPORT
+#endif
+
+#include "yake/base/yakePrerequisites.h"
+#include "yake/scripting/yakeScriptingSystem.h"
+#include "yake/ent/ent.h"
+
+namespace yake {
+namespace ent {
+	/** @todo Move into private namespace. */
+	struct LuaFsmObjectListener : public ObjectListener
+	{
+		LuaFsmObjectListener(scripting::IScriptingSystem& scriptingSystem);
+		virtual void onInit(Object& obj);
+		virtual void onTick(Object& obj);
+		virtual void onFsmEventHandled(Object& obj, const object_fsm&, const object_fsm::event_type& evt);
+		virtual void onFsmEnterState(Object& obj,/*const std::string& fsmName, */const object_fsm&, const object_fsm::state_type& state);
+		virtual void onFsmExitState(Object& obj,/*const std::string& fsmName, */const object_fsm&, const object_fsm::state_type& state);
+	private:
+		scripting::IScriptingSystem&				scriptingSystem_;
+		boost::shared_ptr<scripting::IScript>	startScript_;
+	};
+
+	struct YAKE_ENTLUA_API LuaObjectManagerListener : public ObjectManagerListener
+	{
+		LuaObjectManagerListener(scripting::IScriptingSystem& scriptingSystem);
+		virtual void onObjectCreated(Object* obj);
+	private:
+		LuaFsmObjectListener	fsmListener_;
+	};
+} // namespace ent
+} // namespace yake
+
+#endif



From codeandroid at berlios.de  Sun Mar 12 20:01:28 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 20:01:28 +0100
Subject: [Yake-svn] r1244 - trunk/yake/yapp/msg
Message-ID: <200603121901.k2CJ1SDE024228@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 20:01:16 +0100 (Sun, 12 Mar 2006)
New Revision: 1244

Modified:
   trunk/yake/yapp/msg/yakeMessageQ.h
Log:
textual fix

Modified: trunk/yake/yapp/msg/yakeMessageQ.h
===================================================================
--- trunk/yake/yapp/msg/yakeMessageQ.h	2006-03-12 18:59:00 UTC (rev 1243)
+++ trunk/yake/yapp/msg/yakeMessageQ.h	2006-03-12 19:01:16 UTC (rev 1244)
@@ -54,7 +54,7 @@
 		*/
 		Message* pop();
 
-		/** Returns whether the queue still contains messages.
+		/** Returns whether the queue contains any messages.
 		*/
 		bool empty() const;
 	private:



From codeandroid at berlios.de  Sun Mar 12 20:03:42 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 20:03:42 +0100
Subject: [Yake-svn] r1245 - in trunk/yake/scripts/msvc8: . samples/graphics
Message-ID: <200603121903.k2CJ3gqv024722@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 20:02:38 +0100 (Sun, 12 Mar 2006)
New Revision: 1245

Modified:
   trunk/yake/scripts/msvc8/samples/graphics/sampleGraphicsDemo.vcproj
   trunk/yake/scripts/msvc8/yake.sln
Log:
removed samples (will have a seperate solution)

Modified: trunk/yake/scripts/msvc8/samples/graphics/sampleGraphicsDemo.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/graphics/sampleGraphicsDemo.vcproj	2006-03-12 19:01:16 UTC (rev 1244)
+++ trunk/yake/scripts/msvc8/samples/graphics/sampleGraphicsDemo.vcproj	2006-03-12 19:02:38 UTC (rev 1245)
@@ -63,7 +63,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib data.lib input.lib graphics.lib audio.lib physics.lib scripting.lib graphicsOgre.lib OgreMain_d.lib"
+				AdditionalDependencies="base.lib data.lib input.lib graphics.lib audio.lib physics.lib scripting.lib"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="2"
 				AdditionalLibraryDirectories="../../../../common/lib/$(ConfigurationName);../../../../dependencies/lib;../../../../dependencies/ogrenew/OgreMain/lib/debug"

Modified: trunk/yake/scripts/msvc8/yake.sln
===================================================================
--- trunk/yake/scripts/msvc8/yake.sln	2006-03-12 19:01:16 UTC (rev 1244)
+++ trunk/yake/scripts/msvc8/yake.sln	2006-03-12 19:02:38 UTC (rev 1245)
@@ -1,5 +1,5 @@
 Microsoft Visual Studio Solution File, Format Version 9.00
-# Visual C++ Express 2005
+# Visual Studio 2005
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "base", "base.vcproj", "{D29771DD-715F-452B-B71C-911BACF5956D}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "graphics", "graphics.vcproj", "{ECC8FA24-93AC-4659-8EBD-26B6F418AC64}"
@@ -13,55 +13,6 @@
 		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
 	EndProjectSection
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "registryPluginConcrete", "samples\base\registryPluginConcrete.vcproj", "{F6E2B937-448D-4ADE-9A8F-7DDF0CB38865}"
-	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-		{F6E2B937-449D-4ADE-9A8F-7DDF0CB38866} = {F6E2B937-449D-4ADE-9A8F-7DDF0CB38866}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "registryPluginInterface", "samples\base\registryPluginInterface.vcproj", "{F6E2B937-449D-4ADE-9A8F-7DDF0CB38866}"
-	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleContainer", "samples\base\sampleContainer.vcproj", "{7E0CC2D4-0DDE-419A-81DE-EE0739673432}"
-	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleDebug", "samples\base\sampleDebug.vcproj", "{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}"
-	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRegistry", "samples\base\sampleRegistry.vcproj", "{0CA5014D-D3E7-4B2B-B993-75788097E065}"
-	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRegistryPlugin", "samples\base\sampleRegistryPlugin.vcproj", "{6876FBCB-B5AD-493E-ADE4-F81441BC4EF2}"
-	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-		{F6E2B937-449D-4ADE-9A8F-7DDF0CB38866} = {F6E2B937-449D-4ADE-9A8F-7DDF0CB38866}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRegistryPluginManual", "samples\base\sampleRegistryPluginManual.vcproj", "{6876FBCB-B5AD-494E-ADE4-F81441BC4EF9}"
-	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-		{F6E2B937-449D-4ADE-9A8F-7DDF0CB38866} = {F6E2B937-449D-4ADE-9A8F-7DDF0CB38866}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleGraphicsDemo", "samples\graphics\sampleGraphicsDemo.vcproj", "{723A2F36-A3DC-40E5-A7B0-0629219B04DE}"
-	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
-		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
-		{42BB6F78-B04C-4968-AA5E-271DC45BEFBB} = {42BB6F78-B04C-4968-AA5E-271DC45BEFBB}
-		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
-		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
-		{1AF3930A-4E72-4455-AFD0-6B78684105CD} = {1AF3930A-4E72-4455-AFD0-6B78684105CD}
-	EndProjectSection
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "physics", "physics.vcproj", "{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}"
 	ProjectSection(ProjectDependencies) = postProject
 		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
@@ -95,28 +46,11 @@
 		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 	EndProjectSection
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleScriptingLua", "samples\scripting\sampleScriptingLua.vcproj", "{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}"
-	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
-		{42BB6F78-B04C-4968-AA5E-271DC45BEFBB} = {42BB6F78-B04C-4968-AA5E-271DC45BEFBB}
-		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
-		{CA63F621-0912-4551-B51A-7BD18F491181} = {CA63F621-0912-4551-B51A-7BD18F491181}
-		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
-		{41CEA11B-9678-43E5-B2F4-754944D7B461} = {41CEA11B-9678-43E5-B2F4-754944D7B461}
-		{1AF3930A-4E72-4455-AFD0-6B78684105CD} = {1AF3930A-4E72-4455-AFD0-6B78684105CD}
-	EndProjectSection
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "data", "data.vcproj", "{77A59B89-C2B3-429C-8317-ADE0D046CC3B}"
 	ProjectSection(ProjectDependencies) = postProject
 		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleDataMisc", "samples\data\sampleDataMisc.vcproj", "{22EFD734-D8C5-47D6-8461-C37E02A9F0B6}"
-	ProjectSection(ProjectDependencies) = postProject
-		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
-	EndProjectSection
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "scriptingBindingsLua", "plugins\scripting\scriptingLuaBindings.vcproj", "{CA63F621-0912-4551-B51A-7BD18F491181}"
 	ProjectSection(ProjectDependencies) = postProject
 		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
@@ -138,33 +72,6 @@
 		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
 	EndProjectSection
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "samplePhysicsDemo", "samples\physics\samplePhysicsDemo.vcproj", "{3DA99679-404B-44C7-9267-C97D066F3D96}"
-	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-		{2F5124AA-56BD-4909-811A-E79901978C86} = {2F5124AA-56BD-4909-811A-E79901978C86}
-		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
-		{42BB6F78-B04C-4968-AA5E-271DC45BEFBB} = {42BB6F78-B04C-4968-AA5E-271DC45BEFBB}
-		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
-		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
-		{1AF3930A-4E72-4455-AFD0-6B78684105CD} = {1AF3930A-4E72-4455-AFD0-6B78684105CD}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "reflection", "reflection.vcproj", "{215FEC33-87C9-47E1-80EF-2FC735508B57}"
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "thread", "thread.vcproj", "{AA46155A-CCE2-4B9F-BBA2-84E827CF6222}"
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleThread1", "samples\thread\sampleThread1.vcproj", "{2E9B8C5F-AC44-478B-AE7F-8C6DC3EA3654}"
-	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-		{AA46155A-CCE2-4B9F-BBA2-84E827CF6222} = {AA46155A-CCE2-4B9F-BBA2-84E827CF6222}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sample_application", "samples\application\sample_application.vcproj", "{44C8B2A3-281A-4910-A737-7EA1F6F43E35}"
-	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
-	EndProjectSection
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "graphicsBindingsLua", "plugins\scripting\graphicsLuaBindings.vcproj", "{2D5E8A7F-96DA-4CC5-BFC8-430916ACF18A}"
 	ProjectSection(ProjectDependencies) = postProject
 		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
@@ -203,88 +110,25 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "modelLua", "plugins\model\modelLua.vcproj", "{8150E623-2456-4152-AC96-D302B1CFF6E9}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleEvents", "samples\base\sampleEvents.vcproj", "{CD6F13A0-F399-411A-9766-0F8E02761D90}"
-	ProjectSection(ProjectDependencies) = postProject
-		{F1116FDF-65C1-4788-AC1F-F339279B937A} = {F1116FDF-65C1-4788-AC1F-F339279B937A}
-		{7EB6A55E-D262-4C82-862C-33E831DDF04C} = {7EB6A55E-D262-4C82-862C-33E831DDF04C}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleVehicle", "samples\base\sampleVehicle.vcproj", "{B9A9E534-6EB6-4667-B91B-74B930636F5E}"
-	ProjectSection(ProjectDependencies) = postProject
-		{EAEC3A1F-2888-4EAC-869D-BFA70FD56A65} = {EAEC3A1F-2888-4EAC-869D-BFA70FD56A65}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleDotScene", "samples\graphics\sampleDotScene.vcproj", "{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}"
-	ProjectSection(ProjectDependencies) = postProject
-		{F1116FDF-65C1-4788-AC1F-F339279B937A} = {F1116FDF-65C1-4788-AC1F-F339279B937A}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleCar", "samples\misc\sampleCar.vcproj", "{EE77E955-42BD-47A4-BDC6-D92759F45D01}"
-	ProjectSection(ProjectDependencies) = postProject
-		{EAEC3A1F-2888-4EAC-869D-BFA70FD56A65} = {EAEC3A1F-2888-4EAC-869D-BFA70FD56A65}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleGuiConsole", "samples\misc\sampleGuiConsole.vcproj", "{6B6A5F65-AA92-4ABF-A95A-4AC302CB44E9}"
-	ProjectSection(ProjectDependencies) = postProject
-		{F1116FDF-65C1-4788-AC1F-F339279B937A} = {F1116FDF-65C1-4788-AC1F-F339279B937A}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleScripted", "samples\misc\sampleScripted.vcproj", "{6EA2B9BF-2FDA-4E31-BF17-C56709DFB4D4}"
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleScriptedGraphics", "samples\misc\sampleScriptedGraphics.vcproj", "{B85C2435-267A-461C-AD9E-FE28EE7DCC12}"
-	ProjectSection(ProjectDependencies) = postProject
-		{F1116FDF-65C1-4788-AC1F-F339279B937A} = {F1116FDF-65C1-4788-AC1F-F339279B937A}
-		{CA63F621-0912-4551-B51A-7BD18F491181} = {CA63F621-0912-4551-B51A-7BD18F491181}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleDotLink", "samples\model\sampleDotLink.vcproj", "{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}"
-	ProjectSection(ProjectDependencies) = postProject
-		{F1116FDF-65C1-4788-AC1F-F339279B937A} = {F1116FDF-65C1-4788-AC1F-F339279B937A}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleSync1", "samples\model\sampleSync1.vcproj", "{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}"
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleXODE", "samples\model\sampleXODE.vcproj", "{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}"
-	ProjectSection(ProjectDependencies) = postProject
-		{F1116FDF-65C1-4788-AC1F-F339279B937A} = {F1116FDF-65C1-4788-AC1F-F339279B937A}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRafDemo1", "samples\raf\sampleRafDemo1.vcproj", "{BAA11C61-DA21-4E6F-8B5C-16A062720F1C}"
-	ProjectSection(ProjectDependencies) = postProject
-		{6D6DD5E8-3B81-4C98-B460-B434DEE23EE2} = {6D6DD5E8-3B81-4C98-B460-B434DEE23EE2}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRafMinimal", "samples\raf\sampleRafMinimal.vcproj", "{9B57BE31-B084-4AB4-AFEF-E45A0FFD220D}"
-	ProjectSection(ProjectDependencies) = postProject
-		{6D6DD5E8-3B81-4C98-B460-B434DEE23EE2} = {6D6DD5E8-3B81-4C98-B460-B434DEE23EE2}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleStateMachine", "samples\state\sampleStateMachine.vcproj", "{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}"
-	ProjectSection(ProjectDependencies) = postProject
-		{F1116FDF-65C1-4788-AC1F-F339279B937A} = {F1116FDF-65C1-4788-AC1F-F339279B937A}
-	EndProjectSection
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "vehicle", "vehicle.vcproj", "{EAEC3A1F-2888-4EAC-869D-BFA70FD56A65}"
 	ProjectSection(ProjectDependencies) = postProject
 		{F1116FDF-65C1-4788-AC1F-F339279B937A} = {F1116FDF-65C1-4788-AC1F-F339279B937A}
 	EndProjectSection
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleCmdrMayhem", "samples\misc\sampleCmdrMayhem.vcproj", "{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}"
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "object", "object.vcproj", "{CD73E4D1-5832-4DC1-8E65-06052BBD6F49}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "net", "net.vcproj", "{90688422-B178-44F3-824A-C8CD6F3BD86F}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRoServer", "samples\net\sampleRoServer.vcproj", "{547611C2-43E2-4678-B8E9-92CF69770C40}"
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "ent2", "ent2.vcproj", "{08BC40D8-33D8-4677-993A-32599A93A460}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRoClient", "samples\net\sampleRoClient.vcproj", "{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}"
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleAudio1", "samples\audio\sampleAudio1.vcproj", "{726DFDDE-71FA-403B-8F58-6DA9DF0EF297}"
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleEntFsm", "samples\ent\sampleEntFsm.vcproj", "{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}"
 	ProjectSection(ProjectDependencies) = postProject
-		{42BB6F78-B04C-4968-AA5E-271DC45BEFBB} = {42BB6F78-B04C-4968-AA5E-271DC45BEFBB}
+		{89182311-DB82-446B-AA9B-C70A3A0AF035} = {89182311-DB82-446B-AA9B-C70A3A0AF035}
+		{08BC40D8-33D8-4677-993A-32599A93A460} = {08BC40D8-33D8-4677-993A-32599A93A460}
 	EndProjectSection
 EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "entLua2", "plugins\ent\entLua2.vcproj", "{89182311-DB82-446B-AA9B-C70A3A0AF035}"
+EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) = preSolution
 		Debug|Win32 = Debug|Win32
@@ -303,38 +147,6 @@
 		{A2C2A0B2-2EB0-4254-891D-FE93466809CF}.Debug|Win32.Build.0 = Debug|Win32
 		{A2C2A0B2-2EB0-4254-891D-FE93466809CF}.Release|Win32.ActiveCfg = Release|Win32
 		{A2C2A0B2-2EB0-4254-891D-FE93466809CF}.Release|Win32.Build.0 = Release|Win32
-		{F6E2B937-448D-4ADE-9A8F-7DDF0CB38865}.Debug|Win32.ActiveCfg = Debug|Win32
-		{F6E2B937-448D-4ADE-9A8F-7DDF0CB38865}.Debug|Win32.Build.0 = Debug|Win32
-		{F6E2B937-448D-4ADE-9A8F-7DDF0CB38865}.Release|Win32.ActiveCfg = Release|Win32
-		{F6E2B937-448D-4ADE-9A8F-7DDF0CB38865}.Release|Win32.Build.0 = Release|Win32
-		{F6E2B937-449D-4ADE-9A8F-7DDF0CB38866}.Debug|Win32.ActiveCfg = Debug|Win32
-		{F6E2B937-449D-4ADE-9A8F-7DDF0CB38866}.Debug|Win32.Build.0 = Debug|Win32
-		{F6E2B937-449D-4ADE-9A8F-7DDF0CB38866}.Release|Win32.ActiveCfg = Release|Win32
-		{F6E2B937-449D-4ADE-9A8F-7DDF0CB38866}.Release|Win32.Build.0 = Release|Win32
-		{7E0CC2D4-0DDE-419A-81DE-EE0739673432}.Debug|Win32.ActiveCfg = Debug|Win32
-		{7E0CC2D4-0DDE-419A-81DE-EE0739673432}.Debug|Win32.Build.0 = Debug|Win32
-		{7E0CC2D4-0DDE-419A-81DE-EE0739673432}.Release|Win32.ActiveCfg = Release|Win32
-		{7E0CC2D4-0DDE-419A-81DE-EE0739673432}.Release|Win32.Build.0 = Release|Win32
-		{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}.Debug|Win32.ActiveCfg = Debug|Win32
-		{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}.Debug|Win32.Build.0 = Debug|Win32
-		{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}.Release|Win32.ActiveCfg = Release|Win32
-		{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}.Release|Win32.Build.0 = Release|Win32
-		{0CA5014D-D3E7-4B2B-B993-75788097E065}.Debug|Win32.ActiveCfg = Debug|Win32
-		{0CA5014D-D3E7-4B2B-B993-75788097E065}.Debug|Win32.Build.0 = Debug|Win32
-		{0CA5014D-D3E7-4B2B-B993-75788097E065}.Release|Win32.ActiveCfg = Release|Win32
-		{0CA5014D-D3E7-4B2B-B993-75788097E065}.Release|Win32.Build.0 = Release|Win32
-		{6876FBCB-B5AD-493E-ADE4-F81441BC4EF2}.Debug|Win32.ActiveCfg = Debug|Win32
-		{6876FBCB-B5AD-493E-ADE4-F81441BC4EF2}.Debug|Win32.Build.0 = Debug|Win32
-		{6876FBCB-B5AD-493E-ADE4-F81441BC4EF2}.Release|Win32.ActiveCfg = Release|Win32
-		{6876FBCB-B5AD-493E-ADE4-F81441BC4EF2}.Release|Win32.Build.0 = Release|Win32
-		{6876FBCB-B5AD-494E-ADE4-F81441BC4EF9}.Debug|Win32.ActiveCfg = Debug|Win32
-		{6876FBCB-B5AD-494E-ADE4-F81441BC4EF9}.Debug|Win32.Build.0 = Debug|Win32
-		{6876FBCB-B5AD-494E-ADE4-F81441BC4EF9}.Release|Win32.ActiveCfg = Release|Win32
-		{6876FBCB-B5AD-494E-ADE4-F81441BC4EF9}.Release|Win32.Build.0 = Release|Win32
-		{723A2F36-A3DC-40E5-A7B0-0629219B04DE}.Debug|Win32.ActiveCfg = Debug|Win32
-		{723A2F36-A3DC-40E5-A7B0-0629219B04DE}.Debug|Win32.Build.0 = Debug|Win32
-		{723A2F36-A3DC-40E5-A7B0-0629219B04DE}.Release|Win32.ActiveCfg = Release|Win32
-		{723A2F36-A3DC-40E5-A7B0-0629219B04DE}.Release|Win32.Build.0 = Release|Win32
 		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}.Debug|Win32.ActiveCfg = Debug|Win32
 		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}.Debug|Win32.Build.0 = Debug|Win32
 		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}.Release|Win32.ActiveCfg = Release|Win32
@@ -359,18 +171,10 @@
 		{41CEA11B-9678-43E5-B2F4-754944D7B461}.Debug|Win32.Build.0 = Debug|Win32
 		{41CEA11B-9678-43E5-B2F4-754944D7B461}.Release|Win32.ActiveCfg = Release|Win32
 		{41CEA11B-9678-43E5-B2F4-754944D7B461}.Release|Win32.Build.0 = Release|Win32
-		{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}.Debug|Win32.ActiveCfg = Debug|Win32
-		{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}.Debug|Win32.Build.0 = Debug|Win32
-		{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}.Release|Win32.ActiveCfg = Release|Win32
-		{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}.Release|Win32.Build.0 = Release|Win32
 		{77A59B89-C2B3-429C-8317-ADE0D046CC3B}.Debug|Win32.ActiveCfg = Debug|Win32
 		{77A59B89-C2B3-429C-8317-ADE0D046CC3B}.Debug|Win32.Build.0 = Debug|Win32
 		{77A59B89-C2B3-429C-8317-ADE0D046CC3B}.Release|Win32.ActiveCfg = Release|Win32
 		{77A59B89-C2B3-429C-8317-ADE0D046CC3B}.Release|Win32.Build.0 = Release|Win32
-		{22EFD734-D8C5-47D6-8461-C37E02A9F0B6}.Debug|Win32.ActiveCfg = Debug|Win32
-		{22EFD734-D8C5-47D6-8461-C37E02A9F0B6}.Debug|Win32.Build.0 = Debug|Win32
-		{22EFD734-D8C5-47D6-8461-C37E02A9F0B6}.Release|Win32.ActiveCfg = Release|Win32
-		{22EFD734-D8C5-47D6-8461-C37E02A9F0B6}.Release|Win32.Build.0 = Release|Win32
 		{CA63F621-0912-4551-B51A-7BD18F491181}.Debug|Win32.ActiveCfg = Debug|Win32
 		{CA63F621-0912-4551-B51A-7BD18F491181}.Debug|Win32.Build.0 = Debug|Win32
 		{CA63F621-0912-4551-B51A-7BD18F491181}.Release|Win32.ActiveCfg = Release|Win32
@@ -387,26 +191,6 @@
 		{5749946B-081D-4A80-8119-2BE84F571E81}.Debug|Win32.Build.0 = Debug|Win32
 		{5749946B-081D-4A80-8119-2BE84F571E81}.Release|Win32.ActiveCfg = Release|Win32
 		{5749946B-081D-4A80-8119-2BE84F571E81}.Release|Win32.Build.0 = Release|Win32
-		{3DA99679-404B-44C7-9267-C97D066F3D96}.Debug|Win32.ActiveCfg = Debug|Win32
-		{3DA99679-404B-44C7-9267-C97D066F3D96}.Debug|Win32.Build.0 = Debug|Win32
-		{3DA99679-404B-44C7-9267-C97D066F3D96}.Release|Win32.ActiveCfg = Release|Win32
-		{3DA99679-404B-44C7-9267-C97D066F3D96}.Release|Win32.Build.0 = Release|Win32
-		{215FEC33-87C9-47E1-80EF-2FC735508B57}.Debug|Win32.ActiveCfg = Debug|Win32
-		{215FEC33-87C9-47E1-80EF-2FC735508B57}.Debug|Win32.Build.0 = Debug|Win32
-		{215FEC33-87C9-47E1-80EF-2FC735508B57}.Release|Win32.ActiveCfg = Release|Win32
-		{215FEC33-87C9-47E1-80EF-2FC735508B57}.Release|Win32.Build.0 = Release|Win32
-		{AA46155A-CCE2-4B9F-BBA2-84E827CF6222}.Debug|Win32.ActiveCfg = Debug|Win32
-		{AA46155A-CCE2-4B9F-BBA2-84E827CF6222}.Debug|Win32.Build.0 = Debug|Win32
-		{AA46155A-CCE2-4B9F-BBA2-84E827CF6222}.Release|Win32.ActiveCfg = Release|Win32
-		{AA46155A-CCE2-4B9F-BBA2-84E827CF6222}.Release|Win32.Build.0 = Release|Win32
-		{2E9B8C5F-AC44-478B-AE7F-8C6DC3EA3654}.Debug|Win32.ActiveCfg = Debug|Win32
-		{2E9B8C5F-AC44-478B-AE7F-8C6DC3EA3654}.Debug|Win32.Build.0 = Debug|Win32
-		{2E9B8C5F-AC44-478B-AE7F-8C6DC3EA3654}.Release|Win32.ActiveCfg = Release|Win32
-		{2E9B8C5F-AC44-478B-AE7F-8C6DC3EA3654}.Release|Win32.Build.0 = Release|Win32
-		{44C8B2A3-281A-4910-A737-7EA1F6F43E35}.Debug|Win32.ActiveCfg = Debug|Win32
-		{44C8B2A3-281A-4910-A737-7EA1F6F43E35}.Debug|Win32.Build.0 = Debug|Win32
-		{44C8B2A3-281A-4910-A737-7EA1F6F43E35}.Release|Win32.ActiveCfg = Release|Win32
-		{44C8B2A3-281A-4910-A737-7EA1F6F43E35}.Release|Win32.Build.0 = Release|Win32
 		{2D5E8A7F-96DA-4CC5-BFC8-430916ACF18A}.Debug|Win32.ActiveCfg = Debug|Win32
 		{2D5E8A7F-96DA-4CC5-BFC8-430916ACF18A}.Release|Win32.ActiveCfg = Release|Win32
 		{3867E9A4-41F3-4969-B0A8-40757BCB6C29}.Debug|Win32.ActiveCfg = Debug|Win32
@@ -445,66 +229,10 @@
 		{8150E623-2456-4152-AC96-D302B1CFF6E9}.Debug|Win32.Build.0 = Debug|Win32
 		{8150E623-2456-4152-AC96-D302B1CFF6E9}.Release|Win32.ActiveCfg = Release|Win32
 		{8150E623-2456-4152-AC96-D302B1CFF6E9}.Release|Win32.Build.0 = Release|Win32
-		{CD6F13A0-F399-411A-9766-0F8E02761D90}.Debug|Win32.ActiveCfg = Debug|Win32
-		{CD6F13A0-F399-411A-9766-0F8E02761D90}.Debug|Win32.Build.0 = Debug|Win32
-		{CD6F13A0-F399-411A-9766-0F8E02761D90}.Release|Win32.ActiveCfg = Release|Win32
-		{CD6F13A0-F399-411A-9766-0F8E02761D90}.Release|Win32.Build.0 = Release|Win32
-		{B9A9E534-6EB6-4667-B91B-74B930636F5E}.Debug|Win32.ActiveCfg = Debug|Win32
-		{B9A9E534-6EB6-4667-B91B-74B930636F5E}.Debug|Win32.Build.0 = Debug|Win32
-		{B9A9E534-6EB6-4667-B91B-74B930636F5E}.Release|Win32.ActiveCfg = Release|Win32
-		{B9A9E534-6EB6-4667-B91B-74B930636F5E}.Release|Win32.Build.0 = Release|Win32
-		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Debug|Win32.ActiveCfg = Debug|Win32
-		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Debug|Win32.Build.0 = Debug|Win32
-		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Release|Win32.ActiveCfg = Release|Win32
-		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Release|Win32.Build.0 = Release|Win32
-		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Debug|Win32.ActiveCfg = Debug|Win32
-		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Debug|Win32.Build.0 = Debug|Win32
-		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Release|Win32.ActiveCfg = Release|Win32
-		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Release|Win32.Build.0 = Release|Win32
-		{6B6A5F65-AA92-4ABF-A95A-4AC302CB44E9}.Debug|Win32.ActiveCfg = Debug|Win32
-		{6B6A5F65-AA92-4ABF-A95A-4AC302CB44E9}.Debug|Win32.Build.0 = Debug|Win32
-		{6B6A5F65-AA92-4ABF-A95A-4AC302CB44E9}.Release|Win32.ActiveCfg = Release|Win32
-		{6B6A5F65-AA92-4ABF-A95A-4AC302CB44E9}.Release|Win32.Build.0 = Release|Win32
-		{6EA2B9BF-2FDA-4E31-BF17-C56709DFB4D4}.Debug|Win32.ActiveCfg = Debug|Win32
-		{6EA2B9BF-2FDA-4E31-BF17-C56709DFB4D4}.Debug|Win32.Build.0 = Debug|Win32
-		{6EA2B9BF-2FDA-4E31-BF17-C56709DFB4D4}.Release|Win32.ActiveCfg = Release|Win32
-		{6EA2B9BF-2FDA-4E31-BF17-C56709DFB4D4}.Release|Win32.Build.0 = Release|Win32
-		{B85C2435-267A-461C-AD9E-FE28EE7DCC12}.Debug|Win32.ActiveCfg = Debug|Win32
-		{B85C2435-267A-461C-AD9E-FE28EE7DCC12}.Debug|Win32.Build.0 = Debug|Win32
-		{B85C2435-267A-461C-AD9E-FE28EE7DCC12}.Release|Win32.ActiveCfg = Release|Win32
-		{B85C2435-267A-461C-AD9E-FE28EE7DCC12}.Release|Win32.Build.0 = Release|Win32
-		{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}.Debug|Win32.ActiveCfg = Debug|Win32
-		{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}.Debug|Win32.Build.0 = Debug|Win32
-		{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}.Release|Win32.ActiveCfg = Release|Win32
-		{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}.Release|Win32.Build.0 = Release|Win32
-		{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}.Debug|Win32.ActiveCfg = Debug|Win32
-		{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}.Debug|Win32.Build.0 = Debug|Win32
-		{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}.Release|Win32.ActiveCfg = Release|Win32
-		{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}.Release|Win32.Build.0 = Release|Win32
-		{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}.Debug|Win32.ActiveCfg = Debug|Win32
-		{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}.Debug|Win32.Build.0 = Debug|Win32
-		{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}.Release|Win32.ActiveCfg = Release|Win32
-		{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}.Release|Win32.Build.0 = Release|Win32
-		{BAA11C61-DA21-4E6F-8B5C-16A062720F1C}.Debug|Win32.ActiveCfg = Debug|Win32
-		{BAA11C61-DA21-4E6F-8B5C-16A062720F1C}.Debug|Win32.Build.0 = Debug|Win32
-		{BAA11C61-DA21-4E6F-8B5C-16A062720F1C}.Release|Win32.ActiveCfg = Release|Win32
-		{BAA11C61-DA21-4E6F-8B5C-16A062720F1C}.Release|Win32.Build.0 = Release|Win32
-		{9B57BE31-B084-4AB4-AFEF-E45A0FFD220D}.Debug|Win32.ActiveCfg = Debug|Win32
-		{9B57BE31-B084-4AB4-AFEF-E45A0FFD220D}.Debug|Win32.Build.0 = Debug|Win32
-		{9B57BE31-B084-4AB4-AFEF-E45A0FFD220D}.Release|Win32.ActiveCfg = Release|Win32
-		{9B57BE31-B084-4AB4-AFEF-E45A0FFD220D}.Release|Win32.Build.0 = Release|Win32
-		{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}.Debug|Win32.ActiveCfg = Debug|Win32
-		{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}.Debug|Win32.Build.0 = Debug|Win32
-		{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}.Release|Win32.ActiveCfg = Release|Win32
-		{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}.Release|Win32.Build.0 = Release|Win32
 		{EAEC3A1F-2888-4EAC-869D-BFA70FD56A65}.Debug|Win32.ActiveCfg = Debug|Win32
 		{EAEC3A1F-2888-4EAC-869D-BFA70FD56A65}.Debug|Win32.Build.0 = Debug|Win32
 		{EAEC3A1F-2888-4EAC-869D-BFA70FD56A65}.Release|Win32.ActiveCfg = Release|Win32
 		{EAEC3A1F-2888-4EAC-869D-BFA70FD56A65}.Release|Win32.Build.0 = Release|Win32
-		{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}.Debug|Win32.ActiveCfg = Debug|Win32
-		{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}.Debug|Win32.Build.0 = Debug|Win32
-		{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}.Release|Win32.ActiveCfg = Release|Win32
-		{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}.Release|Win32.Build.0 = Release|Win32
 		{CD73E4D1-5832-4DC1-8E65-06052BBD6F49}.Debug|Win32.ActiveCfg = Debug|Win32
 		{CD73E4D1-5832-4DC1-8E65-06052BBD6F49}.Debug|Win32.Build.0 = Debug|Win32
 		{CD73E4D1-5832-4DC1-8E65-06052BBD6F49}.Release|Win32.ActiveCfg = Release|Win32
@@ -513,18 +241,18 @@
 		{90688422-B178-44F3-824A-C8CD6F3BD86F}.Debug|Win32.Build.0 = Debug|Win32
 		{90688422-B178-44F3-824A-C8CD6F3BD86F}.Release|Win32.ActiveCfg = Release|Win32
 		{90688422-B178-44F3-824A-C8CD6F3BD86F}.Release|Win32.Build.0 = Release|Win32
-		{547611C2-43E2-4678-B8E9-92CF69770C40}.Debug|Win32.ActiveCfg = Debug|Win32
-		{547611C2-43E2-4678-B8E9-92CF69770C40}.Debug|Win32.Build.0 = Debug|Win32
-		{547611C2-43E2-4678-B8E9-92CF69770C40}.Release|Win32.ActiveCfg = Release|Win32
-		{547611C2-43E2-4678-B8E9-92CF69770C40}.Release|Win32.Build.0 = Release|Win32
-		{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}.Debug|Win32.ActiveCfg = Debug|Win32
-		{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}.Debug|Win32.Build.0 = Debug|Win32
-		{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}.Release|Win32.ActiveCfg = Release|Win32
-		{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}.Release|Win32.Build.0 = Release|Win32
-		{726DFDDE-71FA-403B-8F58-6DA9DF0EF297}.Debug|Win32.ActiveCfg = Debug|Win32
-		{726DFDDE-71FA-403B-8F58-6DA9DF0EF297}.Debug|Win32.Build.0 = Debug|Win32
-		{726DFDDE-71FA-403B-8F58-6DA9DF0EF297}.Release|Win32.ActiveCfg = Release|Win32
-		{726DFDDE-71FA-403B-8F58-6DA9DF0EF297}.Release|Win32.Build.0 = Release|Win32
+		{08BC40D8-33D8-4677-993A-32599A93A460}.Debug|Win32.ActiveCfg = Debug|Win32
+		{08BC40D8-33D8-4677-993A-32599A93A460}.Debug|Win32.Build.0 = Debug|Win32
+		{08BC40D8-33D8-4677-993A-32599A93A460}.Release|Win32.ActiveCfg = Release|Win32
+		{08BC40D8-33D8-4677-993A-32599A93A460}.Release|Win32.Build.0 = Release|Win32
+		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Debug|Win32.ActiveCfg = Debug|Win32
+		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Debug|Win32.Build.0 = Debug|Win32
+		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Release|Win32.ActiveCfg = Release|Win32
+		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Release|Win32.Build.0 = Release|Win32
+		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Debug|Win32.ActiveCfg = Debug|Win32
+		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Debug|Win32.Build.0 = Debug|Win32
+		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Release|Win32.ActiveCfg = Release|Win32
+		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Release|Win32.Build.0 = Release|Win32
 	EndGlobalSection
 	GlobalSection(SolutionProperties) = preSolution
 		HideSolutionNode = FALSE



From codeandroid at berlios.de  Sun Mar 12 22:47:38 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 22:47:38 +0100
Subject: [Yake-svn] r1246 - trunk/yake/documentation/api
Message-ID: <200603122147.k2CLlcFa010513@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 22:47:38 +0100 (Sun, 12 Mar 2006)
New Revision: 1246

Modified:
   trunk/yake/documentation/api/docMainPage.h
Log:
dev version

Modified: trunk/yake/documentation/api/docMainPage.h
===================================================================
--- trunk/yake/documentation/api/docMainPage.h	2006-03-12 19:02:38 UTC (rev 1245)
+++ trunk/yake/documentation/api/docMainPage.h	2006-03-12 21:47:38 UTC (rev 1246)
@@ -1,6 +1,6 @@
-/** \mainpage "YAKE 0.5.0 API"
+/** \mainpage "YAKE 0.5.0dev API"
 
-!!! YAKE 0.5.0 API Documentation
+!!! YAKE 0.5.0dev API Documentation
 
 
 !! What is this?



From codeandroid at berlios.de  Sun Mar 12 22:48:26 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 22:48:26 +0100
Subject: [Yake-svn] r1247 - trunk/yake/documentation/api
Message-ID: <200603122148.k2CLmQX2010573@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 22:48:22 +0100 (Sun, 12 Mar 2006)
New Revision: 1247

Removed:
   trunk/yake/documentation/api/api.cfg
   trunk/yake/documentation/api/api.css
   trunk/yake/documentation/api/doc_main.h
   trunk/yake/documentation/api/footer.html
   trunk/yake/documentation/api/header.html
Log:
replaced by doxys

Deleted: trunk/yake/documentation/api/api.cfg
===================================================================
--- trunk/yake/documentation/api/api.cfg	2006-03-12 21:47:38 UTC (rev 1246)
+++ trunk/yake/documentation/api/api.cfg	2006-03-12 21:48:22 UTC (rev 1247)
@@ -1,1263 +0,0 @@
-# Doxyfile 1.4.3
-
-# This file describes the settings to be used by the documentation system
-# doxygen (www.doxygen.org) for a project
-#
-# All text after a hash (#) is considered a comment and will be ignored
-# The format is:
-#       TAG = value [value, ...]
-# For lists items can also be appended using:
-#       TAG += value [value, ...]
-# Values that contain spaces should be placed between quotes (" ")
-
-#---------------------------------------------------------------------------
-# Project related configuration options
-#---------------------------------------------------------------------------
-
-# The PROJECT_NAME tag is a single word (or a sequence of words surrounded 
-# by quotes) that should identify the project.
-
-PROJECT_NAME           = "YAKE API Reference"
-
-# The PROJECT_NUMBER tag can be used to enter a project or revision number. 
-# This could be handy for archiving the generated documentation or 
-# if some version control system is used.
-
-PROJECT_NUMBER         = 0.5dev
-
-# The OUTPUT_DIRECTORY tag is used to specify the (relative or absolute) 
-# base path where the generated documentation will be put. 
-# If a relative path is entered, it will be relative to the location 
-# where doxygen was started. If left blank the current directory will be used.
-
-OUTPUT_DIRECTORY       = documentation/api
-
-# If the CREATE_SUBDIRS tag is set to YES, then doxygen will create 
-# 4096 sub-directories (in 2 levels) under the output directory of each output 
-# format and will distribute the generated files over these directories. 
-# Enabling this option can be useful when feeding doxygen a huge amount of 
-# source files, where putting all generated files in the same directory would 
-# otherwise cause performance problems for the file system.
-
-CREATE_SUBDIRS         = NO
-
-# The OUTPUT_LANGUAGE tag is used to specify the language in which all 
-# documentation generated by doxygen is written. Doxygen will use this 
-# information to generate all constant output in the proper language. 
-# The default language is English, other supported languages are: 
-# Brazilian, Catalan, Chinese, Chinese-Traditional, Croatian, Czech, Danish, 
-# Dutch, Finnish, French, German, Greek, Hungarian, Italian, Japanese, 
-# Japanese-en (Japanese with English messages), Korean, Korean-en, Norwegian, 
-# Polish, Portuguese, Romanian, Russian, Serbian, Slovak, Slovene, Spanish, 
-# Swedish, and Ukrainian.
-
-OUTPUT_LANGUAGE        = English
-
-# This tag can be used to specify the encoding used in the generated output. 
-# The encoding is not always determined by the language that is chosen, 
-# but also whether or not the output is meant for Windows or non-Windows users. 
-# In case there is a difference, setting the USE_WINDOWS_ENCODING tag to YES 
-# forces the Windows encoding (this is the default for the Windows binary), 
-# whereas setting the tag to NO uses a Unix-style encoding (the default for 
-# all platforms other than Windows).
-
-USE_WINDOWS_ENCODING   = YES
-
-# If the BRIEF_MEMBER_DESC tag is set to YES (the default) Doxygen will 
-# include brief member descriptions after the members that are listed in 
-# the file and class documentation (similar to JavaDoc). 
-# Set to NO to disable this.
-
-BRIEF_MEMBER_DESC      = YES
-
-# If the REPEAT_BRIEF tag is set to YES (the default) Doxygen will prepend 
-# the brief description of a member or function before the detailed description. 
-# Note: if both HIDE_UNDOC_MEMBERS and BRIEF_MEMBER_DESC are set to NO, the 
-# brief descriptions will be completely suppressed.
-
-REPEAT_BRIEF           = YES
-
-# This tag implements a quasi-intelligent brief description abbreviator 
-# that is used to form the text in various listings. Each string 
-# in this list, if found as the leading text of the brief description, will be 
-# stripped from the text and the result after processing the whole list, is 
-# used as the annotated text. Otherwise, the brief description is used as-is. 
-# If left blank, the following values are used ("$name" is automatically 
-# replaced with the name of the entity): "The $name class" "The $name widget" 
-# "The $name file" "is" "provides" "specifies" "contains" 
-# "represents" "a" "an" "the"
-
-ABBREVIATE_BRIEF       = 
-
-# If the ALWAYS_DETAILED_SEC and REPEAT_BRIEF tags are both set to YES then 
-# Doxygen will generate a detailed section even if there is only a brief 
-# description.
-
-ALWAYS_DETAILED_SEC    = YES
-
-# If the INLINE_INHERITED_MEMB tag is set to YES, doxygen will show all 
-# inherited members of a class in the documentation of that class as if those 
-# members were ordinary class members. Constructors, destructors and assignment 
-# operators of the base classes will not be shown.
-
-INLINE_INHERITED_MEMB  = NO
-
-# If the FULL_PATH_NAMES tag is set to YES then Doxygen will prepend the full 
-# path before files name in the file list and in the header files. If set 
-# to NO the shortest path that makes the file name unique will be used.
-
-FULL_PATH_NAMES        = YES
-
-# If the FULL_PATH_NAMES tag is set to YES then the STRIP_FROM_PATH tag 
-# can be used to strip a user-defined part of the path. Stripping is 
-# only done if one of the specified strings matches the left-hand part of 
-# the path. The tag can be used to show relative paths in the file list. 
-# If left blank the directory from which doxygen is run is used as the 
-# path to strip.
-
-STRIP_FROM_PATH        = 
-
-# The STRIP_FROM_INC_PATH tag can be used to strip a user-defined part of 
-# the path mentioned in the documentation of a class, which tells 
-# the reader which header file to include in order to use a class. 
-# If left blank only the name of the header file containing the class 
-# definition is used. Otherwise one should specify the include paths that 
-# are normally passed to the compiler using the -I flag.
-
-STRIP_FROM_INC_PATH    = 
-
-# If the SHORT_NAMES tag is set to YES, doxygen will generate much shorter 
-# (but less readable) file names. This can be useful is your file systems 
-# doesn't support long names like on DOS, Mac, or CD-ROM.
-
-SHORT_NAMES            = NO
-
-# If the JAVADOC_AUTOBRIEF tag is set to YES then Doxygen 
-# will interpret the first line (until the first dot) of a JavaDoc-style 
-# comment as the brief description. If set to NO, the JavaDoc 
-# comments will behave just like the Qt-style comments (thus requiring an 
-# explicit @brief command for a brief description.
-
-JAVADOC_AUTOBRIEF      = NO
-
-# The MULTILINE_CPP_IS_BRIEF tag can be set to YES to make Doxygen 
-# treat a multi-line C++ special comment block (i.e. a block of //! or /// 
-# comments) as a brief description. This used to be the default behaviour. 
-# The new default is to treat a multi-line C++ comment block as a detailed 
-# description. Set this tag to YES if you prefer the old behaviour instead.
-
-MULTILINE_CPP_IS_BRIEF = YES
-
-# If the DETAILS_AT_TOP tag is set to YES then Doxygen 
-# will output the detailed description near the top, like JavaDoc.
-# If set to NO, the detailed description appears after the member 
-# documentation.
-
-DETAILS_AT_TOP         = NO
-
-# If the INHERIT_DOCS tag is set to YES (the default) then an undocumented 
-# member inherits the documentation from any documented member that it 
-# re-implements.
-
-INHERIT_DOCS           = YES
-
-# If member grouping is used in the documentation and the DISTRIBUTE_GROUP_DOC 
-# tag is set to YES, then doxygen will reuse the documentation of the first 
-# member in the group (if any) for the other members of the group. By default 
-# all members of a group must be documented explicitly.
-
-DISTRIBUTE_GROUP_DOC   = NO
-
-# If the SEPARATE_MEMBER_PAGES tag is set to YES, then doxygen will produce 
-# a new page for each member. If set to NO, the documentation of a member will 
-# be part of the file/class/namespace that contains it.
-
-SEPARATE_MEMBER_PAGES  = NO
-
-# The TAB_SIZE tag can be used to set the number of spaces in a tab. 
-# Doxygen uses this value to replace tabs by spaces in code fragments.
-
-TAB_SIZE               = 8
-
-# This tag can be used to specify a number of aliases that acts 
-# as commands in the documentation. An alias has the form "name=value". 
-# For example adding "sideeffect=\par Side Effects:\n" will allow you to 
-# put the command \sideeffect (or @sideeffect) in the documentation, which 
-# will result in a user-defined paragraph with heading "Side Effects:". 
-# You can put \n's in the value part of an alias to insert newlines.
-
-ALIASES                = 
-
-# Set the OPTIMIZE_OUTPUT_FOR_C tag to YES if your project consists of C 
-# sources only. Doxygen will then generate output that is more tailored for C. 
-# For instance, some of the names that are used will be different. The list 
-# of all members will be omitted, etc.
-
-OPTIMIZE_OUTPUT_FOR_C  = NO
-
-# Set the OPTIMIZE_OUTPUT_JAVA tag to YES if your project consists of Java sources 
-# only. Doxygen will then generate output that is more tailored for Java. 
-# For instance, namespaces will be presented as packages, qualified scopes 
-# will look different, etc.
-
-OPTIMIZE_OUTPUT_JAVA   = NO
-
-# Set the SUBGROUPING tag to YES (the default) to allow class member groups of 
-# the same type (for instance a group of public functions) to be put as a 
-# subgroup of that type (e.g. under the Public Functions section). Set it to 
-# NO to prevent subgrouping. Alternatively, this can be done per class using 
-# the \nosubgrouping command.
-
-SUBGROUPING            = YES
-
-#---------------------------------------------------------------------------
-# Build related configuration options
-#---------------------------------------------------------------------------
-
-# If the EXTRACT_ALL tag is set to YES doxygen will assume all entities in 
-# documentation are documented, even if no documentation was available. 
-# Private class members and static file members will be hidden unless 
-# the EXTRACT_PRIVATE and EXTRACT_STATIC tags are set to YES
-
-EXTRACT_ALL            = NO
-
-# If the EXTRACT_PRIVATE tag is set to YES all private members of a class 
-# will be included in the documentation.
-
-EXTRACT_PRIVATE        = NO
-
-# If the EXTRACT_STATIC tag is set to YES all static members of a file 
-# will be included in the documentation.
-
-EXTRACT_STATIC         = YES
-
-# If the EXTRACT_LOCAL_CLASSES tag is set to YES classes (and structs) 
-# defined locally in source files will be included in the documentation. 
-# If set to NO only classes defined in header files are included.
-
-EXTRACT_LOCAL_CLASSES  = YES
-
-# This flag is only useful for Objective-C code. When set to YES local 
-# methods, which are defined in the implementation section but not in 
-# the interface are included in the documentation. 
-# If set to NO (the default) only methods in the interface are included.
-
-EXTRACT_LOCAL_METHODS  = NO
-
-# If the HIDE_UNDOC_MEMBERS tag is set to YES, Doxygen will hide all 
-# undocumented members of documented classes, files or namespaces. 
-# If set to NO (the default) these members will be included in the 
-# various overviews, but no documentation section is generated. 
-# This option has no effect if EXTRACT_ALL is enabled.
-
-HIDE_UNDOC_MEMBERS     = NO
-
-# If the HIDE_UNDOC_CLASSES tag is set to YES, Doxygen will hide all 
-# undocumented classes that are normally visible in the class hierarchy. 
-# If set to NO (the default) these classes will be included in the various 
-# overviews. This option has no effect if EXTRACT_ALL is enabled.
-
-HIDE_UNDOC_CLASSES     = NO
-
-# If the HIDE_FRIEND_COMPOUNDS tag is set to YES, Doxygen will hide all 
-# friend (class|struct|union) declarations. 
-# If set to NO (the default) these declarations will be included in the 
-# documentation.
-
-HIDE_FRIEND_COMPOUNDS  = NO
-
-# If the HIDE_IN_BODY_DOCS tag is set to YES, Doxygen will hide any 
-# documentation blocks found inside the body of a function. 
-# If set to NO (the default) these blocks will be appended to the 
-# function's detailed documentation block.
-
-HIDE_IN_BODY_DOCS      = NO
-
-# The INTERNAL_DOCS tag determines if documentation 
-# that is typed after a \internal command is included. If the tag is set 
-# to NO (the default) then the documentation will be excluded. 
-# Set it to YES to include the internal documentation.
-
-INTERNAL_DOCS          = NO
-
-# If the CASE_SENSE_NAMES tag is set to NO then Doxygen will only generate 
-# file names in lower-case letters. If set to YES upper-case letters are also 
-# allowed. This is useful if you have classes or files whose names only differ 
-# in case and if your file system supports case sensitive file names. Windows 
-# and Mac users are advised to set this option to NO.
-
-CASE_SENSE_NAMES       = NO
-
-# If the HIDE_SCOPE_NAMES tag is set to NO (the default) then Doxygen 
-# will show members with their full class and namespace scopes in the 
-# documentation. If set to YES the scope will be hidden.
-
-HIDE_SCOPE_NAMES       = NO
-
-# If the SHOW_INCLUDE_FILES tag is set to YES (the default) then Doxygen 
-# will put a list of the files that are included by a file in the documentation 
-# of that file.
-
-SHOW_INCLUDE_FILES     = YES
-
-# If the INLINE_INFO tag is set to YES (the default) then a tag [inline] 
-# is inserted in the documentation for inline members.
-
-INLINE_INFO            = YES
-
-# If the SORT_MEMBER_DOCS tag is set to YES (the default) then doxygen 
-# will sort the (detailed) documentation of file and class members 
-# alphabetically by member name. If set to NO the members will appear in 
-# declaration order.
-
-SORT_MEMBER_DOCS       = YES
-
-# If the SORT_BRIEF_DOCS tag is set to YES then doxygen will sort the 
-# brief documentation of file, namespace and class members alphabetically 
-# by member name. If set to NO (the default) the members will appear in 
-# declaration order.
-
-SORT_BRIEF_DOCS        = NO
-
-# If the SORT_BY_SCOPE_NAME tag is set to YES, the class list will be 
-# sorted by fully-qualified names, including namespaces. If set to 
-# NO (the default), the class list will be sorted only by class name, 
-# not including the namespace part. 
-# Note: This option is not very useful if HIDE_SCOPE_NAMES is set to YES.
-# Note: This option applies only to the class list, not to the 
-# alphabetical list.
-
-SORT_BY_SCOPE_NAME     = YES
-
-# The GENERATE_TODOLIST tag can be used to enable (YES) or 
-# disable (NO) the todo list. This list is created by putting \todo 
-# commands in the documentation.
-
-GENERATE_TODOLIST      = NO
-
-# The GENERATE_TESTLIST tag can be used to enable (YES) or 
-# disable (NO) the test list. This list is created by putting \test 
-# commands in the documentation.
-
-GENERATE_TESTLIST      = NO
-
-# The GENERATE_BUGLIST tag can be used to enable (YES) or 
-# disable (NO) the bug list. This list is created by putting \bug 
-# commands in the documentation.
-
-GENERATE_BUGLIST       = NO
-
-# The GENERATE_DEPRECATEDLIST tag can be used to enable (YES) or 
-# disable (NO) the deprecated list. This list is created by putting 
-# \deprecated commands in the documentation.
-
-GENERATE_DEPRECATEDLIST= YES
-
-# The ENABLED_SECTIONS tag can be used to enable conditional 
-# documentation sections, marked by \if sectionname ... \endif.
-
-ENABLED_SECTIONS       = 
-
-# The MAX_INITIALIZER_LINES tag determines the maximum number of lines 
-# the initial value of a variable or define consists of for it to appear in 
-# the documentation. If the initializer consists of more lines than specified 
-# here it will be hidden. Use a value of 0 to hide initializers completely. 
-# The appearance of the initializer of individual variables and defines in the 
-# documentation can be controlled using \showinitializer or \hideinitializer 
-# command in the documentation regardless of this setting.
-
-MAX_INITIALIZER_LINES  = 30
-
-# Set the SHOW_USED_FILES tag to NO to disable the list of files generated 
-# at the bottom of the documentation of classes and structs. If set to YES the 
-# list will mention the files that were used to generate the documentation.
-
-SHOW_USED_FILES        = YES
-
-# If the sources in your project are distributed over multiple directories 
-# then setting the SHOW_DIRECTORIES tag to YES will show the directory hierarchy 
-# in the documentation.
-
-SHOW_DIRECTORIES       = YES
-
-# The FILE_VERSION_FILTER tag can be used to specify a program or script that 
-# doxygen should invoke to get the current version for each file (typically from the 
-# version control system). Doxygen will invoke the program by executing (via 
-# popen()) the command <command> <input-file>, where <command> is the value of 
-# the FILE_VERSION_FILTER tag, and <input-file> is the name of an input file 
-# provided by doxygen. Whatever the progam writes to standard output 
-# is used as the file version. See the manual for examples.
-
-FILE_VERSION_FILTER    = 
-
-#---------------------------------------------------------------------------
-# configuration options related to warning and progress messages
-#---------------------------------------------------------------------------
-
-# The QUIET tag can be used to turn on/off the messages that are generated 
-# by doxygen. Possible values are YES and NO. If left blank NO is used.
-
-QUIET                  = NO
-
-# The WARNINGS tag can be used to turn on/off the warning messages that are 
-# generated by doxygen. Possible values are YES and NO. If left blank 
-# NO is used.
-
-WARNINGS               = YES
-
-# If WARN_IF_UNDOCUMENTED is set to YES, then doxygen will generate warnings 
-# for undocumented members. If EXTRACT_ALL is set to YES then this flag will 
-# automatically be disabled.
-
-WARN_IF_UNDOCUMENTED   = YES
-
-# If WARN_IF_DOC_ERROR is set to YES, doxygen will generate warnings for 
-# potential errors in the documentation, such as not documenting some 
-# parameters in a documented function, or documenting parameters that 
-# don't exist or using markup commands wrongly.
-
-WARN_IF_DOC_ERROR      = YES
-
-# This WARN_NO_PARAMDOC option can be abled to get warnings for 
-# functions that are documented, but have no documentation for their parameters 
-# or return value. If set to NO (the default) doxygen will only warn about 
-# wrong or incomplete parameter documentation, but not about the absence of 
-# documentation.
-
-WARN_NO_PARAMDOC       = NO
-
-# The WARN_FORMAT tag determines the format of the warning messages that 
-# doxygen can produce. The string should contain the $file, $line, and $text 
-# tags, which will be replaced by the file and line number from which the 
-# warning originated and the warning text. Optionally the format may contain 
-# $version, which will be replaced by the version of the file (if it could 
-# be obtained via FILE_VERSION_FILTER)
-
-WARN_FORMAT            = "$file:$line: $text"
-
-# The WARN_LOGFILE tag can be used to specify a file to which warning 
-# and error messages should be written. If left blank the output is written 
-# to stderr.
-
-WARN_LOGFILE           = 
-
-#---------------------------------------------------------------------------
-# configuration options related to the input files
-#---------------------------------------------------------------------------
-
-# The INPUT tag can be used to specify the files and/or directories that contain 
-# documented source files. You may enter file names like "myfile.cpp" or 
-# directories like "/usr/src/myproject". Separate the files or directories 
-# with spaces.
-
-INPUT                  = yake/base yake/base/templates yake/base/native
-INPUT += yake/plugins/graphicsOgre
-INPUT += yake/plugins/physicsNx
-INPUT += yake/plugins/physicsOde
-INPUT += yake/plugins/inputOgre
-INPUT += yake/plugins/audioOpenAL
-INPUT += yake/plugins/baseLuaBindings
-INPUT += yake/plugins/graphicsLuaBindings
-INPUT += yake/plugins/scriptingLua
-INPUT += yake/plugins/scriptingLuaBindings
-INPUT += yapp/plugins/entLua
-INPUT += yapp/plugins/modelLua
-INPUT += yapp/plugins/ceguiOgreRendererAdapter
-INPUT += yake/graphics
-INPUT += yake/audio
-INPUT += yake/input
-INPUT += yake/physics
-INPUT += yake/file
-INPUT += yake/data
-INPUT += yake/scripting
-INPUT += yake/audio
-INPUT += yake/common
-INPUT += yake/object
-#INPUT += yake/net
-#INPUT += yake/reflection
-INPUT += documentation/api
-INPUT += yapp/base
-INPUT += yapp/model
-INPUT += yapp/loader
-INPUT += yapp/ent
-INPUT += yapp/statemachine
-INPUT += yapp/base
-INPUT += yapp/msg
-INPUT += yapp/vehicle
-INPUT += yapp/raf
-INPUT += yapp/common
-INPUT += yapp/gui_adapter
-INPUT += yapp/gui_addons
-
-# If the value of the INPUT tag contains directories, you can use the 
-# FILE_PATTERNS tag to specify one or more wildcard pattern (like *.cpp 
-# and *.h) to filter out the source-files in the directories. If left 
-# blank the following patterns are tested: 
-# *.c *.cc *.cxx *.cpp *.c++ *.java *.ii *.ixx *.ipp *.i++ *.inl *.h *.hh *.hxx 
-# *.hpp *.h++ *.idl *.odl *.cs *.php *.php3 *.inc *.m *.mm
-
-FILE_PATTERNS          = 
-
-# The RECURSIVE tag can be used to turn specify whether or not subdirectories 
-# should be searched for input files as well. Possible values are YES and NO. 
-# If left blank NO is used.
-
-RECURSIVE              = NO
-
-# The EXCLUDE tag can be used to specify files and/or directories that should 
-# excluded from the INPUT source files. This way you can easily exclude a 
-# subdirectory from a directory tree whose root is specified with the INPUT tag.
-
-EXCLUDE                = 
-
-# The EXCLUDE_SYMLINKS tag can be used select whether or not files or 
-# directories that are symbolic links (a Unix filesystem feature) are excluded 
-# from the input.
-
-EXCLUDE_SYMLINKS       = NO
-
-# If the value of the INPUT tag contains directories, you can use the 
-# EXCLUDE_PATTERNS tag to specify one or more wildcard patterns to exclude 
-# certain files from those directories.
-
-EXCLUDE_PATTERNS       = 
-
-# The EXAMPLE_PATH tag can be used to specify one or more files or 
-# directories that contain example code fragments that are included (see 
-# the \include command).
-
-EXAMPLE_PATH           = 
-
-# If the value of the EXAMPLE_PATH tag contains directories, you can use the 
-# EXAMPLE_PATTERNS tag to specify one or more wildcard pattern (like *.cpp 
-# and *.h) to filter out the source-files in the directories. If left 
-# blank all files are included.
-
-EXAMPLE_PATTERNS       = 
-
-# If the EXAMPLE_RECURSIVE tag is set to YES then subdirectories will be 
-# searched for input files to be used with the \include or \dontinclude 
-# commands irrespective of the value of the RECURSIVE tag. 
-# Possible values are YES and NO. If left blank NO is used.
-
-EXAMPLE_RECURSIVE      = NO
-
-# The IMAGE_PATH tag can be used to specify one or more files or 
-# directories that contain image that are included in the documentation (see 
-# the \image command).
-
-IMAGE_PATH             = 
-
-# The INPUT_FILTER tag can be used to specify a program that doxygen should 
-# invoke to filter for each input file. Doxygen will invoke the filter program 
-# by executing (via popen()) the command <filter> <input-file>, where <filter> 
-# is the value of the INPUT_FILTER tag, and <input-file> is the name of an 
-# input file. Doxygen will then use the output that the filter program writes 
-# to standard output.  If FILTER_PATTERNS is specified, this tag will be 
-# ignored.
-
-INPUT_FILTER           = 
-
-# The FILTER_PATTERNS tag can be used to specify filters on a per file pattern 
-# basis.  Doxygen will compare the file name with each pattern and apply the 
-# filter if there is a match.  The filters are a list of the form: 
-# pattern=filter (like *.cpp=my_cpp_filter). See INPUT_FILTER for further 
-# info on how filters are used. If FILTER_PATTERNS is empty, INPUT_FILTER 
-# is applied to all files.
-
-FILTER_PATTERNS        = 
-
-# If the FILTER_SOURCE_FILES tag is set to YES, the input filter (if set using 
-# INPUT_FILTER) will be used to filter the input files when producing source 
-# files to browse (i.e. when SOURCE_BROWSER is set to YES).
-
-FILTER_SOURCE_FILES    = NO
-
-#---------------------------------------------------------------------------
-# configuration options related to source browsing
-#---------------------------------------------------------------------------
-
-# If the SOURCE_BROWSER tag is set to YES then a list of source files will 
-# be generated. Documented entities will be cross-referenced with these sources. 
-# Note: To get rid of all source code in the generated output, make sure also 
-# VERBATIM_HEADERS is set to NO.
-
-SOURCE_BROWSER         = NO
-
-# Setting the INLINE_SOURCES tag to YES will include the body 
-# of functions and classes directly in the documentation.
-
-INLINE_SOURCES         = NO
-
-# Setting the STRIP_CODE_COMMENTS tag to YES (the default) will instruct 
-# doxygen to hide any special comment blocks from generated source code 
-# fragments. Normal C and C++ comments will always remain visible.
-
-STRIP_CODE_COMMENTS    = YES
-
-# If the REFERENCED_BY_RELATION tag is set to YES (the default) 
-# then for each documented function all documented 
-# functions referencing it will be listed.
-
-REFERENCED_BY_RELATION = YES
-
-# If the REFERENCES_RELATION tag is set to YES (the default) 
-# then for each documented function all documented entities 
-# called/used by that function will be listed.
-
-REFERENCES_RELATION    = YES
-
-# If the USE_HTAGS tag is set to YES then the references to source code 
-# will point to the HTML generated by the htags(1) tool instead of doxygen 
-# built-in source browser. The htags tool is part of GNU's global source 
-# tagging system (see http://www.gnu.org/software/global/global.html). You 
-# will need version 4.8.6 or higher.
-
-USE_HTAGS              = NO
-
-# If the VERBATIM_HEADERS tag is set to YES (the default) then Doxygen 
-# will generate a verbatim copy of the header file for each class for 
-# which an include is specified. Set to NO to disable this.
-
-VERBATIM_HEADERS       = YES
-
-#---------------------------------------------------------------------------
-# configuration options related to the alphabetical class index
-#---------------------------------------------------------------------------
-
-# If the ALPHABETICAL_INDEX tag is set to YES, an alphabetical index 
-# of all compounds will be generated. Enable this if the project 
-# contains a lot of classes, structs, unions or interfaces.
-
-ALPHABETICAL_INDEX     = YES
-
-# If the alphabetical index is enabled (see ALPHABETICAL_INDEX) then 
-# the COLS_IN_ALPHA_INDEX tag can be used to specify the number of columns 
-# in which this list will be split (can be a number in the range [1..20])
-
-COLS_IN_ALPHA_INDEX    = 5
-
-# In case all classes in a project start with a common prefix, all 
-# classes will be put under the same header in the alphabetical index. 
-# The IGNORE_PREFIX tag can be used to specify one or more prefixes that 
-# should be ignored while generating the index headers.
-
-IGNORE_PREFIX          = 
-
-#---------------------------------------------------------------------------
-# configuration options related to the HTML output
-#---------------------------------------------------------------------------
-
-# If the GENERATE_HTML tag is set to YES (the default) Doxygen will 
-# generate HTML output.
-
-GENERATE_HTML          = YES
-
-# The HTML_OUTPUT tag is used to specify where the HTML docs will be put. 
-# If a relative path is entered the value of OUTPUT_DIRECTORY will be 
-# put in front of it. If left blank `html' will be used as the default path.
-
-HTML_OUTPUT            = html
-
-# The HTML_FILE_EXTENSION tag can be used to specify the file extension for 
-# each generated HTML page (for example: .htm,.php,.asp). If it is left blank 
-# doxygen will generate files with .html extension.
-
-HTML_FILE_EXTENSION    = .html
-
-# The HTML_HEADER tag can be used to specify a personal HTML header for 
-# each generated HTML page. If it is left blank doxygen will generate a 
-# standard header.
-
-HTML_HEADER            = documentation/api/header.html
-
-# The HTML_FOOTER tag can be used to specify a personal HTML footer for 
-# each generated HTML page. If it is left blank doxygen will generate a 
-# standard footer.
-
-HTML_FOOTER            = documentation/api/footer.html
-
-# The HTML_STYLESHEET tag can be used to specify a user-defined cascading 
-# style sheet that is used by each HTML page. It can be used to 
-# fine-tune the look of the HTML output. If the tag is left blank doxygen 
-# will generate a default style sheet. Note that doxygen will try to copy 
-# the style sheet file to the HTML output directory, so don't put your own 
-# stylesheet in the HTML output directory as well, or it will be erased!
-
-HTML_STYLESHEET        = documentation/api/api.css
-
-# If the HTML_ALIGN_MEMBERS tag is set to YES, the members of classes, 
-# files or namespaces will be aligned in HTML using tables. If set to 
-# NO a bullet list will be used.
-
-HTML_ALIGN_MEMBERS     = YES
-
-# If the GENERATE_HTMLHELP tag is set to YES, additional index files 
-# will be generated that can be used as input for tools like the 
-# Microsoft HTML help workshop to generate a compressed HTML help file (.chm) 
-# of the generated HTML documentation.
-
-GENERATE_HTMLHELP      = NO
-
-# If the GENERATE_HTMLHELP tag is set to YES, the CHM_FILE tag can 
-# be used to specify the file name of the resulting .chm file. You 
-# can add a path in front of the file if the result should not be 
-# written to the html output directory.
-
-CHM_FILE               = 
-
-# If the GENERATE_HTMLHELP tag is set to YES, the HHC_LOCATION tag can 
-# be used to specify the location (absolute path including file name) of 
-# the HTML help compiler (hhc.exe). If non-empty doxygen will try to run 
-# the HTML help compiler on the generated index.hhp.
-
-HHC_LOCATION           = 
-
-# If the GENERATE_HTMLHELP tag is set to YES, the GENERATE_CHI flag 
-# controls if a separate .chi index file is generated (YES) or that 
-# it should be included in the master .chm file (NO).
-
-GENERATE_CHI           = NO
-
-# If the GENERATE_HTMLHELP tag is set to YES, the BINARY_TOC flag 
-# controls whether a binary table of contents is generated (YES) or a 
-# normal table of contents (NO) in the .chm file.
-
-BINARY_TOC             = NO
-
-# The TOC_EXPAND flag can be set to YES to add extra items for group members 
-# to the contents of the HTML help documentation and to the tree view.
-
-TOC_EXPAND             = NO
-
-# The DISABLE_INDEX tag can be used to turn on/off the condensed index at 
-# top of each HTML page. The value NO (the default) enables the index and 
-# the value YES disables it.
-
-DISABLE_INDEX          = NO
-
-# This tag can be used to set the number of enum values (range [1..20]) 
-# that doxygen will group on one line in the generated HTML documentation.
-
-ENUM_VALUES_PER_LINE   = 4
-
-# If the GENERATE_TREEVIEW tag is set to YES, a side panel will be
-# generated containing a tree-like index structure (just like the one that 
-# is generated for HTML Help). For this to work a browser that supports 
-# JavaScript, DHTML, CSS and frames is required (for instance Mozilla 1.0+, 
-# Netscape 6.0+, Internet explorer 5.0+, or Konqueror). Windows users are 
-# probably better off using the HTML help feature.
-
-GENERATE_TREEVIEW      = YES
-
-# If the treeview is enabled (see GENERATE_TREEVIEW) then this tag can be 
-# used to set the initial width (in pixels) of the frame in which the tree 
-# is shown.
-
-TREEVIEW_WIDTH         = 250
-
-#---------------------------------------------------------------------------
-# configuration options related to the LaTeX output
-#---------------------------------------------------------------------------
-
-# If the GENERATE_LATEX tag is set to YES (the default) Doxygen will 
-# generate Latex output.
-
-GENERATE_LATEX         = NO
-
-# The LATEX_OUTPUT tag is used to specify where the LaTeX docs will be put. 
-# If a relative path is entered the value of OUTPUT_DIRECTORY will be 
-# put in front of it. If left blank `latex' will be used as the default path.
-
-LATEX_OUTPUT           = latex
-
-# The LATEX_CMD_NAME tag can be used to specify the LaTeX command name to be 
-# invoked. If left blank `latex' will be used as the default command name.
-
-LATEX_CMD_NAME         = latex
-
-# The MAKEINDEX_CMD_NAME tag can be used to specify the command name to 
-# generate index for LaTeX. If left blank `makeindex' will be used as the 
-# default command name.
-
-MAKEINDEX_CMD_NAME     = makeindex
-
-# If the COMPACT_LATEX tag is set to YES Doxygen generates more compact 
-# LaTeX documents. This may be useful for small projects and may help to 
-# save some trees in general.
-
-COMPACT_LATEX          = NO
-
-# The PAPER_TYPE tag can be used to set the paper type that is used 
-# by the printer. Possible values are: a4, a4wide, letter, legal and 
-# executive. If left blank a4wide will be used.
-
-PAPER_TYPE             = a4wide
-
-# The EXTRA_PACKAGES tag can be to specify one or more names of LaTeX 
-# packages that should be included in the LaTeX output.
-
-EXTRA_PACKAGES         = 
-
-# The LATEX_HEADER tag can be used to specify a personal LaTeX header for 
-# the generated latex document. The header should contain everything until 
-# the first chapter. If it is left blank doxygen will generate a 
-# standard header. Notice: only use this tag if you know what you are doing!
-
-LATEX_HEADER           = 
-
-# If the PDF_HYPERLINKS tag is set to YES, the LaTeX that is generated 
-# is prepared for conversion to pdf (using ps2pdf). The pdf file will 
-# contain links (just like the HTML output) instead of page references 
-# This makes the output suitable for online browsing using a pdf viewer.
-
-PDF_HYPERLINKS         = NO
-
-# If the USE_PDFLATEX tag is set to YES, pdflatex will be used instead of 
-# plain latex in the generated Makefile. Set this option to YES to get a 
-# higher quality PDF documentation.
-
-USE_PDFLATEX           = NO
-
-# If the LATEX_BATCHMODE tag is set to YES, doxygen will add the \\batchmode. 
-# command to the generated LaTeX files. This will instruct LaTeX to keep 
-# running if errors occur, instead of asking the user for help. 
-# This option is also used when generating formulas in HTML.
-
-LATEX_BATCHMODE        = NO
-
-# If LATEX_HIDE_INDICES is set to YES then doxygen will not 
-# include the index chapters (such as File Index, Compound Index, etc.) 
-# in the output.
-
-LATEX_HIDE_INDICES     = NO
-
-#---------------------------------------------------------------------------
-# configuration options related to the RTF output
-#---------------------------------------------------------------------------
-
-# If the GENERATE_RTF tag is set to YES Doxygen will generate RTF output 
-# The RTF output is optimized for Word 97 and may not look very pretty with 
-# other RTF readers or editors.
-
-GENERATE_RTF           = NO
-
-# The RTF_OUTPUT tag is used to specify where the RTF docs will be put. 
-# If a relative path is entered the value of OUTPUT_DIRECTORY will be 
-# put in front of it. If left blank `rtf' will be used as the default path.
-
-RTF_OUTPUT             = rtf
-
-# If the COMPACT_RTF tag is set to YES Doxygen generates more compact 
-# RTF documents. This may be useful for small projects and may help to 
-# save some trees in general.
-
-COMPACT_RTF            = NO
-
-# If the RTF_HYPERLINKS tag is set to YES, the RTF that is generated 
-# will contain hyperlink fields. The RTF file will 
-# contain links (just like the HTML output) instead of page references. 
-# This makes the output suitable for online browsing using WORD or other 
-# programs which support those fields. 
-# Note: wordpad (write) and others do not support links.
-
-RTF_HYPERLINKS         = NO
-
-# Load stylesheet definitions from file. Syntax is similar to doxygen's 
-# config file, i.e. a series of assignments. You only have to provide 
-# replacements, missing definitions are set to their default value.
-
-RTF_STYLESHEET_FILE    = 
-
-# Set optional variables used in the generation of an rtf document. 
-# Syntax is similar to doxygen's config file.
-
-RTF_EXTENSIONS_FILE    = 
-
-#---------------------------------------------------------------------------
-# configuration options related to the man page output
-#---------------------------------------------------------------------------
-
-# If the GENERATE_MAN tag is set to YES (the default) Doxygen will 
-# generate man pages
-
-GENERATE_MAN           = NO
-
-# The MAN_OUTPUT tag is used to specify where the man pages will be put. 
-# If a relative path is entered the value of OUTPUT_DIRECTORY will be 
-# put in front of it. If left blank `man' will be used as the default path.
-
-MAN_OUTPUT             = man
-
-# The MAN_EXTENSION tag determines the extension that is added to 
-# the generated man pages (default is the subroutine's section .3)
-
-MAN_EXTENSION          = .3
-
-# If the MAN_LINKS tag is set to YES and Doxygen generates man output, 
-# then it will generate one additional man file for each entity 
-# documented in the real man page(s). These additional files 
-# only source the real man page, but without them the man command 
-# would be unable to find the correct page. The default is NO.
-
-MAN_LINKS              = NO
-
-#---------------------------------------------------------------------------
-# configuration options related to the XML output
-#---------------------------------------------------------------------------
-
-# If the GENERATE_XML tag is set to YES Doxygen will 
-# generate an XML file that captures the structure of 
-# the code including all documentation.
-
-GENERATE_XML           = NO
-
-# The XML_OUTPUT tag is used to specify where the XML pages will be put. 
-# If a relative path is entered the value of OUTPUT_DIRECTORY will be 
-# put in front of it. If left blank `xml' will be used as the default path.
-
-XML_OUTPUT             = xml
-
-# The XML_SCHEMA tag can be used to specify an XML schema, 
-# which can be used by a validating XML parser to check the 
-# syntax of the XML files.
-
-XML_SCHEMA             = 
-
-# The XML_DTD tag can be used to specify an XML DTD, 
-# which can be used by a validating XML parser to check the 
-# syntax of the XML files.
-
-XML_DTD                = 
-
-# If the XML_PROGRAMLISTING tag is set to YES Doxygen will 
-# dump the program listings (including syntax highlighting 
-# and cross-referencing information) to the XML output. Note that 
-# enabling this will significantly increase the size of the XML output.
-
-XML_PROGRAMLISTING     = YES
-
-#---------------------------------------------------------------------------
-# configuration options for the AutoGen Definitions output
-#---------------------------------------------------------------------------
-
-# If the GENERATE_AUTOGEN_DEF tag is set to YES Doxygen will 
-# generate an AutoGen Definitions (see autogen.sf.net) file 
-# that captures the structure of the code including all 
-# documentation. Note that this feature is still experimental 
-# and incomplete at the moment.
-
-GENERATE_AUTOGEN_DEF   = NO
-
-#---------------------------------------------------------------------------
-# configuration options related to the Perl module output
-#---------------------------------------------------------------------------
-
-# If the GENERATE_PERLMOD tag is set to YES Doxygen will 
-# generate a Perl module file that captures the structure of 
-# the code including all documentation. Note that this 
-# feature is still experimental and incomplete at the 
-# moment.
-
-GENERATE_PERLMOD       = NO
-
-# If the PERLMOD_LATEX tag is set to YES Doxygen will generate 
-# the necessary Makefile rules, Perl scripts and LaTeX code to be able 
-# to generate PDF and DVI output from the Perl module output.
-
-PERLMOD_LATEX          = NO
-
-# If the PERLMOD_PRETTY tag is set to YES the Perl module output will be 
-# nicely formatted so it can be parsed by a human reader.  This is useful 
-# if you want to understand what is going on.  On the other hand, if this 
-# tag is set to NO the size of the Perl module output will be much smaller 
-# and Perl will parse it just the same.
-
-PERLMOD_PRETTY         = YES
-
-# The names of the make variables in the generated doxyrules.make file 
-# are prefixed with the string contained in PERLMOD_MAKEVAR_PREFIX. 
-# This is useful so different doxyrules.make files included by the same 
-# Makefile don't overwrite each other's variables.
-
-PERLMOD_MAKEVAR_PREFIX = 
-
-#---------------------------------------------------------------------------
-# Configuration options related to the preprocessor   
-#---------------------------------------------------------------------------
-
-# If the ENABLE_PREPROCESSING tag is set to YES (the default) Doxygen will 
-# evaluate all C-preprocessor directives found in the sources and include 
-# files.
-
-ENABLE_PREPROCESSING   = YES
-
-# If the MACRO_EXPANSION tag is set to YES Doxygen will expand all macro 
-# names in the source code. If set to NO (the default) only conditional 
-# compilation will be performed. Macro expansion can be done in a controlled 
-# way by setting EXPAND_ONLY_PREDEF to YES.
-
-MACRO_EXPANSION        = NO
-
-# If the EXPAND_ONLY_PREDEF and MACRO_EXPANSION tags are both set to YES 
-# then the macro expansion is limited to the macros specified with the 
-# PREDEFINED and EXPAND_AS_PREDEFINED tags.
-
-EXPAND_ONLY_PREDEF     = NO
-
-# If the SEARCH_INCLUDES tag is set to YES (the default) the includes files 
-# in the INCLUDE_PATH (see below) will be search if a #include is found.
-
-SEARCH_INCLUDES        = YES
-
-# The INCLUDE_PATH tag can be used to specify one or more directories that 
-# contain include files that are not input files but should be processed by 
-# the preprocessor.
-
-INCLUDE_PATH           = 
-
-# You can use the INCLUDE_FILE_PATTERNS tag to specify one or more wildcard 
-# patterns (like *.h and *.hpp) to filter out the header-files in the 
-# directories. If left blank, the patterns specified with FILE_PATTERNS will 
-# be used.
-
-INCLUDE_FILE_PATTERNS  = 
-
-# The PREDEFINED tag can be used to specify one or more macro names that 
-# are defined before the preprocessor is started (similar to the -D option of 
-# gcc). The argument of the tag is a list of macros of the form: name 
-# or name=definition (no spaces). If the definition and the = are 
-# omitted =1 is assumed. To prevent a macro definition from being 
-# undefined via #undef or recursively expanded use the := operator 
-# instead of the = operator.
-
-PREDEFINED             = 
-
-# If the MACRO_EXPANSION and EXPAND_ONLY_PREDEF tags are set to YES then 
-# this tag can be used to specify a list of macro names that should be expanded. 
-# The macro definition that is found in the sources will be used. 
-# Use the PREDEFINED tag if you want to use a different macro definition.
-
-EXPAND_AS_DEFINED      = 
-
-# If the SKIP_FUNCTION_MACROS tag is set to YES (the default) then 
-# doxygen's preprocessor will remove all function-like macros that are alone 
-# on a line, have an all uppercase name, and do not end with a semicolon. Such 
-# function macros are typically used for boiler-plate code, and will confuse 
-# the parser if not removed.
-
-SKIP_FUNCTION_MACROS   = YES
-
-#---------------------------------------------------------------------------
-# Configuration::additions related to external references   
-#---------------------------------------------------------------------------
-
-# The TAGFILES option can be used to specify one or more tagfiles. 
-# Optionally an initial location of the external documentation 
-# can be added for each tagfile. The format of a tag file without 
-# this location is as follows: 
-#   TAGFILES = file1 file2 ... 
-# Adding location for the tag files is done as follows: 
-#   TAGFILES = file1=loc1 "file2 = loc2" ... 
-# where "loc1" and "loc2" can be relative or absolute paths or 
-# URLs. If a location is present for each tag, the installdox tool 
-# does not have to be run to correct the links.
-# Note that each tag file must have a unique name
-# (where the name does NOT include the path)
-# If a tag file is not located in the directory in which doxygen 
-# is run, you must also specify the path to the tagfile here.
-
-TAGFILES               = 
-
-# When a file name is specified after GENERATE_TAGFILE, doxygen will create 
-# a tag file that is based on the input files it reads.
-
-GENERATE_TAGFILE       = 
-
-# If the ALLEXTERNALS tag is set to YES all external classes will be listed 
-# in the class index. If set to NO only the inherited external classes 
-# will be listed.
-
-ALLEXTERNALS           = NO
-
-# If the EXTERNAL_GROUPS tag is set to YES all external groups will be listed 
-# in the modules index. If set to NO, only the current project's groups will 
-# be listed.
-
-EXTERNAL_GROUPS        = YES
-
-# The PERL_PATH should be the absolute path and name of the perl script 
-# interpreter (i.e. the result of `which perl').
-
-PERL_PATH              = /usr/bin/perl
-
-#---------------------------------------------------------------------------
-# Configuration options related to the dot tool   
-#---------------------------------------------------------------------------
-
-# If the CLASS_DIAGRAMS tag is set to YES (the default) Doxygen will 
-# generate a inheritance diagram (in HTML, RTF and LaTeX) for classes with base 
-# or super classes. Setting the tag to NO turns the diagrams off. Note that 
-# this option is superseded by the HAVE_DOT option below. This is only a 
-# fallback. It is recommended to install and use dot, since it yields more 
-# powerful graphs.
-
-CLASS_DIAGRAMS         = YES
-
-# If set to YES, the inheritance and collaboration graphs will hide 
-# inheritance and usage relations if the target is undocumented 
-# or is not a class.
-
-HIDE_UNDOC_RELATIONS   = YES
-
-# If you set the HAVE_DOT tag to YES then doxygen will assume the dot tool is 
-# available from the path. This tool is part of Graphviz, a graph visualization 
-# toolkit from AT&T and Lucent Bell Labs. The other options in this section 
-# have no effect if this option is set to NO (the default)
-
-HAVE_DOT               = NO
-
-# If the CLASS_GRAPH and HAVE_DOT tags are set to YES then doxygen 
-# will generate a graph for each documented class showing the direct and 
-# indirect inheritance relations. Setting this tag to YES will force the 
-# the CLASS_DIAGRAMS tag to NO.
-
-CLASS_GRAPH            = YES
-
-# If the COLLABORATION_GRAPH and HAVE_DOT tags are set to YES then doxygen 
-# will generate a graph for each documented class showing the direct and 
-# indirect implementation dependencies (inheritance, containment, and 
-# class references variables) of the class with other documented classes.
-
-COLLABORATION_GRAPH    = YES
-
-# If the GROUP_GRAPHS and HAVE_DOT tags are set to YES then doxygen 
-# will generate a graph for groups, showing the direct groups dependencies
-
-GROUP_GRAPHS           = YES
-
-# If the UML_LOOK tag is set to YES doxygen will generate inheritance and 
-# collaboration diagrams in a style similar to the OMG's Unified Modeling 
-# Language.
-
-UML_LOOK               = NO
-
-# If set to YES, the inheritance and collaboration graphs will show the 
-# relations between templates and their instances.
-
-TEMPLATE_RELATIONS     = NO
-
-# If the ENABLE_PREPROCESSING, SEARCH_INCLUDES, INCLUDE_GRAPH, and HAVE_DOT 
-# tags are set to YES then doxygen will generate a graph for each documented 
-# file showing the direct and indirect include dependencies of the file with 
-# other documented files.
-
-INCLUDE_GRAPH          = YES
-
-# If the ENABLE_PREPROCESSING, SEARCH_INCLUDES, INCLUDED_BY_GRAPH, and 
-# HAVE_DOT tags are set to YES then doxygen will generate a graph for each 
-# documented header file showing the documented files that directly or 
-# indirectly include this file.
-
-INCLUDED_BY_GRAPH      = YES
-
-# If the CALL_GRAPH and HAVE_DOT tags are set to YES then doxygen will 
-# generate a call dependency graph for every global function or class method. 
-# Note that enabling this option will significantly increase the time of a run. 
-# So in most cases it will be better to enable call graphs for selected 
-# functions only using the \callgraph command.
-
-CALL_GRAPH             = NO
-
-# If the GRAPHICAL_HIERARCHY and HAVE_DOT tags are set to YES then doxygen 
-# will graphical hierarchy of all classes instead of a textual one.
-
-GRAPHICAL_HIERARCHY    = YES
-
-# If the DIRECTORY_GRAPH, SHOW_DIRECTORIES and HAVE_DOT tags are set to YES 
-# then doxygen will show the dependencies a directory has on other directories 
-# in a graphical way. The dependency relations are determined by the #include
-# relations between the files in the directories.
-
-DIRECTORY_GRAPH        = YES
-
-# The DOT_IMAGE_FORMAT tag can be used to set the image format of the images 
-# generated by dot. Possible values are png, jpg, or gif
-# If left blank png will be used.
-
-DOT_IMAGE_FORMAT       = png
-
-# The tag DOT_PATH can be used to specify the path where the dot tool can be 
-# found. If left blank, it is assumed the dot tool can be found in the path.
-
-DOT_PATH               = 
-
-# The DOTFILE_DIRS tag can be used to specify one or more directories that 
-# contain dot files that are included in the documentation (see the 
-# \dotfile command).
-
-DOTFILE_DIRS           = 
-
-# The MAX_DOT_GRAPH_WIDTH tag can be used to set the maximum allowed width 
-# (in pixels) of the graphs generated by dot. If a graph becomes larger than 
-# this value, doxygen will try to truncate the graph, so that it fits within 
-# the specified constraint. Beware that most browsers cannot cope with very 
-# large images.
-
-MAX_DOT_GRAPH_WIDTH    = 1024
-
-# The MAX_DOT_GRAPH_HEIGHT tag can be used to set the maximum allows height 
-# (in pixels) of the graphs generated by dot. If a graph becomes larger than 
-# this value, doxygen will try to truncate the graph, so that it fits within 
-# the specified constraint. Beware that most browsers cannot cope with very 
-# large images.
-
-MAX_DOT_GRAPH_HEIGHT   = 1024
-
-# The MAX_DOT_GRAPH_DEPTH tag can be used to set the maximum depth of the 
-# graphs generated by dot. A depth value of 3 means that only nodes reachable 
-# from the root by following a path via at most 3 edges will be shown. Nodes 
-# that lay further from the root node will be omitted. Note that setting this 
-# option to 1 or 2 may greatly reduce the computation time needed for large 
-# code bases. Also note that a graph may be further truncated if the graph's 
-# image dimensions are not sufficient to fit the graph (see MAX_DOT_GRAPH_WIDTH 
-# and MAX_DOT_GRAPH_HEIGHT). If 0 is used for the depth value (the default), 
-# the graph is not depth-constrained.
-
-MAX_DOT_GRAPH_DEPTH    = 0
-
-# Set the DOT_TRANSPARENT tag to YES to generate images with a transparent 
-# background. This is disabled by default, which results in a white background. 
-# Warning: Depending on the platform used, enabling this option may lead to 
-# badly anti-aliased labels on the edges of a graph (i.e. they become hard to 
-# read).
-
-DOT_TRANSPARENT        = NO
-
-# Set the DOT_MULTI_TARGETS tag to YES allow dot to generate multiple output 
-# files in one run (i.e. multiple -o and -T options on the command line). This 
-# makes dot run faster, but since only newer versions of dot (>1.8.10) 
-# support this, this feature is disabled by default.
-
-DOT_MULTI_TARGETS      = NO
-
-# If the GENERATE_LEGEND tag is set to YES (the default) Doxygen will 
-# generate a legend page explaining the meaning of the various boxes and 
-# arrows in the dot generated graphs.
-
-GENERATE_LEGEND        = YES
-
-# If the DOT_CLEANUP tag is set to YES (the default) Doxygen will 
-# remove the intermediate dot files that are used to generate 
-# the various graphs.
-
-DOT_CLEANUP            = YES
-
-#---------------------------------------------------------------------------
-# Configuration::additions related to the search engine   
-#---------------------------------------------------------------------------
-
-# The SEARCHENGINE tag specifies whether or not a search engine should be 
-# used. If set to NO the values of all tags below this one will be ignored.
-
-SEARCHENGINE           = NO

Deleted: trunk/yake/documentation/api/api.css
===================================================================
--- trunk/yake/documentation/api/api.css	2006-03-12 21:47:38 UTC (rev 1246)
+++ trunk/yake/documentation/api/api.css	2006-03-12 21:48:22 UTC (rev 1247)
@@ -1,309 +0,0 @@
-BODY,H1,H2,H3,H4,H5,H6,P,CENTER,TD,TH,UL,DL,DIV {
-	font-family: Geneva, Arial, Helvetica, sans-serif;
-}
-BODY,TD {
-       font-size: 90%;
-}
-H1 {
-	text-align: center;
-       font-size: 160%;
-}
-H2 {
-       font-size: 120%;
-}
-H3 {
-       font-size: 100%;
-}
-CAPTION { font-weight: bold }
-DIV.qindex {
-	width: 100%;
-	background-color: #eeeeff;
-	border: 1px solid #b0b0b0;
-	text-align: center;
-	margin: 2px;
-	padding: 2px;
-	line-height: 140%;
-}
-DIV.nav {
-	width: 100%;
-	background-color: #eeeeff;
-	border: 1px solid #b0b0b0;
-	text-align: center;
-	margin: 2px;
-	padding: 2px;
-	line-height: 140%;
-}
-DIV.navtab {
-       background-color: #eeeeff;
-       border: 1px solid #b0b0b0;
-       text-align: center;
-       margin: 2px;
-       margin-right: 15px;
-       padding: 2px;
-}
-TD.navtab {
-       font-size: 70%;
-}
-A.qindex {
-       text-decoration: none;
-       font-weight: bold;
-       color: #1A419D;
-}
-A.qindex:visited {
-       text-decoration: none;
-       font-weight: bold;
-       color: #1A419D
-}
-A.qindex:hover {
-	text-decoration: none;
-	background-color: #ddddff;
-}
-A.qindexHL {
-	text-decoration: none;
-	font-weight: bold;
-	background-color: #6666cc;
-	color: #ffffff;
-	border: 1px double #9295C2;
-}
-A.qindexHL:hover {
-	text-decoration: none;
-	background-color: #6666cc;
-	color: #ffffff;
-}
-A.qindexHL:visited { text-decoration: none; background-color: #6666cc; color: #ffffff }
-A.el { text-decoration: none; font-weight: bold }
-A.elRef { font-weight: bold }
-A.code:link { text-decoration: none; font-weight: normal; color: #0000FF}
-A.code:visited { text-decoration: none; font-weight: normal; color: #0000FF}
-A.codeRef:link { font-weight: normal; color: #0000FF}
-A.codeRef:visited { font-weight: normal; color: #0000FF}
-A:hover { text-decoration: none; background-color: #f2f2ff }
-DL.el { margin-left: -1cm }
-.fragment {
-       font-family: Fixed, monospace;
-       font-size: 95%;
-}
-PRE.fragment {
-	border: 1px solid #CCCCCC;
-	background-color: #f5f5f5;
-	margin-top: 4px;
-	margin-bottom: 4px;
-	margin-left: 2px;
-	margin-right: 8px;
-	padding-left: 6px;
-	padding-right: 6px;
-	padding-top: 4px;
-	padding-bottom: 4px;
-}
-DIV.ah { background-color: black; font-weight: bold; color: #ffffff; margin-bottom: 3px; margin-top: 3px }
-TD.md { background-color: #F4F4FB; font-weight: bold; }
-TD.mdPrefix {
-       background-color: #F4F4FB;
-       color: #606060;
-	font-size: 80%;
-}
-TD.mdname1 { background-color: #F4F4FB; font-weight: bold; color: #602020; }
-TD.mdname { background-color: #F4F4FB; font-weight: bold; color: #602020; width: 600px; }
-DIV.groupHeader {
-       margin-left: 16px;
-       margin-top: 12px;
-       margin-bottom: 6px;
-       font-weight: bold;
-}
-DIV.groupText { margin-left: 16px; font-style: italic; font-size: 90% }
-BODY {
-	background: white;
-	color: black;
-	margin-right: 20px;
-	margin-left: 20px;
-}
-TD.indexkey {
-	background-color: #eeeeff;
-	font-weight: bold;
-	padding-right  : 10px;
-	padding-top    : 2px;
-	padding-left   : 10px;
-	padding-bottom : 2px;
-	margin-left    : 0px;
-	margin-right   : 0px;
-	margin-top     : 2px;
-	margin-bottom  : 2px;
-	border: 1px solid #CCCCCC;
-}
-TD.indexvalue {
-	background-color: #eeeeff;
-	font-style: italic;
-	padding-right  : 10px;
-	padding-top    : 2px;
-	padding-left   : 10px;
-	padding-bottom : 2px;
-	margin-left    : 0px;
-	margin-right   : 0px;
-	margin-top     : 2px;
-	margin-bottom  : 2px;
-	border: 1px solid #CCCCCC;
-}
-TR.memlist {
-   background-color: #f0f0f0; 
-}
-P.formulaDsp { text-align: center; }
-IMG.formulaDsp { }
-IMG.formulaInl { vertical-align: middle; }
-SPAN.keyword       { color: #008000 }
-SPAN.keywordtype   { color: #604020 }
-SPAN.keywordflow   { color: #e08000 }
-SPAN.comment       { color: #800000 }
-SPAN.preprocessor  { color: #806020 }
-SPAN.stringliteral { color: #002080 }
-SPAN.charliteral   { color: #008080 }
-.mdTable {
-	border: 1px solid #868686;
-	background-color: #F4F4FB;
-}
-.mdRow {
-	padding: 8px 10px;
-}
-.mdescLeft {
-       padding: 0px 8px 4px 8px;
-	font-size: 80%;
-	font-style: italic;
-	background-color: #FAFAFA;
-	border-top: 1px none #E0E0E0;
-	border-right: 1px none #E0E0E0;
-	border-bottom: 1px none #E0E0E0;
-	border-left: 1px none #E0E0E0;
-	margin: 0px;
-}
-.mdescRight {
-       padding: 0px 8px 4px 8px;
-	font-size: 80%;
-	font-style: italic;
-	background-color: #FAFAFA;
-	border-top: 1px none #E0E0E0;
-	border-right: 1px none #E0E0E0;
-	border-bottom: 1px none #E0E0E0;
-	border-left: 1px none #E0E0E0;
-	margin: 0px;
-}
-.memItemLeft {
-	padding: 1px 0px 0px 8px;
-	margin: 4px;
-	border-top-width: 1px;
-	border-right-width: 1px;
-	border-bottom-width: 1px;
-	border-left-width: 1px;
-	border-top-color: #E0E0E0;
-	border-right-color: #E0E0E0;
-	border-bottom-color: #E0E0E0;
-	border-left-color: #E0E0E0;
-	border-top-style: solid;
-	border-right-style: none;
-	border-bottom-style: none;
-	border-left-style: none;
-	background-color: #FAFAFA;
-	font-size: 80%;
-}
-.memItemRight {
-	padding: 1px 8px 0px 8px;
-	margin: 4px;
-	border-top-width: 1px;
-	border-right-width: 1px;
-	border-bottom-width: 1px;
-	border-left-width: 1px;
-	border-top-color: #E0E0E0;
-	border-right-color: #E0E0E0;
-	border-bottom-color: #E0E0E0;
-	border-left-color: #E0E0E0;
-	border-top-style: solid;
-	border-right-style: none;
-	border-bottom-style: none;
-	border-left-style: none;
-	background-color: #FAFAFA;
-	font-size: 80%;
-}
-.memTemplItemLeft {
-	padding: 1px 0px 0px 8px;
-	margin: 4px;
-	border-top-width: 1px;
-	border-right-width: 1px;
-	border-bottom-width: 1px;
-	border-left-width: 1px;
-	border-top-color: #E0E0E0;
-	border-right-color: #E0E0E0;
-	border-bottom-color: #E0E0E0;
-	border-left-color: #E0E0E0;
-	border-top-style: none;
-	border-right-style: none;
-	border-bottom-style: none;
-	border-left-style: none;
-	background-color: #FAFAFA;
-	font-size: 80%;
-}
-.memTemplItemRight {
-	padding: 1px 8px 0px 8px;
-	margin: 4px;
-	border-top-width: 1px;
-	border-right-width: 1px;
-	border-bottom-width: 1px;
-	border-left-width: 1px;
-	border-top-color: #E0E0E0;
-	border-right-color: #E0E0E0;
-	border-bottom-color: #E0E0E0;
-	border-left-color: #E0E0E0;
-	border-top-style: none;
-	border-right-style: none;
-	border-bottom-style: none;
-	border-left-style: none;
-	background-color: #FAFAFA;
-	font-size: 80%;
-}
-.memTemplParams {
-	padding: 1px 0px 0px 8px;
-	margin: 4px;
-	border-top-width: 1px;
-	border-right-width: 1px;
-	border-bottom-width: 1px;
-	border-left-width: 1px;
-	border-top-color: #E0E0E0;
-	border-right-color: #E0E0E0;
-	border-bottom-color: #E0E0E0;
-	border-left-color: #E0E0E0;
-	border-top-style: solid;
-	border-right-style: none;
-	border-bottom-style: none;
-	border-left-style: none;
-       color: #606060;
-	background-color: #FAFAFA;
-	font-size: 80%;
-}
-.search     { color: #003399;
-              font-weight: bold;
-}
-FORM.search {
-              margin-bottom: 0px;
-              margin-top: 0px;
-}
-INPUT.search { font-size: 75%;
-               color: #000080;
-               font-weight: normal;
-               background-color: #eeeeff;
-}
-TD.tiny      { font-size: 75%;
-}
-a {
-	color: #252E78;
-}
-a:visited {
-	color: #3D2185;
-}
-.dirtab { padding: 4px;
-          border-collapse: collapse;
-          border: 1px solid #b0b0b0;
-}
-TH.dirtab { background: #eeeeff;
-            font-weight: bold;
-}
-HR { height: 1px;
-     border: none;
-     border-top: 1px solid black;
-}

Deleted: trunk/yake/documentation/api/doc_main.h
===================================================================
--- trunk/yake/documentation/api/doc_main.h	2006-03-12 21:47:38 UTC (rev 1246)
+++ trunk/yake/documentation/api/doc_main.h	2006-03-12 21:48:22 UTC (rev 1247)
@@ -1,12 +0,0 @@
-/**
-
-	\mainpage YAKE API Reference
-
-	\section Introduction
-
-	The API reference is a useful tool intended to be used in addition to the manual.
-	The manual can be found at http://www.yake.org/wiki.
-
-	The Yake Team
-
-*/
\ No newline at end of file

Deleted: trunk/yake/documentation/api/footer.html
===================================================================
--- trunk/yake/documentation/api/footer.html	2006-03-12 21:47:38 UTC (rev 1246)
+++ trunk/yake/documentation/api/footer.html	2006-03-12 21:48:22 UTC (rev 1247)
@@ -1,4 +0,0 @@
-<hr size="1"><address style="align: right;"><small>
-Copyright by the Yake Team and the Contributors<br>Generated on $datetime for $projectname by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> $doxygenversion</small></address>
-</body>
-</html>

Deleted: trunk/yake/documentation/api/header.html
===================================================================
--- trunk/yake/documentation/api/header.html	2006-03-12 21:47:38 UTC (rev 1246)
+++ trunk/yake/documentation/api/header.html	2006-03-12 21:48:22 UTC (rev 1247)
@@ -1,12 +0,0 @@
-<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
-<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
-<title>$title</title>
-<link href="$relpath$api.css" rel="stylesheet" type="text/css">
-</head><body>
-<table width="99%" margin=0 padding=0>
- <tr style="color: #1A419D; font-weight: bold;">
-  <td align="left">YAKE $projectnumber</td>
-  <td align="right">API Reference</td>
- </tr>
-</table>
-<hr>
\ No newline at end of file



From codeandroid at berlios.de  Sun Mar 12 22:49:04 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 22:49:04 +0100
Subject: [Yake-svn] r1248 - trunk/yake/documentation/api
Message-ID: <200603122149.k2CLn47l010633@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 22:49:03 +0100 (Sun, 12 Mar 2006)
New Revision: 1248

Modified:
   trunk/yake/documentation/api/DoxySfile
Log:
added component 'yake/msg'

Modified: trunk/yake/documentation/api/DoxySfile
===================================================================
--- trunk/yake/documentation/api/DoxySfile	2006-03-12 21:48:22 UTC (rev 1247)
+++ trunk/yake/documentation/api/DoxySfile	2006-03-12 21:49:03 UTC (rev 1248)
@@ -8,7 +8,7 @@
 #INPUT                               = yake/base/math yake/base/mpl yake/base/native yake/base/templates yake/base
 #INPUT                               = yake/audio yake/data yake/ent yake/file yake/graphics yake/input yake/net yake/object yake/physics yake/prop yake/scripting yake/statemachine
 #INPUT                               = yake/base
-INPUT                               = yake/base/math yake/base/mpl yake/base/native yake/base/templates yake/base yake/audio yake/data yake/ent yake/file yake/graphics yake/input yake/net yake/object yake/physics yake/prop yake/scripting yake/statemachine
+INPUT                               = documentation/api yake/base/math yake/base/mpl yake/base/native yake/base/templates yake/base yake/audio yake/data yake/ent yake/file yake/graphics yake/input yake/net yake/object yake/physics yake/prop yake/scripting yake/statemachine yake/msg
 OUTPUT_DIRECTORY                    = documentation/api/html
 GENERATE_DOXYS_HELP                 = YES
 HTML_FILE_EXTENSION                 = .html
@@ -92,7 +92,7 @@
 IGNORE_FILE_NAME                    = DoxyS.ignore
 FILE_PATTERNS                       = *.inl *.h *.hh *.hxx *.hpp *.h++ 
 RECURSIVE                           = NO
-EXCLUDE                             = doxys_docs/ yake/reflection/ yake/samples
+EXCLUDE                             = yake/reflection/ yake/samples
 EXCLUDE_SYMLINKS                    = NO
 EXCLUDE_PATTERNS                    = 
 EXAMPLE_PATH                        = 



From codeandroid at berlios.de  Sun Mar 12 22:49:42 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 22:49:42 +0100
Subject: [Yake-svn] r1249 - trunk/yake/scripts/msvc8
Message-ID: <200603122149.k2CLngEu010741@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 22:49:42 +0100 (Sun, 12 Mar 2006)
New Revision: 1249

Added:
   trunk/yake/scripts/msvc8/ent2.vcproj
Log:
initial revision

Added: trunk/yake/scripts/msvc8/ent2.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/ent2.vcproj	2006-03-12 21:49:03 UTC (rev 1248)
+++ trunk/yake/scripts/msvc8/ent2.vcproj	2006-03-12 21:49:42 UTC (rev 1249)
@@ -0,0 +1,292 @@
+<?xml version="1.0" encoding="Windows-1252"?>
+<VisualStudioProject
+	ProjectType="Visual C++"
+	Version="8,00"
+	Name="ent2"
+	ProjectGUID="{08BC40D8-33D8-4677-993A-32599A93A460}"
+	RootNamespace="yapp"
+	Keyword="Win32Proj"
+	>
+	<Platforms>
+		<Platform
+			Name="Win32"
+		/>
+	</Platforms>
+	<ToolFiles>
+	</ToolFiles>
+	<Configurations>
+		<Configuration
+			Name="Debug|Win32"
+			OutputDirectory="../../common/bin/$(ConfigurationName)"
+			IntermediateDirectory="../../common/obj/$(ConfigurationName)/$(ProjectName)"
+			ConfigurationType="2"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				Optimization="0"
+				AdditionalIncludeDirectories="../../;../../dependencies;../../dependencies/boost;../../dependencies/ttl"
+				PreprocessorDefinitions="_STLP_DEBUG;WIN32;_DEBUG;_CONSOLE;YAKE_ENT_EXPORTS"
+				MinimalRebuild="true"
+				BasicRuntimeChecks="3"
+				RuntimeLibrary="3"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="2"
+				PrecompiledHeaderThrough="yake/ent/pch.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="4"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib physics.lib data.lib"
+				OutputFile="$(OutDir)/$(ProjectName).dll"
+				LinkIncremental="2"
+				AdditionalLibraryDirectories="../../common/lib/$(ConfigurationName);../../dependencies/lib"
+				GenerateDebugInformation="true"
+				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
+				SubSystem="1"
+				ImportLibrary="../../common/lib/$(ConfigurationName)/$(ProjectName).lib"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+		<Configuration
+			Name="Release|Win32"
+			OutputDirectory="../../common/bin/$(ConfigurationName)"
+			IntermediateDirectory="../../common/obj/$(ConfigurationName)/$(ProjectName)"
+			ConfigurationType="2"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				AdditionalIncludeDirectories="../../;../../dependencies;../../dependencies/boost;../../dependencies/ttl"
+				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE;YAKE_ENT_EXPORTS"
+				RuntimeLibrary="2"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="2"
+				PrecompiledHeaderThrough="yake/ent/pch.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="3"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib physics.lib data.lib"
+				OutputFile="$(OutDir)/$(ProjectName).dll"
+				LinkIncremental="1"
+				AdditionalLibraryDirectories="../../common/lib/$(ConfigurationName);../../dependencies/lib"
+				GenerateDebugInformation="true"
+				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
+				SubSystem="1"
+				OptimizeReferences="2"
+				EnableCOMDATFolding="2"
+				ImportLibrary="../../common/lib/$(ConfigurationName)/$(ProjectName).lib"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+	</Configurations>
+	<References>
+	</References>
+	<Files>
+		<Filter
+			Name="src"
+			Filter="cpp;c;cxx;def;odl;idl;hpj;bat;asm;asmx"
+			UniqueIdentifier="{115664F1-EC08-4142-B5D0-91C3C574D1EC}"
+			>
+			<File
+				RelativePath="..\..\src\yake\ent\component.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\component_holder.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\object.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\object_listener.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\object_mgr.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\object_mgr_listener.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\pch.cpp"
+				>
+				<FileConfiguration
+					Name="Debug|Win32"
+					>
+					<Tool
+						Name="VCCLCompilerTool"
+						UsePrecompiledHeader="1"
+					/>
+				</FileConfiguration>
+				<FileConfiguration
+					Name="Release|Win32"
+					>
+					<Tool
+						Name="VCCLCompilerTool"
+						UsePrecompiledHeader="1"
+					/>
+				</FileConfiguration>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\vm_holder.cpp"
+				>
+			</File>
+		</Filter>
+		<Filter
+			Name="inc"
+			Filter="h;hpp;hxx;hm;inl;inc;xsd"
+			UniqueIdentifier="{1D967178-F5B9-46f9-AA8E-78B77BB7A694}"
+			>
+			<File
+				RelativePath="..\..\yake\ent\component.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\component_holder.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\ent.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\object.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\object_listener.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\object_mgr.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\object_mgr_listener.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\pch.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\prerequisites.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\vm_holder.h"
+				>
+			</File>
+		</Filter>
+	</Files>
+	<Globals>
+	</Globals>
+</VisualStudioProject>



From codeandroid at berlios.de  Sun Mar 12 22:58:32 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 22:58:32 +0100
Subject: [Yake-svn] r1250 - trunk/yake/yapp
Message-ID: <200603122158.k2CLwWlr011438@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 22:58:31 +0100 (Sun, 12 Mar 2006)
New Revision: 1250

Removed:
   trunk/yake/yapp/ent/
Log:
replaced by yake/ent



From codeandroid at berlios.de  Sun Mar 12 23:00:44 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:00:44 +0100
Subject: [Yake-svn] r1251 - trunk/yake/src/yapp
Message-ID: <200603122200.k2CM0i8F011706@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:00:44 +0100 (Sun, 12 Mar 2006)
New Revision: 1251

Removed:
   trunk/yake/src/yapp/ent/
Log:
replaced by yake/ent



From codeandroid at berlios.de  Sun Mar 12 23:01:40 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:01:40 +0100
Subject: [Yake-svn] r1252 - trunk/yake/src/yapp/plugins
Message-ID: <200603122201.k2CM1eR5011774@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:01:40 +0100 (Sun, 12 Mar 2006)
New Revision: 1252

Removed:
   trunk/yake/src/yapp/plugins/entLua/
Log:
replaced by yake/ent



From codeandroid at berlios.de  Sun Mar 12 23:02:19 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:02:19 +0100
Subject: [Yake-svn] r1253 - trunk/yake/yapp/plugins
Message-ID: <200603122202.k2CM2JSB011888@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:02:18 +0100 (Sun, 12 Mar 2006)
New Revision: 1253

Removed:
   trunk/yake/yapp/plugins/entLua/
Log:
replaced by yake/ent



From codeandroid at berlios.de  Sun Mar 12 23:03:15 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:03:15 +0100
Subject: [Yake-svn] r1254 - trunk/yake/scripts/msvc8
Message-ID: <200603122203.k2CM3FQR012001@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:03:14 +0100 (Sun, 12 Mar 2006)
New Revision: 1254

Removed:
   trunk/yake/scripts/msvc8/ent.vcproj
Modified:
   trunk/yake/scripts/msvc8/ent2.vcproj
   trunk/yake/scripts/msvc8/yake.sln
Log:
updated ent

Deleted: trunk/yake/scripts/msvc8/ent.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/ent.vcproj	2006-03-12 22:02:18 UTC (rev 1253)
+++ trunk/yake/scripts/msvc8/ent.vcproj	2006-03-12 22:03:14 UTC (rev 1254)
@@ -1,324 +0,0 @@
-<?xml version="1.0" encoding="Windows-1252"?>
-<VisualStudioProject
-	ProjectType="Visual C++"
-	Version="8,00"
-	Name="ent"
-	ProjectGUID="{B145E9A0-2656-4481-972A-39A6A0568F14}"
-	RootNamespace="yapp"
-	Keyword="Win32Proj"
-	>
-	<Platforms>
-		<Platform
-			Name="Win32"
-		/>
-	</Platforms>
-	<ToolFiles>
-	</ToolFiles>
-	<Configurations>
-		<Configuration
-			Name="Debug|Win32"
-			OutputDirectory="../../common/bin/$(ConfigurationName)"
-			IntermediateDirectory="../../common/obj/$(ConfigurationName)/$(ProjectName)"
-			ConfigurationType="2"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				Optimization="0"
-				AdditionalIncludeDirectories="../../;../../dependencies;../../dependencies/boost;../../dependencies/ttl"
-				PreprocessorDefinitions="_STLP_DEBUG;WIN32;_DEBUG;_CONSOLE;YAKE_ENT_EXPORTS"
-				MinimalRebuild="true"
-				BasicRuntimeChecks="3"
-				RuntimeLibrary="3"
-				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
-				PrecompiledHeaderThrough="yapp/ent/yakePCH.h"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="4"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib physics.lib data.lib"
-				OutputFile="$(OutDir)/$(ProjectName).dll"
-				LinkIncremental="2"
-				AdditionalLibraryDirectories="../../common/lib/$(ConfigurationName);../../dependencies/lib"
-				GenerateDebugInformation="true"
-				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
-				SubSystem="1"
-				ImportLibrary="../../common/lib/$(ConfigurationName)/$(ProjectName).lib"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-		<Configuration
-			Name="Release|Win32"
-			OutputDirectory="../../common/bin/$(ConfigurationName)"
-			IntermediateDirectory="../../common/obj/$(ConfigurationName)/$(ProjectName)"
-			ConfigurationType="2"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				AdditionalIncludeDirectories="../../;../../dependencies;../../dependencies/boost;../../dependencies/ttl"
-				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE;YAKE_ENT_EXPORTS"
-				RuntimeLibrary="2"
-				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
-				PrecompiledHeaderThrough="yapp/ent/yakePCH.h"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="3"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib physics.lib data.lib"
-				OutputFile="$(OutDir)/$(ProjectName).dll"
-				LinkIncremental="1"
-				AdditionalLibraryDirectories="../../common/lib/$(ConfigurationName);../../dependencies/lib"
-				GenerateDebugInformation="true"
-				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
-				SubSystem="1"
-				OptimizeReferences="2"
-				EnableCOMDATFolding="2"
-				ImportLibrary="../../common/lib/$(ConfigurationName)/$(ProjectName).lib"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-	</Configurations>
-	<References>
-	</References>
-	<Files>
-		<Filter
-			Name="src"
-			Filter="cpp;c;cxx;def;odl;idl;hpj;bat;asm;asmx"
-			UniqueIdentifier="{E22096B0-18DC-47ae-BBBD-A51C0F018B87}"
-			>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakeActor.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakeDemo.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakeEnt.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakeEntity.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakeEntityComponent.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakeEntityMachine.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakeEvent.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakeLight.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakeMessaging.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakeObject.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakePawn.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakePCH.cpp"
-				>
-				<FileConfiguration
-					Name="Debug|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
-				<FileConfiguration
-					Name="Release|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
-			</File>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakeSim.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yapp\ent\yakeTrigger.cpp"
-				>
-			</File>
-		</Filter>
-		<Filter
-			Name="inc"
-			Filter="h;hpp;hxx;hm;inl;inc;xsd"
-			UniqueIdentifier="{D3A5D637-E2C0-4f5a-B733-3757A329BD6B}"
-			>
-			<File
-				RelativePath="..\..\yapp\ent\yakeActor.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yapp\ent\yakeCommon.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yapp\ent\yakeEnt.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yapp\ent\yakeEntity.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yapp\ent\yakeEntityComponent.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yapp\ent\yakeEntityMachine.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yapp\ent\yakeEvent.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yapp\ent\yakeMessaging.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yapp\ent\yakeObject.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yapp\ent\yakePCH.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yapp\ent\yakeSim.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yapp\ent\yakeTrigger.h"
-				>
-			</File>
-		</Filter>
-	</Files>
-	<Globals>
-	</Globals>
-</VisualStudioProject>

Modified: trunk/yake/scripts/msvc8/ent2.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/ent2.vcproj	2006-03-12 22:02:18 UTC (rev 1253)
+++ trunk/yake/scripts/msvc8/ent2.vcproj	2006-03-12 22:03:14 UTC (rev 1254)
@@ -2,7 +2,7 @@
 <VisualStudioProject
 	ProjectType="Visual C++"
 	Version="8,00"
-	Name="ent2"
+	Name="ent"
 	ProjectGUID="{08BC40D8-33D8-4677-993A-32599A93A460}"
 	RootNamespace="yapp"
 	Keyword="Win32Proj"

Modified: trunk/yake/scripts/msvc8/yake.sln
===================================================================
--- trunk/yake/scripts/msvc8/yake.sln	2006-03-12 22:02:18 UTC (rev 1253)
+++ trunk/yake/scripts/msvc8/yake.sln	2006-03-12 22:03:14 UTC (rev 1254)
@@ -100,12 +100,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "msg", "msg.vcproj", "{7EB6A55E-D262-4C82-862C-33E831DDF04C}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "ent", "ent.vcproj", "{B145E9A0-2656-4481-972A-39A6A0568F14}"
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "entCommon", "plugins\ent\entCommon.vcproj", "{9E975777-551F-45F8-85FD-40BE6B0183A4}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "entLua", "plugins\ent\entLua.vcproj", "{3EEED188-5D62-476B-9CF3-022EBBAFFD12}"
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "ceguiOgreRendererAdapter", "plugins\gui\ceguiOgreRendererAdapter.vcproj", "{526DC299-3C9B-46ED-8C16-0490AE5CAE88}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "modelLua", "plugins\model\modelLua.vcproj", "{8150E623-2456-4152-AC96-D302B1CFF6E9}"
@@ -119,15 +115,20 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "net", "net.vcproj", "{90688422-B178-44F3-824A-C8CD6F3BD86F}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "ent2", "ent2.vcproj", "{08BC40D8-33D8-4677-993A-32599A93A460}"
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "ent", "ent2.vcproj", "{08BC40D8-33D8-4677-993A-32599A93A460}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleEntFsm", "samples\ent\sampleEntFsm.vcproj", "{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}"
 	ProjectSection(ProjectDependencies) = postProject
+		{08BC40D8-33D8-4677-993A-32599A93A460} = {08BC40D8-33D8-4677-993A-32599A93A460}
 		{89182311-DB82-446B-AA9B-C70A3A0AF035} = {89182311-DB82-446B-AA9B-C70A3A0AF035}
+	EndProjectSection
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "entLua", "plugins\ent\entLua2.vcproj", "{89182311-DB82-446B-AA9B-C70A3A0AF035}"
+	ProjectSection(ProjectDependencies) = postProject
 		{08BC40D8-33D8-4677-993A-32599A93A460} = {08BC40D8-33D8-4677-993A-32599A93A460}
 	EndProjectSection
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "entLua2", "plugins\ent\entLua2.vcproj", "{89182311-DB82-446B-AA9B-C70A3A0AF035}"
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "msg2", "msg2.vcproj", "{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}"
 EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) = preSolution
@@ -209,18 +210,10 @@
 		{7EB6A55E-D262-4C82-862C-33E831DDF04C}.Debug|Win32.Build.0 = Debug|Win32
 		{7EB6A55E-D262-4C82-862C-33E831DDF04C}.Release|Win32.ActiveCfg = Release|Win32
 		{7EB6A55E-D262-4C82-862C-33E831DDF04C}.Release|Win32.Build.0 = Release|Win32
-		{B145E9A0-2656-4481-972A-39A6A0568F14}.Debug|Win32.ActiveCfg = Debug|Win32
-		{B145E9A0-2656-4481-972A-39A6A0568F14}.Debug|Win32.Build.0 = Debug|Win32
-		{B145E9A0-2656-4481-972A-39A6A0568F14}.Release|Win32.ActiveCfg = Release|Win32
-		{B145E9A0-2656-4481-972A-39A6A0568F14}.Release|Win32.Build.0 = Release|Win32
 		{9E975777-551F-45F8-85FD-40BE6B0183A4}.Debug|Win32.ActiveCfg = Debug|Win32
 		{9E975777-551F-45F8-85FD-40BE6B0183A4}.Debug|Win32.Build.0 = Debug|Win32
 		{9E975777-551F-45F8-85FD-40BE6B0183A4}.Release|Win32.ActiveCfg = Release|Win32
 		{9E975777-551F-45F8-85FD-40BE6B0183A4}.Release|Win32.Build.0 = Release|Win32
-		{3EEED188-5D62-476B-9CF3-022EBBAFFD12}.Debug|Win32.ActiveCfg = Debug|Win32
-		{3EEED188-5D62-476B-9CF3-022EBBAFFD12}.Debug|Win32.Build.0 = Debug|Win32
-		{3EEED188-5D62-476B-9CF3-022EBBAFFD12}.Release|Win32.ActiveCfg = Release|Win32
-		{3EEED188-5D62-476B-9CF3-022EBBAFFD12}.Release|Win32.Build.0 = Release|Win32
 		{526DC299-3C9B-46ED-8C16-0490AE5CAE88}.Debug|Win32.ActiveCfg = Debug|Win32
 		{526DC299-3C9B-46ED-8C16-0490AE5CAE88}.Debug|Win32.Build.0 = Debug|Win32
 		{526DC299-3C9B-46ED-8C16-0490AE5CAE88}.Release|Win32.ActiveCfg = Release|Win32
@@ -253,6 +246,10 @@
 		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Debug|Win32.Build.0 = Debug|Win32
 		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Release|Win32.ActiveCfg = Release|Win32
 		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Release|Win32.Build.0 = Release|Win32
+		{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}.Debug|Win32.ActiveCfg = Debug|Win32
+		{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}.Debug|Win32.Build.0 = Debug|Win32
+		{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}.Release|Win32.ActiveCfg = Release|Win32
+		{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}.Release|Win32.Build.0 = Release|Win32
 	EndGlobalSection
 	GlobalSection(SolutionProperties) = preSolution
 		HideSolutionNode = FALSE



From codeandroid at berlios.de  Sun Mar 12 23:03:56 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:03:56 +0100
Subject: [Yake-svn] r1255 - trunk/yake/scripts/msvc8/plugins/ent
Message-ID: <200603122203.k2CM3udE012091@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:03:56 +0100 (Sun, 12 Mar 2006)
New Revision: 1255

Modified:
   trunk/yake/scripts/msvc8/plugins/ent/entLua.vcproj
Log:
replaced by yake/ent

Modified: trunk/yake/scripts/msvc8/plugins/ent/entLua.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/plugins/ent/entLua.vcproj	2006-03-12 22:03:14 UTC (rev 1254)
+++ trunk/yake/scripts/msvc8/plugins/ent/entLua.vcproj	2006-03-12 22:03:56 UTC (rev 1255)
@@ -3,7 +3,7 @@
 	ProjectType="Visual C++"
 	Version="8,00"
 	Name="entLua"
-	ProjectGUID="{3EEED188-5D62-476B-9CF3-022EBBAFFD12}"
+	ProjectGUID="{89182311-DB82-446B-AA9B-C70A3A0AF035}"
 	Keyword="Win32Proj"
 	>
 	<Platforms>
@@ -46,7 +46,7 @@
 				BasicRuntimeChecks="3"
 				RuntimeLibrary="3"
 				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
+				UsePrecompiledHeader="0"
 				PrecompiledHeaderThrough="yapp/plugins/entLua/pch.h"
 				WarningLevel="3"
 				Detect64BitPortabilityProblems="true"
@@ -63,7 +63,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="yapp.lib ent.lib scripting.lib scriptingLua.lib luad.lib luabindd.lib"
+				AdditionalDependencies="ent2.lib scripting.lib scriptingLua.lib luad.lib luabindd.lib"
 				OutputFile="$(OutDir)/$(ProjectName).dll"
 				LinkIncremental="2"
 				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/luabind/lib;../../../../dependencies/lua/lib;../../../../dependencies/lib"
@@ -128,7 +128,7 @@
 				PreprocessorDefinitions="WIN32;NDEBUG;_WINDOWS;_USRDLL;YAKE_ENTLUA_EXPORTS"
 				RuntimeLibrary="2"
 				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
+				UsePrecompiledHeader="0"
 				PrecompiledHeaderThrough="yapp/plugins/entLua/pch.h"
 				WarningLevel="3"
 				Detect64BitPortabilityProblems="true"
@@ -145,7 +145,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="yapp.lib ent.lib scripting.lib scriptingLua.lib lua.lib luabind.lib"
+				AdditionalDependencies="ent2.lib scripting.lib scriptingLua.lib lua.lib luabind.lib"
 				OutputFile="$(OutDir)/$(ProjectName).dll"
 				LinkIncremental="1"
 				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/luabind/lib;../../../../dependencies/lua/lib;../../../../dependencies/lib"
@@ -189,70 +189,22 @@
 		<Filter
 			Name="src"
 			Filter="cpp;c;cxx;def;odl;idl;hpj;bat;asm;asmx"
-			UniqueIdentifier="{9CB4E8A9-2FDE-4824-AE67-A41A3676A03C}"
+			UniqueIdentifier="{09A10F80-1825-424a-AEA9-250CB4511F6F}"
 			>
 			<File
-				RelativePath="..\..\..\..\src\yapp\plugins\entLua\pch.cpp"
+				RelativePath="..\..\..\..\src\yake\plugins\entLua\entLua.cpp"
 				>
-				<FileConfiguration
-					Name="Debug|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
-				<FileConfiguration
-					Name="Release|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
 			</File>
-			<File
-				RelativePath="..\..\..\..\src\yapp\plugins\entLua\yakeEvent_lua.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\..\..\src\yapp\plugins\entLua\yakeLuaBinder.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\..\..\src\yapp\plugins\entLua\yakeStateCb_lua.cpp"
-				>
-			</File>
 		</Filter>
 		<Filter
 			Name="inc"
 			Filter="h;hpp;hxx;hm;inl;inc;xsd"
-			UniqueIdentifier="{C4684ADB-F16C-49c0-B735-7B03DC9337AA}"
+			UniqueIdentifier="{7D1512F3-3C33-47f9-B6FE-5D846ED21130}"
 			>
 			<File
-				RelativePath="..\..\..\..\yapp\plugins\entLua\pch.h"
+				RelativePath="..\..\..\..\yake\plugins\entLua\entLua.h"
 				>
 			</File>
-			<File
-				RelativePath="..\..\..\..\yapp\plugins\entLua\yakeEntLua.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\..\..\yapp\plugins\entLua\yakeEvent_lua.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\..\..\yapp\plugins\entLua\yakeLuaBinder.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\..\..\yapp\plugins\entLua\yakePrerequisites.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\..\..\yapp\plugins\entLua\yakeStateCb_lua.h"
-				>
-			</File>
 		</Filter>
 	</Files>
 	<Globals>



From codeandroid at berlios.de  Sun Mar 12 23:04:57 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:04:57 +0100
Subject: [Yake-svn] r1256 - trunk/yake/scripts/msvc8
Message-ID: <200603122204.k2CM4vIx012233@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:04:57 +0100 (Sun, 12 Mar 2006)
New Revision: 1256

Added:
   trunk/yake/scripts/msvc8/ent.vcproj
Log:
replaced by yake/ent

Added: trunk/yake/scripts/msvc8/ent.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/ent.vcproj	2006-03-12 22:03:56 UTC (rev 1255)
+++ trunk/yake/scripts/msvc8/ent.vcproj	2006-03-12 22:04:57 UTC (rev 1256)
@@ -0,0 +1,292 @@
+<?xml version="1.0" encoding="Windows-1252"?>
+<VisualStudioProject
+	ProjectType="Visual C++"
+	Version="8,00"
+	Name="ent"
+	ProjectGUID="{08BC40D8-33D8-4677-993A-32599A93A460}"
+	RootNamespace="yapp"
+	Keyword="Win32Proj"
+	>
+	<Platforms>
+		<Platform
+			Name="Win32"
+		/>
+	</Platforms>
+	<ToolFiles>
+	</ToolFiles>
+	<Configurations>
+		<Configuration
+			Name="Debug|Win32"
+			OutputDirectory="../../common/bin/$(ConfigurationName)"
+			IntermediateDirectory="../../common/obj/$(ConfigurationName)/$(ProjectName)"
+			ConfigurationType="2"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				Optimization="0"
+				AdditionalIncludeDirectories="../../;../../dependencies;../../dependencies/boost;../../dependencies/ttl"
+				PreprocessorDefinitions="_STLP_DEBUG;WIN32;_DEBUG;_CONSOLE;YAKE_ENT_EXPORTS"
+				MinimalRebuild="true"
+				BasicRuntimeChecks="3"
+				RuntimeLibrary="3"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="2"
+				PrecompiledHeaderThrough="yake/ent/pch.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="4"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib physics.lib data.lib"
+				OutputFile="$(OutDir)/$(ProjectName).dll"
+				LinkIncremental="2"
+				AdditionalLibraryDirectories="../../common/lib/$(ConfigurationName);../../dependencies/lib"
+				GenerateDebugInformation="true"
+				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
+				SubSystem="1"
+				ImportLibrary="../../common/lib/$(ConfigurationName)/$(ProjectName).lib"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+		<Configuration
+			Name="Release|Win32"
+			OutputDirectory="../../common/bin/$(ConfigurationName)"
+			IntermediateDirectory="../../common/obj/$(ConfigurationName)/$(ProjectName)"
+			ConfigurationType="2"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				AdditionalIncludeDirectories="../../;../../dependencies;../../dependencies/boost;../../dependencies/ttl"
+				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE;YAKE_ENT_EXPORTS"
+				RuntimeLibrary="2"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="2"
+				PrecompiledHeaderThrough="yake/ent/pch.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="3"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib physics.lib data.lib"
+				OutputFile="$(OutDir)/$(ProjectName).dll"
+				LinkIncremental="1"
+				AdditionalLibraryDirectories="../../common/lib/$(ConfigurationName);../../dependencies/lib"
+				GenerateDebugInformation="true"
+				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
+				SubSystem="1"
+				OptimizeReferences="2"
+				EnableCOMDATFolding="2"
+				ImportLibrary="../../common/lib/$(ConfigurationName)/$(ProjectName).lib"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+	</Configurations>
+	<References>
+	</References>
+	<Files>
+		<Filter
+			Name="src"
+			Filter="cpp;c;cxx;def;odl;idl;hpj;bat;asm;asmx"
+			UniqueIdentifier="{115664F1-EC08-4142-B5D0-91C3C574D1EC}"
+			>
+			<File
+				RelativePath="..\..\src\yake\ent\component.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\component_holder.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\object.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\object_listener.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\object_mgr.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\object_mgr_listener.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\pch.cpp"
+				>
+				<FileConfiguration
+					Name="Debug|Win32"
+					>
+					<Tool
+						Name="VCCLCompilerTool"
+						UsePrecompiledHeader="1"
+					/>
+				</FileConfiguration>
+				<FileConfiguration
+					Name="Release|Win32"
+					>
+					<Tool
+						Name="VCCLCompilerTool"
+						UsePrecompiledHeader="1"
+					/>
+				</FileConfiguration>
+			</File>
+			<File
+				RelativePath="..\..\src\yake\ent\vm_holder.cpp"
+				>
+			</File>
+		</Filter>
+		<Filter
+			Name="inc"
+			Filter="h;hpp;hxx;hm;inl;inc;xsd"
+			UniqueIdentifier="{1D967178-F5B9-46f9-AA8E-78B77BB7A694}"
+			>
+			<File
+				RelativePath="..\..\yake\ent\component.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\component_holder.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\ent.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\object.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\object_listener.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\object_mgr.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\object_mgr_listener.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\pch.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\prerequisites.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\ent\vm_holder.h"
+				>
+			</File>
+		</Filter>
+	</Files>
+	<Globals>
+	</Globals>
+</VisualStudioProject>



From codeandroid at berlios.de  Sun Mar 12 23:05:46 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:05:46 +0100
Subject: [Yake-svn] r1257 - trunk/yake/scripts/msvc8
Message-ID: <200603122205.k2CM5kEP012328@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:05:46 +0100 (Sun, 12 Mar 2006)
New Revision: 1257

Modified:
   trunk/yake/scripts/msvc8/yake.sln
Log:
yapp/ent replaced by yake/ent

Modified: trunk/yake/scripts/msvc8/yake.sln
===================================================================
--- trunk/yake/scripts/msvc8/yake.sln	2006-03-12 22:04:57 UTC (rev 1256)
+++ trunk/yake/scripts/msvc8/yake.sln	2006-03-12 22:05:46 UTC (rev 1257)
@@ -9,8 +9,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "graphicsOGRE", "plugins\graphics\graphicsOgre.vcproj", "{A2C2A0B2-2EB0-4254-891D-FE93466809CF}"
 	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "physics", "physics.vcproj", "{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}"
@@ -20,8 +20,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "physicsODE", "plugins\physics\physicsODE.vcproj", "{2F5124AA-56BD-4909-811A-E79901978C86}"
 	ProjectSection(ProjectDependencies) = postProject
-		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
 		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
+		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "input", "input.vcproj", "{1AF3930A-4E72-4455-AFD0-6B78684105CD}"
@@ -31,8 +31,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "inputOGRE", "plugins\input\inputOgre.vcproj", "{A1A2FE19-7B7E-42F1-808B-8FA5B6AA697E}"
 	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 		{1AF3930A-4E72-4455-AFD0-6B78684105CD} = {1AF3930A-4E72-4455-AFD0-6B78684105CD}
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "scripting", "scripting.vcproj", "{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}"
@@ -42,8 +42,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "scriptingLua", "plugins\scripting\scriptingLua.vcproj", "{41CEA11B-9678-43E5-B2F4-754944D7B461}"
 	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "data", "data.vcproj", "{77A59B89-C2B3-429C-8317-ADE0D046CC3B}"
@@ -53,8 +53,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "scriptingBindingsLua", "plugins\scripting\scriptingLuaBindings.vcproj", "{CA63F621-0912-4551-B51A-7BD18F491181}"
 	ProjectSection(ProjectDependencies) = postProject
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 		{41CEA11B-9678-43E5-B2F4-754944D7B461} = {41CEA11B-9678-43E5-B2F4-754944D7B461}
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "audio", "audio.vcproj", "{42BB6F78-B04C-4968-AA5E-271DC45BEFBB}"
@@ -74,26 +74,26 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "graphicsBindingsLua", "plugins\scripting\graphicsLuaBindings.vcproj", "{2D5E8A7F-96DA-4CC5-BFC8-430916ACF18A}"
 	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
-		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
 		{41CEA11B-9678-43E5-B2F4-754944D7B461} = {41CEA11B-9678-43E5-B2F4-754944D7B461}
+		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "baseBindingsLua", "plugins\scripting\baseLuaBindings.vcproj", "{3867E9A4-41F3-4969-B0A8-40757BCB6C29}"
 	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 		{41CEA11B-9678-43E5-B2F4-754944D7B461} = {41CEA11B-9678-43E5-B2F4-754944D7B461}
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "yapp", "yapp.vcproj", "{F1116FDF-65C1-4788-AC1F-F339279B937A}"
 	ProjectSection(ProjectDependencies) = postProject
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
-		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
-		{42BB6F78-B04C-4968-AA5E-271DC45BEFBB} = {42BB6F78-B04C-4968-AA5E-271DC45BEFBB}
-		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
 		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
+		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
+		{42BB6F78-B04C-4968-AA5E-271DC45BEFBB} = {42BB6F78-B04C-4968-AA5E-271DC45BEFBB}
+		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "raf", "raf.vcproj", "{6D6DD5E8-3B81-4C98-B460-B434DEE23EE2}"
@@ -115,21 +115,18 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "net", "net.vcproj", "{90688422-B178-44F3-824A-C8CD6F3BD86F}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "ent", "ent2.vcproj", "{08BC40D8-33D8-4677-993A-32599A93A460}"
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleEntFsm", "samples\ent\sampleEntFsm.vcproj", "{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}"
 	ProjectSection(ProjectDependencies) = postProject
-		{08BC40D8-33D8-4677-993A-32599A93A460} = {08BC40D8-33D8-4677-993A-32599A93A460}
 		{89182311-DB82-446B-AA9B-C70A3A0AF035} = {89182311-DB82-446B-AA9B-C70A3A0AF035}
-	EndProjectSection
-EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "entLua", "plugins\ent\entLua2.vcproj", "{89182311-DB82-446B-AA9B-C70A3A0AF035}"
-	ProjectSection(ProjectDependencies) = postProject
 		{08BC40D8-33D8-4677-993A-32599A93A460} = {08BC40D8-33D8-4677-993A-32599A93A460}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "msg2", "msg2.vcproj", "{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}"
 EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "entLua", "plugins\ent\entLua.vcproj", "{89182311-DB82-446B-AA9B-C70A3A0AF035}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "ent", "ent.vcproj", "{08BC40D8-33D8-4677-993A-32599A93A460}"
+EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) = preSolution
 		Debug|Win32 = Debug|Win32
@@ -234,22 +231,22 @@
 		{90688422-B178-44F3-824A-C8CD6F3BD86F}.Debug|Win32.Build.0 = Debug|Win32
 		{90688422-B178-44F3-824A-C8CD6F3BD86F}.Release|Win32.ActiveCfg = Release|Win32
 		{90688422-B178-44F3-824A-C8CD6F3BD86F}.Release|Win32.Build.0 = Release|Win32
-		{08BC40D8-33D8-4677-993A-32599A93A460}.Debug|Win32.ActiveCfg = Debug|Win32
-		{08BC40D8-33D8-4677-993A-32599A93A460}.Debug|Win32.Build.0 = Debug|Win32
-		{08BC40D8-33D8-4677-993A-32599A93A460}.Release|Win32.ActiveCfg = Release|Win32
-		{08BC40D8-33D8-4677-993A-32599A93A460}.Release|Win32.Build.0 = Release|Win32
 		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Debug|Win32.ActiveCfg = Debug|Win32
 		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Debug|Win32.Build.0 = Debug|Win32
 		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Release|Win32.ActiveCfg = Release|Win32
 		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Release|Win32.Build.0 = Release|Win32
-		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Debug|Win32.ActiveCfg = Debug|Win32
-		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Debug|Win32.Build.0 = Debug|Win32
-		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Release|Win32.ActiveCfg = Release|Win32
-		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Release|Win32.Build.0 = Release|Win32
 		{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}.Debug|Win32.ActiveCfg = Debug|Win32
 		{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}.Debug|Win32.Build.0 = Debug|Win32
 		{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}.Release|Win32.ActiveCfg = Release|Win32
 		{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}.Release|Win32.Build.0 = Release|Win32
+		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Debug|Win32.ActiveCfg = Debug|Win32
+		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Debug|Win32.Build.0 = Debug|Win32
+		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Release|Win32.ActiveCfg = Release|Win32
+		{89182311-DB82-446B-AA9B-C70A3A0AF035}.Release|Win32.Build.0 = Release|Win32
+		{08BC40D8-33D8-4677-993A-32599A93A460}.Debug|Win32.ActiveCfg = Debug|Win32
+		{08BC40D8-33D8-4677-993A-32599A93A460}.Debug|Win32.Build.0 = Debug|Win32
+		{08BC40D8-33D8-4677-993A-32599A93A460}.Release|Win32.ActiveCfg = Release|Win32
+		{08BC40D8-33D8-4677-993A-32599A93A460}.Release|Win32.Build.0 = Release|Win32
 	EndGlobalSection
 	GlobalSection(SolutionProperties) = preSolution
 		HideSolutionNode = FALSE



From codeandroid at berlios.de  Sun Mar 12 23:06:19 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:06:19 +0100
Subject: [Yake-svn] r1258 - in trunk/yake/scripts/msvc8/samples: . ent
Message-ID: <200603122206.k2CM6Jbv012389@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:06:19 +0100 (Sun, 12 Mar 2006)
New Revision: 1258

Added:
   trunk/yake/scripts/msvc8/samples/ent/
   trunk/yake/scripts/msvc8/samples/ent/sampleEntFsm.vcproj
Log:
initial revision

Added: trunk/yake/scripts/msvc8/samples/ent/sampleEntFsm.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/ent/sampleEntFsm.vcproj	2006-03-12 22:05:46 UTC (rev 1257)
+++ trunk/yake/scripts/msvc8/samples/ent/sampleEntFsm.vcproj	2006-03-12 22:06:19 UTC (rev 1258)
@@ -0,0 +1,199 @@
+<?xml version="1.0" encoding="Windows-1252"?>
+<VisualStudioProject
+	ProjectType="Visual C++"
+	Version="8,00"
+	Name="sampleEntFsm"
+	ProjectGUID="{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}"
+	Keyword="Win32Proj"
+	>
+	<Platforms>
+		<Platform
+			Name="Win32"
+		/>
+	</Platforms>
+	<ToolFiles>
+	</ToolFiles>
+	<Configurations>
+		<Configuration
+			Name="Debug|Win32"
+			OutputDirectory="../../../../common/bin/debug"
+			IntermediateDirectory="../../../../common/obj/debug/$(ProjectName)"
+			ConfigurationType="1"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				Optimization="0"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
+				PreprocessorDefinitions="WIN32;_DEBUG;_CONSOLE"
+				MinimalRebuild="true"
+				BasicRuntimeChecks="3"
+				RuntimeLibrary="3"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="0"
+				PrecompiledHeaderThrough="yapp/samples/base/vehicle/yakePCH.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="4"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib vehicle.lib"
+				OutputFile="$(OutDir)/$(ProjectName).exe"
+				LinkIncremental="2"
+				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/lib"
+				GenerateDebugInformation="true"
+				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
+				SubSystem="1"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+		<Configuration
+			Name="Release|Win32"
+			OutputDirectory="../../../../common/bin/release"
+			IntermediateDirectory="../../../../common/obj/release/$(ProjectName)"
+			ConfigurationType="1"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
+				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE"
+				RuntimeLibrary="2"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="0"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="3"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib vehicle.lib"
+				OutputFile="$(OutDir)/$(ProjectName).exe"
+				LinkIncremental="1"
+				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"
+				GenerateDebugInformation="false"
+				SubSystem="1"
+				OptimizeReferences="2"
+				EnableCOMDATFolding="2"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+	</Configurations>
+	<References>
+	</References>
+	<Files>
+		<Filter
+			Name="inc"
+			>
+		</Filter>
+		<Filter
+			Name="src"
+			>
+			<File
+				RelativePath="..\..\..\..\src\yake\samples\ent\sampleEntFsm\demo.cpp"
+				>
+			</File>
+		</Filter>
+	</Files>
+	<Globals>
+	</Globals>
+</VisualStudioProject>



From codeandroid at berlios.de  Sun Mar 12 23:16:28 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:16:28 +0100
Subject: [Yake-svn] r1259 - in trunk/yake/src/yake/samples: . msg msg/sampleMsg1
Message-ID: <200603122216.k2CMGS7P013000@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:16:28 +0100 (Sun, 12 Mar 2006)
New Revision: 1259

Added:
   trunk/yake/src/yake/samples/msg/
   trunk/yake/src/yake/samples/msg/sampleMsg1/
   trunk/yake/src/yake/samples/msg/sampleMsg1/demo.cpp
Log:
initial revision

Added: trunk/yake/src/yake/samples/msg/sampleMsg1/demo.cpp
===================================================================
--- trunk/yake/src/yake/samples/msg/sampleMsg1/demo.cpp	2006-03-12 22:06:19 UTC (rev 1258)
+++ trunk/yake/src/yake/samples/msg/sampleMsg1/demo.cpp	2006-03-12 22:16:28 UTC (rev 1259)
@@ -0,0 +1,149 @@
+//#include "yake/base/yakePrerequisites.h"
+#include "yake/base/yake.h"
+#include "yake/msg/yakeMessage.h"
+
+using namespace yake;
+
+void app_handle_int(const int& i)
+{
+	std::cout << "app_handle_int(" << i << ")\n";
+}
+
+struct MsgResize
+{
+	int width;
+	int height;
+	MsgResize(int w = 0, int h = 0) : width(w), height(h) {}
+};
+void app_handle_MsgResize1(const MsgResize& msg)
+{
+	std::cout << "app_handle_MsgResize1(width=" << msg.width << ", height=" << msg.height << ")\n";
+}
+void app_handle_MsgResize2(const MsgResize& msg)
+{
+	std::cout << "app_handle_MsgResize2(width=" << msg.width << ", height=" << msg.height << ")\n";
+}
+struct MsgQ2
+{
+	MsgQ2(msg::router<msg::DoubleQueuedProcessor>& router) : router_(router)
+	{}
+	msg::router<msg::DoubleQueuedProcessor>& router_;
+};
+void app_handle_q2(const MsgQ2& msg)
+{
+	std::cout << "app_handle_q2()\n";
+	msg.router_.post(msg::makeMessage(444));
+}
+
+/*
+struct MsgResizeAllocator
+{
+	static msg::message<MsgResize>* create(const MsgResize& v)
+	{
+		msg::message<MsgResize>* msg = pool_.construct();
+		msg->setValue(v);
+		return msg;
+	}
+	static void destroy(msg::message<MsgResize>* msg)
+	{
+		assert( pool_.is_from(msg) );
+		pool_.destroy( msg );
+	}
+private:
+	typedef boost::object_pool<msg::message<MsgResize> > pool_type;
+	static pool_type	pool_;
+};
+MsgResizeAllocator::pool_type MsgResizeAllocator::pool_;
+namespace msg {
+	template<>
+	message<MsgResize>* makeMessage(const MsgResize& v)
+	{ 
+		std::cout << "makeMessage<MsgResize>()\n";
+		return MsgResizeAllocator::create(v); 
+	}
+	template<>
+	void destroyMessage(message<MsgResize>* msg)
+	{ 
+		std::cout << "destroyMessage<MsgResize>()\n";
+		return MsgResizeAllocator::destroy(msg); 
+	}
+} // namespace msg
+*/
+
+struct ObjectMessage
+{
+	ObjectMessage() {}
+
+	template<typename A1>
+	ObjectMessage(const std::string& name1, const A1& a1)
+	{
+		params_[ name1 ] = a1;
+	}
+
+	template<typename A1, typename A2>
+	ObjectMessage(const std::string& name1, const A1& a1, const std::string& name2, const A2& a2)
+	{
+		params_[ name1 ] = a1;
+		params_[ name2 ] = a2;
+	}
+
+	size_t size() const
+	{ return params_.size(); }
+
+private:
+	typedef std::map<std::string,boost::any> params_map;
+	params_map	params_;
+};
+
+int main(int argc, char* argv[])
+{
+	// Default/Immediate processing:
+	{
+		msg::router<msg::ImmediateProcessor> router;
+
+		// The following message will be lost as there's no handler registered yet!
+		router.post(msg::makeMessage(1234));
+
+		// register a few handlers
+		router << msg::makeListener<int>(&app_handle_int);
+		router << msg::makeListener<MsgResize>(&app_handle_MsgResize1);
+		router << msg::makeListener<MsgResize>(&app_handle_MsgResize2);
+
+		// post a few message to different handlers (depending on type)
+		router.post(msg::makeMessage(1234));
+		router.post(msg::makeMessage(123.12));
+		router.post(msg::makeMessage(MsgResize(20,30)));
+	}
+	//Q'd :
+	{
+		msg::router<msg::SingleQueuedProcessor> router;
+
+		// The following message will *not* be lost even though there's no handler registered yet!
+		router.post(msg::makeMessage(1234));
+
+		router << msg::makeListener<int>(&app_handle_int);
+
+		// The following call will trigger processing of the messages.
+		// NB It is not possible to post message while messages are processed! Use a DoubleQueuedProcessor router for that!
+		router.processMessages();
+	}
+
+	//Double-Q'd :
+	{
+		msg::router<msg::DoubleQueuedProcessor> router;
+
+		// add a few handlers/listeners
+		router << msg::makeListener<int>(&app_handle_int);
+		router << msg::makeListener<MsgQ2>(&app_handle_q2);
+
+		// Post a message - the message handler will post a message to the same router!
+		// router<DoubleQueuedProcessor> supports this behaviour!
+		router.post(msg::makeMessage(MsgQ2(router)));
+		router.processMessages(); // handles MsgQ2 message
+		router.processMessages(); // handles int message that the MsgQ2 handler posted
+
+		// @todo
+		router.postMessage(ObjectMessage("entity",0x00a0a0a0,"name",std::string("freak")));
+	}
+}
+



From codeandroid at berlios.de  Sun Mar 12 23:18:55 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:18:55 +0100
Subject: [Yake-svn] r1260 - in trunk/yake/yake: . msg
Message-ID: <200603122218.k2CMIta4013235@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:18:54 +0100 (Sun, 12 Mar 2006)
New Revision: 1260

Added:
   trunk/yake/yake/msg/
   trunk/yake/yake/msg/listener.h
   trunk/yake/yake/msg/listener_mgr.h
   trunk/yake/yake/msg/message.h
   trunk/yake/yake/msg/prerequisites.h
   trunk/yake/yake/msg/processors.h
   trunk/yake/yake/msg/router.h
   trunk/yake/yake/msg/yakeMessage.h
Log:
initial revision

Added: trunk/yake/yake/msg/listener.h
===================================================================
--- trunk/yake/yake/msg/listener.h	2006-03-12 22:16:28 UTC (rev 1259)
+++ trunk/yake/yake/msg/listener.h	2006-03-12 22:18:54 UTC (rev 1260)
@@ -0,0 +1,91 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#ifndef YAKE_MSG_LISTENER_H
+#define YAKE_MSG_LISTENER_H
+
+#include "yake/msg/prerequisites.h"
+
+MSG_NAMESPACE_BEGIN
+
+	struct listener_base
+	{
+		listener_base(const std::string& msgTypeName) : msgTypeName_(msgTypeName) {}
+		void execute(const message_base& msg)
+		{ doExecute(msg); }
+		const std::string& msgTypeName() const
+		{ return msgTypeName_; }
+		void destroy()
+		{
+			assert( this );
+			delete this;
+		}
+	protected:
+		virtual void doExecute(const message_base&) = 0;
+	private:
+		std::string		msgTypeName_;
+	};
+	/*
+	enum ListenerResult
+	{
+		LR_UNHANDLED,
+		LR_HANDLED,
+		LR_FAILED
+	};
+	*/
+	template<typename MsgType>
+	struct listener : public listener_base
+	{
+		typedef boost::function<void(const MsgType&)> HandlerFn;
+
+		listener(const HandlerFn& fn) : listener_base(typeid(MsgType).name()),fn_(fn)
+		{}
+	protected:
+		virtual void doExecute(const message_base& msgbase)
+		{
+			try {
+				fn_( static_cast<const MsgType&>(boost::any_cast<MsgType>(msgbase.value())) );
+			}
+			catch( boost::bad_any_cast& e )
+			{
+				std::cerr << "msg.exception: " << e.what() << "\n";
+			}
+			catch( ...)
+			{
+				std::cerr << "msg.exception: unhandled exception\n";
+			}
+		}
+	private:
+		HandlerFn			fn_;
+	};
+
+	template<typename T>
+	listener<T>* makeListener(const boost::function<void(const T&)>& fn)
+	{ return new listener<T>(fn); }
+
+MSG_NAMESPACE_END
+
+#endif

Added: trunk/yake/yake/msg/listener_mgr.h
===================================================================
--- trunk/yake/yake/msg/listener_mgr.h	2006-03-12 22:16:28 UTC (rev 1259)
+++ trunk/yake/yake/msg/listener_mgr.h	2006-03-12 22:18:54 UTC (rev 1260)
@@ -0,0 +1,68 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#ifndef YAKE_MSG_LISTENER_MGR_H
+#define YAKE_MSG_LISTENER_MGR_H
+
+#include "yake/msg/prerequisites.h"
+
+MSG_NAMESPACE_BEGIN
+
+	namespace detail {
+		typedef std::deque<boost::shared_ptr<listener_base> > listener_list;
+		typedef std::map<std::string,listener_list> listener_map;
+
+		struct msg_listener_mgr
+		{
+			bool add(listener_base* l)
+			{
+				assert(l);
+				if (!l)
+					return false;
+				listeners_[l->msgTypeName()].push_back( boost::shared_ptr<listener_base>(l) );
+				return true;
+			}
+			void process(message_base* msg)
+			{
+				assert( msg );
+				listener_map::const_iterator itMsgType = listeners_.find(msg->msgTypeName());
+				if (itMsgType == listeners_.end())
+					return;
+				const listener_list& l = itMsgType->second;
+				for (listener_list::const_iterator it = l.begin(); it != l.end(); ++it)
+					(*it)->execute(*msg);
+				MSG_NAMESPACE::destroyMessage(msg);
+			}
+		private:
+			typedef MSG_NAMESPACE::detail::listener_list listener_list;
+			typedef MSG_NAMESPACE::detail::listener_map listener_map;
+			listener_map	listeners_;
+		};
+	}
+
+MSG_NAMESPACE_END
+
+#endif

Added: trunk/yake/yake/msg/message.h
===================================================================
--- trunk/yake/yake/msg/message.h	2006-03-12 22:16:28 UTC (rev 1259)
+++ trunk/yake/yake/msg/message.h	2006-03-12 22:18:54 UTC (rev 1260)
@@ -0,0 +1,92 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#ifndef YAKE_MSG_MESSAGE_H
+#define YAKE_MSG_MESSAGE_H
+
+#include "yake/msg/prerequisites.h"
+
+MSG_NAMESPACE_BEGIN
+
+	struct message_base
+	{
+	private:
+		message_base(const message_base&);
+		message_base& operator=(const message_base&);
+	public:
+		template<typename T>
+		message_base(const T& value) : value_(value), msgTypeName_(typeid(T).name())
+		{}
+		const boost::any& value() const
+		{ return value_; }
+		const std::string& msgTypeName() const
+		{ return msgTypeName_; }
+	protected:
+		boost::any		value_;
+	private:
+		std::string		msgTypeName_;
+	};
+	template<typename T>
+	struct message : public message_base
+	{
+		message(const T& v) : message_base(v)
+		{}
+		message() : message_base(T())
+		{}
+		void setValue(const T& v)
+		{ value_ = v; } //@todo add type mismatch tests
+	};
+
+	struct DefaultMessageAllocator
+	{
+		DefaultMessageAllocator& instance();
+		template<typename T>
+		static message<T>* create(const T& v)
+		{
+			return new message<T>(v);
+		}
+		template<typename MsgType>
+		static void destroy(const MsgType* msg)
+		{
+			assert( msg );
+			delete msg;
+		}
+	};
+
+	template<typename T>
+	message<T>* makeMessage(const T& v)
+	{ 
+		return DefaultMessageAllocator::create<T>(v); 
+	}
+	template<typename T>
+	void destroyMessage(T* msg)
+	{ 
+		return DefaultMessageAllocator::destroy(msg); 
+	}
+
+MSG_NAMESPACE_END
+
+#endif

Added: trunk/yake/yake/msg/prerequisites.h
===================================================================
--- trunk/yake/yake/msg/prerequisites.h	2006-03-12 22:16:28 UTC (rev 1259)
+++ trunk/yake/yake/msg/prerequisites.h	2006-03-12 22:18:54 UTC (rev 1260)
@@ -0,0 +1,47 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#ifndef YAKE_MSG_PREREQUISITES_H
+#define YAKE_MSG_PREREQUISITES_H
+
+#define MSG_NAMESPACE ::yake::msg
+#define MSG_NAMESPACE_BEGIN namespace yake { namespace msg {
+#define MSG_NAMESPACE_END }}
+
+/*
+#include <cassert>
+#include <vector>
+#include <deque>
+#include <map>
+#include <string>
+#include <boost/shared_ptr.hpp>
+#include <boost/bind.hpp>
+#include <boost/function.hpp>
+#include <boost/any.hpp>
+#include <boost/pool/object_pool.hpp>
+*/
+
+#endif

Added: trunk/yake/yake/msg/processors.h
===================================================================
--- trunk/yake/yake/msg/processors.h	2006-03-12 22:16:28 UTC (rev 1259)
+++ trunk/yake/yake/msg/processors.h	2006-03-12 22:18:54 UTC (rev 1260)
@@ -0,0 +1,111 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#ifndef YAKE_MSG_PROCESSORS_H
+#define YAKE_MSG_PROCESSORS_H
+
+#include "yake/msg/prerequisites.h"
+
+MSG_NAMESPACE_BEGIN
+
+	struct ImmediateProcessor : public detail::msg_listener_mgr
+	{
+		typedef detail::listener_map listener_map;
+		typedef detail::listener_list listener_list;
+
+		void onPost(message_base* msg)
+		{
+			assert(msg);
+			this->process(msg);
+		}
+	};
+	struct SingleQueuedProcessor : public detail::msg_listener_mgr
+	{
+		typedef detail::listener_map listener_map;
+		typedef detail::listener_list listener_list;
+
+		SingleQueuedProcessor() : isProcessing_(false)
+		{}
+		void onPost(message_base* msg)
+		{
+			assert(!isProcessing_);
+			assert(msg);
+			q_.push_back(msg); //@todo sort by msg type!?
+		}
+		void processMessages()
+		{
+			assert( !isProcessing_ );
+			isProcessing_ = true;
+			for (msg_q::const_iterator it = q_.begin(); it != q_.end(); ++it)
+			{
+				message_base* msg = *it;
+				assert( msg );
+				this->process(msg);
+			}
+			q_.clear();
+			isProcessing_ = false;
+		}
+	private:
+		typedef std::deque<message_base*> msg_q;
+		msg_q		q_;
+		bool		isProcessing_;
+	};
+	struct DoubleQueuedProcessor : public detail::msg_listener_mgr
+	{
+		typedef detail::listener_map listener_map;
+		typedef detail::listener_list listener_list;
+
+		DoubleQueuedProcessor() : q_(&q1_), isProcessing_(false) {}
+		void onPost(message_base* msg)
+		{
+			assert(msg);
+			q_->push_back(msg); //@todo sort by msg type!?
+		}
+		void processMessages()
+		{
+			assert( !isProcessing_ );
+			isProcessing_ = true;
+			msg_q* procQ = q_;
+			q_ = (q_ == &q1_) ? &q2_ : &q1_;
+			for (msg_q::const_iterator it = procQ->begin(); it != procQ->end(); ++it)
+			{
+				message_base* msg = *it;
+				assert( msg );
+				this->process(msg);
+			}
+			procQ->clear();
+			isProcessing_ = false;
+		}
+	private:
+		typedef std::deque<message_base*> msg_q;
+		msg_q		q1_,q2_;
+		msg_q*	q_;
+		bool		isProcessing_;
+	};
+
+MSG_NAMESPACE_END
+
+#endif

Added: trunk/yake/yake/msg/router.h
===================================================================
--- trunk/yake/yake/msg/router.h	2006-03-12 22:16:28 UTC (rev 1259)
+++ trunk/yake/yake/msg/router.h	2006-03-12 22:18:54 UTC (rev 1260)
@@ -0,0 +1,75 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#ifndef YAKE_MSG_ROUTER_H
+#define YAKE_MSG_ROUTER_H
+
+#include "yake/msg/prerequisites.h"
+
+MSG_NAMESPACE_BEGIN
+
+	template<typename T_processor>
+	struct router : public T_processor
+	{
+		router();
+
+		template<typename T>
+		void postMessage(const T& v)
+		{ this->post( MSG_NAMESPACE::makeMessage(v) ); }
+
+		void post(message_base* msg)
+		{
+			this->onPost(msg);
+		}
+
+
+		router& operator << (listener_base*);
+
+	private:
+		// disallow:
+		router(const router&);
+		router& operator=(const router&);
+		//...
+	private:
+		typedef detail::listener_list listener_list;
+		typedef detail::listener_map listener_map;
+	};
+	template<typename T_processor>
+	router<T_processor>::router()
+	{}
+	template<typename T_processor>
+	router<T_processor>& router<T_processor>::operator << (listener_base* l)
+	{
+		assert(l);
+		if (!l)
+			return *this;
+		this->add(l);
+		return *this;
+	}
+
+MSG_NAMESPACE_END
+
+#endif

Added: trunk/yake/yake/msg/yakeMessage.h
===================================================================
--- trunk/yake/yake/msg/yakeMessage.h	2006-03-12 22:16:28 UTC (rev 1259)
+++ trunk/yake/yake/msg/yakeMessage.h	2006-03-12 22:18:54 UTC (rev 1260)
@@ -0,0 +1,37 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#ifndef YAKE_MESSAGE_H
+#define YAKE_MESSAGE_H
+
+#include "yake/msg/prerequisites.h"
+#include "yake/msg/message.h"
+#include "yake/msg/listener.h"
+#include "yake/msg/listener_mgr.h"
+#include "yake/msg/router.h"
+#include "yake/msg/processors.h"
+
+#endif



From codeandroid at berlios.de  Sun Mar 12 23:20:08 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:20:08 +0100
Subject: [Yake-svn] r1261 - trunk/yake/yake/ent
Message-ID: <200603122220.k2CMK8XQ013315@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:20:06 +0100 (Sun, 12 Mar 2006)
New Revision: 1261

Modified:
   trunk/yake/yake/ent/component.h
   trunk/yake/yake/ent/component_holder.h
   trunk/yake/yake/ent/ent.h
   trunk/yake/yake/ent/object.h
   trunk/yake/yake/ent/object_listener.h
   trunk/yake/yake/ent/object_mgr.h
   trunk/yake/yake/ent/object_mgr_listener.h
   trunk/yake/yake/ent/pch.h
   trunk/yake/yake/ent/prerequisites.h
   trunk/yake/yake/ent/vm_holder.h
Log:
added license text

Modified: trunk/yake/yake/ent/component.h
===================================================================
--- trunk/yake/yake/ent/component.h	2006-03-12 22:18:54 UTC (rev 1260)
+++ trunk/yake/yake/ent/component.h	2006-03-12 22:20:06 UTC (rev 1261)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #ifndef YAKE_ENT_OBJECT_COMPONENT_H
 #define YAKE_ENT_OBJECT_COMPONENT_H
 

Modified: trunk/yake/yake/ent/component_holder.h
===================================================================
--- trunk/yake/yake/ent/component_holder.h	2006-03-12 22:18:54 UTC (rev 1260)
+++ trunk/yake/yake/ent/component_holder.h	2006-03-12 22:20:06 UTC (rev 1261)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #ifndef YAKE_ENT_COMPONENT_HOLDER_H
 #define YAKE_ENT_COMPONENT_HOLDER_H
 

Modified: trunk/yake/yake/ent/ent.h
===================================================================
--- trunk/yake/yake/ent/ent.h	2006-03-12 22:18:54 UTC (rev 1260)
+++ trunk/yake/yake/ent/ent.h	2006-03-12 22:20:06 UTC (rev 1261)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #ifndef YAKE_ENT_H
 #define YAKE_ENT_H
 

Modified: trunk/yake/yake/ent/object.h
===================================================================
--- trunk/yake/yake/ent/object.h	2006-03-12 22:18:54 UTC (rev 1260)
+++ trunk/yake/yake/ent/object.h	2006-03-12 22:20:06 UTC (rev 1261)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #ifndef YAKE_ENT_OBJECT_H
 #define YAKE_ENT_OBJECT_H
 

Modified: trunk/yake/yake/ent/object_listener.h
===================================================================
--- trunk/yake/yake/ent/object_listener.h	2006-03-12 22:18:54 UTC (rev 1260)
+++ trunk/yake/yake/ent/object_listener.h	2006-03-12 22:20:06 UTC (rev 1261)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #ifndef YAKE_ENT_OBJECTLISTENER_H
 #define YAKE_ENT_OBJECTLISTENER_H
 

Modified: trunk/yake/yake/ent/object_mgr.h
===================================================================
--- trunk/yake/yake/ent/object_mgr.h	2006-03-12 22:18:54 UTC (rev 1260)
+++ trunk/yake/yake/ent/object_mgr.h	2006-03-12 22:20:06 UTC (rev 1261)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #ifndef YAKE_ENT_OBJECTMANAGER_H
 #define YAKE_ENT_OBJECTMANAGER_H
 

Modified: trunk/yake/yake/ent/object_mgr_listener.h
===================================================================
--- trunk/yake/yake/ent/object_mgr_listener.h	2006-03-12 22:18:54 UTC (rev 1260)
+++ trunk/yake/yake/ent/object_mgr_listener.h	2006-03-12 22:20:06 UTC (rev 1261)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #ifndef YAKE_ENT_OBJECTMANAGERLISTENER_H
 #define YAKE_ENT_OBJECTMANAGERLISTENER_H
 

Modified: trunk/yake/yake/ent/pch.h
===================================================================
--- trunk/yake/yake/ent/pch.h	2006-03-12 22:18:54 UTC (rev 1260)
+++ trunk/yake/yake/ent/pch.h	2006-03-12 22:20:06 UTC (rev 1261)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #ifndef YAKE_ENT_PCH_H
 #define YAKE_ENT_PCH_H
 

Modified: trunk/yake/yake/ent/prerequisites.h
===================================================================
--- trunk/yake/yake/ent/prerequisites.h	2006-03-12 22:18:54 UTC (rev 1260)
+++ trunk/yake/yake/ent/prerequisites.h	2006-03-12 22:20:06 UTC (rev 1261)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #ifndef YAKE_OBJECT_PREREQUISITES_H
 #define YAKE_OBJECT_PREREQUISITES_H
 

Modified: trunk/yake/yake/ent/vm_holder.h
===================================================================
--- trunk/yake/yake/ent/vm_holder.h	2006-03-12 22:18:54 UTC (rev 1260)
+++ trunk/yake/yake/ent/vm_holder.h	2006-03-12 22:20:06 UTC (rev 1261)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #ifndef YAKE_ENT_VMHOLDER_H
 #define YAKE_ENT_VMHOLDER_H
 



From codeandroid at berlios.de  Sun Mar 12 23:20:27 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:20:27 +0100
Subject: [Yake-svn] r1262 - trunk/yake/src/yake/ent
Message-ID: <200603122220.k2CMKRkE013388@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:20:27 +0100 (Sun, 12 Mar 2006)
New Revision: 1262

Modified:
   trunk/yake/src/yake/ent/component.cpp
   trunk/yake/src/yake/ent/component_holder.cpp
   trunk/yake/src/yake/ent/object.cpp
   trunk/yake/src/yake/ent/object_listener.cpp
   trunk/yake/src/yake/ent/object_mgr.cpp
   trunk/yake/src/yake/ent/object_mgr_listener.cpp
   trunk/yake/src/yake/ent/pch.cpp
   trunk/yake/src/yake/ent/vm_holder.cpp
Log:
added license text

Modified: trunk/yake/src/yake/ent/component.cpp
===================================================================
--- trunk/yake/src/yake/ent/component.cpp	2006-03-12 22:20:06 UTC (rev 1261)
+++ trunk/yake/src/yake/ent/component.cpp	2006-03-12 22:20:27 UTC (rev 1262)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #include "yake/ent/pch.h"
 #include "yake/ent/ent.h"
 

Modified: trunk/yake/src/yake/ent/component_holder.cpp
===================================================================
--- trunk/yake/src/yake/ent/component_holder.cpp	2006-03-12 22:20:06 UTC (rev 1261)
+++ trunk/yake/src/yake/ent/component_holder.cpp	2006-03-12 22:20:27 UTC (rev 1262)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #include "yake/ent/pch.h"
 #include "yake/ent/ent.h"
 

Modified: trunk/yake/src/yake/ent/object.cpp
===================================================================
--- trunk/yake/src/yake/ent/object.cpp	2006-03-12 22:20:06 UTC (rev 1261)
+++ trunk/yake/src/yake/ent/object.cpp	2006-03-12 22:20:27 UTC (rev 1262)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #include "yake/ent/pch.h"
 #include "yake/ent/ent.h"
 

Modified: trunk/yake/src/yake/ent/object_listener.cpp
===================================================================
--- trunk/yake/src/yake/ent/object_listener.cpp	2006-03-12 22:20:06 UTC (rev 1261)
+++ trunk/yake/src/yake/ent/object_listener.cpp	2006-03-12 22:20:27 UTC (rev 1262)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #include "yake/ent/pch.h"
 #include "yake/ent/ent.h"
 

Modified: trunk/yake/src/yake/ent/object_mgr.cpp
===================================================================
--- trunk/yake/src/yake/ent/object_mgr.cpp	2006-03-12 22:20:06 UTC (rev 1261)
+++ trunk/yake/src/yake/ent/object_mgr.cpp	2006-03-12 22:20:27 UTC (rev 1262)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #include "yake/ent/pch.h"
 #include "yake/ent/ent.h"
 

Modified: trunk/yake/src/yake/ent/object_mgr_listener.cpp
===================================================================
--- trunk/yake/src/yake/ent/object_mgr_listener.cpp	2006-03-12 22:20:06 UTC (rev 1261)
+++ trunk/yake/src/yake/ent/object_mgr_listener.cpp	2006-03-12 22:20:27 UTC (rev 1262)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #include "yake/ent/pch.h"
 #include "yake/ent/ent.h"
 

Modified: trunk/yake/src/yake/ent/pch.cpp
===================================================================
--- trunk/yake/src/yake/ent/pch.cpp	2006-03-12 22:20:06 UTC (rev 1261)
+++ trunk/yake/src/yake/ent/pch.cpp	2006-03-12 22:20:27 UTC (rev 1262)
@@ -1 +1,27 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #include "yake/ent/pch.h"

Modified: trunk/yake/src/yake/ent/vm_holder.cpp
===================================================================
--- trunk/yake/src/yake/ent/vm_holder.cpp	2006-03-12 22:20:06 UTC (rev 1261)
+++ trunk/yake/src/yake/ent/vm_holder.cpp	2006-03-12 22:20:27 UTC (rev 1262)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #include "yake/ent/pch.h"
 #include "yake/ent/ent.h"
 



From codeandroid at berlios.de  Sun Mar 12 23:20:38 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:20:38 +0100
Subject: [Yake-svn] r1263 - trunk/yake/src/yake/plugins/entLua
Message-ID: <200603122220.k2CMKcL1013448@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:20:38 +0100 (Sun, 12 Mar 2006)
New Revision: 1263

Modified:
   trunk/yake/src/yake/plugins/entLua/entLua.cpp
Log:
added license text

Modified: trunk/yake/src/yake/plugins/entLua/entLua.cpp
===================================================================
--- trunk/yake/src/yake/plugins/entLua/entLua.cpp	2006-03-12 22:20:27 UTC (rev 1262)
+++ trunk/yake/src/yake/plugins/entLua/entLua.cpp	2006-03-12 22:20:38 UTC (rev 1263)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #include "yake/base/yake.h"
 #include "yake/plugins/entLua/entLua.h"
 #include "yake/plugins/scriptingLua/ScriptingSystemLua.h"



From codeandroid at berlios.de  Sun Mar 12 23:20:49 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:20:49 +0100
Subject: [Yake-svn] r1264 - trunk/yake/yake/plugins/entLua
Message-ID: <200603122220.k2CMKn2u013504@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:20:49 +0100 (Sun, 12 Mar 2006)
New Revision: 1264

Modified:
   trunk/yake/yake/plugins/entLua/entLua.h
Log:
added license text

Modified: trunk/yake/yake/plugins/entLua/entLua.h
===================================================================
--- trunk/yake/yake/plugins/entLua/entLua.h	2006-03-12 22:20:38 UTC (rev 1263)
+++ trunk/yake/yake/plugins/entLua/entLua.h	2006-03-12 22:20:49 UTC (rev 1264)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #ifndef YAKE_ENTLUA_H
 #define YAKE_ENTLUA_H
 



From codeandroid at berlios.de  Sun Mar 12 23:30:43 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:30:43 +0100
Subject: [Yake-svn] r1265 - trunk/yake/yake/physics
Message-ID: <200603122230.k2CMUhGN014178@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:30:42 +0100 (Sun, 12 Mar 2006)
New Revision: 1265

Modified:
   trunk/yake/yake/physics/yakePhysicsPrerequisites.h
Log:
removed listener

Modified: trunk/yake/yake/physics/yakePhysicsPrerequisites.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsPrerequisites.h	2006-03-12 22:20:49 UTC (rev 1264)
+++ trunk/yake/yake/physics/yakePhysicsPrerequisites.h	2006-03-12 22:30:42 UTC (rev 1265)
@@ -44,34 +44,6 @@
 	typedef Deque<CLASS##Ptr> CLASS##PtrList;
 
 namespace yake {
-	/** @todo move out */
-	template<class ListenerType>
-		class ListenerManager
-		{
-		private:
-			typedef Deque<ListenerType*> ListenerPtrList;
-			ListenerPtrList	mListeners;
-		public:
-			virtual ~ListenerManager()
-			{
-				ConstDequeIterator<ListenerPtrList> it(mListeners);
-				while (it.hasMoreElements())
-					delete it.getNext();
-			}
-
-			void pushListener(ListenerType* pListener)
-			{
-				if (pListener)
-					mListeners.push_back( pListener );
-			}
-			void removeListener(ListenerType* pListener)
-			{
-				typename ListenerPtrList::iterator itFind = std::find( mListeners.begin(), mListeners.end(), pListener );
-				if (itFind != mListeners.end())
-					mListeners.erase( itFind );
-			}
-		};
-
 namespace physics {
 	typedef ::yake::uint32 TriangleMeshId;
 	const TriangleMeshId kTriangleMeshIdNone = 0xFFFFFFFF;



From codeandroid at berlios.de  Sun Mar 12 23:31:32 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 12 Mar 2006 23:31:32 +0100
Subject: [Yake-svn] r1266 - trunk/yake/yake/physics
Message-ID: <200603122231.k2CMVWtK014233@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-12 23:31:32 +0100 (Sun, 12 Mar 2006)
New Revision: 1266

Modified:
   trunk/yake/yake/physics/yakePhysicsBody.h
Log:
now using tagged listener manager

Modified: trunk/yake/yake/physics/yakePhysicsBody.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsBody.h	2006-03-12 22:30:42 UTC (rev 1265)
+++ trunk/yake/yake/physics/yakePhysicsBody.h	2006-03-12 22:31:32 UTC (rev 1266)
@@ -30,6 +30,7 @@
 #ifndef YAKE_PHYSICS_PREQREQUISITES_H
 #	include <yake/physics/yakePhysicsPrerequisites.h>
 #endif
+#include <yake/base/yakeTaggedListenerManager.h>
 
 namespace yake {
 	using namespace ::yake::math;



From codeandroid at berlios.de  Mon Mar 13 00:12:38 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Mon, 13 Mar 2006 00:12:38 +0100
Subject: [Yake-svn] r1267 - trunk/yake/yapp/base
Message-ID: <200603122312.k2CNCcKX016852@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-13 00:12:37 +0100 (Mon, 13 Mar 2006)
New Revision: 1267

Modified:
   trunk/yake/yapp/base/yapp.h
Log:
remove deprecated fsm

Modified: trunk/yake/yapp/base/yapp.h
===================================================================
--- trunk/yake/yapp/base/yapp.h	2006-03-12 22:31:32 UTC (rev 1266)
+++ trunk/yake/yapp/base/yapp.h	2006-03-12 23:12:37 UTC (rev 1267)
@@ -38,7 +38,6 @@
 #include <yapp/model/yakeModel.h>
 #include <yapp/model/yakeComplexModel.h>
 #include <yapp/base/event/yakeEvent.h>
-#include <yapp/statemachine/yakeFiniteStateMachine.h>
 #include <yapp/base/yakeTask.h>
 #include <yapp/model/yakeModelMovableLink.h>
 /*



From codeandroid at berlios.de  Mon Mar 13 00:13:03 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Mon, 13 Mar 2006 00:13:03 +0100
Subject: [Yake-svn] r1268 - in trunk/yake/scripts/msvc8: . plugins/ent samples samples/msg
Message-ID: <200603122313.k2CND3MR016890@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-13 00:13:03 +0100 (Mon, 13 Mar 2006)
New Revision: 1268

Added:
   trunk/yake/scripts/msvc8/samples/msg/
   trunk/yake/scripts/msvc8/samples/msg/sampleMsg1.vcproj
Modified:
   trunk/yake/scripts/msvc8/plugins/ent/entLua.vcproj
   trunk/yake/scripts/msvc8/yake.sln
Log:


Modified: trunk/yake/scripts/msvc8/plugins/ent/entLua.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/plugins/ent/entLua.vcproj	2006-03-12 23:12:37 UTC (rev 1267)
+++ trunk/yake/scripts/msvc8/plugins/ent/entLua.vcproj	2006-03-12 23:13:03 UTC (rev 1268)
@@ -63,7 +63,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="ent2.lib scripting.lib scriptingLua.lib luad.lib luabindd.lib"
+				AdditionalDependencies="ent.lib scripting.lib scriptingLua.lib luad.lib luabindd.lib"
 				OutputFile="$(OutDir)/$(ProjectName).dll"
 				LinkIncremental="2"
 				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/luabind/lib;../../../../dependencies/lua/lib;../../../../dependencies/lib"
@@ -145,7 +145,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="ent2.lib scripting.lib scriptingLua.lib lua.lib luabind.lib"
+				AdditionalDependencies="ent.lib scripting.lib scriptingLua.lib lua.lib luabind.lib"
 				OutputFile="$(OutDir)/$(ProjectName).dll"
 				LinkIncremental="1"
 				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/luabind/lib;../../../../dependencies/lua/lib;../../../../dependencies/lib"

Added: trunk/yake/scripts/msvc8/samples/msg/sampleMsg1.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/msg/sampleMsg1.vcproj	2006-03-12 23:12:37 UTC (rev 1267)
+++ trunk/yake/scripts/msvc8/samples/msg/sampleMsg1.vcproj	2006-03-12 23:13:03 UTC (rev 1268)
@@ -0,0 +1,199 @@
+<?xml version="1.0" encoding="Windows-1252"?>
+<VisualStudioProject
+	ProjectType="Visual C++"
+	Version="8,00"
+	Name="sampleMsg1"
+	ProjectGUID="{452438E8-F03B-47B9-984B-2CF79D2F6734}"
+	Keyword="Win32Proj"
+	>
+	<Platforms>
+		<Platform
+			Name="Win32"
+		/>
+	</Platforms>
+	<ToolFiles>
+	</ToolFiles>
+	<Configurations>
+		<Configuration
+			Name="Debug|Win32"
+			OutputDirectory="../../../../common/bin/debug"
+			IntermediateDirectory="../../../../common/obj/debug/$(ProjectName)"
+			ConfigurationType="1"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="0"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				Optimization="0"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
+				PreprocessorDefinitions="WIN32;_DEBUG;_CONSOLE"
+				MinimalRebuild="true"
+				BasicRuntimeChecks="3"
+				RuntimeLibrary="3"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="0"
+				PrecompiledHeaderThrough="yapp/samples/base/vehicle/yakePCH.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="4"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib"
+				OutputFile="$(OutDir)/$(ProjectName).exe"
+				LinkIncremental="2"
+				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/lib"
+				GenerateDebugInformation="true"
+				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
+				SubSystem="1"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+		<Configuration
+			Name="Release|Win32"
+			OutputDirectory="../../../../common/bin/release"
+			IntermediateDirectory="../../../../common/obj/release/$(ProjectName)"
+			ConfigurationType="1"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="0"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
+				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE"
+				RuntimeLibrary="2"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="0"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="3"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib"
+				OutputFile="$(OutDir)/$(ProjectName).exe"
+				LinkIncremental="1"
+				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"
+				GenerateDebugInformation="false"
+				SubSystem="1"
+				OptimizeReferences="2"
+				EnableCOMDATFolding="2"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+	</Configurations>
+	<References>
+	</References>
+	<Files>
+		<Filter
+			Name="inc"
+			>
+		</Filter>
+		<Filter
+			Name="src"
+			>
+			<File
+				RelativePath="..\..\..\..\src\yake\samples\msg\sampleMsg1\demo.cpp"
+				>
+			</File>
+		</Filter>
+	</Files>
+	<Globals>
+	</Globals>
+</VisualStudioProject>

Modified: trunk/yake/scripts/msvc8/yake.sln
===================================================================
--- trunk/yake/scripts/msvc8/yake.sln	2006-03-12 23:12:37 UTC (rev 1267)
+++ trunk/yake/scripts/msvc8/yake.sln	2006-03-12 23:13:03 UTC (rev 1268)
@@ -9,8 +9,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "graphicsOGRE", "plugins\graphics\graphicsOgre.vcproj", "{A2C2A0B2-2EB0-4254-891D-FE93466809CF}"
 	ProjectSection(ProjectDependencies) = postProject
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "physics", "physics.vcproj", "{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}"
@@ -20,8 +20,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "physicsODE", "plugins\physics\physicsODE.vcproj", "{2F5124AA-56BD-4909-811A-E79901978C86}"
 	ProjectSection(ProjectDependencies) = postProject
+		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
 		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
-		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "input", "input.vcproj", "{1AF3930A-4E72-4455-AFD0-6B78684105CD}"
@@ -31,8 +31,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "inputOGRE", "plugins\input\inputOgre.vcproj", "{A1A2FE19-7B7E-42F1-808B-8FA5B6AA697E}"
 	ProjectSection(ProjectDependencies) = postProject
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 		{1AF3930A-4E72-4455-AFD0-6B78684105CD} = {1AF3930A-4E72-4455-AFD0-6B78684105CD}
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "scripting", "scripting.vcproj", "{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}"
@@ -42,8 +42,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "scriptingLua", "plugins\scripting\scriptingLua.vcproj", "{41CEA11B-9678-43E5-B2F4-754944D7B461}"
 	ProjectSection(ProjectDependencies) = postProject
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "data", "data.vcproj", "{77A59B89-C2B3-429C-8317-ADE0D046CC3B}"
@@ -53,8 +53,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "scriptingBindingsLua", "plugins\scripting\scriptingLuaBindings.vcproj", "{CA63F621-0912-4551-B51A-7BD18F491181}"
 	ProjectSection(ProjectDependencies) = postProject
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 		{41CEA11B-9678-43E5-B2F4-754944D7B461} = {41CEA11B-9678-43E5-B2F4-754944D7B461}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "audio", "audio.vcproj", "{42BB6F78-B04C-4968-AA5E-271DC45BEFBB}"
@@ -74,26 +74,26 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "graphicsBindingsLua", "plugins\scripting\graphicsLuaBindings.vcproj", "{2D5E8A7F-96DA-4CC5-BFC8-430916ACF18A}"
 	ProjectSection(ProjectDependencies) = postProject
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
+		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
 		{41CEA11B-9678-43E5-B2F4-754944D7B461} = {41CEA11B-9678-43E5-B2F4-754944D7B461}
-		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "baseBindingsLua", "plugins\scripting\baseLuaBindings.vcproj", "{3867E9A4-41F3-4969-B0A8-40757BCB6C29}"
 	ProjectSection(ProjectDependencies) = postProject
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 		{41CEA11B-9678-43E5-B2F4-754944D7B461} = {41CEA11B-9678-43E5-B2F4-754944D7B461}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "yapp", "yapp.vcproj", "{F1116FDF-65C1-4788-AC1F-F339279B937A}"
 	ProjectSection(ProjectDependencies) = postProject
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
+		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
+		{42BB6F78-B04C-4968-AA5E-271DC45BEFBB} = {42BB6F78-B04C-4968-AA5E-271DC45BEFBB}
+		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
 		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
-		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
-		{42BB6F78-B04C-4968-AA5E-271DC45BEFBB} = {42BB6F78-B04C-4968-AA5E-271DC45BEFBB}
-		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "raf", "raf.vcproj", "{6D6DD5E8-3B81-4C98-B460-B434DEE23EE2}"
@@ -124,9 +124,14 @@
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "msg2", "msg2.vcproj", "{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "entLua", "plugins\ent\entLua.vcproj", "{89182311-DB82-446B-AA9B-C70A3A0AF035}"
+	ProjectSection(ProjectDependencies) = postProject
+		{08BC40D8-33D8-4677-993A-32599A93A460} = {08BC40D8-33D8-4677-993A-32599A93A460}
+	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "ent", "ent.vcproj", "{08BC40D8-33D8-4677-993A-32599A93A460}"
 EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleMsg1", "samples\msg\sampleMsg1.vcproj", "{452438E8-F03B-47B9-984B-2CF79D2F6734}"
+EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) = preSolution
 		Debug|Win32 = Debug|Win32
@@ -247,6 +252,10 @@
 		{08BC40D8-33D8-4677-993A-32599A93A460}.Debug|Win32.Build.0 = Debug|Win32
 		{08BC40D8-33D8-4677-993A-32599A93A460}.Release|Win32.ActiveCfg = Release|Win32
 		{08BC40D8-33D8-4677-993A-32599A93A460}.Release|Win32.Build.0 = Release|Win32
+		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Debug|Win32.ActiveCfg = Debug|Win32
+		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Debug|Win32.Build.0 = Debug|Win32
+		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Release|Win32.ActiveCfg = Release|Win32
+		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Release|Win32.Build.0 = Release|Win32
 	EndGlobalSection
 	GlobalSection(SolutionProperties) = preSolution
 		HideSolutionNode = FALSE



From codeandroid at berlios.de  Mon Mar 13 00:13:51 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Mon, 13 Mar 2006 00:13:51 +0100
Subject: [Yake-svn] r1269 - trunk/yake/scripts/msvc8
Message-ID: <200603122313.k2CNDpHe016963@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-13 00:13:51 +0100 (Mon, 13 Mar 2006)
New Revision: 1269

Removed:
   trunk/yake/scripts/msvc8/ent2.vcproj
Log:
yapp/ent replaced by yake/ent

Deleted: trunk/yake/scripts/msvc8/ent2.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/ent2.vcproj	2006-03-12 23:13:03 UTC (rev 1268)
+++ trunk/yake/scripts/msvc8/ent2.vcproj	2006-03-12 23:13:51 UTC (rev 1269)
@@ -1,292 +0,0 @@
-<?xml version="1.0" encoding="Windows-1252"?>
-<VisualStudioProject
-	ProjectType="Visual C++"
-	Version="8,00"
-	Name="ent"
-	ProjectGUID="{08BC40D8-33D8-4677-993A-32599A93A460}"
-	RootNamespace="yapp"
-	Keyword="Win32Proj"
-	>
-	<Platforms>
-		<Platform
-			Name="Win32"
-		/>
-	</Platforms>
-	<ToolFiles>
-	</ToolFiles>
-	<Configurations>
-		<Configuration
-			Name="Debug|Win32"
-			OutputDirectory="../../common/bin/$(ConfigurationName)"
-			IntermediateDirectory="../../common/obj/$(ConfigurationName)/$(ProjectName)"
-			ConfigurationType="2"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				Optimization="0"
-				AdditionalIncludeDirectories="../../;../../dependencies;../../dependencies/boost;../../dependencies/ttl"
-				PreprocessorDefinitions="_STLP_DEBUG;WIN32;_DEBUG;_CONSOLE;YAKE_ENT_EXPORTS"
-				MinimalRebuild="true"
-				BasicRuntimeChecks="3"
-				RuntimeLibrary="3"
-				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
-				PrecompiledHeaderThrough="yake/ent/pch.h"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="4"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib physics.lib data.lib"
-				OutputFile="$(OutDir)/$(ProjectName).dll"
-				LinkIncremental="2"
-				AdditionalLibraryDirectories="../../common/lib/$(ConfigurationName);../../dependencies/lib"
-				GenerateDebugInformation="true"
-				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
-				SubSystem="1"
-				ImportLibrary="../../common/lib/$(ConfigurationName)/$(ProjectName).lib"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-		<Configuration
-			Name="Release|Win32"
-			OutputDirectory="../../common/bin/$(ConfigurationName)"
-			IntermediateDirectory="../../common/obj/$(ConfigurationName)/$(ProjectName)"
-			ConfigurationType="2"
-			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
-			CharacterSet="2"
-			>
-			<Tool
-				Name="VCPreBuildEventTool"
-			/>
-			<Tool
-				Name="VCCustomBuildTool"
-			/>
-			<Tool
-				Name="VCXMLDataGeneratorTool"
-			/>
-			<Tool
-				Name="VCWebServiceProxyGeneratorTool"
-			/>
-			<Tool
-				Name="VCMIDLTool"
-			/>
-			<Tool
-				Name="VCCLCompilerTool"
-				AdditionalIncludeDirectories="../../;../../dependencies;../../dependencies/boost;../../dependencies/ttl"
-				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE;YAKE_ENT_EXPORTS"
-				RuntimeLibrary="2"
-				RuntimeTypeInfo="true"
-				UsePrecompiledHeader="2"
-				PrecompiledHeaderThrough="yake/ent/pch.h"
-				WarningLevel="3"
-				Detect64BitPortabilityProblems="true"
-				DebugInformationFormat="3"
-			/>
-			<Tool
-				Name="VCManagedResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCResourceCompilerTool"
-			/>
-			<Tool
-				Name="VCPreLinkEventTool"
-			/>
-			<Tool
-				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib physics.lib data.lib"
-				OutputFile="$(OutDir)/$(ProjectName).dll"
-				LinkIncremental="1"
-				AdditionalLibraryDirectories="../../common/lib/$(ConfigurationName);../../dependencies/lib"
-				GenerateDebugInformation="true"
-				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
-				SubSystem="1"
-				OptimizeReferences="2"
-				EnableCOMDATFolding="2"
-				ImportLibrary="../../common/lib/$(ConfigurationName)/$(ProjectName).lib"
-				TargetMachine="1"
-			/>
-			<Tool
-				Name="VCALinkTool"
-			/>
-			<Tool
-				Name="VCManifestTool"
-			/>
-			<Tool
-				Name="VCXDCMakeTool"
-			/>
-			<Tool
-				Name="VCBscMakeTool"
-			/>
-			<Tool
-				Name="VCFxCopTool"
-			/>
-			<Tool
-				Name="VCAppVerifierTool"
-			/>
-			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
-				Name="VCPostBuildEventTool"
-			/>
-		</Configuration>
-	</Configurations>
-	<References>
-	</References>
-	<Files>
-		<Filter
-			Name="src"
-			Filter="cpp;c;cxx;def;odl;idl;hpj;bat;asm;asmx"
-			UniqueIdentifier="{115664F1-EC08-4142-B5D0-91C3C574D1EC}"
-			>
-			<File
-				RelativePath="..\..\src\yake\ent\component.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yake\ent\component_holder.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yake\ent\object.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yake\ent\object_listener.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yake\ent\object_mgr.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yake\ent\object_mgr_listener.cpp"
-				>
-			</File>
-			<File
-				RelativePath="..\..\src\yake\ent\pch.cpp"
-				>
-				<FileConfiguration
-					Name="Debug|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
-				<FileConfiguration
-					Name="Release|Win32"
-					>
-					<Tool
-						Name="VCCLCompilerTool"
-						UsePrecompiledHeader="1"
-					/>
-				</FileConfiguration>
-			</File>
-			<File
-				RelativePath="..\..\src\yake\ent\vm_holder.cpp"
-				>
-			</File>
-		</Filter>
-		<Filter
-			Name="inc"
-			Filter="h;hpp;hxx;hm;inl;inc;xsd"
-			UniqueIdentifier="{1D967178-F5B9-46f9-AA8E-78B77BB7A694}"
-			>
-			<File
-				RelativePath="..\..\yake\ent\component.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yake\ent\component_holder.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yake\ent\ent.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yake\ent\object.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yake\ent\object_listener.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yake\ent\object_mgr.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yake\ent\object_mgr_listener.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yake\ent\pch.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yake\ent\prerequisites.h"
-				>
-			</File>
-			<File
-				RelativePath="..\..\yake\ent\vm_holder.h"
-				>
-			</File>
-		</Filter>
-	</Files>
-	<Globals>
-	</Globals>
-</VisualStudioProject>



From codeandroid at berlios.de  Wed Mar 15 21:02:53 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:02:53 +0100
Subject: [Yake-svn] r1270 - trunk/yake/yake/statemachine
Message-ID: <200603152002.k2FK2rL1004191@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:02:26 +0100 (Wed, 15 Mar 2006)
New Revision: 1270

Modified:
   trunk/yake/yake/statemachine/fsm_core.h
Log:
added license + comments

Modified: trunk/yake/yake/statemachine/fsm_core.h
===================================================================
--- trunk/yake/yake/statemachine/fsm_core.h	2006-03-12 23:13:51 UTC (rev 1269)
+++ trunk/yake/yake/statemachine/fsm_core.h	2006-03-15 20:02:26 UTC (rev 1270)
@@ -1,3 +1,29 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
 #ifndef FSM_CORE_H
 #define FSM_CORE_H
 
@@ -24,27 +50,39 @@
 
 namespace fsm {
 #if defined(FSM_USE_NULL_STATE)
+	/** Returns the state representing a 'null state' for a given type (as template parameter).
+		This function can be specialized for custom types. Specializations for common types are
+		provided (string, int ...).
+		See the documentation of machine<> for more information on null states.
+		@see machine<>
+	*/
 	template<typename state_type_>
 	const state_type_& get_null_state();
 
+	/** Returns whether a state is equal to the null state for this type.
+		This function can be specialized for custom types when necessary.
+	*/
 	template<typename state_type_>
 	inline bool is_state_null(const state_type_& state)
 	{
 		return (state == get_null_state<state_type_>());
 	}
 
+	/** Specialization for 'int'. */
 	template<>
 	inline const int& get_null_state()
 	{
 		static int ms_null = 0xffffffff;
 		return ms_null;
 	}
+	/** Specialization for 'unsigned char'. */
 	template<>
 	inline const unsigned char& get_null_state()
 	{
 		static unsigned char ms_null = 0xff;
 		return ms_null;
 	}
+	/** Specialization for 'std::string'. */
 	template<>
 	inline const std::string& get_null_state()
 	{
@@ -52,12 +90,14 @@
 		return ms_null;
 	}
 #endif
+	/** Generic operator object with a single parameter that does nothing (as the name implies). */
 	template<typename T1>
 	struct do_nothing_on_one
 	{
 		void operator()(const T1&)
 		{}
 	};
+	/** Generic operator object with two parameters that does nothing (as the name implies). */
 	template<typename T1, typename T2>
 	struct do_nothing_on_two
 	{
@@ -65,39 +105,78 @@
 		{}
 	};
 
+	/** Basic generic finite state machine. State and event types can be configured per machine type at compile-time.
+		Machine instances are configured at run-time (i.e. states and transitions are added at run-time).
+		@Remarks boost::statechart looks like a good candidate for a compile-time only state machine.
+		@todo add findPathToState() which finds a transition path from the current to the specified destination state
+				and enables the client to execute processEvent() for each event in the path.
+		@see oomachine
+	*/
 	template<typename _state_type, typename _event_type>
 	struct machine
 	{
 		// types
+
+		/** Type of this machine's states. */
 		typedef _state_type state_type;
+
+		/** Type of this machine's events. */
 		typedef _event_type event_type;
+
+		/** Type to self. */
 		typedef machine machine_type;
 
+		/** Do nothing operation - used as default in processEvent(). */
 		typedef do_nothing_on_one<state_type> do_nothing_state_op;
+
+		/** Do nothing operation - used as default in processEvent(). */
 		typedef do_nothing_on_two<machine_type,state_type> do_nothing_op;
 
 		// construction
 #if defined(FSM_USE_NULL_STATE)
+		/** Constructs a machine. Sets the current state to the state type's null state. */
 		machine() : 
 			curr_(get_null_state<state_type>()) 
 #else
+		/** Constructs a machine. */
 		machine()
 #endif
 		{}
 
 		// operations
+
+		/** Add a state.
+			@Remarks Client code has to take care that the machine is in a valid state when events are processed.
+		*/
 		void addState(const state_type&);
 		//? void addEvent(const event_type);
+
+		/** Add a transition.
+			@Remarks Client code has to take care that the machine is in a valid state when events are processed.
+		*/
 		void addTransition(const state_type&, const event_type&, const state_type&);
+
+		/** Explicitely set the current state.
+			A call to this function can be useful if the initial state has to be set explicitely. By default (if null
+			states are enabled) the initial state is the null state and a transition from a null state to a custom
+			state added with addState() has to be specified by the client code.
+		*/
 		void setState(const state_type&);
 
+		/** Clears the machine, i.e. removes all states and transitions.
+		*/
 		void clear();
 
+		/** Returns the number of states that have been added with addState(). */
 		size_t numStates() const;
+		/** Returns the number of outgoing transitions for a specific state. */
 		size_t numOffgoingTransitions(const state_type&) const; // off-going transitions for source state
+
+		/** Returns a reference to the current state. */
 		const state_type& current() const;
 
 #ifdef _DEBUG
+		/** DEBUG-ONLY function for dumping the machine contents to a std::ostream object. */
 		void dump(std::ostream& out) const
 		{
 			out << "machine<>::dump()\n";
@@ -114,14 +193,24 @@
 		}
 #endif
 
+		/** This method validates the machine by making sure that states and transitions are properly connected, i.e.
+			it finds unconnected states and invalid transitions.
+			@todo implement!
+		*/
 		std::pair<bool,std::string> validate();
 
+		/** Processes the given event thereby triggering a transition from the current state to the transition's target state.
+			If no transition can be found for the combination of currently active state and given event, the method returns without doing anything.
+		*/
 		void processEvent(const event_type& evt)
 		{
 			do_nothing_op do_nothing;
 			processEventCb(evt, do_nothing, do_nothing);
 		}
 
+		/** Same as processEvent but this method allows to provide custom callbacks for 'enter state' and 'exit state' calls.
+			@copydoc processEvent
+		*/
 		template<typename enter_state_op_t, typename exit_state_op_t>
 		void processEventCb(const event_type& evt, enter_state_op_t& enterOp, exit_state_op_t& exitOp)
 		{



From codeandroid at berlios.de  Wed Mar 15 21:03:30 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:03:30 +0100
Subject: [Yake-svn] r1271 - trunk/yake/yake/statemachine
Message-ID: <200603152003.k2FK3UWx004282@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:03:29 +0100 (Wed, 15 Mar 2006)
New Revision: 1271

Added:
   trunk/yake/yake/statemachine/fsm_oo_machine.h
Log:
initial revision

Added: trunk/yake/yake/statemachine/fsm_oo_machine.h
===================================================================
--- trunk/yake/yake/statemachine/fsm_oo_machine.h	2006-03-15 20:02:26 UTC (rev 1270)
+++ trunk/yake/yake/statemachine/fsm_oo_machine.h	2006-03-15 20:03:29 UTC (rev 1271)
@@ -0,0 +1,102 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright (c) The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#ifndef FSM_OOMACHINE_H
+#define FSM_OOMACHINE_H
+
+#include "yake/statemachine/fsm_core.h"
+
+namespace fsm {
+
+	template<typename _state_class_type /*= oostate */, typename _event_type>
+	struct oomachine
+	{
+		typedef _event_type event_type;
+		typedef _state_class_type* state_type;
+
+		oomachine() :
+			fnEnter_( boost::bind(&oomachine::onEnter,this,_1,_2) ),
+			fnExit_( boost::bind(&oomachine::onExit,this,_1,_2) )
+		{
+		}
+
+		void addState(const state_type);
+		void addTransition(const state_type, const event_type&, const state_type);
+		void setState(const state_type);
+		void processEvent(const event_type& evt);
+		const state_type& current() const
+		{ return machine_.current(); }
+	private:
+		typedef ::fsm::machine<state_type,event_type> machine_type;
+		void onEnter(machine_type&,const state_type&);
+		void onExit(machine_type&,const state_type&);
+	private:
+		machine_type			machine_;
+		typedef boost::function<void(machine_type&,const state_type&)> CbFn;
+		CbFn						fnEnter_;
+		CbFn						fnExit_;
+	};
+
+	template<typename _state_class_type, typename _event_type>
+	void oomachine<_state_class_type,_event_type>::onEnter(machine_type&,const state_type& state)
+	{
+		YAKE_ASSERT( state );
+		state->onEnter();
+	}
+	template<typename _state_class_type, typename _event_type>
+	void oomachine<_state_class_type,_event_type>::onExit(machine_type&,const state_type& state)
+	{
+		YAKE_ASSERT( state );
+		state->onExit();
+	}
+	template<typename _state_class_type, typename _event_type>
+	void oomachine<_state_class_type,_event_type>::addState(const state_type s)
+	{
+		machine_.addState(s);
+	}
+	template<typename _state_class_type, typename _event_type>
+	void oomachine<_state_class_type,_event_type>::addTransition(const state_type from, const event_type& ev, const state_type to)
+	{
+		machine_.addTransition( from, ev, to );
+	}
+	template<typename _state_class_type, typename _event_type>
+	void oomachine<_state_class_type,_event_type>::setState(const state_type s)
+	{
+		if (machine_.current())
+			fnExit_( machine_, machine_.current() );
+		fnEnter_( machine_, s );
+		machine_.setState( s );
+	}
+	template<typename _state_class_type, typename _event_type>
+	void oomachine<_state_class_type,_event_type>::processEvent(const event_type& evt)
+	{
+		YAKE_ASSERT( !fnEnter_.empty() );
+		machine_.processEventCb(evt, fnEnter_, fnExit_);
+	}
+
+} // namespace fsm
+
+#endif



From codeandroid at berlios.de  Wed Mar 15 21:05:23 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:05:23 +0100
Subject: [Yake-svn] r1272 - trunk/yake/yake/ent
Message-ID: <200603152005.k2FK5NTo004733@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:04:26 +0100 (Wed, 15 Mar 2006)
New Revision: 1272

Modified:
   trunk/yake/yake/ent/component.h
   trunk/yake/yake/ent/component_holder.h
   trunk/yake/yake/ent/object.h
Log:
renamed Co to Component,
containment instead of inheritance for Object

Modified: trunk/yake/yake/ent/component.h
===================================================================
--- trunk/yake/yake/ent/component.h	2006-03-15 20:03:29 UTC (rev 1271)
+++ trunk/yake/yake/ent/component.h	2006-03-15 20:04:26 UTC (rev 1272)
@@ -33,12 +33,10 @@
 namespace yake {
 namespace ent {
 
-	struct Co;
-
 #define DECL_CO(CLASS,DESC) \
 	DECL_CLASS_RTTI(CLASS,DESC) \
 public: \
-	static CLASS* cast(::yake::ent::Co*);
+	static CLASS* cast(::yake::ent::Component*);
 
 #define IMPL_CO(CLASS) \
 	IMPL_CLASS_RTTI(CLASS)
@@ -46,11 +44,11 @@
 #define IMPL_CO_1(CLASS,PARENT1) \
 	IMPL_CLASS_RTTI_1(CLASS,PARENT1)
 
-	struct YAKE_ENT_API Co : public PropHolder<Co>
+	struct YAKE_ENT_API Component : public PropHolder<Component>
 	{
-		virtual ~Co() {}
+		virtual ~Component() {}
 
-		DECL_CO(Co,"Component base")
+		DECL_CO(Component,"Component base")
 	public:
 	};
 

Modified: trunk/yake/yake/ent/component_holder.h
===================================================================
--- trunk/yake/yake/ent/component_holder.h	2006-03-15 20:03:29 UTC (rev 1271)
+++ trunk/yake/yake/ent/component_holder.h	2006-03-15 20:04:26 UTC (rev 1272)
@@ -36,12 +36,12 @@
 	struct YAKE_ENT_API CoHolder
 	{
 		// operations
-		void addCo(const CoTag&, Co*);
-		Co* removeCo(const Co*);
-		Co* removeCo(const CoTag&);
-		Co* getCo(const CoTag&) const;
+		void addComponent(const CoTag&, Component*);
+		Component* removeComponent(const Component*);
+		Component* removeComponent(const CoTag&);
+		Component* getComponent(const CoTag&) const;
 	private:
-		typedef std::map<CoTag,Co*> TagCoMap;
+		typedef std::map<CoTag,Component*> TagCoMap;
 		TagCoMap	components_;
 	};
 

Modified: trunk/yake/yake/ent/object.h
===================================================================
--- trunk/yake/yake/ent/object.h	2006-03-15 20:03:29 UTC (rev 1271)
+++ trunk/yake/yake/ent/object.h	2006-03-15 20:04:26 UTC (rev 1272)
@@ -83,7 +83,9 @@
 		ObjectId				id_;
 	};
 
-	struct YAKE_ENT_API Entity : public Object, public CoHolder, public VMHolder
+	/** @todo Do not publicly inherit from CoHolder and VMHolder!?
+	*/
+	struct YAKE_ENT_API Entity : public Object, public CoHolder
 	{
 		DECL_OBJECT(Entity,"Entity")
 		Entity() {}
@@ -93,6 +95,7 @@
 		typedef object_fsm::event_type fsm_event_type;
 
 		// id operations
+		
 		void setId(const ObjectId& id);
 		const ObjectId& getId() const;
 
@@ -106,6 +109,14 @@
 		{ return m_.current(); }
 
 		// VM operations
+
+		boost::signals::connection subsribeToVmAttached(const VMHolder::VmAttachedSignal::slot_type&);
+		boost::signals::connection subscribeToVmDetached(const VMHolder::VmDetachedSignal::slot_type&);
+
+		bool attachVM(scripting::IVM*,const std::string& tag);
+		scripting::IVM* detachVM(const std::string& tag);
+		scripting::IVM* getVM(const std::string& tag) const;
+
 		scripting::IVM* getFsmVM() const
 		{
 			 return this->getVM("main");
@@ -120,6 +131,7 @@
 		void onExit(const object_fsm&, const object_fsm::state_type& state);
 	private:
 		object_fsm			m_;
+		VMHolder				vms_;
 	};
 
 } // namespace ent



From codeandroid at berlios.de  Wed Mar 15 21:11:40 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:11:40 +0100
Subject: [Yake-svn] r1273 - trunk/yake/src/yake/ent
Message-ID: <200603152011.k2FKBeCb008133@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:11:38 +0100 (Wed, 15 Mar 2006)
New Revision: 1273

Modified:
   trunk/yake/src/yake/ent/component.cpp
   trunk/yake/src/yake/ent/component_holder.cpp
   trunk/yake/src/yake/ent/object.cpp
   trunk/yake/src/yake/ent/vm_holder.cpp
Log:
renamed Co to Component

Modified: trunk/yake/src/yake/ent/component.cpp
===================================================================
--- trunk/yake/src/yake/ent/component.cpp	2006-03-15 20:04:26 UTC (rev 1272)
+++ trunk/yake/src/yake/ent/component.cpp	2006-03-15 20:11:38 UTC (rev 1273)
@@ -30,7 +30,7 @@
 namespace yake {
 namespace ent {
 
-	IMPL_CLASS_RTTI(Co)
+	IMPL_CLASS_RTTI(Component)
 } // namespace object
 } // namespace yake
 

Modified: trunk/yake/src/yake/ent/component_holder.cpp
===================================================================
--- trunk/yake/src/yake/ent/component_holder.cpp	2006-03-15 20:04:26 UTC (rev 1272)
+++ trunk/yake/src/yake/ent/component_holder.cpp	2006-03-15 20:11:38 UTC (rev 1273)
@@ -30,13 +30,13 @@
 namespace yake {
 namespace ent {
 
-	void CoHolder::addCo(const CoTag& tag, Co* co)
+	void CoHolder::addComponent(const CoTag& tag, Component* co)
 	{
-		if (getCo(tag))
+		if (getComponent(tag))
 			return; //@todo throw instead?
 		components_.insert( std::make_pair(tag, co) );
 	}
-	Co* CoHolder::getCo(const CoTag& tag) const
+	Component* CoHolder::getComponent(const CoTag& tag) const
 	{
 		TagCoMap::const_iterator itFind = components_.find(tag);
 		return ((itFind == components_.end()) ? 0 : itFind->second);

Modified: trunk/yake/src/yake/ent/object.cpp
===================================================================
--- trunk/yake/src/yake/ent/object.cpp	2006-03-15 20:04:26 UTC (rev 1272)
+++ trunk/yake/src/yake/ent/object.cpp	2006-03-15 20:11:38 UTC (rev 1273)
@@ -70,5 +70,26 @@
 		//std::cout << "Entity.state.exit '" << state << "'\n";
 		listeners_fsmExitState(*this,fsm,state);
 	}
+	boost::signals::connection Entity::subsribeToVmAttached(const VMHolder::VmAttachedSignal::slot_type& slot)
+	{
+		return vms_.subsribeToVmAttached(slot);
+	}
+	boost::signals::connection Entity::subscribeToVmDetached(const VMHolder::VmDetachedSignal::slot_type& slot)
+	{
+		return vms_.subscribeToVmDetached(slot);
+	}
+	bool Entity::attachVM(scripting::IVM* vm,const std::string& tag)
+	{
+		return vms_.attachVM(vm,tag);
+	}
+	scripting::IVM* Entity::detachVM(const std::string& tag)
+	{
+		return vms_.detachVM(tag);
+	}
+	scripting::IVM* Entity::getVM(const std::string& tag) const
+	{
+		return vms_.getVM(tag);
+	}
+
 }
 }
\ No newline at end of file

Modified: trunk/yake/src/yake/ent/vm_holder.cpp
===================================================================
--- trunk/yake/src/yake/ent/vm_holder.cpp	2006-03-15 20:04:26 UTC (rev 1272)
+++ trunk/yake/src/yake/ent/vm_holder.cpp	2006-03-15 20:11:38 UTC (rev 1273)
@@ -57,6 +57,7 @@
 		if (vms_.end() != it)
 			return false;
 		vms_.insert( VmMap::value_type(tag,vm) );
+		sigAttached_(tag,vm);
 		return true;
 	}
 	scripting::IVM* VMHolder::detachVM(const std::string &tag)
@@ -70,6 +71,7 @@
 			return 0;
 		scripting::IVM* vm = it->second;
 		vms_.erase(tag);
+		sigAttached_(tag,vm);
 		return vm;
 	}
 	scripting::IVM* VMHolder::getVM(const std::string &tag) const
@@ -83,6 +85,14 @@
 			return 0;
 		return it->second;
 	}
+	boost::signals::connection VMHolder::subsribeToVmAttached(const VmAttachedSignal::slot_type& slot)
+	{
+		return sigAttached_.connect(slot);
+	}
+	boost::signals::connection VMHolder::subscribeToVmDetached(const VmDetachedSignal::slot_type& slot)
+	{
+		return sigDetached_.connect(slot);
+	}
 
 }
 }
\ No newline at end of file



From codeandroid at berlios.de  Wed Mar 15 21:12:51 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:12:51 +0100
Subject: [Yake-svn] r1274 - in trunk/yake/src/yake/samples: . statemachine statemachine/sampleFsm1
Message-ID: <200603152012.k2FKCpGm009145@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:12:50 +0100 (Wed, 15 Mar 2006)
New Revision: 1274

Added:
   trunk/yake/src/yake/samples/statemachine/
   trunk/yake/src/yake/samples/statemachine/sampleFsm1/
   trunk/yake/src/yake/samples/statemachine/sampleFsm1/demo.cpp
Log:
initial revision

Added: trunk/yake/src/yake/samples/statemachine/sampleFsm1/demo.cpp
===================================================================
--- trunk/yake/src/yake/samples/statemachine/sampleFsm1/demo.cpp	2006-03-15 20:11:38 UTC (rev 1273)
+++ trunk/yake/src/yake/samples/statemachine/sampleFsm1/demo.cpp	2006-03-15 20:12:50 UTC (rev 1274)
@@ -0,0 +1,80 @@
+//#include "yake/base/yakePrerequisites.h"
+#include "yake/base/yake.h"
+#include "yake/statemachine/fsm_core.h"
+#include "yake/statemachine/fsm_oo_machine.h"
+
+struct test_state_base
+{
+	virtual ~test_state_base() {}
+	virtual void onEnter() {}
+	virtual void onExit() {}
+};
+typedef test_state_base* test_state_base_ptr;
+//namespace yake {
+namespace fsm {
+	template<>
+	inline const test_state_base_ptr& get_null_state()
+	{ 
+		static test_state_base* ms_null = 0;
+		return ms_null; 
+	}
+}
+//}
+struct test_state : public test_state_base
+{
+	test_state(const std::string& name) : name_(name)
+	{}
+	virtual void onEnter()
+	{
+		std::cout << name_ << ".onEnter()\n";
+	}
+	virtual void onExit()
+	{
+		std::cout << name_ << ".onExit()\n";
+	}
+private:
+	std::string	name_;
+};
+
+int main(int argc, char* argv[])
+{
+	using namespace yake;
+	{  // machine demo #1 - 3 states - 2 transitions - 2 events
+		typedef fsm::machine<String,String> machine_t;
+
+		const String ksAwakening = "awakening";
+		const String ksAlive = "alive";
+		const String ksDead = "dead";
+
+		machine_t	m;
+		m.addState( ksAwakening );
+		m.addState( ksAlive );
+		m.addState( ksDead );
+		m.addTransition( ksAwakening, "spawn", ksAlive );
+		m.addTransition( ksAlive, "die", ksDead );
+		m.setState( ksAwakening ); // initial state
+
+		m.processEvent( "spawn" );
+		YAKE_LOG_INFORMATION( m.current() );
+		YAKE_ASSERT( m.current() == ksAlive );
+
+		m.processEvent( "die" );
+		YAKE_LOG_INFORMATION( m.current() );
+		YAKE_ASSERT( m.current() == ksDead );
+	}
+	{  // machine with object states with onEnter() and onExit() callback methods.
+		typedef fsm::oomachine<test_state_base,String> machine_t;
+		test_state_base* first = new test_state("first");
+		test_state_base* second = new test_state("second");
+
+		machine_t machine;
+		machine.addState( first );
+		machine.addState( second );
+		machine.setState( first );
+		machine.addTransition( first, "go", second );
+		YAKE_ASSERT( machine.current() == first );
+		machine.processEvent("go");
+		YAKE_ASSERT( machine.current() == second );
+	}
+}
+



From codeandroid at berlios.de  Wed Mar 15 21:20:25 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:20:25 +0100
Subject: [Yake-svn] r1275 - trunk/yake/src/yake/samples/ent/sampleEntFsm
Message-ID: <200603152020.k2FKKPuS013830@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:20:24 +0100 (Wed, 15 Mar 2006)
New Revision: 1275

Modified:
   trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp
Log:
initial revision

Modified: trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp
===================================================================
--- trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp	2006-03-15 20:12:50 UTC (rev 1274)
+++ trunk/yake/src/yake/samples/ent/sampleEntFsm/demo.cpp	2006-03-15 20:20:24 UTC (rev 1275)
@@ -58,15 +58,127 @@
 		scripting::IScriptingSystem&	scriptingSys_;
 	};
 
-	struct SimpleGraphicsCo : public ent::Co
+	struct SimpleGraphicsCo : public ent::Component
 	{
 		DECL_CO(SimpleGraphicsCo,"SimpleGraphicsCo")
 	};
-	IMPL_CO_1(SimpleGraphicsCo,"Co")
+	IMPL_CO_1(SimpleGraphicsCo,"Component")
 } // namespace exapp
+#ifdef OOSTATE
+struct oostate 
+{
+	virtual ~oostate() {}
+	virtual void onEnter() {}
+	virtual void onExit() {}
+};
+template<typename _state_class_type /*= oostate */, typename _event_type>
+struct oomachine
+{
+	typedef _event_type event_type;
+	typedef _state_class_type* state_type;
 
+	oomachine() :
+		fnEnter_( boost::bind(&oomachine::onEnter,this,_1,_2) ),
+		fnExit_( boost::bind(&oomachine::onExit,this,_1,_2) )
+	{
+	}
+
+	void addState(const state_type);
+	void addTransition(const state_type, const event_type&, const state_type);
+	void setState(const state_type);
+	void processEvent(const event_type& evt);
+	const state_type& getCurrentFsmState() const
+	{ return m_.current(); }
+private:
+	typedef fsm::machine<state_type,event_type> machine_type;
+	void onEnter(machine_type&,const state_type&);
+	void onExit(machine_type&,const state_type&);
+private:
+	machine_type			machine_;
+	typedef boost::function<void(machine_type&,const state_type&)> CbFn;
+	CbFn						fnEnter_;
+	CbFn						fnExit_;
+};
+template<typename _state_class_type, typename _event_type>
+void oomachine<_state_class_type,_event_type>::onEnter(machine_type&,const state_type& state)
+{
+	YAKE_ASSERT( state );
+	state->onEnter();
+}
+template<typename _state_class_type, typename _event_type>
+void oomachine<_state_class_type,_event_type>::onExit(machine_type&,const state_type& state)
+{
+	YAKE_ASSERT( state );
+	state->onExit();
+}
+template<typename _state_class_type, typename _event_type>
+void oomachine<_state_class_type,_event_type>::addState(const state_type s)
+{
+	machine_.addState(s);
+}
+template<typename _state_class_type, typename _event_type>
+void oomachine<_state_class_type,_event_type>::addTransition(const state_type from, const event_type& ev, const state_type to)
+{
+	machine_.addTransition( from, ev, to );
+}
+template<typename _state_class_type, typename _event_type>
+void oomachine<_state_class_type,_event_type>::setState(const state_type s)
+{
+	machine_.setState( s );
+}
+template<typename _state_class_type, typename _event_type>
+void oomachine<_state_class_type,_event_type>::processEvent(const event_type& evt)
+{
+	YAKE_ASSERT( !fnEnter_.empty() );
+	machine_.processEventCb(evt, fnEnter_, fnExit_);
+}
+struct test_state_base
+{
+	virtual ~test_state_base() {}
+	virtual void onEnter() {}
+	virtual void onExit() {}
+};
+typedef test_state_base* test_state_base_ptr;
+namespace fsm {
+	template<>
+	inline const test_state_base_ptr& get_null_state()
+	{ 
+		static test_state_base* ms_null = 0;
+		return ms_null; 
+	}
+}
+struct test_state : public test_state_base
+{
+	test_state(const std::string& name) : name_(name)
+	{}
+	virtual void onEnter()
+	{
+		std::cout << name_ << ".onEnter()\n";
+	}
+	virtual void onExit()
+	{
+		std::cout << name_ << ".onExit()\n";
+	}
+private:
+	std::string	name_;
+};
+void test()
+{
+	typedef oomachine<test_state_base,std::string> machine_t;
+	test_state_base* first = new test_state("first");
+	test_state_base* second = new test_state("second");
+
+	machine_t machine;
+	machine.addState( first );
+	machine.addState( second );
+	machine.setState( first );
+	machine.addTransition( first, "go", second );
+	machine.processEvent("go");
+}
+#endif
 int main(int argc, char* argv[])
 {
+	//test();
 
 	// Create the scripting system we want to use (Lua).
 	SharedPtr<scripting::IScriptingSystem> luaSys = templates::create<scripting::IScriptingSystem>("lua");
@@ -110,16 +222,16 @@
 	/*
 	RttiClassMgr clsMgr;
 	clsMgr.insert( ent::Object::cls() );
-	clsMgr.insert( ent::Co::cls() );
+	clsMgr.insert( ent::Component::cls() );
 	exapp::SimpleGraphicsCo::cls()->add( PropDef("position","position",Vector3(0,0,0)) );
 	clsMgr.insert( exapp::SimpleGraphicsCo::cls() );
 
-	e->addCo("gfx",new exapp::SimpleGraphicsCo());
-	e->getCo("gfx")->init();
-	if (!e->getCo("gfx")->setValue("position",Vector3(10,0,0)))
+	e->addComponent("gfx",new exapp::SimpleGraphicsCo());
+	e->getComponent("gfx")->init();
+	if (!e->getComponent("gfx")->setValue("position",Vector3(10,0,0)))
 		std::cerr << "could not set position\n";
 	Vector3 pos(0,0,0);
-	if (e->getCo("gfx")->getValue<Vector3>("position",pos))
+	if (e->getComponent("gfx")->getValue<Vector3>("position",pos))
 		std::cout << "position=" << pos << "\n";
 	else
 		std::cerr << "could not get position\n";



From codeandroid at berlios.de  Wed Mar 15 21:22:18 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:22:18 +0100
Subject: [Yake-svn] r1276 - in trunk/yake/scripts/msvc8/samples: . statemachine
Message-ID: <200603152022.k2FKMIWk014536@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:22:16 +0100 (Wed, 15 Mar 2006)
New Revision: 1276

Added:
   trunk/yake/scripts/msvc8/samples/statemachine/
   trunk/yake/scripts/msvc8/samples/statemachine/sampleFsm1.vcproj
Log:
initial revision

Added: trunk/yake/scripts/msvc8/samples/statemachine/sampleFsm1.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/statemachine/sampleFsm1.vcproj	2006-03-15 20:20:24 UTC (rev 1275)
+++ trunk/yake/scripts/msvc8/samples/statemachine/sampleFsm1.vcproj	2006-03-15 20:22:16 UTC (rev 1276)
@@ -0,0 +1,199 @@
+<?xml version="1.0" encoding="Windows-1252"?>
+<VisualStudioProject
+	ProjectType="Visual C++"
+	Version="8,00"
+	Name="sampleFsm1"
+	ProjectGUID="{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}"
+	Keyword="Win32Proj"
+	>
+	<Platforms>
+		<Platform
+			Name="Win32"
+		/>
+	</Platforms>
+	<ToolFiles>
+	</ToolFiles>
+	<Configurations>
+		<Configuration
+			Name="Debug|Win32"
+			OutputDirectory="../../../../common/bin/debug"
+			IntermediateDirectory="../../../../common/obj/debug/$(ProjectName)"
+			ConfigurationType="1"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				Optimization="0"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
+				PreprocessorDefinitions="WIN32;_DEBUG;_CONSOLE"
+				MinimalRebuild="true"
+				BasicRuntimeChecks="3"
+				RuntimeLibrary="3"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="0"
+				PrecompiledHeaderThrough="yapp/samples/base/vehicle/yakePCH.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="4"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib vehicle.lib"
+				OutputFile="$(OutDir)/$(ProjectName).exe"
+				LinkIncremental="2"
+				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/lib"
+				GenerateDebugInformation="true"
+				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
+				SubSystem="1"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+		<Configuration
+			Name="Release|Win32"
+			OutputDirectory="../../../../common/bin/release"
+			IntermediateDirectory="../../../../common/obj/release/$(ProjectName)"
+			ConfigurationType="1"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
+				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE"
+				RuntimeLibrary="2"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="0"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="3"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib vehicle.lib"
+				OutputFile="$(OutDir)/$(ProjectName).exe"
+				LinkIncremental="1"
+				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"
+				GenerateDebugInformation="false"
+				SubSystem="1"
+				OptimizeReferences="2"
+				EnableCOMDATFolding="2"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+	</Configurations>
+	<References>
+	</References>
+	<Files>
+		<Filter
+			Name="inc"
+			>
+		</Filter>
+		<Filter
+			Name="src"
+			>
+			<File
+				RelativePath="..\..\..\..\src\yake\samples\statemachine\sampleFsm1\demo.cpp"
+				>
+			</File>
+		</Filter>
+	</Files>
+	<Globals>
+	</Globals>
+</VisualStudioProject>



From codeandroid at berlios.de  Wed Mar 15 21:39:51 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:39:51 +0100
Subject: [Yake-svn] r1277 - trunk/yake/scripts/msvc8
Message-ID: <200603152039.k2FKdp8G028508@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:39:50 +0100 (Wed, 15 Mar 2006)
New Revision: 1277

Added:
   trunk/yake/scripts/msvc8/samples.sln
Log:
initial revision

Added: trunk/yake/scripts/msvc8/samples.sln
===================================================================
--- trunk/yake/scripts/msvc8/samples.sln	2006-03-15 20:22:16 UTC (rev 1276)
+++ trunk/yake/scripts/msvc8/samples.sln	2006-03-15 20:39:50 UTC (rev 1277)
@@ -0,0 +1,146 @@
+?
+Microsoft Visual Studio Solution File, Format Version 9.00
+# Visual Studio 2005
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleAudio1", "samples\audio\sampleAudio1.vcproj", "{726DFDDE-71FA-403B-8F58-6DA9DF0EF297}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleDataMisc", "samples\data\sampleDataMisc.vcproj", "{22EFD734-D8C5-47D6-8461-C37E02A9F0B6}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleEntFsm", "samples\ent\sampleEntFsm.vcproj", "{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleDotScene", "samples\graphics\sampleDotScene.vcproj", "{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleGraphicsDemo", "samples\graphics\sampleGraphicsDemo.vcproj", "{723A2F36-A3DC-40E5-A7B0-0629219B04DE}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleCar", "samples\misc\sampleCar.vcproj", "{EE77E955-42BD-47A4-BDC6-D92759F45D01}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleGuiConsole", "samples\misc\sampleGuiConsole.vcproj", "{6B6A5F65-AA92-4ABF-A95A-4AC302CB44E9}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleScripted", "samples\misc\sampleScripted.vcproj", "{6EA2B9BF-2FDA-4E31-BF17-C56709DFB4D4}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleScriptedGraphics", "samples\misc\sampleScriptedGraphics.vcproj", "{B85C2435-267A-461C-AD9E-FE28EE7DCC12}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleCmdrMayhem", "samples\misc\sampleCmdrMayhem.vcproj", "{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleModelDotLink", "samples\model\sampleDotLink.vcproj", "{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleModelSync1", "samples\model\sampleSync1.vcproj", "{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleModelXODE", "samples\model\sampleXODE.vcproj", "{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleMsg1", "samples\msg\sampleMsg1.vcproj", "{452438E8-F03B-47B9-984B-2CF79D2F6734}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRoClient", "samples\net\sampleRoClient.vcproj", "{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRoServer", "samples\net\sampleRoServer.vcproj", "{547611C2-43E2-4678-B8E9-92CF69770C40}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "samplePhysicsDemo", "samples\physics\samplePhysicsDemo.vcproj", "{3DA99679-404B-44C7-9267-C97D066F3D96}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRafDemo1", "samples\raf\sampleRafDemo1.vcproj", "{BAA11C61-DA21-4E6F-8B5C-16A062720F1C}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleRafMinimal", "samples\raf\sampleRafMinimal.vcproj", "{9B57BE31-B084-4AB4-AFEF-E45A0FFD220D}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleScriptingLua", "samples\scripting\sampleScriptingLua.vcproj", "{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleStateMachine", "samples\state\sampleStateMachine.vcproj", "{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleFsm1", "samples\statemachine\sampleFsm1.vcproj", "{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}"
+EndProject
+Global
+	GlobalSection(SolutionConfigurationPlatforms) = preSolution
+		Debug|Win32 = Debug|Win32
+		Release|Win32 = Release|Win32
+	EndGlobalSection
+	GlobalSection(ProjectConfigurationPlatforms) = postSolution
+		{726DFDDE-71FA-403B-8F58-6DA9DF0EF297}.Debug|Win32.ActiveCfg = Debug|Win32
+		{726DFDDE-71FA-403B-8F58-6DA9DF0EF297}.Debug|Win32.Build.0 = Debug|Win32
+		{726DFDDE-71FA-403B-8F58-6DA9DF0EF297}.Release|Win32.ActiveCfg = Release|Win32
+		{726DFDDE-71FA-403B-8F58-6DA9DF0EF297}.Release|Win32.Build.0 = Release|Win32
+		{22EFD734-D8C5-47D6-8461-C37E02A9F0B6}.Debug|Win32.ActiveCfg = Debug|Win32
+		{22EFD734-D8C5-47D6-8461-C37E02A9F0B6}.Debug|Win32.Build.0 = Debug|Win32
+		{22EFD734-D8C5-47D6-8461-C37E02A9F0B6}.Release|Win32.ActiveCfg = Release|Win32
+		{22EFD734-D8C5-47D6-8461-C37E02A9F0B6}.Release|Win32.Build.0 = Release|Win32
+		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Debug|Win32.ActiveCfg = Debug|Win32
+		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Debug|Win32.Build.0 = Debug|Win32
+		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Release|Win32.ActiveCfg = Release|Win32
+		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Release|Win32.Build.0 = Release|Win32
+		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Debug|Win32.ActiveCfg = Debug|Win32
+		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Debug|Win32.Build.0 = Debug|Win32
+		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Release|Win32.ActiveCfg = Release|Win32
+		{8E612AD0-68D1-445E-A31E-7CB1CCA18CA0}.Release|Win32.Build.0 = Release|Win32
+		{723A2F36-A3DC-40E5-A7B0-0629219B04DE}.Debug|Win32.ActiveCfg = Debug|Win32
+		{723A2F36-A3DC-40E5-A7B0-0629219B04DE}.Debug|Win32.Build.0 = Debug|Win32
+		{723A2F36-A3DC-40E5-A7B0-0629219B04DE}.Release|Win32.ActiveCfg = Release|Win32
+		{723A2F36-A3DC-40E5-A7B0-0629219B04DE}.Release|Win32.Build.0 = Release|Win32
+		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Debug|Win32.ActiveCfg = Debug|Win32
+		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Debug|Win32.Build.0 = Debug|Win32
+		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Release|Win32.ActiveCfg = Release|Win32
+		{EE77E955-42BD-47A4-BDC6-D92759F45D01}.Release|Win32.Build.0 = Release|Win32
+		{6B6A5F65-AA92-4ABF-A95A-4AC302CB44E9}.Debug|Win32.ActiveCfg = Debug|Win32
+		{6B6A5F65-AA92-4ABF-A95A-4AC302CB44E9}.Debug|Win32.Build.0 = Debug|Win32
+		{6B6A5F65-AA92-4ABF-A95A-4AC302CB44E9}.Release|Win32.ActiveCfg = Release|Win32
+		{6B6A5F65-AA92-4ABF-A95A-4AC302CB44E9}.Release|Win32.Build.0 = Release|Win32
+		{6EA2B9BF-2FDA-4E31-BF17-C56709DFB4D4}.Debug|Win32.ActiveCfg = Debug|Win32
+		{6EA2B9BF-2FDA-4E31-BF17-C56709DFB4D4}.Debug|Win32.Build.0 = Debug|Win32
+		{6EA2B9BF-2FDA-4E31-BF17-C56709DFB4D4}.Release|Win32.ActiveCfg = Release|Win32
+		{6EA2B9BF-2FDA-4E31-BF17-C56709DFB4D4}.Release|Win32.Build.0 = Release|Win32
+		{B85C2435-267A-461C-AD9E-FE28EE7DCC12}.Debug|Win32.ActiveCfg = Debug|Win32
+		{B85C2435-267A-461C-AD9E-FE28EE7DCC12}.Debug|Win32.Build.0 = Debug|Win32
+		{B85C2435-267A-461C-AD9E-FE28EE7DCC12}.Release|Win32.ActiveCfg = Release|Win32
+		{B85C2435-267A-461C-AD9E-FE28EE7DCC12}.Release|Win32.Build.0 = Release|Win32
+		{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}.Debug|Win32.ActiveCfg = Debug|Win32
+		{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}.Debug|Win32.Build.0 = Debug|Win32
+		{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}.Release|Win32.ActiveCfg = Release|Win32
+		{1CE9D735-3119-4E08-B4A0-F4DAD35FC8D5}.Release|Win32.Build.0 = Release|Win32
+		{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}.Debug|Win32.ActiveCfg = Debug|Win32
+		{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}.Debug|Win32.Build.0 = Debug|Win32
+		{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}.Release|Win32.ActiveCfg = Release|Win32
+		{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}.Release|Win32.Build.0 = Release|Win32
+		{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}.Debug|Win32.ActiveCfg = Debug|Win32
+		{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}.Debug|Win32.Build.0 = Debug|Win32
+		{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}.Release|Win32.ActiveCfg = Release|Win32
+		{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}.Release|Win32.Build.0 = Release|Win32
+		{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}.Debug|Win32.ActiveCfg = Debug|Win32
+		{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}.Debug|Win32.Build.0 = Debug|Win32
+		{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}.Release|Win32.ActiveCfg = Release|Win32
+		{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}.Release|Win32.Build.0 = Release|Win32
+		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Debug|Win32.ActiveCfg = Debug|Win32
+		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Debug|Win32.Build.0 = Debug|Win32
+		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Release|Win32.ActiveCfg = Release|Win32
+		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Release|Win32.Build.0 = Release|Win32
+		{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}.Debug|Win32.ActiveCfg = Debug|Win32
+		{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}.Debug|Win32.Build.0 = Debug|Win32
+		{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}.Release|Win32.ActiveCfg = Release|Win32
+		{4F5EEBEB-7594-4934-8DF5-FB4604E84CCB}.Release|Win32.Build.0 = Release|Win32
+		{547611C2-43E2-4678-B8E9-92CF69770C40}.Debug|Win32.ActiveCfg = Debug|Win32
+		{547611C2-43E2-4678-B8E9-92CF69770C40}.Debug|Win32.Build.0 = Debug|Win32
+		{547611C2-43E2-4678-B8E9-92CF69770C40}.Release|Win32.ActiveCfg = Release|Win32
+		{547611C2-43E2-4678-B8E9-92CF69770C40}.Release|Win32.Build.0 = Release|Win32
+		{3DA99679-404B-44C7-9267-C97D066F3D96}.Debug|Win32.ActiveCfg = Debug|Win32
+		{3DA99679-404B-44C7-9267-C97D066F3D96}.Debug|Win32.Build.0 = Debug|Win32
+		{3DA99679-404B-44C7-9267-C97D066F3D96}.Release|Win32.ActiveCfg = Release|Win32
+		{3DA99679-404B-44C7-9267-C97D066F3D96}.Release|Win32.Build.0 = Release|Win32
+		{BAA11C61-DA21-4E6F-8B5C-16A062720F1C}.Debug|Win32.ActiveCfg = Debug|Win32
+		{BAA11C61-DA21-4E6F-8B5C-16A062720F1C}.Debug|Win32.Build.0 = Debug|Win32
+		{BAA11C61-DA21-4E6F-8B5C-16A062720F1C}.Release|Win32.ActiveCfg = Release|Win32
+		{BAA11C61-DA21-4E6F-8B5C-16A062720F1C}.Release|Win32.Build.0 = Release|Win32
+		{9B57BE31-B084-4AB4-AFEF-E45A0FFD220D}.Debug|Win32.ActiveCfg = Debug|Win32
+		{9B57BE31-B084-4AB4-AFEF-E45A0FFD220D}.Debug|Win32.Build.0 = Debug|Win32
+		{9B57BE31-B084-4AB4-AFEF-E45A0FFD220D}.Release|Win32.ActiveCfg = Release|Win32
+		{9B57BE31-B084-4AB4-AFEF-E45A0FFD220D}.Release|Win32.Build.0 = Release|Win32
+		{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}.Debug|Win32.ActiveCfg = Debug|Win32
+		{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}.Debug|Win32.Build.0 = Debug|Win32
+		{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}.Release|Win32.ActiveCfg = Release|Win32
+		{26B28ECB-A1FD-4CC0-A5EE-6E4587BBB058}.Release|Win32.Build.0 = Release|Win32
+		{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}.Debug|Win32.ActiveCfg = Debug|Win32
+		{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}.Debug|Win32.Build.0 = Debug|Win32
+		{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}.Release|Win32.ActiveCfg = Release|Win32
+		{84F0FA89-EB3D-47D6-9C6E-628434AE2C70}.Release|Win32.Build.0 = Release|Win32
+		{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}.Debug|Win32.ActiveCfg = Debug|Win32
+		{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}.Debug|Win32.Build.0 = Debug|Win32
+		{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}.Release|Win32.ActiveCfg = Release|Win32
+		{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}.Release|Win32.Build.0 = Release|Win32
+	EndGlobalSection
+	GlobalSection(SolutionProperties) = preSolution
+		HideSolutionNode = FALSE
+	EndGlobalSection
+EndGlobal



From codeandroid at berlios.de  Wed Mar 15 21:40:20 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:40:20 +0100
Subject: [Yake-svn] r1278 - trunk/yake/scripts/msvc8
Message-ID: <200603152040.k2FKeKPs028963@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:40:14 +0100 (Wed, 15 Mar 2006)
New Revision: 1278

Modified:
   trunk/yake/scripts/msvc8/yake.sln
Log:


Modified: trunk/yake/scripts/msvc8/yake.sln
===================================================================
--- trunk/yake/scripts/msvc8/yake.sln	2006-03-15 20:39:50 UTC (rev 1277)
+++ trunk/yake/scripts/msvc8/yake.sln	2006-03-15 20:40:14 UTC (rev 1278)
@@ -115,12 +115,6 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "net", "net.vcproj", "{90688422-B178-44F3-824A-C8CD6F3BD86F}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleEntFsm", "samples\ent\sampleEntFsm.vcproj", "{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}"
-	ProjectSection(ProjectDependencies) = postProject
-		{89182311-DB82-446B-AA9B-C70A3A0AF035} = {89182311-DB82-446B-AA9B-C70A3A0AF035}
-		{08BC40D8-33D8-4677-993A-32599A93A460} = {08BC40D8-33D8-4677-993A-32599A93A460}
-	EndProjectSection
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "msg2", "msg2.vcproj", "{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "entLua", "plugins\ent\entLua.vcproj", "{89182311-DB82-446B-AA9B-C70A3A0AF035}"
@@ -236,10 +230,6 @@
 		{90688422-B178-44F3-824A-C8CD6F3BD86F}.Debug|Win32.Build.0 = Debug|Win32
 		{90688422-B178-44F3-824A-C8CD6F3BD86F}.Release|Win32.ActiveCfg = Release|Win32
 		{90688422-B178-44F3-824A-C8CD6F3BD86F}.Release|Win32.Build.0 = Release|Win32
-		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Debug|Win32.ActiveCfg = Debug|Win32
-		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Debug|Win32.Build.0 = Debug|Win32
-		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Release|Win32.ActiveCfg = Release|Win32
-		{E7B61D39-73E5-4C0E-97D4-1E6FFA12390C}.Release|Win32.Build.0 = Release|Win32
 		{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}.Debug|Win32.ActiveCfg = Debug|Win32
 		{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}.Debug|Win32.Build.0 = Debug|Win32
 		{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}.Release|Win32.ActiveCfg = Release|Win32



From codeandroid at berlios.de  Wed Mar 15 21:50:07 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:50:07 +0100
Subject: [Yake-svn] r1279 - trunk/yake/src/yake/samples/physics/demo
Message-ID: <200603152050.k2FKo7Vv017945@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:50:03 +0100 (Wed, 15 Mar 2006)
New Revision: 1279

Modified:
   trunk/yake/src/yake/samples/physics/demo/yakeDemo.cpp
Log:


Modified: trunk/yake/src/yake/samples/physics/demo/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yake/samples/physics/demo/yakeDemo.cpp	2006-03-15 20:40:14 UTC (rev 1278)
+++ trunk/yake/src/yake/samples/physics/demo/yakeDemo.cpp	2006-03-15 20:50:03 UTC (rev 1279)
@@ -59,7 +59,7 @@
 	Views						mViews;;
 	SceneNodes					mSceneNodes;
 
-	Deque< SharedPtr<Library> >	mLibs;
+	Deque< SharedPtr<base::Library> >	mLibs;
 
 	SharedPtr<graphics::IGraphicsSystem> mGraphics;
 	SharedPtr<graphics::IWorld>	mGWorld;
@@ -180,8 +180,8 @@
 		pL->setType( graphics::ILight::LT_POINT );
 		pL->setDiffuseColour( Color(1,1,1,1) );
 		pSN->setPosition( Vector3(0,50,0) );
-        pL->setDiffuseColour(Color(0.35, 0.35, 0.38));
-        pL->setSpecularColour(Color(0.9, 0.9, 1));
+		pL->setDiffuseColour(Color(0.35, 0.35, 0.38));
+		pL->setSpecularColour(Color(0.9, 0.9, 1));
 		pL->setAttenuation( 8000, 1, 0.0005, 0 );
 		pL->setCastsShadows( true );
 	}
@@ -228,7 +228,7 @@
 	SharedPtr<base::Library> pLib = loadLib("physicsOde" );
 	YAKE_ASSERT( pLib ).debug("Cannot load physics plugin 1.");
 
-	mPhysics1 = create< physics::IPhysicsSystem >("ode");
+	mPhysics1 = templates::create< physics::IPhysicsSystem >("ode");
 	YAKE_ASSERT( mPhysics1 ).debug("Cannot create physics system 1.");
 
 	mPWorld1 = mPhysics1->createWorld();
@@ -239,7 +239,7 @@
 	pLib = loadLib("physicsNX" );
 	YAKE_ASSERT( pLib ).debug("Cannot load physics plugin 2.");
 
-	mPhysics2 = create< physics::IPhysicsSystem >("nx");
+	mPhysics2 = templates::create< physics::IPhysicsSystem >("nx");
 	YAKE_ASSERT( mPhysics2 ).debug("Cannot create physics system 2.");
 
 	mPWorld2 = mPhysics2->createWorld();
@@ -250,7 +250,7 @@
 	pLib = loadLib("graphicsOgre" );
 	YAKE_ASSERT( pLib ).debug("Cannot load graphics plugin.");
 
-	mGraphics = create_default< graphics::IGraphicsSystem >();
+	mGraphics = templates::create_default< graphics::IGraphicsSystem >();
 	YAKE_ASSERT( mGraphics ).debug("Cannot create graphics system.");
 
 	mGWorld = mGraphics->createWorld();
@@ -400,12 +400,12 @@
 
 	RandomNumberGeneratorMT randomiser;
 
-	real lastTime = base::native::getTime();
+	real lastTime = native::getTime();
 	while (!mShutdownRequested)
 	{
 		static uint32 siFrame = 0;
 		// timing
-		real time = base::native::getTime();
+		real time = native::getTime();
 		real timeElapsed = time-lastTime;//timer->getSeconds();
 		lastTime = time;
 



From codeandroid at berlios.de  Wed Mar 15 21:51:24 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:51:24 +0100
Subject: [Yake-svn] r1280 - trunk/yake/src/yake/samples/graphics/demo
Message-ID: <200603152051.k2FKpOF6018763@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:51:23 +0100 (Wed, 15 Mar 2006)
New Revision: 1280

Modified:
   trunk/yake/src/yake/samples/graphics/demo/yakeGraphicsDemo.cpp
Log:


Modified: trunk/yake/src/yake/samples/graphics/demo/yakeGraphicsDemo.cpp
===================================================================
--- trunk/yake/src/yake/samples/graphics/demo/yakeGraphicsDemo.cpp	2006-03-15 20:50:03 UTC (rev 1279)
+++ trunk/yake/src/yake/samples/graphics/demo/yakeGraphicsDemo.cpp	2006-03-15 20:51:23 UTC (rev 1280)
@@ -332,11 +332,11 @@
 		mGWorld->setShadowsEnabled( true );
 
 		// main loop
-		real lastTime = base::native::getTime();
+		real lastTime = native::getTime();
 		while (!shutdownRequested())
 		{
 			// timing
-			real time = base::native::getTime();
+			real time = native::getTime();
 			real timeElapsed = time-lastTime;//timer->getSeconds();
 			lastTime = time;
 



From codeandroid at berlios.de  Wed Mar 15 21:52:44 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:52:44 +0100
Subject: [Yake-svn] r1281 - in trunk/yake/src/yapp/samples: graphics/dotScene gui/console model/XODE model/sync1
Message-ID: <200603152052.k2FKqiE5019607@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:52:43 +0100 (Wed, 15 Mar 2006)
New Revision: 1281

Modified:
   trunk/yake/src/yapp/samples/graphics/dotScene/yakeDotSceneDemo.cpp
   trunk/yake/src/yapp/samples/gui/console/yakeConsoleDemo.cpp
   trunk/yake/src/yapp/samples/model/XODE/yakeXODELoaderDemo.cpp
   trunk/yake/src/yapp/samples/model/sync1/yakeDemo.cpp
Log:


Modified: trunk/yake/src/yapp/samples/graphics/dotScene/yakeDotSceneDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/graphics/dotScene/yakeDotSceneDemo.cpp	2006-03-15 20:51:23 UTC (rev 1280)
+++ trunk/yake/src/yapp/samples/graphics/dotScene/yakeDotSceneDemo.cpp	2006-03-15 20:52:43 UTC (rev 1281)
@@ -128,11 +128,11 @@
 		setupScene();
 
 		// main loop
-		real lastTime = base::native::getTime();
+		real lastTime = native::getTime();
 		while (!shutdownRequested())
 		{
 			// timing
-			real time = base::native::getTime();
+			real time = native::getTime();
 			real timeElapsed = time - lastTime;//timer->getSeconds();
 			lastTime = time;
 

Modified: trunk/yake/src/yapp/samples/gui/console/yakeConsoleDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/gui/console/yakeConsoleDemo.cpp	2006-03-15 20:51:23 UTC (rev 1280)
+++ trunk/yake/src/yapp/samples/gui/console/yakeConsoleDemo.cpp	2006-03-15 20:52:43 UTC (rev 1281)
@@ -447,11 +447,11 @@
 		initGui();
 
 		// main loop
-		real lastTime = base::native::getTime();
+		real lastTime = native::getTime();
 		while (!shutdownRequested())
 		{
 			// timing
-			real time = base::native::getTime();
+			real time = native::getTime();
 			real timeElapsed = time - lastTime;
 			lastTime = time;
 

Modified: trunk/yake/src/yapp/samples/model/XODE/yakeXODELoaderDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/model/XODE/yakeXODELoaderDemo.cpp	2006-03-15 20:51:23 UTC (rev 1280)
+++ trunk/yake/src/yapp/samples/model/XODE/yakeXODELoaderDemo.cpp	2006-03-15 20:52:43 UTC (rev 1281)
@@ -93,12 +93,12 @@
 		YAKE_LOG( "Running simulation..." );
 
 		// main loop
-		real lastTime = base::native::getTime();
+		real lastTime = native::getTime();
 		while (!shutdownRequested())
 		{
 			// timing
 			static real totalTimeElapsed = 0;
-			real time = base::native::getTime();
+			real time = native::getTime();
 			real timeElapsed = time - lastTime;
 			lastTime = time;
 			totalTimeElapsed += timeElapsed;

Modified: trunk/yake/src/yapp/samples/model/sync1/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/model/sync1/yakeDemo.cpp	2006-03-15 20:51:23 UTC (rev 1280)
+++ trunk/yake/src/yapp/samples/model/sync1/yakeDemo.cpp	2006-03-15 20:52:43 UTC (rev 1281)
@@ -406,11 +406,11 @@
 		setupObject(obj);
 
 		// main loop
-		real lastTime = base::native::getTime();
+		real lastTime = native::getTime();
 		while (!shutdownRequested())
 		{
 			// timing
-			real time = base::native::getTime();
+			real time = native::getTime();
 			real timeElapsed = time - lastTime;
 			if (timeElapsed > real(0.05))
 				timeElapsed = real(0.05);



From codeandroid at berlios.de  Wed Mar 15 21:58:46 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:58:46 +0100
Subject: [Yake-svn] r1282 - in trunk/yake/src/yake/base/native: Linux win32
Message-ID: <200603152058.k2FKwkSx023433@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:58:45 +0100 (Wed, 15 Mar 2006)
New Revision: 1282

Modified:
   trunk/yake/src/yake/base/native/Linux/yakeApplication.cpp
   trunk/yake/src/yake/base/native/win32/yakeApplication.cpp
Log:
removed namespace base

Modified: trunk/yake/src/yake/base/native/Linux/yakeApplication.cpp
===================================================================
--- trunk/yake/src/yake/base/native/Linux/yakeApplication.cpp	2006-03-15 20:52:43 UTC (rev 1281)
+++ trunk/yake/src/yake/base/native/Linux/yakeApplication.cpp	2006-03-15 20:58:45 UTC (rev 1282)
@@ -47,12 +47,10 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace native
 {
 
-char* getApplicationDir()
+const char* getApplicationDir()
 {
 	static char path[ PATH_MAX ] = "";
 
@@ -73,5 +71,4 @@
 
 
 } // native
-} // base
 } // yake

Modified: trunk/yake/src/yake/base/native/win32/yakeApplication.cpp
===================================================================
--- trunk/yake/src/yake/base/native/win32/yakeApplication.cpp	2006-03-15 20:52:43 UTC (rev 1281)
+++ trunk/yake/src/yake/base/native/win32/yakeApplication.cpp	2006-03-15 20:58:45 UTC (rev 1282)
@@ -44,12 +44,10 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace native
 {
 
-char* getApplicationDir()
+const char* getApplicationDir()
 {
 	static char szBuffer[ MAX_PATH ] = "";
 
@@ -64,5 +62,4 @@
 
 
 } // native
-} // base
 } // yake



From codeandroid at berlios.de  Wed Mar 15 21:59:07 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:59:07 +0100
Subject: [Yake-svn] r1283 - trunk/yake/src/yapp/samples/model/dotLink
Message-ID: <200603152059.k2FKx7Db023651@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:59:02 +0100 (Wed, 15 Mar 2006)
New Revision: 1283

Modified:
   trunk/yake/src/yapp/samples/model/dotLink/yakeDotLinkDemo.cpp
Log:


Modified: trunk/yake/src/yapp/samples/model/dotLink/yakeDotLinkDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/model/dotLink/yakeDotLinkDemo.cpp	2006-03-15 20:58:45 UTC (rev 1282)
+++ trunk/yake/src/yapp/samples/model/dotLink/yakeDotLinkDemo.cpp	2006-03-15 20:59:02 UTC (rev 1283)
@@ -172,11 +172,11 @@
 		  setupWorld();
 
 		  // main loop
-		  real lastTime = base::native::getTime();
+		  real lastTime = native::getTime();
 		  while (!shutdownRequested())
 		  {
 			  // timing
-			  real time = base::native::getTime();
+			  real time = native::getTime();
 			  real timeElapsed = time - lastTime;
 			  lastTime = time;
 



From codeandroid at berlios.de  Wed Mar 15 21:59:25 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 21:59:25 +0100
Subject: [Yake-svn] r1284 - trunk/yake/yake/base/native
Message-ID: <200603152059.k2FKxP2T023833@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 21:59:24 +0100 (Wed, 15 Mar 2006)
New Revision: 1284

Modified:
   trunk/yake/yake/base/native/yakeNative.h
Log:
added const

Modified: trunk/yake/yake/base/native/yakeNative.h
===================================================================
--- trunk/yake/yake/base/native/yakeNative.h	2006-03-15 20:59:02 UTC (rev 1283)
+++ trunk/yake/yake/base/native/yakeNative.h	2006-03-15 20:59:24 UTC (rev 1284)
@@ -80,7 +80,7 @@
 YAKE_BASE_NATIVE_API float getTime();
 
 // Application Information Interface.
-YAKE_BASE_NATIVE_API char* getApplicationDir();
+YAKE_BASE_NATIVE_API const char* getApplicationDir();
 
 } // native
 } // yake



From codeandroid at berlios.de  Wed Mar 15 22:00:31 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 22:00:31 +0100
Subject: [Yake-svn] r1285 - in trunk/yake/scripts/msvc8: . samples/audio samples/base samples/data samples/ent samples/misc samples/model samples/scripting
Message-ID: <200603152100.k2FL0VON024053@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 22:00:29 +0100 (Wed, 15 Mar 2006)
New Revision: 1285

Modified:
   trunk/yake/scripts/msvc8/samples.sln
   trunk/yake/scripts/msvc8/samples/audio/sampleAudio1.vcproj
   trunk/yake/scripts/msvc8/samples/base/sampleDebug.vcproj
   trunk/yake/scripts/msvc8/samples/data/sampleDataMisc.vcproj
   trunk/yake/scripts/msvc8/samples/ent/sampleEntFsm.vcproj
   trunk/yake/scripts/msvc8/samples/misc/sampleScriptedGraphics.vcproj
   trunk/yake/scripts/msvc8/samples/model/sampleDotLink.vcproj
   trunk/yake/scripts/msvc8/samples/model/sampleSync1.vcproj
   trunk/yake/scripts/msvc8/samples/model/sampleXODE.vcproj
   trunk/yake/scripts/msvc8/samples/scripting/sampleScriptingLua.vcproj
Log:
various fixes

Modified: trunk/yake/scripts/msvc8/samples/audio/sampleAudio1.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/audio/sampleAudio1.vcproj	2006-03-15 20:59:24 UTC (rev 1284)
+++ trunk/yake/scripts/msvc8/samples/audio/sampleAudio1.vcproj	2006-03-15 21:00:29 UTC (rev 1285)
@@ -64,6 +64,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib audio.lib"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="2"
 				AdditionalLibraryDirectories="../../../../common/lib/$(ConfigurationName);../../../../dependencies/lib"
@@ -142,6 +143,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib audio.lib"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="1"
 				AdditionalLibraryDirectories="../../../../common/lib/$(ConfigurationName);../../../../dependencies/lib"

Modified: trunk/yake/scripts/msvc8/samples/base/sampleDebug.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/base/sampleDebug.vcproj	2006-03-15 20:59:24 UTC (rev 1284)
+++ trunk/yake/scripts/msvc8/samples/base/sampleDebug.vcproj	2006-03-15 21:00:29 UTC (rev 1285)
@@ -65,7 +65,7 @@
 				Name="VCLinkerTool"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="2"
-				AdditionalLibraryDirectories="../../../../dependencies/lib"
+				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/lib"
 				GenerateDebugInformation="true"
 				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
 				SubSystem="1"

Modified: trunk/yake/scripts/msvc8/samples/data/sampleDataMisc.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/data/sampleDataMisc.vcproj	2006-03-15 20:59:24 UTC (rev 1284)
+++ trunk/yake/scripts/msvc8/samples/data/sampleDataMisc.vcproj	2006-03-15 21:00:29 UTC (rev 1285)
@@ -63,6 +63,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib data.lib"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="2"
 				AdditionalLibraryDirectories="../../../../common/lib/$(ConfigurationName);../../../../dependencies/lib"
@@ -140,6 +141,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib data.lib"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="1"
 				AdditionalLibraryDirectories="../../../../common/lib/$(ConfigurationName);../../../../dependencies/lib"

Modified: trunk/yake/scripts/msvc8/samples/ent/sampleEntFsm.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/ent/sampleEntFsm.vcproj	2006-03-15 20:59:24 UTC (rev 1284)
+++ trunk/yake/scripts/msvc8/samples/ent/sampleEntFsm.vcproj	2006-03-15 21:00:29 UTC (rev 1285)
@@ -63,7 +63,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib vehicle.lib"
+				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib scripting.lib ent.lib entlua.lib"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="2"
 				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/lib"
@@ -142,7 +142,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.lib vehicle.lib"
+				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib scripting.lib ent.lib entlua.lib"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="1"
 				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"

Modified: trunk/yake/scripts/msvc8/samples/misc/sampleScriptedGraphics.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/misc/sampleScriptedGraphics.vcproj	2006-03-15 20:59:24 UTC (rev 1284)
+++ trunk/yake/scripts/msvc8/samples/misc/sampleScriptedGraphics.vcproj	2006-03-15 21:00:29 UTC (rev 1285)
@@ -63,7 +63,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib input.lib data.lib graphics.lib yapp.lib audio.lib physics.lib scripting.lib scriptingLua.lib scriptingBindingsLua.lib luabindd.lib luad.lib"
+				AdditionalDependencies="base.lib input.lib data.lib graphics.lib yapp.lib audio.lib physics.lib scripting.lib"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="2"
 				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/luabind/lib;../../../../dependencies/lua/lib;../../../../dependencies/lib"
@@ -143,7 +143,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib input.lib data.lib graphics.lib yapp.lib audio.lib physics.lib scripting.lib scriptingLua.lib scriptingBindingsLua.lib luabind.lib lua.lib"
+				AdditionalDependencies="base.lib input.lib data.lib graphics.lib yapp.lib audio.lib physics.lib scripting.lib"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="1"
 				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/luabind/lib;../../../../dependencies/lua/lib;../../../../dependencies/lib"

Modified: trunk/yake/scripts/msvc8/samples/model/sampleDotLink.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/model/sampleDotLink.vcproj	2006-03-15 20:59:24 UTC (rev 1284)
+++ trunk/yake/scripts/msvc8/samples/model/sampleDotLink.vcproj	2006-03-15 21:00:29 UTC (rev 1285)
@@ -2,7 +2,7 @@
 <VisualStudioProject
 	ProjectType="Visual C++"
 	Version="8,00"
-	Name="sampleDotLink"
+	Name="sampleModelDotLink"
 	ProjectGUID="{1C76B4C7-8ECE-4C0D-81B4-B65707F96510}"
 	Keyword="Win32Proj"
 	>

Modified: trunk/yake/scripts/msvc8/samples/model/sampleSync1.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/model/sampleSync1.vcproj	2006-03-15 20:59:24 UTC (rev 1284)
+++ trunk/yake/scripts/msvc8/samples/model/sampleSync1.vcproj	2006-03-15 21:00:29 UTC (rev 1285)
@@ -2,7 +2,7 @@
 <VisualStudioProject
 	ProjectType="Visual C++"
 	Version="8,00"
-	Name="sampleSync1"
+	Name="sampleModelSync1"
 	ProjectGUID="{A2E804D9-C95C-47EB-87AB-FAA8A6CAC21B}"
 	Keyword="Win32Proj"
 	>

Modified: trunk/yake/scripts/msvc8/samples/model/sampleXODE.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/model/sampleXODE.vcproj	2006-03-15 20:59:24 UTC (rev 1284)
+++ trunk/yake/scripts/msvc8/samples/model/sampleXODE.vcproj	2006-03-15 21:00:29 UTC (rev 1285)
@@ -2,7 +2,7 @@
 <VisualStudioProject
 	ProjectType="Visual C++"
 	Version="8,00"
-	Name="sampleXODE"
+	Name="sampleModelXODE"
 	ProjectGUID="{0FCB117D-9915-40AE-A86D-99C3D6EB7B2C}"
 	Keyword="Win32Proj"
 	>
@@ -63,7 +63,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib"
+				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.kib"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="2"
 				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/lib"
@@ -142,7 +142,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib"
+				AdditionalDependencies="base.lib graphics.lib physics.lib audio.lib data.lib input.lib yapp.lib scripting.kib"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="1"
 				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"

Modified: trunk/yake/scripts/msvc8/samples/scripting/sampleScriptingLua.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/scripting/sampleScriptingLua.vcproj	2006-03-15 20:59:24 UTC (rev 1284)
+++ trunk/yake/scripts/msvc8/samples/scripting/sampleScriptingLua.vcproj	2006-03-15 21:00:29 UTC (rev 1285)
@@ -63,7 +63,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="input.lib graphics.lib audio.lib scripting.lib luad.lib luabindd.lib"
+				AdditionalDependencies="base.lib scripting.lib audio.lib graphics.lib physics.lib input.lib"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="2"
 				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies\lua\lib;../../../../dependencies\luabind\lib;../../../../dependencies/lib"
@@ -142,7 +142,7 @@
 			/>
 			<Tool
 				Name="VCLinkerTool"
-				AdditionalDependencies="input.lib graphics.lib audio.lib scripting.lib"
+				AdditionalDependencies="base.lib scripting.lib audio.lib graphics.lib physics.lib input.lib"
 				OutputFile="$(OutDir)/$(ProjectName).exe"
 				LinkIncremental="1"
 				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"

Modified: trunk/yake/scripts/msvc8/samples.sln
===================================================================
--- trunk/yake/scripts/msvc8/samples.sln	2006-03-15 20:59:24 UTC (rev 1284)
+++ trunk/yake/scripts/msvc8/samples.sln	2006-03-15 21:00:29 UTC (rev 1285)
@@ -45,6 +45,10 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleFsm1", "samples\statemachine\sampleFsm1.vcproj", "{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}"
 EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleEvents", "samples\base\sampleEvents.vcproj", "{CD6F13A0-F399-411A-9766-0F8E02761D90}"
+EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleDebug", "samples\base\sampleDebug.vcproj", "{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}"
+EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) = preSolution
 		Debug|Win32 = Debug|Win32
@@ -139,6 +143,14 @@
 		{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}.Debug|Win32.Build.0 = Debug|Win32
 		{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}.Release|Win32.ActiveCfg = Release|Win32
 		{F270D584-0E4B-4FF0-8EDB-4D098BE49D43}.Release|Win32.Build.0 = Release|Win32
+		{CD6F13A0-F399-411A-9766-0F8E02761D90}.Debug|Win32.ActiveCfg = Debug|Win32
+		{CD6F13A0-F399-411A-9766-0F8E02761D90}.Debug|Win32.Build.0 = Debug|Win32
+		{CD6F13A0-F399-411A-9766-0F8E02761D90}.Release|Win32.ActiveCfg = Release|Win32
+		{CD6F13A0-F399-411A-9766-0F8E02761D90}.Release|Win32.Build.0 = Release|Win32
+		{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}.Debug|Win32.ActiveCfg = Debug|Win32
+		{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}.Debug|Win32.Build.0 = Debug|Win32
+		{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}.Release|Win32.ActiveCfg = Release|Win32
+		{BCA46ED8-E97C-49D0-A521-FA8E7CEB885A}.Release|Win32.Build.0 = Release|Win32
 	EndGlobalSection
 	GlobalSection(SolutionProperties) = preSolution
 		HideSolutionNode = FALSE



From codeandroid at berlios.de  Wed Mar 15 22:03:40 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 22:03:40 +0100
Subject: [Yake-svn] r1286 - trunk/yake/yapp/samples/misc/scripted
Message-ID: <200603152103.k2FL3eJa024782@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 22:03:39 +0100 (Wed, 15 Mar 2006)
New Revision: 1286

Modified:
   trunk/yake/yapp/samples/misc/scripted/yakePCH.h
Log:


Modified: trunk/yake/yapp/samples/misc/scripted/yakePCH.h
===================================================================
--- trunk/yake/yapp/samples/misc/scripted/yakePCH.h	2006-03-15 21:00:29 UTC (rev 1285)
+++ trunk/yake/yapp/samples/misc/scripted/yakePCH.h	2006-03-15 21:03:39 UTC (rev 1286)
@@ -12,5 +12,3 @@
 // Yapp
 #include <yapp/base/yapp.h>
 #include <yapp/base/event/yakeEvent.h>
-#include <yapp/statemachine/yakeFiniteStateMachine.h>
-#include <yapp/ent/yakeEnt.h>



From codeandroid at berlios.de  Wed Mar 15 22:24:00 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Wed, 15 Mar 2006 22:24:00 +0100
Subject: [Yake-svn] r1287 - trunk/yake/src/yake/plugins/baseLuaBindings
Message-ID: <200603152124.k2FLO0si027279@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-15 22:24:00 +0100 (Wed, 15 Mar 2006)
New Revision: 1287

Modified:
   trunk/yake/src/yake/plugins/baseLuaBindings/yakeLuaBinder.cpp
Log:
more bindings

Modified: trunk/yake/src/yake/plugins/baseLuaBindings/yakeLuaBinder.cpp
===================================================================
--- trunk/yake/src/yake/plugins/baseLuaBindings/yakeLuaBinder.cpp	2006-03-15 21:03:39 UTC (rev 1286)
+++ trunk/yake/src/yake/plugins/baseLuaBindings/yakeLuaBinder.cpp	2006-03-15 21:24:00 UTC (rev 1287)
@@ -87,6 +87,13 @@
 				    .def( constructor< real, real, real >() )
 				    .def( constructor< const real* const >() )
 				    .def( constructor< Vector3 const& >() )
+					 .def( "length", &yake::math::Vector3::length )
+					 .def( "normalise", &yake::math::Vector3::normalise )
+					 .def( "crossProduct", &yake::math::Vector3::crossProduct )
+					 .def( "dotProduct", &yake::math::Vector3::dotProduct )
+					 .def( "reflect", &yake::math::Vector3::reflect )
+					 .def( "perpendicular", &yake::math::Vector3::perpendicular )
+					 .def( "getRotationTo", &yake::math::Vector3::getRotationTo )
 				];
 
 				// Vector4
@@ -123,8 +130,12 @@
 				// RandomNumberGenerator
 				module( YAKE_MATH_MODULE )
 				[
-				    class_< RandomNumberGeneratorMT >( "RandomNumberGeneratorMT" )
+				    class_< RandomNumberGeneratorMT >( "RandomNumberGenerator" )
 				    .def( constructor<>() )
+					 .def( "setSeed", &RandomNumberGeneratorMT::setSeed )
+					 .def( "getSeed", &RandomNumberGeneratorMT::getSeed )
+					 .def( "randInt", &RandomNumberGeneratorMT::randInt )
+					 .def( "randReal", &RandomNumberGeneratorMT::randReal )
 				];
 
 			}



From codeandroid at berlios.de  Thu Mar 16 23:30:37 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Thu, 16 Mar 2006 23:30:37 +0100
Subject: [Yake-svn] r1288 - trunk/yake/documentation/api
Message-ID: <200603162230.k2GMUbaQ018684@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-16 23:30:36 +0100 (Thu, 16 Mar 2006)
New Revision: 1288

Modified:
   trunk/yake/documentation/api/DoxySfile
Log:
uppercase project name,
different tab size,
clean up

Modified: trunk/yake/documentation/api/DoxySfile
===================================================================
--- trunk/yake/documentation/api/DoxySfile	2006-03-15 21:24:00 UTC (rev 1287)
+++ trunk/yake/documentation/api/DoxySfile	2006-03-16 22:30:36 UTC (rev 1288)
@@ -3,11 +3,9 @@
 #---------------------------------------------------------------------------
 # General configuration options
 #---------------------------------------------------------------------------
-PROJECT_NAME                        = Yake
+PROJECT_NAME                        = YAKE
 PROJECT_NUMBER                      = 
-#INPUT                               = yake/base/math yake/base/mpl yake/base/native yake/base/templates yake/base
-#INPUT                               = yake/audio yake/data yake/ent yake/file yake/graphics yake/input yake/net yake/object yake/physics yake/prop yake/scripting yake/statemachine
-#INPUT                               = yake/base
+#INPUT                               = yake/msg
 INPUT                               = documentation/api yake/base/math yake/base/mpl yake/base/native yake/base/templates yake/base yake/audio yake/data yake/ent yake/file yake/graphics yake/input yake/net yake/object yake/physics yake/prop yake/scripting yake/statemachine yake/msg
 OUTPUT_DIRECTORY                    = documentation/api/html
 GENERATE_DOXYS_HELP                 = YES
@@ -73,7 +71,7 @@
 # Options to control how the input is parsed
 #---------------------------------------------------------------------------
 HIDE_IN_BODY_DOCS                   = YES
-TAB_SIZE                            = 3
+TAB_SIZE                            = 4
 ALIASES                             = 
 ENABLED_SECTIONS                    = 
 IGNORE_CLASS_PREFIX                 = 



From codeandroid at berlios.de  Thu Mar 16 23:31:52 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Thu, 16 Mar 2006 23:31:52 +0100
Subject: [Yake-svn] r1289 - trunk/yake/yake/msg
Message-ID: <200603162231.k2GMVqCx018824@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-16 23:31:52 +0100 (Thu, 16 Mar 2006)
New Revision: 1289

Modified:
   trunk/yake/yake/msg/listener.h
   trunk/yake/yake/msg/listener_mgr.h
   trunk/yake/yake/msg/message.h
   trunk/yake/yake/msg/processors.h
   trunk/yake/yake/msg/router.h
Log:
added message sources,
added documentation

Modified: trunk/yake/yake/msg/listener.h
===================================================================
--- trunk/yake/yake/msg/listener.h	2006-03-16 22:30:36 UTC (rev 1288)
+++ trunk/yake/yake/msg/listener.h	2006-03-16 22:31:52 UTC (rev 1289)
@@ -31,23 +31,30 @@
 
 MSG_NAMESPACE_BEGIN
 
-	struct listener_base
-	{
-		listener_base(const std::string& msgTypeName) : msgTypeName_(msgTypeName) {}
-		void execute(const message_base& msg)
-		{ doExecute(msg); }
-		const std::string& msgTypeName() const
-		{ return msgTypeName_; }
-		void destroy()
+	namespace detail {
+		/** Internal base class for listeners providing the basic interface and functionality. */
+		struct listener_base
 		{
-			assert( this );
-			delete this;
-		}
-	protected:
-		virtual void doExecute(const message_base&) = 0;
-	private:
-		std::string		msgTypeName_;
-	};
+		private:
+			listener_base(const listener_base&);
+			listener_base& operator = (const listener_base&);
+		public:
+			listener_base(const std::string& msgTypeName) : msgTypeName_(msgTypeName) {}
+			void execute(const message_base& msg)
+			{ doExecute(msg); }
+			const std::string& msgTypeName() const
+			{ return msgTypeName_; }
+			void destroy()
+			{
+				assert( this );
+				delete this;
+			}
+		protected:
+			virtual void doExecute(const message_base&) = 0;
+		private:
+			std::string		msgTypeName_;
+		};
+	} // namespace detail
 	/*
 	enum ListenerResult
 	{
@@ -56,15 +63,25 @@
 		LR_FAILED
 	};
 	*/
+	/** Represents a listener for a specific type; \
+		the listener object encapsulates a user provided message handling function object.
+	*/
 	template<typename MsgType>
-	struct listener : public listener_base
+	struct listener : public detail::listener_base
 	{
+	private:
+		listener(const listener&);
+		listener& operator(const listener&);
+	public:
 		typedef boost::function<void(const MsgType&)> HandlerFn;
 
-		listener(const HandlerFn& fn) : listener_base(typeid(MsgType).name()),fn_(fn)
+		/** Construct a listener object with a handler function. The handler function has to be valid (i.e. non-empty).
+		*/
+		listener(const HandlerFn& fn) : detail::listener_base(typeid(MsgType).name()),fn_(fn)
 		{}
 	protected:
-		virtual void doExecute(const message_base& msgbase)
+		/** Executes the message handler function object and provides the message 'msgbase' as a parameter. */
+		virtual void doExecute(const detail::message_base& msgbase)
 		{
 			try {
 				fn_( static_cast<const MsgType&>(boost::any_cast<MsgType>(msgbase.value())) );
@@ -82,6 +99,7 @@
 		HandlerFn			fn_;
 	};
 
+	/** Helper function to easily create listener objects for a given message type. */
 	template<typename T>
 	listener<T>* makeListener(const boost::function<void(const T&)>& fn)
 	{ return new listener<T>(fn); }

Modified: trunk/yake/yake/msg/listener_mgr.h
===================================================================
--- trunk/yake/yake/msg/listener_mgr.h	2006-03-16 22:30:36 UTC (rev 1288)
+++ trunk/yake/yake/msg/listener_mgr.h	2006-03-16 22:31:52 UTC (rev 1289)
@@ -32,34 +32,47 @@
 MSG_NAMESPACE_BEGIN
 
 	namespace detail {
-		typedef std::deque<boost::shared_ptr<listener_base> > listener_list;
+		typedef std::deque<boost::shared_ptr<detail::listener_base> > listener_list;
 		typedef std::map<std::string,listener_list> listener_map;
 
+		/** Internal base class providing listener management and
+			a hook for derived routers/processors.
+		*/
 		struct msg_listener_mgr
 		{
-			bool add(listener_base* l)
+			bool add(detail::listener_base* l, source_type source = 0)
 			{
-				assert(l);
+				YAKE_ASSERT(l);
 				if (!l)
 					return false;
-				listeners_[l->msgTypeName()].push_back( boost::shared_ptr<listener_base>(l) );
+				sources_[source][l->msgTypeName()].push_back( boost::shared_ptr<detail::listener_base>(l) );
 				return true;
 			}
-			void process(message_base* msg)
+			void process(detail::message_base* msg)
 			{
-				assert( msg );
-				listener_map::const_iterator itMsgType = listeners_.find(msg->msgTypeName());
-				if (itMsgType == listeners_.end())
+				YAKE_ASSERT( msg );
+				source_map::const_iterator itSource = sources_.find(msg->source());
+				if (itSource == sources_.end())
 					return;
+				const listener_map& listeners = itSource->second;
+				listener_map::const_iterator itMsgType = listeners.find(msg->msgTypeName());
+				if (itMsgType == listeners.end())
+					return;
 				const listener_list& l = itMsgType->second;
 				for (listener_list::const_iterator it = l.begin(); it != l.end(); ++it)
 					(*it)->execute(*msg);
 				MSG_NAMESPACE::destroyMessage(msg);
 			}
+			void clear()
+			{
+				sources_.clear();
+			}
 		private:
 			typedef MSG_NAMESPACE::detail::listener_list listener_list;
 			typedef MSG_NAMESPACE::detail::listener_map listener_map;
-			listener_map	listeners_;
+			typedef AssocVector<source_type,listener_map> source_map;
+			source_map		sources_;
+			//listener_map	listeners_;
 		};
 	}
 

Modified: trunk/yake/yake/msg/message.h
===================================================================
--- trunk/yake/yake/msg/message.h	2006-03-16 22:30:36 UTC (rev 1288)
+++ trunk/yake/yake/msg/message.h	2006-03-16 22:31:52 UTC (rev 1289)
@@ -31,56 +31,84 @@
 
 MSG_NAMESPACE_BEGIN
 
-	struct message_base
-	{
-	private:
-		message_base(const message_base&);
-		message_base& operator=(const message_base&);
-	public:
-		template<typename T>
-		message_base(const T& value) : value_(value), msgTypeName_(typeid(T).name())
-		{}
-		const boost::any& value() const
-		{ return value_; }
-		const std::string& msgTypeName() const
-		{ return msgTypeName_; }
-	protected:
-		boost::any		value_;
-	private:
-		std::string		msgTypeName_;
-	};
+	/** Represents the (optionally to be used) source of a message. */
+	typedef const void* source_type;
+
+	/** @copydoc source_type
+		@Remarks This is an alias for good looking client code.
+	*/
+	typedef source_type Source;
+
+	namespace detail {
+		/** Internal base class for messages providing the very basic interface.
+		*/
+		struct message_base
+		{
+		private:
+			message_base(const message_base&);
+			message_base& operator=(const message_base&);
+		public:
+			template<typename T>
+			message_base(const T& value, source_type src = 0) : value_(value), msgTypeName_(typeid(T).name()), src_(src)
+			{}
+			const boost::any& value() const
+			{ return value_; }
+			const std::string& msgTypeName() const
+			{ return msgTypeName_; }
+			source_type source() const
+			{ return src_; }
+		protected:
+			boost::any		value_;
+		private:
+			std::string		msgTypeName_;
+			source_type		src_;
+		};
+	} // namespace detail
+	/** Represents a concrete message for the type T.
+		Provides value assignment.
+	*/
 	template<typename T>
-	struct message : public message_base
+	struct message : public detail::message_base
 	{
-		message(const T& v) : message_base(v)
+		/** Construct a message with value and optional source (0 by default).
+			
+		*/
+		message(const T& v, source_type src = 0) : detail::message_base(v,src)
 		{}
-		message() : message_base(T())
+		/** Construct a message with default value for type T and source 0. */
+		message() : detail::message_base(T())
 		{}
+		/** Set the value to v. */
 		void setValue(const T& v)
-		{ value_ = v; } //@todo add type mismatch tests
+		{ value_ = v; } //@todo add type mismatch tests!?
 	};
 
+	/** As the name implies this allocator is used by default for message creation and destruction. */
 	struct DefaultMessageAllocator
 	{
 		DefaultMessageAllocator& instance();
 		template<typename T>
-		static message<T>* create(const T& v)
+		static message<T>* create(const T& v, source_type src = 0)
 		{
-			return new message<T>(v);
+			return new message<T>(v,src);
 		}
 		template<typename MsgType>
 		static void destroy(const MsgType* msg)
 		{
-			assert( msg );
+			YAKE_ASSERT( msg );
 			delete msg;
 		}
 	};
 
+	/** Helper function to easily create messages.
+	*/
 	template<typename T>
-	message<T>* makeMessage(const T& v)
+	message<T>* makeMessage(const T& v, source_type src = 0)
 	{ 
-		return DefaultMessageAllocator::create<T>(v); 
+		return DefaultMessageAllocator::create<T>(v,src); 
 	}
+
+	/** Destroys the message. */
 	template<typename T>
 	void destroyMessage(T* msg)
 	{ 

Modified: trunk/yake/yake/msg/processors.h
===================================================================
--- trunk/yake/yake/msg/processors.h	2006-03-16 22:30:36 UTC (rev 1288)
+++ trunk/yake/yake/msg/processors.h	2006-03-16 22:31:52 UTC (rev 1289)
@@ -31,17 +31,23 @@
 
 MSG_NAMESPACE_BEGIN
 
+	/** Processes messages immediately when they are possed. */
 	struct ImmediateProcessor : public detail::msg_listener_mgr
 	{
 		typedef detail::listener_map listener_map;
 		typedef detail::listener_list listener_list;
 
-		void onPost(message_base* msg)
+		void onPost(detail::message_base* msg)
 		{
-			assert(msg);
+			YAKE_ASSERT(msg);
 			this->process(msg);
 		}
 	};
+	/** Queues messages in a single queue and processes them when processMessages() is called.
+		@Remarks It is not possible post messages while processing is in progress! See DoubleQueuedProcessor for a processor which can do that. processMessages() must not be called when processing is already in progress.
+		@see ImmediateProcessor
+		@see DoubleQueuedProcessor
+	*/
 	struct SingleQueuedProcessor : public detail::msg_listener_mgr
 	{
 		typedef detail::listener_map listener_map;
@@ -49,60 +55,65 @@
 
 		SingleQueuedProcessor() : isProcessing_(false)
 		{}
-		void onPost(message_base* msg)
+		void onPost(detail::message_base* msg)
 		{
-			assert(!isProcessing_);
-			assert(msg);
+			YAKE_ASSERT(!isProcessing_);
+			YAKE_ASSERT(msg);
 			q_.push_back(msg); //@todo sort by msg type!?
 		}
 		void processMessages()
 		{
-			assert( !isProcessing_ );
+			YAKE_ASSERT( !isProcessing_ );
 			isProcessing_ = true;
 			for (msg_q::const_iterator it = q_.begin(); it != q_.end(); ++it)
 			{
-				message_base* msg = *it;
-				assert( msg );
+				detail::message_base* msg = *it;
+				YAKE_ASSERT( msg );
 				this->process(msg);
 			}
 			q_.clear();
 			isProcessing_ = false;
 		}
 	private:
-		typedef std::deque<message_base*> msg_q;
+		typedef std::deque<detail::message_base*> msg_q;
 		msg_q		q_;
 		bool		isProcessing_;
 	};
+	/** Queues messages in a single queue and processes them when processMessages() is called.
+		@Remarks It is possible post messages while processing is in progress! processMessages() must not be called when processing is already in progress.
+		@see ImmediateProcessor
+		@see SingleQueuedProcessor
+	*/
 	struct DoubleQueuedProcessor : public detail::msg_listener_mgr
 	{
 		typedef detail::listener_map listener_map;
 		typedef detail::listener_list listener_list;
 
 		DoubleQueuedProcessor() : q_(&q1_), isProcessing_(false) {}
-		void onPost(message_base* msg)
+		void onPost(detail::message_base* msg)
 		{
-			assert(msg);
+			YAKE_ASSERT(msg);
 			q_->push_back(msg); //@todo sort by msg type!?
 		}
 		void processMessages()
 		{
-			assert( !isProcessing_ );
+			YAKE_ASSERT( !isProcessing_ );
 			isProcessing_ = true;
 			msg_q* procQ = q_;
 			q_ = (q_ == &q1_) ? &q2_ : &q1_;
 			for (msg_q::const_iterator it = procQ->begin(); it != procQ->end(); ++it)
 			{
-				message_base* msg = *it;
-				assert( msg );
+				detail::message_base* msg = *it;
+				YAKE_ASSERT( msg );
 				this->process(msg);
 			}
 			procQ->clear();
 			isProcessing_ = false;
 		}
 	private:
-		typedef std::deque<message_base*> msg_q;
+		typedef std::deque<detail::message_base*> msg_q;
 		msg_q		q1_,q2_;
-		msg_q*	q_;
+		msg_q*		q_;
 		bool		isProcessing_;
 	};
 

Modified: trunk/yake/yake/msg/router.h
===================================================================
--- trunk/yake/yake/msg/router.h	2006-03-16 22:30:36 UTC (rev 1288)
+++ trunk/yake/yake/msg/router.h	2006-03-16 22:31:52 UTC (rev 1289)
@@ -31,29 +31,52 @@
 
 MSG_NAMESPACE_BEGIN
 
+	/** Generic customizable message router which represents a central point for listener management, message posting and message processing.
+		
+		Example:
+		@code
+			using namespace msg;
+
+			router< ImmediateProcessor > myrouter;
+
+			myrouter.post(makeMessage(1)); // int(1) is the message
+			myrouter.postMessage(1); // the same - but using an alternative posting method
+		@endcode
+		@see detail::msg_listener_mgr
+		@todo merge documentation of listener_mgr into router's docs.
+	*/
 	template<typename T_processor>
 	struct router : public T_processor
 	{
+	private:
+		// disallow:
+		router(const router&);
+		router& operator=(const router&);
+	public:
+		/** @todo add docs */
+		typedef T_processor processor_type;
+
+		/** Construct a router. */
 		router();
 
 		template<typename T>
-		void postMessage(const T& v)
-		{ this->post( MSG_NAMESPACE::makeMessage(v) ); }
+		void postMessage(const T& v, source_type source = 0)
+		{ this->post( MSG_NAMESPACE::makeMessage(v,source) ); }
 
-		void post(message_base* msg)
+		/** Post a message. Processing is controlled by T_processor.
+			@see postMessage()
+		*/
+		void post(detail::message_base* msg)
 		{
 			this->onPost(msg);
 		}
 
+		/** Operator for listener registration (with source identifier 0). */
+		router& operator << (detail::listener_base*);
+		/** Operator for listener registration with user supplied source identifier. */
+		router& operator << (const std::pair<detail::listener_base*,source_type>&);
 
-		router& operator << (listener_base*);
-
 	private:
-		// disallow:
-		router(const router&);
-		router& operator=(const router&);
-		//...
-	private:
 		typedef detail::listener_list listener_list;
 		typedef detail::listener_map listener_map;
 	};
@@ -61,15 +84,23 @@
 	router<T_processor>::router()
 	{}
 	template<typename T_processor>
-	router<T_processor>& router<T_processor>::operator << (listener_base* l)
+	router<T_processor>& router<T_processor>::operator << (detail::listener_base* l)
 	{
-		assert(l);
+		YAKE_ASSERT(l);
 		if (!l)
 			return *this;
 		this->add(l);
 		return *this;
 	}
-
+	template<typename T_processor>
+	router<T_processor>& router<T_processor>::operator << (const std::pair<detail::listener_base*,source_type>& l)
+	{
+		YAKE_ASSERT(l.first);
+		if (!l.first)
+			return *this;
+		this->add(l.first,l.second);
+		return *this;
+	}
 MSG_NAMESPACE_END
 
 #endif



From codeandroid at berlios.de  Thu Mar 16 23:32:58 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Thu, 16 Mar 2006 23:32:58 +0100
Subject: [Yake-svn] r1290 - trunk/yake/yake/statemachine
Message-ID: <200603162232.k2GMWwwp018968@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-16 23:32:58 +0100 (Thu, 16 Mar 2006)
New Revision: 1290

Modified:
   trunk/yake/yake/statemachine/fsm_oo_machine.h
Log:
const correctness

Modified: trunk/yake/yake/statemachine/fsm_oo_machine.h
===================================================================
--- trunk/yake/yake/statemachine/fsm_oo_machine.h	2006-03-16 22:31:52 UTC (rev 1289)
+++ trunk/yake/yake/statemachine/fsm_oo_machine.h	2006-03-16 22:32:58 UTC (rev 1290)
@@ -43,9 +43,9 @@
 		{
 		}
 
-		void addState(const state_type);
-		void addTransition(const state_type, const event_type&, const state_type);
-		void setState(const state_type);
+		void addState(state_type);
+		void addTransition(state_type, const event_type&, state_type);
+		void setState(state_type);
 		void processEvent(const event_type& evt);
 		const state_type& current() const
 		{ return machine_.current(); }
@@ -73,17 +73,17 @@
 		state->onExit();
 	}
 	template<typename _state_class_type, typename _event_type>
-	void oomachine<_state_class_type,_event_type>::addState(const state_type s)
+	void oomachine<_state_class_type,_event_type>::addState(state_type s)
 	{
 		machine_.addState(s);
 	}
 	template<typename _state_class_type, typename _event_type>
-	void oomachine<_state_class_type,_event_type>::addTransition(const state_type from, const event_type& ev, const state_type to)
+	void oomachine<_state_class_type,_event_type>::addTransition(state_type from, const event_type& ev, state_type to)
 	{
 		machine_.addTransition( from, ev, to );
 	}
 	template<typename _state_class_type, typename _event_type>
-	void oomachine<_state_class_type,_event_type>::setState(const state_type s)
+	void oomachine<_state_class_type,_event_type>::setState(state_type s)
 	{
 		if (machine_.current())
 			fnExit_( machine_, machine_.current() );



From codeandroid at berlios.de  Thu Mar 16 23:33:44 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Thu, 16 Mar 2006 23:33:44 +0100
Subject: [Yake-svn] r1291 - trunk/yake/src/yake/samples/msg/sampleMsg1
Message-ID: <200603162233.k2GMXiQw019045@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-16 23:33:44 +0100 (Thu, 16 Mar 2006)
New Revision: 1291

Modified:
   trunk/yake/src/yake/samples/msg/sampleMsg1/demo.cpp
Log:
demo message source based subscriptions,
added comments

Modified: trunk/yake/src/yake/samples/msg/sampleMsg1/demo.cpp
===================================================================
--- trunk/yake/src/yake/samples/msg/sampleMsg1/demo.cpp	2006-03-16 22:32:58 UTC (rev 1290)
+++ trunk/yake/src/yake/samples/msg/sampleMsg1/demo.cpp	2006-03-16 22:33:44 UTC (rev 1291)
@@ -46,7 +46,7 @@
 	}
 	static void destroy(msg::message<MsgResize>* msg)
 	{
-		assert( pool_.is_from(msg) );
+		YAKE_ASSERT( pool_.is_from(msg) );
 		pool_.destroy( msg );
 	}
 private:
@@ -81,12 +81,23 @@
 	}
 
 	template<typename A1, typename A2>
-	ObjectMessage(const std::string& name1, const A1& a1, const std::string& name2, const A2& a2)
+	ObjectMessage(	const std::string& name1, const A1& a1,
+					const std::string& name2, const A2& a2)
 	{
 		params_[ name1 ] = a1;
 		params_[ name2 ] = a2;
 	}
 
+	template<typename A1, typename A2, typename A3>
+	ObjectMessage(	const std::string& name1, const A1& a1,
+					const std::string& name2, const A2& a2,
+					const std::string& name3, const A3& a3)
+	{
+		params_[ name1 ] = a1;
+		params_[ name2 ] = a2;
+		params_[ name3 ] = a3;
+	}
+
 	size_t size() const
 	{ return params_.size(); }
 
@@ -99,6 +110,7 @@
 {
 	// Default/Immediate processing:
 	{
+		YAKE_LOG_INFORMATION("demo: immediate processing");
 		msg::router<msg::ImmediateProcessor> router;
 
 		// The following message will be lost as there's no handler registered yet!
@@ -110,12 +122,18 @@
 		router << msg::makeListener<MsgResize>(&app_handle_MsgResize2);
 
 		// post a few message to different handlers (depending on type)
+
+		// The following 2 calls result in the same. makeMessage() can be useful for creating and queuing
+		// message prior to sending them.
+		router.postMessage(1234);
 		router.post(msg::makeMessage(1234));
+
 		router.post(msg::makeMessage(123.12));
 		router.post(msg::makeMessage(MsgResize(20,30)));
 	}
 	//Q'd :
 	{
+		YAKE_LOG_INFORMATION("demo: 1-queued processing");
 		msg::router<msg::SingleQueuedProcessor> router;
 
 		// The following message will *not* be lost even though there's no handler registered yet!
@@ -130,6 +148,7 @@
 
 	//Double-Q'd :
 	{
+		YAKE_LOG_INFORMATION("demo: 2-queued processing");
 		msg::router<msg::DoubleQueuedProcessor> router;
 
 		// add a few handlers/listeners
@@ -145,5 +164,18 @@
 		// @todo
 		router.postMessage(ObjectMessage("entity",0x00a0a0a0,"name",std::string("freak")));
 	}
+	// Default/Immediate processing using source identifiers
+	{
+		YAKE_LOG_INFORMATION("demo: immediate processing with subscription to source identifiers");
+		msg::router<msg::ImmediateProcessor> router;
+
+		// register a few handlers
+		router << std::make_pair(msg::makeListener<MsgResize>(&app_handle_MsgResize1),msg::Source(12));
+
+		// post a few message to different handlers (depending on type)
+		router.post(msg::makeMessage(MsgResize(44,44)));
+		router.post(msg::makeMessage(MsgResize(55,55),msg::Source(11)));
+		router.post(msg::makeMessage(MsgResize(66,66),msg::Source(12)));
+	}
 }
 



From codeandroid at berlios.de  Thu Mar 16 23:34:36 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Thu, 16 Mar 2006 23:34:36 +0100
Subject: [Yake-svn] r1293 - trunk/yake/yapp/raf
Message-ID: <200603162234.k2GMYasF019198@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-16 23:34:35 +0100 (Thu, 16 Mar 2006)
New Revision: 1293

Modified:
   trunk/yake/yapp/raf/pch.h
   trunk/yake/yapp/raf/yakeApplicationState.h
   trunk/yake/yapp/raf/yakeRaf.h
Log:
ported to new yake::statemachine

Modified: trunk/yake/yapp/raf/pch.h
===================================================================
--- trunk/yake/yapp/raf/pch.h	2006-03-16 22:34:24 UTC (rev 1292)
+++ trunk/yake/yapp/raf/pch.h	2006-03-16 22:34:35 UTC (rev 1293)
@@ -32,6 +32,8 @@
 #include <yake/audio/yakeAudio.h>
 #include <yake/scripting/yakeScriptingSystem.h>
 #include <yapp/base/yapp.h>
-#include <yapp/ent/yakeEnt.h>
+#include <yake/statemachine/fsm_core.h>
+#include <yake/statemachine/fsm_oo_machine.h>
+#include <yake/ent/ent.h>
 
-#include <yapp/raf/yakePrerequisites.h>
\ No newline at end of file
+#include <yapp/raf/yakePrerequisites.h>

Modified: trunk/yake/yapp/raf/yakeApplicationState.h
===================================================================
--- trunk/yake/yapp/raf/yakeApplicationState.h	2006-03-16 22:34:24 UTC (rev 1292)
+++ trunk/yake/yapp/raf/yakeApplicationState.h	2006-03-16 22:34:35 UTC (rev 1293)
@@ -31,12 +31,10 @@
 namespace raf {
 	class Application;
 
-	typedef YAKE_RAF_API state::Machine<String> AppMachine;
-
 	/** Application states of the application state machine are represented by derived
 		classes of this type.
 	*/
-	class YAKE_RAF_API ApplicationState : public yake::state::State
+	class YAKE_RAF_API ApplicationState
 	{
 		ApplicationState();
 	public:
@@ -45,11 +43,40 @@
 
 		Application& getApp();
 		const Application& getApp() const;
+
+		virtual void onEnter() {}
+		virtual void onStep() {}
+		virtual void onExit() {}
 	private:
 		Application&	mOwner;
 	};
 	typedef ApplicationState* ApplicationStatePtr;
 
+	class YAKE_RAF_API AppMachine
+	{
+	private:
+		AppMachine(const AppMachine&);
+		AppMachine& operator=(const AppMachine&);
+	public:
+		AppMachine();
+		~AppMachine();
+
+		typedef String event_type;
+		void addState(const String&, ApplicationState*);
+		void setState(const String&);
+		void addTransition(const String&, const event_type&, const String&);
+		void processEvent(const event_type&);
+		//const String& currentName() const;
+
+		void step();
+	private:
+		typedef fsm::oomachine<ApplicationState,String> fsm_type;
+		fsm_type						machine_;
+
+		typedef AssocVector<String,SharedPtr<ApplicationState> > state_map;
+		state_map					states_;
+	};
+
 	/** Main state base class */
 	class YAKE_RAF_API MainState : public ApplicationState
 	{
@@ -65,4 +92,14 @@
 } // namespace raf
 } // namespace yake
 
+namespace fsm {
+	template <>
+	inline const yake::raf::ApplicationStatePtr& get_null_state<yake::raf::ApplicationState*>()
+	{
+		static yake::raf::ApplicationStatePtr ms_null = 0;
+		return ms_null;
+	}
+}
+
+
 #endif

Modified: trunk/yake/yapp/raf/yakeRaf.h
===================================================================
--- trunk/yake/yapp/raf/yakeRaf.h	2006-03-16 22:34:24 UTC (rev 1292)
+++ trunk/yake/yapp/raf/yakeRaf.h	2006-03-16 22:34:35 UTC (rev 1293)
@@ -28,7 +28,7 @@
 #define YAKE_RAF_H
 
 #include <yapp/raf/yakePrerequisites.h>
-#include <yapp/statemachine/yakeFiniteStateMachine.h>
+#include <yake/statemachine/fsm_oo_machine.h>
 #include <yapp/raf/yakeApplicationState.h>
 #include <yapp/raf/yakeRtApplicationState.h>
 #include <yapp/raf/yakeApplication.h>



From codeandroid at berlios.de  Thu Mar 16 23:34:24 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Thu, 16 Mar 2006 23:34:24 +0100
Subject: [Yake-svn] r1292 - trunk/yake/src/yapp/raf
Message-ID: <200603162234.k2GMYOPx019127@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-16 23:34:24 +0100 (Thu, 16 Mar 2006)
New Revision: 1292

Modified:
   trunk/yake/src/yapp/raf/yakeApplication.cpp
   trunk/yake/src/yapp/raf/yakeApplicationState.cpp
Log:
ported to new yake::statemachine

Modified: trunk/yake/src/yapp/raf/yakeApplication.cpp
===================================================================
--- trunk/yake/src/yapp/raf/yakeApplication.cpp	2006-03-16 22:33:44 UTC (rev 1291)
+++ trunk/yake/src/yapp/raf/yakeApplication.cpp	2006-03-16 22:34:24 UTC (rev 1292)
@@ -363,7 +363,7 @@
 #endif
 
 		// application state machine
-		mMachine = new AppMachine( state::TH_RELAXED );
+		mMachine = new AppMachine();
 		YAKE_ASSERT( mMachine );
 		if (!mMachine)
 			return false;
@@ -388,7 +388,6 @@
 		YAKE_ASSERT( mMachine );
 		if (mMachine)
 		{
-			mMachine->exitAll();
 			YAKE_SAFE_DELETE( mMachine );
 		}
 #if YAKE_RAF_USES_CEGUI == 1
@@ -420,7 +419,7 @@
 		YAKE_ASSERT( mMachine );
 		if (!mMachine)
 			return false;
-		mMachine->changeTo("main");
+		mMachine->setState("main"); // initial state
 		mMachine->step();
 		return true;
 	}

Modified: trunk/yake/src/yapp/raf/yakeApplicationState.cpp
===================================================================
--- trunk/yake/src/yapp/raf/yakeApplicationState.cpp	2006-03-16 22:33:44 UTC (rev 1291)
+++ trunk/yake/src/yapp/raf/yakeApplicationState.cpp	2006-03-16 22:34:24 UTC (rev 1292)
@@ -58,16 +58,55 @@
 	}
 	void MainState::onEnter()
 	{
-		std::cout << "MainState::onEnter()\n";
+		YAKE_LOG_INFORMATION("MainState::onEnter()");
 	}
 	void MainState::onExit()
 	{
-		std::cout << "MainState::onExit()\n";
+		YAKE_LOG_INFORMATION("MainState::onExit()");
 	}
 	void MainState::onStep()
 	{
-		std::cout << "MainState::onStep()\n";
+		YAKE_LOG_INFORMATION("MainState::onStep()");
 	}
 
+	//-----------------------------------------------------
+	// Class: AppMachine
+	//-----------------------------------------------------
+	AppMachine::AppMachine()
+	{}
+	AppMachine::~AppMachine()
+	{}
+	void AppMachine::addState(const String& stateId, ApplicationState* state)
+	{
+		YAKE_ASSERT( !stateId.empty() );
+		YAKE_ASSERT( state );
+		YAKE_ASSERT( states_.end() == states_.find(stateId) );
+		states_.insert( state_map::value_type(stateId,SharedPtr<ApplicationState>(state)) );
+		machine_.addState( state );
+	}
+	void AppMachine::setState(const String& stateId)
+	{
+		state_map::const_iterator it = states_.find(stateId);
+		YAKE_ASSERT( states_.end() != it );
+		machine_.setState( it->second.get() );
+	}
+	void AppMachine::addTransition(const String& from, const event_type& evt, const String& to)
+	{
+		state_map::const_iterator itFrom = states_.find(from);
+		YAKE_ASSERT( states_.end() != itFrom );
+		state_map::const_iterator itTo = states_.find(to);
+		YAKE_ASSERT( states_.end() != itTo );
+		machine_.addTransition( itFrom->second.get(), evt, itTo->second.get() );
+	}
+	void AppMachine::processEvent(const event_type& evt)
+	{
+		machine_.processEvent( evt );
+	}
+	void AppMachine::step()
+	{
+		YAKE_ASSERT( machine_.current() );
+		machine_.current()->onStep();
+	}
+
 } // namespace raf
 } // namespace yake



From codeandroid at berlios.de  Thu Mar 16 23:37:28 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Thu, 16 Mar 2006 23:37:28 +0100
Subject: [Yake-svn] r1294 - trunk/yake/yake/msg
Message-ID: <200603162237.k2GMbS60019372@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-16 23:37:28 +0100 (Thu, 16 Mar 2006)
New Revision: 1294

Modified:
   trunk/yake/yake/msg/router.h
Log:
added documentation

Modified: trunk/yake/yake/msg/router.h
===================================================================
--- trunk/yake/yake/msg/router.h	2006-03-16 22:34:35 UTC (rev 1293)
+++ trunk/yake/yake/msg/router.h	2006-03-16 22:37:28 UTC (rev 1294)
@@ -41,7 +41,12 @@
 
 			myrouter.post(makeMessage(1)); // int(1) is the message
 			myrouter.postMessage(1); // the same - but using an alternative posting method
+
+			myrouter.postMessage(1,Source(12)); // posting message int(1) from source 12
 		@endcode
+
+		For more elaborate examples see the source distribution.
+
 		@see detail::msg_listener_mgr
 		@todo merge documentation of listener_mgr into router's docs.
 	*/



From codeandroid at berlios.de  Fri Mar 17 21:30:24 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Fri, 17 Mar 2006 21:30:24 +0100
Subject: [Yake-svn] r1295 - trunk/yake/yake/msg
Message-ID: <200603172030.k2HKUOsJ000806@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-17 21:30:21 +0100 (Fri, 17 Mar 2006)
New Revision: 1295

Modified:
   trunk/yake/yake/msg/listener.h
Log:
added missing =

Modified: trunk/yake/yake/msg/listener.h
===================================================================
--- trunk/yake/yake/msg/listener.h	2006-03-16 22:37:28 UTC (rev 1294)
+++ trunk/yake/yake/msg/listener.h	2006-03-17 20:30:21 UTC (rev 1295)
@@ -71,7 +71,7 @@
 	{
 	private:
 		listener(const listener&);
-		listener& operator(const listener&);
+		listener& operator=(const listener&);
 	public:
 		typedef boost::function<void(const MsgType&)> HandlerFn;
 



From codeandroid at berlios.de  Fri Mar 17 21:33:46 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Fri, 17 Mar 2006 21:33:46 +0100
Subject: [Yake-svn] r1296 - trunk/yake/scripts/msvc8
Message-ID: <200603172033.k2HKXk18001196@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-17 21:33:06 +0100 (Fri, 17 Mar 2006)
New Revision: 1296

Added:
   trunk/yake/scripts/msvc8/msg2.vcproj
Log:
initial version

Added: trunk/yake/scripts/msvc8/msg2.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/msg2.vcproj	2006-03-17 20:30:21 UTC (rev 1295)
+++ trunk/yake/scripts/msvc8/msg2.vcproj	2006-03-17 20:33:06 UTC (rev 1296)
@@ -0,0 +1,232 @@
+<?xml version="1.0" encoding="Windows-1252"?>
+<VisualStudioProject
+	ProjectType="Visual C++"
+	Version="8,00"
+	Name="msg2"
+	ProjectGUID="{9E9DDB4A-CF98-4ED5-AB85-D3F5E71AE912}"
+	RootNamespace="yake"
+	Keyword="Win32Proj"
+	>
+	<Platforms>
+		<Platform
+			Name="Win32"
+		/>
+	</Platforms>
+	<ToolFiles>
+	</ToolFiles>
+	<Configurations>
+		<Configuration
+			Name="Debug|Win32"
+			OutputDirectory="../../common/bin/$(ConfigurationName)"
+			IntermediateDirectory="../../common/obj/$(ConfigurationName)/$(ProjectName)"
+			ConfigurationType="2"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				Optimization="0"
+				AdditionalIncludeDirectories="../../;../../dependencies;../../dependencies/boost;../../dependencies/ttl"
+				PreprocessorDefinitions="_STLP_DEBUG;WIN32;_DEBUG;_CONSOLE;YAKE_ENT_EXPORTS"
+				MinimalRebuild="true"
+				BasicRuntimeChecks="3"
+				RuntimeLibrary="3"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="2"
+				PrecompiledHeaderThrough="yake/ent/pch.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="4"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib physics.lib data.lib"
+				OutputFile="$(OutDir)/$(ProjectName).dll"
+				LinkIncremental="2"
+				AdditionalLibraryDirectories="../../common/lib/$(ConfigurationName);../../dependencies/lib"
+				GenerateDebugInformation="true"
+				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
+				SubSystem="1"
+				ImportLibrary="../../common/lib/$(ConfigurationName)/$(ProjectName).lib"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+		<Configuration
+			Name="Release|Win32"
+			OutputDirectory="../../common/bin/$(ConfigurationName)"
+			IntermediateDirectory="../../common/obj/$(ConfigurationName)/$(ProjectName)"
+			ConfigurationType="2"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				AdditionalIncludeDirectories="../../;../../dependencies;../../dependencies/boost;../../dependencies/ttl"
+				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE;YAKE_ENT_EXPORTS"
+				RuntimeLibrary="2"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="2"
+				PrecompiledHeaderThrough="yake/ent/pch.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="3"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib physics.lib data.lib"
+				OutputFile="$(OutDir)/$(ProjectName).dll"
+				LinkIncremental="1"
+				AdditionalLibraryDirectories="../../common/lib/$(ConfigurationName);../../dependencies/lib"
+				GenerateDebugInformation="true"
+				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
+				SubSystem="1"
+				OptimizeReferences="2"
+				EnableCOMDATFolding="2"
+				ImportLibrary="../../common/lib/$(ConfigurationName)/$(ProjectName).lib"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+	</Configurations>
+	<References>
+	</References>
+	<Files>
+		<Filter
+			Name="src"
+			Filter="cpp;c;cxx;def;odl;idl;hpj;bat;asm;asmx"
+			UniqueIdentifier="{90B82316-A576-4dfa-A009-860340E10347}"
+			>
+		</Filter>
+		<Filter
+			Name="inc"
+			Filter="h;hpp;hxx;hm;inl;inc;xsd"
+			UniqueIdentifier="{AFE9C44D-2751-4300-A665-CC2717BD39BE}"
+			>
+			<File
+				RelativePath="..\..\yake\msg\listener.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\msg\listener_mgr.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\msg\message.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\msg\prerequisites.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\msg\processors.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\msg\router.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\yake\msg\yakeMessage.h"
+				>
+			</File>
+		</Filter>
+	</Files>
+	<Globals>
+	</Globals>
+</VisualStudioProject>



From codeandroid at berlios.de  Sat Mar 18 18:11:27 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sat, 18 Mar 2006 18:11:27 +0100
Subject: [Yake-svn] r1297 - trunk/yake/yake/msg
Message-ID: <200603181711.k2IHBRrq022349@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-18 18:11:27 +0100 (Sat, 18 Mar 2006)
New Revision: 1297

Modified:
   trunk/yake/yake/msg/listener.h
   trunk/yake/yake/msg/message.h
   trunk/yake/yake/msg/router.h
Log:
added kNullSource

Modified: trunk/yake/yake/msg/listener.h
===================================================================
--- trunk/yake/yake/msg/listener.h	2006-03-17 20:33:06 UTC (rev 1296)
+++ trunk/yake/yake/msg/listener.h	2006-03-18 17:11:27 UTC (rev 1297)
@@ -40,6 +40,7 @@
 			listener_base& operator = (const listener_base&);
 		public:
 			listener_base(const std::string& msgTypeName) : msgTypeName_(msgTypeName) {}
+			virtual ~listener_base() {}
 			void execute(const message_base& msg)
 			{ doExecute(msg); }
 			const std::string& msgTypeName() const

Modified: trunk/yake/yake/msg/message.h
===================================================================
--- trunk/yake/yake/msg/message.h	2006-03-17 20:33:06 UTC (rev 1296)
+++ trunk/yake/yake/msg/message.h	2006-03-18 17:11:27 UTC (rev 1297)
@@ -39,6 +39,8 @@
 	*/
 	typedef source_type Source;
 
+	const Source kNullSource = Source(0);
+
 	namespace detail {
 		/** Internal base class for messages providing the very basic interface.
 		*/
@@ -49,7 +51,7 @@
 			message_base& operator=(const message_base&);
 		public:
 			template<typename T>
-			message_base(const T& value, source_type src = 0) : value_(value), msgTypeName_(typeid(T).name()), src_(src)
+			message_base(const T& value, source_type src = kNullSource) : value_(value), msgTypeName_(typeid(T).name()), src_(src)
 			{}
 			const boost::any& value() const
 			{ return value_; }
@@ -73,7 +75,7 @@
 		/** Construct a message with value and optional source (0 by default).
 			
 		*/
-		message(const T& v, source_type src = 0) : detail::message_base(v,src)
+		message(const T& v, source_type src = kNullSource) : detail::message_base(v,src)
 		{}
 		/** Construct a message with default value for type T and source 0. */
 		message() : detail::message_base(T())
@@ -88,7 +90,7 @@
 	{
 		DefaultMessageAllocator& instance();
 		template<typename T>
-		static message<T>* create(const T& v, source_type src = 0)
+		static message<T>* create(const T& v, source_type src = kNullSource)
 		{
 			return new message<T>(v,src);
 		}
@@ -103,7 +105,7 @@
 	/** Helper function to easily create messages.
 	*/
 	template<typename T>
-	message<T>* makeMessage(const T& v, source_type src = 0)
+	message<T>* makeMessage(const T& v, source_type src = kNullSource)
 	{ 
 		return DefaultMessageAllocator::create<T>(v,src); 
 	}

Modified: trunk/yake/yake/msg/router.h
===================================================================
--- trunk/yake/yake/msg/router.h	2006-03-17 20:33:06 UTC (rev 1296)
+++ trunk/yake/yake/msg/router.h	2006-03-18 17:11:27 UTC (rev 1297)
@@ -65,7 +65,7 @@
 		router();
 
 		template<typename T>
-		void postMessage(const T& v, source_type source = 0)
+		void postMessage(const T& v, source_type source = kNullSource)
 		{ this->post( MSG_NAMESPACE::makeMessage(v,source) ); }
 
 		/** Post a message. Processing is controlled by T_processor.



From codeandroid at berlios.de  Sat Mar 18 18:11:54 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sat, 18 Mar 2006 18:11:54 +0100
Subject: [Yake-svn] r1298 - trunk/yake/src/yake/samples/msg/sampleMsg1
Message-ID: <200603181711.k2IHBsd4022425@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-18 18:11:54 +0100 (Sat, 18 Mar 2006)
New Revision: 1298

Modified:
   trunk/yake/src/yake/samples/msg/sampleMsg1/demo.cpp
Log:
added kNullSource

Modified: trunk/yake/src/yake/samples/msg/sampleMsg1/demo.cpp
===================================================================
--- trunk/yake/src/yake/samples/msg/sampleMsg1/demo.cpp	2006-03-18 17:11:27 UTC (rev 1297)
+++ trunk/yake/src/yake/samples/msg/sampleMsg1/demo.cpp	2006-03-18 17:11:54 UTC (rev 1298)
@@ -174,6 +174,7 @@
 
 		// post a few message to different handlers (depending on type)
 		router.post(msg::makeMessage(MsgResize(44,44)));
+		router.post(msg::makeMessage(MsgResize(44,44),msg::kNullSource));
 		router.post(msg::makeMessage(MsgResize(55,55),msg::Source(11)));
 		router.post(msg::makeMessage(MsgResize(66,66),msg::Source(12)));
 	}



From codeandroid at berlios.de  Sat Mar 18 18:17:02 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sat, 18 Mar 2006 18:17:02 +0100
Subject: [Yake-svn] r1299 - trunk/yake/yake/ent
Message-ID: <200603181717.k2IHH2Zo022749@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-18 18:17:01 +0100 (Sat, 18 Mar 2006)
New Revision: 1299

Modified:
   trunk/yake/yake/ent/object_mgr.h
Log:
added message posting methods

Modified: trunk/yake/yake/ent/object_mgr.h
===================================================================
--- trunk/yake/yake/ent/object_mgr.h	2006-03-18 17:11:54 UTC (rev 1298)
+++ trunk/yake/yake/ent/object_mgr.h	2006-03-18 17:17:01 UTC (rev 1299)
@@ -30,6 +30,7 @@
 #include "yake/ent/prerequisites.h"
 #include "yake/ent/object.h"
 #include "yake/ent/object_mgr_listener.h"
+#include "yake/msg/yakeMessage.h"
 
 namespace yake {
 namespace ent {
@@ -50,6 +51,43 @@
 		{
 			return objMgr_.registerClass(name,&T::create,&T::destroy);
 		}
+
+		/** Post a global message. This message is *not* broadcasted to every object!
+			@see msg::makeMessage
+			@see msg::makeListener
+			@see broadcastMessage
+		*/
+		void postMessage(msg::detail::message_base*, const msg::Source source = msg::kNullSource);
+
+		/** Post a global message which is broadcasted to every object!
+			@see msg::makeMessage
+			@see msg::makeListener
+		*/
+		void broadcastMessage(msg::detail::message_base*, const msg::Source source = msg::kNullSource);
+
+		/** Post message to a specific object.
+			@see msg::makeMessage
+			@see msg::makeListener
+		*/
+		void postMessage(Object*, msg::detail::message_base*, const msg::Source source = msg::kNullSource);
+
+		/** Post message to a specific object.
+			@see msg::makeMessage
+			@see msg::makeListener
+		*/
+		void postMessage(ObjectId, msg::detail::message_base*, const msg::Source source = msg::kNullSource);
+
+		/** Post message to objects in a STL(-like) container with object pointers.
+			@see msg::makeMessage
+			@see msg::makeListener
+		*/
+		template<typename T_container>
+		void postMessage(const T_container& objCtr, msg::detail::message_base* msg, const msg::Source source = msg::kNullSource)
+		{
+			ConstVectorIterator<T_container> it(objCtr);
+			while (it.hasMoreElements())
+				postMessage( it.getNext(), msg, source );
+		}
 	protected:
 		//
 		typedef ListenerManager<ObjectManagerListener> listener_mgr_type;



From codeandroid at berlios.de  Sun Mar 19 15:36:35 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 15:36:35 +0100
Subject: [Yake-svn] r1300 - trunk/yake/yake/base/mpl
Message-ID: <200603191436.k2JEaZ6V006905@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 15:36:32 +0100 (Sun, 19 Mar 2006)
New Revision: 1300

Modified:
   trunk/yake/yake/base/mpl/yakeCast.h
Log:
added checked_cast

Modified: trunk/yake/yake/base/mpl/yakeCast.h
===================================================================
--- trunk/yake/yake/base/mpl/yakeCast.h	2006-03-18 17:17:01 UTC (rev 1299)
+++ trunk/yake/yake/base/mpl/yakeCast.h	2006-03-19 14:36:32 UTC (rev 1300)
@@ -42,6 +42,24 @@
 //============================================================================
 namespace yake
 {
+	/** Use this instead of dynamic_cast in performance critical code.
+		@Remarks See "C++ Coding Standards, Ch93".
+	*/
+	template<typename To, typename From>
+	To checked_cast(From* from)
+	{
+		YAKE_ASSERT( dynamic_cast<To>(from) == static_cast<To>(from) && "checked_cast failed" );
+		return static_cast<To>(from);
+	}
+	/** Use this instead of dynamic_cast in performance critical code.
+		@Remarks See "C++ Coding Standards, Ch93".
+	*/
+	template<typename To, typename From>
+	To checked_cast(From& from)
+	{
+		YAKE_ASSERT( dynamic_cast<To>(&from) == static_cast<To>(&from) && "checked_cast failed" );
+		return static_cast<To>(from);
+	}
 namespace base
 {
 namespace mpl



From codeandroid at berlios.de  Sun Mar 19 18:10:16 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 18:10:16 +0100
Subject: [Yake-svn] r1301 - in trunk/yake/common/bin: debug release
Message-ID: <200603191710.k2JHAGnQ026076@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 18:10:16 +0100 (Sun, 19 Mar 2006)
New Revision: 1301

Modified:
   trunk/yake/common/bin/debug/yake.graphics.ogre_config.cfg
   trunk/yake/common/bin/release/yake.graphics.ogre_config.cfg
Log:
new configuration option

Modified: trunk/yake/common/bin/debug/yake.graphics.ogre_config.cfg
===================================================================
--- trunk/yake/common/bin/debug/yake.graphics.ogre_config.cfg	2006-03-19 14:36:32 UTC (rev 1300)
+++ trunk/yake/common/bin/debug/yake.graphics.ogre_config.cfg	2006-03-19 17:10:16 UTC (rev 1301)
@@ -1,3 +1,4 @@
 ;scenemanager=exterior_close
 ;world=terrain.cfg
 shadowtype=modulated_texture
+;show_config_dialog=no

Modified: trunk/yake/common/bin/release/yake.graphics.ogre_config.cfg
===================================================================
--- trunk/yake/common/bin/release/yake.graphics.ogre_config.cfg	2006-03-19 14:36:32 UTC (rev 1300)
+++ trunk/yake/common/bin/release/yake.graphics.ogre_config.cfg	2006-03-19 17:10:16 UTC (rev 1301)
@@ -1,3 +1,4 @@
 ;scenemanager=exterior_close
 ;world=terrain.cfg
 shadowtype=modulated_texture
+;show_config_dialog=no



From codeandroid at berlios.de  Sun Mar 19 18:55:37 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 18:55:37 +0100
Subject: [Yake-svn] r1302 - in trunk/yake: . common/media/vehicles src/yake/audio src/yake/base src/yake/base/math src/yake/base/native/Linux src/yake/graphics src/yake/plugins/baseLuaBindings src/yake/plugins/graphicsLuaBindings src/yake/plugins/graphicsOgre src/yake/plugins/inputOgre src/yake/plugins/physicsODE src/yake/samples/base/debug src/yake/thread src/yapp src/yapp/base/event src/yapp/loader src/yapp/model src/yapp/plugins src/yapp/plugins/ceguiOgreRendererAdapter src/yapp/plugins/terrainPhysMgr src/yapp/raf src/yapp/samples src/yapp/samples/base/vehicle src/yapp/samples/gui/console src/yapp/samples/misc/cmdrmayhem src/yapp/samples/model/XODE src/yapp/samples/model/dotLink src/yapp/vehicle yake/audio yake/base yake/base/math yake/base/mpl yake/base/native yake/base/templates yake/graphics yake/object yake/physics yake/plugins/graphicsOgre yake/plugins/inputOgre yake/plugins/physicsODE yake/prop yake/samples/common yake/scripting yake/statemachine yake/thread yapp/common yapp/l!
 oader yapp/model yapp/plugins yapp/plugins/ceguiOgreRendererAdapter yapp/plugins/terrainPhysMgr yapp/raf yapp/vehicle
Message-ID: <200603191755.k2JHtb8G010705@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 18:54:00 +0100 (Sun, 19 Mar 2006)
New Revision: 1302

Added:
   trunk/yake/src/yapp/plugins/terrainPhysMgr/
   trunk/yake/src/yapp/plugins/terrainPhysMgr/TerrainOdeActor.cpp
   trunk/yake/src/yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.cpp
   trunk/yake/yapp/plugins/terrainPhysMgr/
   trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeActor.h
   trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeShape.h
   trunk/yake/yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.h
Modified:
   trunk/yake/SConstruct
   trunk/yake/buildspec.xml
   trunk/yake/common/media/vehicles/jet.xml
   trunk/yake/src/yake/audio/yakeAudio.cpp
   trunk/yake/src/yake/base/math/yakeQuaternion.cpp
   trunk/yake/src/yake/base/native/Linux/yakeApplication.cpp
   trunk/yake/src/yake/base/native/Linux/yakeCriticalSection.cpp
   trunk/yake/src/yake/base/native/Linux/yakeDebug.cpp
   trunk/yake/src/yake/base/native/Linux/yakeLibrary.cpp
   trunk/yake/src/yake/base/native/Linux/yakeTime.cpp
   trunk/yake/src/yake/base/yakeDebugLogAppender.cpp
   trunk/yake/src/yake/graphics/yakeGraphicsSystem.cpp
   trunk/yake/src/yake/plugins/baseLuaBindings/yakeLuaBinder.cpp
   trunk/yake/src/yake/plugins/graphicsLuaBindings/yakeLuaBinder.cpp
   trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreCamera.cpp
   trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreCore.cpp
   trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreEntity.cpp
   trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreGeometryAccess.cpp
   trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreLight.cpp
   trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreNode.cpp
   trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreParticleSystem.cpp
   trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreViewport.cpp
   trunk/yake/src/yake/plugins/graphicsOgre/yakeGraphicsWorld.cpp
   trunk/yake/src/yake/plugins/inputOgre/InputSystemOgre.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeActor.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeBallJoint.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeBody.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeFixedJoint.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeHinge2Joint.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeHingeJoint.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeJoint.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeMaterial.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeRay.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeShapes.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeSliderJoint.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeUniversalJoint.cpp
   trunk/yake/src/yake/plugins/physicsODE/OdeWorld.cpp
   trunk/yake/src/yake/samples/base/debug/yakeUnitTest.cpp
   trunk/yake/src/yake/thread/yakeThread.cpp
   trunk/yake/src/yapp/Makefile.am
   trunk/yake/src/yapp/base/event/Makefile.am
   trunk/yake/src/yapp/loader/yakeDotLinkLoader.cpp
   trunk/yake/src/yapp/loader/yakeDotScene.cpp
   trunk/yake/src/yapp/loader/yakeModelMovableLinkCreator.cpp
   trunk/yake/src/yapp/loader/yakeXODEParser.cpp
   trunk/yake/src/yapp/model/Makefile.am
   trunk/yake/src/yapp/model/yakeComplexModel.cpp
   trunk/yake/src/yapp/model/yakeModelMovableLink.cpp
   trunk/yake/src/yapp/model/yakePhysical.cpp
   trunk/yake/src/yapp/model/yakePhysicalDataImporter.cpp
   trunk/yake/src/yapp/plugins/ceguiOgreRendererAdapter/plugin.cpp
   trunk/yake/src/yapp/raf/yakeApplication.cpp
   trunk/yake/src/yapp/raf/yakeApplicationState.cpp
   trunk/yake/src/yapp/raf/yakeRtApplicationState.cpp
   trunk/yake/src/yapp/samples/Makefile.am
   trunk/yake/src/yapp/samples/base/vehicle/yakeDemo.cpp
   trunk/yake/src/yapp/samples/gui/console/yakeConsoleDemo.cpp
   trunk/yake/src/yapp/samples/misc/cmdrmayhem/yakeDemo.cpp
   trunk/yake/src/yapp/samples/model/XODE/yakeXODELoaderDemo.cpp
   trunk/yake/src/yapp/samples/model/dotLink/yakeDotLinkDemo.cpp
   trunk/yake/src/yapp/vehicle/yakeDotVehicle.cpp
   trunk/yake/src/yapp/vehicle/yakeMountPoint.cpp
   trunk/yake/src/yapp/vehicle/yakeNativeOde.cpp
   trunk/yake/src/yapp/vehicle/yakeOdeEngine.cpp
   trunk/yake/src/yapp/vehicle/yakeVehicle.cpp
   trunk/yake/yake/audio/yakeAudio.h
   trunk/yake/yake/audio/yakeAudioSystem.h
   trunk/yake/yake/audio/yakePCH.h
   trunk/yake/yake/base/math/yakeColor.h
   trunk/yake/yake/base/math/yakeColor.inl
   trunk/yake/yake/base/math/yakeGeometry.h
   trunk/yake/yake/base/math/yakeMath.h
   trunk/yake/yake/base/math/yakeMatrix3.h
   trunk/yake/yake/base/math/yakeQuaternion.h
   trunk/yake/yake/base/math/yakeVector3.h
   trunk/yake/yake/base/mpl/yakeBuildArguments.h
   trunk/yake/yake/base/mpl/yakeBuildIteration.h
   trunk/yake/yake/base/native/yakeNative.h
   trunk/yake/yake/base/templates/yakePointer.h
   trunk/yake/yake/base/templates/yakeRegistry.h
   trunk/yake/yake/base/yake.h
   trunk/yake/yake/base/yakeConfigFile.h
   trunk/yake/yake/base/yakeLibrary.h
   trunk/yake/yake/base/yakeMovable.h
   trunk/yake/yake/base/yakeProcessor.h
   trunk/yake/yake/base/yakeString.h
   trunk/yake/yake/base/yakeTaggedListenerManager.h
   trunk/yake/yake/graphics/yakeGeometryAccess.h
   trunk/yake/yake/graphics/yakeGraphicalWorld.h
   trunk/yake/yake/graphics/yakeGraphicsSystem.h
   trunk/yake/yake/object/ClassAndObjectIdManager.inl
   trunk/yake/yake/object/ObjectContainer.h
   trunk/yake/yake/object/ObjectManager.h
   trunk/yake/yake/object/ObjectManager.inl
   trunk/yake/yake/object/common.h
   trunk/yake/yake/physics/yakeAffectorZone.h
   trunk/yake/yake/physics/yakePhysicsActor.h
   trunk/yake/yake/physics/yakePhysicsAffectors.h
   trunk/yake/yake/physics/yakePhysicsAvatar.h
   trunk/yake/yake/physics/yakePhysicsBody.h
   trunk/yake/yake/physics/yakePhysicsBodyGroup.h
   trunk/yake/yake/physics/yakePhysicsJoint.h
   trunk/yake/yake/physics/yakePhysicsMaterial.h
   trunk/yake/yake/physics/yakePhysicsMotors.h
   trunk/yake/yake/physics/yakePhysicsPrerequisites.h
   trunk/yake/yake/physics/yakePhysicsShape.h
   trunk/yake/yake/physics/yakePhysicsWorld.h
   trunk/yake/yake/plugins/graphicsOgre/graphicsOgreCamera.h
   trunk/yake/yake/plugins/graphicsOgre/graphicsOgreCore.h
   trunk/yake/yake/plugins/graphicsOgre/graphicsOgreEntity.h
   trunk/yake/yake/plugins/graphicsOgre/graphicsOgreGeometryAccess.h
   trunk/yake/yake/plugins/graphicsOgre/graphicsOgreLight.h
   trunk/yake/yake/plugins/graphicsOgre/graphicsOgreNode.h
   trunk/yake/yake/plugins/graphicsOgre/graphicsOgreParticleSystem.h
   trunk/yake/yake/plugins/graphicsOgre/graphicsOgreViewport.h
   trunk/yake/yake/plugins/graphicsOgre/yakeGraphicsSystem.h
   trunk/yake/yake/plugins/graphicsOgre/yakeGraphicsWorld.h
   trunk/yake/yake/plugins/graphicsOgre/yakePCH.h
   trunk/yake/yake/plugins/inputOgre/InputSystemOgre.h
   trunk/yake/yake/plugins/physicsODE/OdeActor.h
   trunk/yake/yake/plugins/physicsODE/OdeAvatar.h
   trunk/yake/yake/plugins/physicsODE/OdeBody.h
   trunk/yake/yake/plugins/physicsODE/OdeJoint.h
   trunk/yake/yake/plugins/physicsODE/OdeMaterial.h
   trunk/yake/yake/plugins/physicsODE/OdeRay.h
   trunk/yake/yake/plugins/physicsODE/OdeShapes.h
   trunk/yake/yake/plugins/physicsODE/OdeWorld.h
   trunk/yake/yake/prop/prerequisites.h
   trunk/yake/yake/prop/prop_def.h
   trunk/yake/yake/prop/prop_holder.h
   trunk/yake/yake/prop/rtti_class.h
   trunk/yake/yake/samples/common/yakeExampleApplication.h
   trunk/yake/yake/scripting/yakeScriptingSystem.h
   trunk/yake/yake/statemachine/fsm_core.h
   trunk/yake/yake/thread/ZThreadMutexForwarder.h
   trunk/yake/yake/thread/ZThreadThreadForwarder.h
   trunk/yake/yake/thread/yakeThread.h
   trunk/yake/yake/thread/yakeThreadPrerequisites.h
   trunk/yake/yapp/common/yakeCameraControllers.h
   trunk/yake/yapp/loader/yakeDotScene.h
   trunk/yake/yapp/loader/yakeXODE.h
   trunk/yake/yapp/loader/yakeXODEParser.h
   trunk/yake/yapp/model/yakeComplexModel.h
   trunk/yake/yapp/model/yakeGraphical.h
   trunk/yake/yapp/model/yakeModel.h
   trunk/yake/yapp/model/yakeModelLink.h
   trunk/yake/yapp/model/yakeModelMovableLink.h
   trunk/yake/yapp/model/yakePhysical.h
   trunk/yake/yapp/model/yakePhysicalDataImporter.h
   trunk/yake/yapp/plugins/ceguiOgreRendererAdapter/pch.h
   trunk/yake/yapp/raf/pch.h
   trunk/yake/yapp/raf/yakeApplication.h
   trunk/yake/yapp/raf/yakeApplicationState.h
   trunk/yake/yapp/raf/yakePrerequisites.h
   trunk/yake/yapp/vehicle/yakeDotVehicle.h
   trunk/yake/yapp/vehicle/yakeInterfaces.h
   trunk/yake/yapp/vehicle/yakeMountPoint.h
   trunk/yake/yapp/vehicle/yakeNativeOde.h
   trunk/yake/yapp/vehicle/yakeTemplates.h
   trunk/yake/yapp/vehicle/yakeVehicle.h
   trunk/yake/yapp/vehicle/yakeVehicleSystem.h
Log:
patch #1453160 by mj, slightly modified by psy;
major points includes linux compatibility, OGRE Dagon compatibility, vehicles enhancements, physics enhancements, paging landscape ode<->ogre physics plugin, and various other fixes.

Modified: trunk/yake/SConstruct
===================================================================
--- trunk/yake/SConstruct	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/SConstruct	2006-03-19 17:54:00 UTC (rev 1302)
@@ -39,6 +39,19 @@
 
 cc_flags = '-DGCC_3_1 -DEXT_HASH -DYAKE_DEBUG -DYAKE_DEBUG_BUILD'
 
+# optimization flags
+optimization_flags = ' -O3 '
+
+# debug flag. -g[Level]
+debug_flags = ' -g '
+
+# if you want to profile with GNU gprof
+profiler_flags = ' -pg '
+
+# if you want to test code coverage with GNU gcov
+code_coverage_flags = ' -fprofile-arcs -ftest-coverage '
+
+
 lib_includes = build.commonIncludes
 build_dir = build.commonPaths['ObjectDir']
 bin_build_dir = build.commonPaths['ProgramInstallDir']

Modified: trunk/yake/buildspec.xml
===================================================================
--- trunk/yake/buildspec.xml	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/buildspec.xml	2006-03-19 17:54:00 UTC (rev 1302)
@@ -10,6 +10,7 @@
 			<include>.</include>
 			<include>dependencies/ttl</include>
 			<include>dependencies/OGRE</include>
+			<include>dependencies/PLSM</include>
 			<include>dependencies/ode/include</include>
 			<include>dependencies/luabind</include>
 			<include>/usr/local/include/CEGUI</include>
@@ -33,6 +34,7 @@
 		name="yakeTemplates"
 		src="src/yake/base/templates"
 	>
+		<libadd>yakeNative</libadd>
 	</BuildSharedLibrary>
 
 	<BuildSharedLibrary
@@ -109,6 +111,12 @@
 		<libadd>ZThread</libadd>
         </BuildSharedLibrary>
 
+        <BuildSharedLibrary
+                name="yakeObject"
+                src="src/yake/object"
+        >
+                <libadd>yakeBase</libadd>
+        </BuildSharedLibrary>
 
 <!--
 	<BuildSharedLibrary
@@ -226,27 +234,19 @@
 	</BuildSharedLibrary>
 
 	<BuildSharedLibrary
-		name="yappStatemachine"	
-		src="src/yapp/statemachine"
-	>
-		<libadd>yappBase</libadd>
-	</BuildSharedLibrary>
-
-	<BuildSharedLibrary
 		name="yappMsg"	
 		src="src/yapp/msg"
 	>
 		<libadd>yappBase</libadd>
 	</BuildSharedLibrary>
 
-	<BuildSharedLibrary
+	<!--<BuildSharedLibrary
 		name="yappEnt"	
 		src="src/yapp/ent"
 	>
 		<libadd>yappBase</libadd>
-		<libadd>yappStatemachine</libadd>
 		<libadd>yappMsg</libadd>
-	</BuildSharedLibrary>
+	</BuildSharedLibrary>-->
 
 	<BuildSharedLibrary
 		name="yappVehicle"	
@@ -261,8 +261,11 @@
 		src="src/yapp/raf"
 	>
 		<libadd>yappBase</libadd>
+		<libadd>yakeCEGUIOgreAdapter</libadd>
+		<libadd>CEGUIOgreRenderer</libadd>
 	</BuildSharedLibrary>
 
+	
 	<BuildSharedLibrary
 		name="yakeCEGUIOgreAdapter"
 		src="src/yapp/plugins/ceguiOgreRendererAdapter"
@@ -271,21 +274,28 @@
 		<libadd>OgreMain</libadd>
 	</BuildSharedLibrary>
 
-	<BuildSharedLibrary
+	<!--<BuildSharedLibrary
 		name="yappEntLua"
 		src="src/yapp/plugins/entLua"
 	>
 		<libadd>yappEnt</libadd>
-	</BuildSharedLibrary>
+	</BuildSharedLibrary>-->
 
 	<BuildSharedLibrary
 		name="yappmodelLuaBindings"
 		src="src/yapp/plugins/modelLuaBindings"
 	>
-		<libadd>yappEnt</libadd>
+		<!--libadd>yappEnt</libadd-->
 		<libadd>luabind</libadd>
 	</BuildSharedLibrary>
 
+	<BuildSharedLibrary
+		name="yappTerrainPhysicsManager"
+		src="src/yapp/plugins/terrainPhysMgr"
+	>
+		<libadd>PagingLandscape</libadd>
+	</BuildSharedLibrary>	
+
 <!-- SAMPLES -->
 
 	<List name="common_libs">
@@ -344,10 +354,25 @@
 	>
 		<libadd>common_libs</libadd>	
 		<libadd>yappModel</libadd>	
+		<libadd>yappVehicle</libadd>	
+		<libadd>yappraf</libadd>
+	</BuildProgram>
+
+	<!--
+	<BuildProgram
+		name="TerrainDemo"
+		src="src/yapp/samples/ode_terrain_demo"
+	>
+		<libadd>common_libs</libadd>	
+		<libadd>yappModel</libadd>	
 		<libadd>yappStatemachine</libadd>	
 		<libadd>yappVehicle</libadd>	
 		<libadd>yappraf</libadd>
+		<libadd>PagingLandscape</libadd>
+		<libadd>yappTerrainPhysicsManager</libadd>
+		<libadd>dl</libadd>
 	</BuildProgram>	
+	-->
 
 	<BuildProgram
 		name="consoleDemo"
@@ -360,7 +385,16 @@
 		<libadd>luabind</libadd>
 		<libadd>CEGUIOgreRenderer</libadd>
 	</BuildProgram>
-		
+	<!--<BuildProgram 
+		name="cmdrmayhem"
+		src="src/yapp/samples/misc/cmdrmayhem"
+	>
+		<libadd>common_libs</libadd>
+		<libadd>yappModel</libadd>	
+		<libadd>yappVehicle</libadd>
+		<libadd>yappraf</libadd>
+	</BuildProgram>
+	-->
 
 </BuildSpec>
 

Modified: trunk/yake/common/media/vehicles/jet.xml
===================================================================
--- trunk/yake/common/media/vehicles/jet.xml	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/common/media/vehicles/jet.xml	2006-03-19 17:54:00 UTC (rev 1302)
@@ -49,6 +49,14 @@
 		<engine name="upward" type="MountedThruster" mountPoint="bottom">
 			<forces min="0." max="250." dieOff="10" rise="20" />
 		</engine>
+		<!-- bottom (downward) thruster -->
+		<mountPoint name="top">
+			<position x="0" y="0" z="0" />
+			<direction x="0" y="1" z="0" />
+		</mountPoint>
+		<engine name="downward" type="MountedThruster" mountPoint="top">
+			<forces min="0." max="250." dieOff="10" rise="20" />
+		</engine>
 		<!-- two axles -->
 		<axle name="front" />
 		<axle name="rear" />
@@ -64,4 +72,4 @@
 			<position x="3" y="-3" z="-3" />
 		</wheel>
 	</vehicleTemplate>
-</dotvehicle>
\ No newline at end of file
+</dotvehicle>

Modified: trunk/yake/src/yake/audio/yakeAudio.cpp
===================================================================
--- trunk/yake/src/yake/audio/yakeAudio.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/audio/yakeAudio.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -37,3 +37,4 @@
 
 }
 }
+

Modified: trunk/yake/src/yake/base/math/yakeQuaternion.cpp
===================================================================
--- trunk/yake/src/yake/base/math/yakeQuaternion.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/base/math/yakeQuaternion.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -83,7 +83,7 @@
         }
     }
 
-	//-----------------------------------------------------------------------
+    //-----------------------------------------------------------------------
     void Quaternion::ToRotationMatrix (Matrix3& kRot) const
     {
         real fTx  = real(2.0)*x;

Modified: trunk/yake/src/yake/base/native/Linux/yakeApplication.cpp
===================================================================
--- trunk/yake/src/yake/base/native/Linux/yakeApplication.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/base/native/Linux/yakeApplication.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -72,3 +72,4 @@
 
 } // native
 } // yake
+

Modified: trunk/yake/src/yake/base/native/Linux/yakeCriticalSection.cpp
===================================================================
--- trunk/yake/src/yake/base/native/Linux/yakeCriticalSection.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/base/native/Linux/yakeCriticalSection.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -35,8 +35,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace native
 {
 
@@ -58,5 +56,5 @@
 }
 
 } // native
-} // base
 } // yake
+

Modified: trunk/yake/src/yake/base/native/Linux/yakeDebug.cpp
===================================================================
--- trunk/yake/src/yake/base/native/Linux/yakeDebug.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/base/native/Linux/yakeDebug.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -41,8 +41,6 @@
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace native
 {
 
@@ -92,5 +90,5 @@
 }
 
 } // native
-} // base
 } // yake
+

Modified: trunk/yake/src/yake/base/native/Linux/yakeLibrary.cpp
===================================================================
--- trunk/yake/src/yake/base/native/Linux/yakeLibrary.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/base/native/Linux/yakeLibrary.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -34,29 +34,25 @@
 
 extern "C"
 {
-#	include <dlfcn.h>
+#include <dlfcn.h>
+#include <assert.h>
 }
 
 // Yake
 #include <yake/base/yakePCH.h>
-#include <yake/base/templates/yakeSmartAssert.h>
-#include <yake/base/yakeException.h>
+#include <yake/base/native/yakeNative.h>
 
 //============================================================================
 //    INTERFACE STRUCTURES / UTILITY CLASSES
 //============================================================================
 namespace yake
 {
-namespace base
-{
 namespace native
 {
 
-YAKE_DECLARE_GLOBAL;
 YAKE_BASE_NATIVE_API LibraryHandle library_Load( const char* pFilename )
 {
-	YAKE_DECLARE_FUNCTION( yake::base::native::library_Load );
-	YAKE_ASSERT( pFilename ).debug( "Invalid filename." );
+	assert( pFilename && "Invalid filename." );
 
 	// Due to Linux libraries naming we decided to add some "brand" prefix
 	String yakeLibPrefix( "libyake" );
@@ -75,32 +71,44 @@
 	
 	String name = yakeName;
 	
-	YAKE_LOG( "Trying to load " + name );
+#ifdef YAKE_DEBUG
+	debug_Print( String( "Trying to load " + name ).c_str() );
+#endif
+
 	LibraryHandle handle = ( LibraryHandle )dlopen( name.c_str(), RTLD_LAZY );
 	
 	// trying to load library with libyapp prefix
 	if ( handle == NULL )
 	{
-		YAKE_LOG( "dlerror returned:" + String( dlerror() ) );
+#ifdef YAKE_DEBUG
+		debug_Print( String( "dlerror returned:" + String( dlerror() ) ).c_str() );
+#endif
 		
 		name = yappName;
 		
-		YAKE_LOG( "Now trying to load " + name );
+#ifdef YAKE_DEBUG
+		debug_Print( String( "Now trying to load " + name ).c_str() );
+#endif
+
 		handle = ( LibraryHandle )dlopen( name.c_str(), RTLD_LAZY );
 	}
 	
 	if ( handle == NULL )
-		throw Exception( "Failed to load " + String( pFilename ) + String( " with both libyake and libyapp prefixes due to " ) + String( dlerror() ) , "native::Linux::library_Load" );
+		throw "Failed to load " + String( pFilename ) 
+		    + String( " with both libyake and libyapp prefixes due to " ) 
+		    + String( dlerror() );
 
-	YAKE_LOG( "successfully loaded " + name );
+#ifdef YAKE_DEBUG
+	debug_Print( String( "successfully loaded " + name ).c_str() );
+#endif
 	
 	return handle;
 }
 
 YAKE_BASE_NATIVE_API void* library_GetSymbol( LibraryHandle library, const char* pFunction )
 {
-	YAKE_ASSERT( library ).debug( "Invalid library handle." );
-	YAKE_ASSERT( pFunction ).debug( "Invalid library function." );
+	assert( library && "Invalid library handle." );
+	assert( pFunction && "Invalid library function." );
 
 	// Get the Procedure's Address.
 	void* address = dlsym( const_cast< void* >( library ), pFunction );
@@ -110,12 +118,12 @@
  
 YAKE_BASE_NATIVE_API void library_Free( LibraryHandle library )
 {
-	YAKE_ASSERT( library ).debug( "Invalid library handle" );
+	assert( library && "Invalid library handle" );
 
 	dlclose( const_cast< void* >( library ) );
 }
 
 
 } // native
-} // base
 } // yake
+

Modified: trunk/yake/src/yake/base/native/Linux/yakeTime.cpp
===================================================================
--- trunk/yake/src/yake/base/native/Linux/yakeTime.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/base/native/Linux/yakeTime.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -123,3 +123,4 @@
 	
 } // timer
 } // yake
+

Modified: trunk/yake/src/yake/base/yakeDebugLogAppender.cpp
===================================================================
--- trunk/yake/src/yake/base/yakeDebugLogAppender.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/base/yakeDebugLogAppender.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -52,3 +52,4 @@
 	}
 } // base
 } // yake
+

Modified: trunk/yake/src/yake/graphics/yakeGraphicsSystem.cpp
===================================================================
--- trunk/yake/src/yake/graphics/yakeGraphicsSystem.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/graphics/yakeGraphicsSystem.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -94,18 +94,18 @@
 	}
 
 	/** @Remarks Code has been taken more or less directly from Ogre's OgreCamera.cpp. */
-	Ray ICamera::createCameraToViewportRay(const real screenX, const real screenY) const
+	math::Ray ICamera::createCameraToViewportRay(const real screenX, const real screenY) const
 	{
 		real centeredScreenX = (screenX - 0.5f);
 		real centeredScreenY = (0.5f - screenY);
 
 		const real nearDist = getNearClipDistance();
 
-		real normalizedSlope = Math::Tan(getFOV() / 2); // getFOV() returns FOVy
+		real normalizedSlope = math::Math::Tan(getFOV() / 2); // getFOV() returns FOVy
 		real viewportYToWorldY = normalizedSlope * nearDist * 2;
 		real viewportXToWorldX = viewportYToWorldY * getAspectRatio();
 
-		Vector3 rayOrigin, rayDirection;
+		math::Vector3 rayOrigin, rayDirection;
 		if (getProjectionType() == PT_PERSPECTIVE)
 		{
 			rayOrigin = getPosition(); //@todo fixme should be: getDerivedPosition()
@@ -123,10 +123,11 @@
 			rayOrigin.z = 0.0f;
 			rayOrigin = getOrientation() * rayOrigin; //@todo fixme should be: getDerivedOrientation() * rayOrigin;
 			rayOrigin = getPosition() + rayOrigin; //@todo fixme should be: getDerivedPosition() + rayOrigin;
-			rayDirection = getOrientation() * Vector3::kUnitZ; //@todo fixme should be: getDerivedDirection();
+			rayDirection = getOrientation() * math::Vector3::kUnitZ; //@todo fixme should be: getDerivedDirection();
 		}
-		return Ray( rayOrigin, rayDirection );
+		return math::Ray( rayOrigin, rayDirection );
 	}
 
 } // graphics
 } // yake
+

Modified: trunk/yake/src/yake/plugins/baseLuaBindings/yakeLuaBinder.cpp
===================================================================
--- trunk/yake/src/yake/plugins/baseLuaBindings/yakeLuaBinder.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/baseLuaBindings/yakeLuaBinder.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -56,6 +56,7 @@
 				    class_<Color>("Color")
 				    .def( constructor<>() )
 				    .def( constructor<real,real,real,real>() )
+				    .def( constructor< const Color& >() )
 				    //FIXME some strange members in anonymous union::struct
 				    /*						.def_readwrite( "r", &Color::r )
 				    						.def_readwrite( "g", &Color::g )

Modified: trunk/yake/src/yake/plugins/graphicsLuaBindings/yakeLuaBinder.cpp
===================================================================
--- trunk/yake/src/yake/plugins/graphicsLuaBindings/yakeLuaBinder.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/graphicsLuaBindings/yakeLuaBinder.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -112,18 +112,13 @@
 				    .def( "setMaterial", &IEntity::setMaterial )
 				    .def( "setSubEntityMaterial", &IEntity::setSubEntityMaterial )
 				    .def( "setCastsShadow", &IEntity::setCastsShadow )
+				    .def( "setRenderDetail", &IEntity::setRenderDetail )
 				];
 				YAKE_LOG( "IEntity bound..." );
 
 				module( YAKE_GRAPHICS_MODULE )
 				[
 				    class_<ICamera, bases<Movable, GraphicsEntity> >( "ICamera" )
-				    .enum_( "SceneDetailLevel" )
-				    [
-				        value( "SDL_POINTS", ICamera::SDL_POINTS ),
-				        value( "SDL_WIREFRAME", ICamera::SDL_WIREFRAME ),
-				        value( "SDL_SOLID", ICamera::SDL_SOLID )
-				    ]
 				    .enum_( "ProjectionType" )
 				    [
 				        value( "PT_ORTHOGRAPHIC", ICamera::PT_ORTHOGRAPHIC ),
@@ -149,10 +144,11 @@
 				    .def( "setFixedYawAxis", &ICamera::setFixedYawAxis )
 				    .def( "moveRelative", &ICamera::moveRelative )
 				    .def( "lookAt", &ICamera::lookAt )
-				    .def( "rotate", (void(ICamera::*)(const Quaternion&))&ICamera::rotate )
-				    .def( "rotateAxisAngle", (void(ICamera::*)(const Vector3&, real))&ICamera::rotate )
+				    .def( "rotate", (void(ICamera::*)(const math::Quaternion&))&ICamera::rotate )
+				    .def( "rotateAxisAngle", (void(ICamera::*)(const math::Vector3&, real))&ICamera::rotate )
 				    .def( "pitch", &ICamera::pitch )
 				    .def( "yaw", &ICamera::yaw )
+				    .def( "roll", &ICamera::roll )
 				    .def( "createCameraToViewportRay", &ICamera::createCameraToViewportRay )
 				    .def( "getProjectionMatrix", &ICamera::getProjectionMatrix )
 				    .def( "getViewMatrix", &ICamera::getViewMatrix )
@@ -191,6 +187,8 @@
 				    .def( "getAttachedCamera", &IViewport::getAttachedCamera )
 				    .def( "setDimensions", &IViewport::setDimensions )
 				    .def( "setZ", &IViewport::setZ )
+				    .def( "setBackgroundColor", &IViewport::setBackgroundColor )
+				    .def( "getBackgroundColor", &IViewport::getBackgroundColor )
 				];
 				YAKE_LOG( "IViewport bound..." );
 

Modified: trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreCamera.cpp
===================================================================
--- trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreCamera.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreCamera.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -32,7 +32,7 @@
 namespace ogre3d {
 
 	//------------------------------------------------------
-	OgreCamera::OgreCamera( Ogre::SceneManager * sceneMgr ) : mSceneMgr( sceneMgr ), mCam( 0 )
+	OgreCamera::OgreCamera( Ogre::SceneManager* sceneMgr ) : mSceneMgr( sceneMgr ), mCam( 0 )
 	{
 		YAKE_ASSERT( sceneMgr ).debug("need a scene manager!");
 		mCam = mSceneMgr->createCamera( yake::uniqueName::create("sn_") );
@@ -69,66 +69,90 @@
 	}
 
 	//------------------------------------------------------
-	void OgreCamera::setPosition( const Vector3 & position )
+	void OgreCamera::setPosition( const math::Vector3& position )
 	{
 		YAKE_ASSERT( mCam ).debug("need a camera!");
 		mCam->setPosition( VEC_YAKE2OGRE( position ) );
 	}
 
 	//------------------------------------------------------
-	Vector3 OgreCamera::getPosition() const
+	math::Vector3 OgreCamera::getPosition() const
 	{
 		YAKE_ASSERT( mCam ).debug("need a camera!");
 		return VEC_OGRE2YAKE( mCam->getPosition() );
 	}
 
 	//------------------------------------------------------
-	void OgreCamera::setOrientation( const Quaternion & orientation )
+	math::Vector3 OgreCamera::getDerivedPosition() const
 	{
 		YAKE_ASSERT( mCam ).debug("need a camera!");
+		return VEC_OGRE2YAKE( mCam->getDerivedPosition() );
+	}
+
+	//------------------------------------------------------
+	void OgreCamera::setOrientation( const math::Quaternion & orientation )
+	{
+		YAKE_ASSERT( mCam ).debug("need a camera!");
 		mCam->setOrientation( QUAT_YAKE2OGRE( orientation ) );
 	}
 
 	//------------------------------------------------------
-	Quaternion OgreCamera::getOrientation() const
+	math::Quaternion OgreCamera::getOrientation() const
 	{
 		YAKE_ASSERT( mCam ).debug("need a camera!");
 		return QUAT_OGRE2YAKE( mCam->getOrientation() );
 	}
 
 	//------------------------------------------------------
+	math::Quaternion OgreCamera::getDerivedOrientation() const
+	{
+		YAKE_ASSERT( mCam ).debug("need a camera!");
+		return QUAT_OGRE2YAKE( mCam->getDerivedOrientation() );
+	}
+
+	//------------------------------------------------------
 	void OgreCamera::setDetailLevel( SceneDetailLevel sd )
 	{
+// for Ogre 1.1.0 "Dagon" compatibility
+#if OGRE_VERSION_MINOR >= 1 
+		mCam->setPolygonMode( Ogre::PolygonMode( sd ) );
+#else
 		mCam->setDetailLevel( Ogre::SceneDetailLevel( sd ) );
+#endif
 	}
 	
 	//------------------------------------------------------
-	ICamera::SceneDetailLevel OgreCamera::getDetailLevel() const
+	SceneDetailLevel OgreCamera::getDetailLevel() const
 	{
+// for Ogre 1.1.0 "Dagon" compatibility
+#if OGRE_VERSION_MINOR >= 1 
+		return SceneDetailLevel( mCam->getPolygonMode() );
+#else
 		return SceneDetailLevel( mCam->getDetailLevel() );
+#endif
 	}
 	
 	//------------------------------------------------------
-	void OgreCamera::setDirection( const Vector3& rVec )
+	void OgreCamera::setDirection( const math::Vector3& rVec )
 	{
 		//@todo cleaner implementation
 		mCam->setDirection( VEC_YAKE2OGRE( rVec ) );
 	}
 	
 	//------------------------------------------------------
-	Vector3 OgreCamera::getDirection() const
+	math::Vector3 OgreCamera::getDirection() const
 	{
 		return VEC_OGRE2YAKE( mCam->getDirection() );
 	}
 	
 	//------------------------------------------------------
-	Vector3 OgreCamera::getUp() const
+	math::Vector3 OgreCamera::getUp() const
 	{
 		return VEC_OGRE2YAKE( mCam->getUp() );
 	}
 	
 	//------------------------------------------------------
-	Vector3 OgreCamera::getRight() const
+	math::Vector3 OgreCamera::getRight() const
 	{
 		return VEC_OGRE2YAKE( mCam->getRight() );
 	}
@@ -140,19 +164,19 @@
 	}
 	
 	//------------------------------------------------------
-	void OgreCamera::setFixedYawAxis( const Vector3& yawAxis )
+	void OgreCamera::setFixedYawAxis( const math::Vector3& yawAxis )
 	{
 		mCam->setFixedYawAxis( true, VEC_YAKE2OGRE( yawAxis ) );
 	}
 	
 	//------------------------------------------------------
-	void OgreCamera::moveRelative( const Vector3& rVec )
+	void OgreCamera::moveRelative( const math::Vector3& rVec )
 	{
 		mCam->moveRelative( VEC_YAKE2OGRE( rVec ) );
 	}
 	
 	//------------------------------------------------------
-	void OgreCamera::lookAt( const Vector3& target )
+	void OgreCamera::lookAt( const math::Vector3& target )
 	{
 		mCam->lookAt( VEC_YAKE2OGRE( target ) );
 	}
@@ -216,7 +240,7 @@
 	}
 
 	//------------------------------------------------------
-	Matrix4 OgreCamera::getProjectionMatrix() const
+	math::Matrix4 OgreCamera::getProjectionMatrix() const
 	{
 		YAKE_ASSERT( mCam ).debug("need a camera!");
 // for Ogre 1.1.0 "Dagon" compatibility
@@ -228,7 +252,7 @@
 	}
 
 	//------------------------------------------------------
-	Matrix4 OgreCamera::getViewMatrix() const
+	math::Matrix4 OgreCamera::getViewMatrix() const
 	{
 		YAKE_ASSERT( mCam ).debug("need a camera!");
 		return MATRIX4_OGRE2YAKE( mCam->getViewMatrix() );

Modified: trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreCore.cpp
===================================================================
--- trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreCore.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreCore.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -108,7 +108,6 @@
 				{
 					mRSys = (*it);
 					String str = mRSys->getName().c_str();
-					//if (str.find("3D9"))
 					if ( str.find("GL") )
 						found = true;
 					++it;
@@ -127,6 +126,14 @@
 				mRSys->setConfigOption("VSync", "No");
 				mRSys->setConfigOption("Video Mode", "800 x 600 @ 32-bit colour");
 #else
+				if ( mConfig[ "show_config_dialog" ] == "no" )
+				{
+				    if ( !mRoot->restoreConfig() )
+				    {
+					return;
+				    }
+				}
+				else				
 				if (!mRoot->showConfigDialog())
 				{
 					return;
@@ -175,7 +182,14 @@
 	{
 		StringMap::const_iterator itFind = mConfig.find("scenemanager");
 		if (itFind == mConfig.end())
+		{
+// for Ogre 1.1.0 "Dagon" compatibility
+#if OGRE_VERSION_MINOR >= 1 
+			mSceneMgr = mRoot->createSceneManager( ST_GENERIC, "YakeSM" );
+#else
 			mSceneMgr = mRoot->getSceneManager( ST_GENERIC );
+#endif
+		}
 		else
 		{
 			String val = itFind->second;
@@ -190,7 +204,12 @@
 				YAKE_ASSERT( 1==0 ).warning("unknown scene manager config option. Using fallback: generic.");
 				mSceneType = ST_GENERIC;
 			}
+// for Ogre 1.1.0 "Dagon" compatibility
+#if OGRE_VERSION_MINOR >= 1 
+			mSceneMgr = mRoot->createSceneManager( mSceneType, "YakeSM" );
+#else
 			mSceneMgr = mRoot->getSceneManager( mSceneType );
+#endif
 		}
 		YAKE_ASSERT( mSceneMgr );
 	}
@@ -206,7 +225,7 @@
 				Ogre::SceneNode::ObjectIterator itObj = pSN->getAttachedObjectIterator();
 				while (itObj.hasMoreElements())
 				{
-					YAKE_LOG_WARNING(String("gfx rootnode.obj '") << String(itObj.getNext()->getName().c_str()) << "'");
+					YAKE_LOG_WARNING( "gfx rootnode.obj '" + itObj.getNext()->getName() + "'" );
 				}
 			}
 			if (pSN->numChildren() > 0)
@@ -214,7 +233,7 @@
 				Ogre::SceneNode::ChildNodeIterator itN = pSN->getChildIterator();
 				while (itN.hasMoreElements())
 				{
-					YAKE_LOG_WARNING(String("gfx rootnode.node '") << String(itN.getNext()->getName().c_str()) << "'");
+					YAKE_LOG_WARNING( "gfx rootnode.node '" + itN.getNext()->getName() + "'" );
 				}
 			}
 			pSN->detachAllObjects();
@@ -251,13 +270,13 @@
 		while (seci.hasMoreElements())
 		{
 			secName = seci.peekNextKey();
-            ConfigFile::SettingsMultiMap *settings = seci.getNext();
-            ConfigFile::SettingsMultiMap::iterator i;
-            for (i = settings->begin(); i != settings->end(); ++i)
-            {
-                typeName = i->first;
-                archName = i->second;
-				Ogre::ResourceGroupManager::getSingleton().addResourceLocation(archName, typeName, secName);
+			ConfigFile::SettingsMultiMap *settings = seci.getNext();
+			ConfigFile::SettingsMultiMap::iterator i;
+			for (i = settings->begin(); i != settings->end(); ++i)
+			{
+			    typeName = i->first;
+			    archName = i->second;
+			    Ogre::ResourceGroupManager::getSingleton().addResourceLocation(archName, typeName, secName);
 			}
 		}
 	}
@@ -343,3 +362,4 @@
 }
 }
 }
+

Modified: trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreEntity.cpp
===================================================================
--- trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreEntity.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreEntity.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -34,7 +34,7 @@
 namespace ogre3d {
 
 	//------------------------------------------------------
-	OgreEntity::OgreEntity( ::Ogre::SceneManager * sceneMgr, const String & mesh ) : mSceneMgr( sceneMgr ), mEntity( 0 )
+	OgreEntity::OgreEntity( Ogre::SceneManager* sceneMgr, const String& mesh ) : mSceneMgr( sceneMgr ), mEntity( 0 )
 	{
 		YAKE_ASSERT( mSceneMgr ).debug("need a scene manager!");
 		YAKE_TRY
@@ -78,14 +78,14 @@
 	}
 
 	//------------------------------------------------------
-	void OgreEntity::setMaterial( const String & materialName )
+	void OgreEntity::setMaterial( const String& materialName )
 	{
 		if (mEntity)
 			mEntity->setMaterialName( materialName );
 	}
 
 	//------------------------------------------------------
-	void OgreEntity::setSubEntityMaterial( const String & subEntity, const String & materialName )
+	void OgreEntity::setSubEntityMaterial( const String& subEntity, const String& materialName )
 	{
 		if (mEntity)
 		{
@@ -115,6 +115,26 @@
 			mEntity->setCastShadows( castsShadow );
 	}
 
+	//------------------------------------------------------
+	void OgreEntity::setRenderDetail( SceneDetailLevel sdl )
+	{
+	    YAKE_ASSERT( mEntity ).error( "need an entity" );
+// for Ogre 1.1.0 "Dagon" compatibility
+#if OGRE_VERSION_MINOR >= 1 
+	    // in Dagon material system becomes more consistent. So
+	    // polygon mode is considered to be a part of the render state,
+	    // i.e. material. If you want to change polygon mode you're 
+	    // encouraged to change entity ( subentity ) material.
+	    // This implementation just sets polygon mode override flag so 
+	    // entity's polygon mode can be overrided by camera's setting.
+	    YAKE_ASSERT( false ).warning( "Deprecated method. Read comments in the code." );
+	    mEntity->setPolygonModeOverrideable( true );
+#else
+	    mEntity->setRenderDetail( Ogre::SceneDetailLevel( sdl ) );
+#endif
+	}
+
 }
 }
 }
+

Modified: trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreGeometryAccess.cpp
===================================================================
--- trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreGeometryAccess.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreGeometryAccess.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -314,7 +314,7 @@
 	}
 
 	//-----------------------------------------------------
-	bool OgreSubmeshAccess::setPosition( uint32 index, const Vector3 & position )
+	bool OgreSubmeshAccess::setPosition( uint32 index, const math::Vector3 & position )
 	{
 		YAKE_ASSERT( mpLockedPositions != 0 ).warning("should be locked!");
 		YAKE_ASSERT( mhwvbPositions.isNull() == false ).warning("need a hwvb!");
@@ -371,7 +371,7 @@
 	}
 
 	//-----------------------------------------------------
-	bool OgreSubmeshAccess::setTexCoord( uint16 set, uint16 index, const Vector3 & uv )
+	bool OgreSubmeshAccess::setTexCoord( uint16 set, uint16 index, const math::Vector3 & uv )
 	{
 		YAKE_ASSERT( mpLockedTexCoords[set] != 0 ).warning("should be locked!");
 		YAKE_ASSERT( mhwvbTexCoords[set].isNull() == false ).warning("need a hwvb!");
@@ -431,7 +431,7 @@
 	}
 
 	//-----------------------------------------------------
-	bool OgreSubmeshAccess::setColour( uint32 index, const Color & colour )
+	bool OgreSubmeshAccess::setColour( uint32 index, const math::Color& colour )
 	{
 		YAKE_ASSERT( mpLockedColours != 0 ).warning("should be locked!");
 		YAKE_ASSERT( mhwvbColours.isNull() == false ).warning("need a hwvb!");
@@ -540,7 +540,7 @@
 	}
 
 	//-----------------------------------------------------
-	bool OgreSubmeshAccess::setNormal( uint32 index, const Vector3 & normal )
+	bool OgreSubmeshAccess::setNormal( uint32 index, const math::Vector3 & normal )
 	{
 		YAKE_ASSERT( mpLockedNormals != 0 ).warning("should be locked!");
 		YAKE_ASSERT( mhwvbNormals.isNull() == false ).warning("need a hwvb!");
@@ -556,3 +556,4 @@
 }
 }
 }
+

Modified: trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreLight.cpp
===================================================================
--- trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreLight.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreLight.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -117,14 +117,14 @@
 	}
 
 	//------------------------------------------------------
-	void OgreLight::setDiffuseColour( const Color& colour )
+	void OgreLight::setDiffuseColour( const math::Color& colour )
 	{
 		YAKE_ASSERT( mLight ).debug( "need actual light!" );
 		mLight->setDiffuseColour( COL_YAKE2OGRE( colour ) );
 	}
 
 	//------------------------------------------------------
-	void OgreLight::setSpecularColour( const Color& colour )
+	void OgreLight::setSpecularColour( const math::Color& colour )
 	{
 		YAKE_ASSERT( mLight ).debug( "need actual light!" );
 		mLight->setSpecularColour( COL_YAKE2OGRE( colour ) );
@@ -208,42 +208,42 @@
 	}
 
 	//------------------------------------------------------
-	void OgreLight::setPosition( const Vector3& rPosition )
+	void OgreLight::setPosition( const math::Vector3& rPosition )
 	{
 		YAKE_ASSERT( mLight ).debug( "need actual light!" );
 		mLight->setPosition( VEC_YAKE2OGRE( rPosition ) );
 	}
 
 	//------------------------------------------------------
-	Vector3 OgreLight::getPosition() const
+	math::Vector3 OgreLight::getPosition() const
 	{
 		YAKE_ASSERT( mLight ).debug( "need actual light!" );
 		return VEC_OGRE2YAKE( mLight->getPosition() );
 	}
 
 	//------------------------------------------------------
-	void OgreLight::setOrientation( const Quaternion & orientation )
+	void OgreLight::setOrientation( const math::Quaternion & orientation )
 	{
 		YAKE_ASSERT( mLight ).debug( "need actual light!" );
-		setDirection( orientation * Vector3(0,0,1) );
+		setDirection( orientation * math::Vector3(0,0,1) );
 	}
 
 	//------------------------------------------------------
-	Quaternion OgreLight::getOrientation() const
+	math::Quaternion OgreLight::getOrientation() const
 	{
 		YAKE_ASSERT( mLight ).debug( "not implemented..." );
-		return Quaternion::kIdentity;
+		return math::Quaternion::kIdentity;
 	}
 
 	//------------------------------------------------------
-	void OgreLight::setDirection( const Vector3& direction )
+	void OgreLight::setDirection( const math::Vector3& direction )
 	{
 		YAKE_ASSERT( mLight ).debug( "need actual light!" );
 		mLight->setDirection( VEC_YAKE2OGRE( direction ) );
 	}
 
 	//------------------------------------------------------
-	Vector3 OgreLight::getDirection() const
+	math::Vector3 OgreLight::getDirection() const
 	{
 		YAKE_ASSERT( mLight ).debug( "need actual light!" );
 		return VEC_OGRE2YAKE( mLight->getDirection() );
@@ -252,3 +252,4 @@
 } // ogre3d
 } // graphics
 } // yake
+

Modified: trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreNode.cpp
===================================================================
--- trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreNode.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreNode.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -37,20 +37,22 @@
 namespace ogre3d {
 
 	//------------------------------------------------------
-	OgreNode::OgreNode( GraphicalWorld& owningWorld, Ogre::SceneManager * sceneMgr, const String& name /*= ""*/ ) : 
+	OgreNode::OgreNode( GraphicalWorld& owningWorld, Ogre::SceneManager* sceneMgr, const String& name /*= ""*/ ) : 
 			mWorld( owningWorld ),
 			mSceneNode( 0 ) ,mSceneMgr( sceneMgr ), mParentNode(0)
 	{
 		YAKE_ASSERT( sceneMgr ).debug("need a scene manager!");
+
 		String ogreid = name;
 		if (ogreid.empty())
-			ogreid = uniqueName::create("sn_"+name+"_");
+			ogreid = uniqueName::create( "sn_" );
 		mName = ogreid;
 		mSceneNode = static_cast< Ogre::SceneNode* >( mSceneMgr->getRootSceneNode()->createChild( ogreid ) );
 		YAKE_ASSERT( mSceneNode ).warning("Couldn't create a scene node!");
+
 		mSceneNode->setPosition( 0, 0, 0 );
+		
 		mWorld.reg( this );
-		//YAKE_LOG(String("gfx: new node '") << name << "' ogreid='" << String(mSceneNode->getName().c_str()) << "'");
 	}
 
 	//------------------------------------------------------
@@ -149,26 +151,26 @@
 	}
 
 	//------------------------------------------------------
-	void OgreNode::setPosition( const Vector3 & position )
+	void OgreNode::setPosition( const math::Vector3 & position )
 	{
 		YAKE_ASSERT( mSceneNode ).debug("need a scene node!");
 		mSceneNode->setPosition( VEC_YAKE2OGRE( position ) );
 	}
 
 	//------------------------------------------------------
-	Vector3 OgreNode::getPosition() const
+	math::Vector3 OgreNode::getPosition() const
 	{
 		YAKE_ASSERT( mSceneNode ).debug("need a scene node!");
 		return VEC_OGRE2YAKE( mSceneNode->getPosition() );
 	}
 
 	//------------------------------------------------------
-	Vector3 OgreNode::getPosition( ISceneNode::TransformSpace ts ) const
+	math::Vector3 OgreNode::getPosition( ISceneNode::TransformSpace ts ) const
 	{
 		switch( ts )
 		{
 			case TS_LOCAL:
-				return Vector3();
+				return math::Vector3();
 				
 			case TS_PARENT:
 				return getPosition();
@@ -178,74 +180,82 @@
 			
 			default:
 				YAKE_ASSERT( 0 ).error( "Unknown transform space" );
-				return Vector3();
+				return math::Vector3();
 		}
 	}
 
 	//------------------------------------------------------
-	void OgreNode::setOrientation( const Quaternion & orientation )
+	void OgreNode::setOrientation( const math::Quaternion & orientation )
 	{
 		YAKE_ASSERT( mSceneNode ).debug("need a scene node!");
 		mSceneNode->setOrientation( QUAT_YAKE2OGRE( orientation ) );
 	}
 
 	//------------------------------------------------------
-	Quaternion OgreNode::getOrientation() const
+	math::Quaternion OgreNode::getOrientation() const
 	{
 		YAKE_ASSERT( mSceneNode ).debug("need a scene node!");
 		return QUAT_OGRE2YAKE( mSceneNode->getOrientation() );
 	}
 
 	//------------------------------------------------------
-	void OgreNode::setScale( const Vector3 & scale )
+	void OgreNode::setScale( const math::Vector3 & scale )
 	{
 		YAKE_ASSERT( mSceneNode ).debug("need a scene node!");
 		mSceneNode->setScale( VEC_YAKE2OGRE( scale ) );
 	}
 
 	//------------------------------------------------------
-	Vector3 OgreNode::getScale() const
+	math::Vector3 OgreNode::getScale() const
 	{
 		YAKE_ASSERT( mSceneNode ).debug("need a scene node!");
 		return VEC_OGRE2YAKE( mSceneNode->getScale() );
 	}
 
 	//------------------------------------------------------
-	Vector3 OgreNode::getDerivedPosition() const
+	void OgreNode::setInheritScale( bool inherit )
 	{
 		YAKE_ASSERT( mSceneNode ).debug("need a scene node!");
+
+		mSceneNode->setInheritScale( inherit );
+	}
+
+	//------------------------------------------------------
+	math::Vector3 OgreNode::getDerivedPosition() const
+	{
+		YAKE_ASSERT( mSceneNode ).debug("need a scene node!");
 		return VEC_OGRE2YAKE( mSceneNode->_getDerivedPosition() );
 	}
 
 	//------------------------------------------------------
-	void OgreNode::getDerivedPosition( Vector3& retPos ) const
+	void OgreNode::getDerivedPosition( math::Vector3& retPos ) const
 	{
 		YAKE_ASSERT( mSceneNode ).debug("need a scene node!");
 		retPos = VEC_OGRE2YAKE( mSceneNode->_getDerivedPosition() );
 	}
 
 	//------------------------------------------------------
-	Quaternion OgreNode::getDerivedOrientation() const
+	math::Quaternion OgreNode::getDerivedOrientation() const
 	{
 		YAKE_ASSERT( mSceneNode ).debug("need a scene node!");
 		return QUAT_OGRE2YAKE( mSceneNode->_getDerivedOrientation() );
 	}
 
 	//------------------------------------------------------
-	void OgreNode::getDerivedOrientation( Quaternion& retRot ) const
+	void OgreNode::getDerivedOrientation( math::Quaternion& retRot ) const
 	{
 		YAKE_ASSERT( mSceneNode ).debug("need a scene node!");
 		retRot = QUAT_OGRE2YAKE( mSceneNode->_getDerivedOrientation() );
 	}
 
 	//------------------------------------------------------
-	void OgreNode::translate( const Vector3& rDelta, const TransformSpace relativeTo /*= TS_PARENT*/ )
+	void OgreNode::translate( const math::Vector3& rDelta, const TransformSpace relativeTo /*= TS_PARENT*/ )
 	{
 		mSceneNode->translate( VEC_YAKE2OGRE(rDelta), TS_YAKE2OGRE(relativeTo) );
 	}
 
 	//------------------------------------------------------
-	void OgreNode::rotate( const Quaternion& rDelta, const TransformSpace relativeTo /*= TS_PARENT*/ )
+	void OgreNode::rotate( const math::Quaternion& rDelta, const TransformSpace relativeTo /*= TS_PARENT*/ )
 	{
 		mSceneNode->rotate( QUAT_YAKE2OGRE(rDelta), TS_YAKE2OGRE(relativeTo) );
 	}
@@ -372,8 +382,14 @@
 	ISceneNode* OgreNode::createChildNode( const String& name /*= ""*/ )
 	{
 		YAKE_ASSERT( mSceneNode ).debug("need a scene node!");
+
 		OgreNode* pChild = new OgreNode( mWorld, mSceneMgr, name );
+
 		this->addChildNode( pChild );
+
+		pChild->setPosition( math::Vector3() );
+		pChild->setOrientation( math::Quaternion() );
+
 		return pChild;
 	}
 

Modified: trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreParticleSystem.cpp
===================================================================
--- trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreParticleSystem.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreParticleSystem.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -32,19 +32,34 @@
 namespace graphics {
 
 	//------------------------------------------------------
+// for Ogre 1.1.0 "Dagon" compatibility
+#if OGRE_VERSION_MINOR >= 1 
+	OgreParticleSystem::OgreParticleSystem( Ogre::SceneManager& rSMgr, const String& rPSTempl ) : 
+		mSceneMgr( rSMgr ), mParticleSys( NULL )
+	{
+		mParticleSys = mSceneMgr.createParticleSystem( uniqueName::create( "ps_" ), rPSTempl );
+
+		YAKE_ASSERT( mParticleSys ).debug( "Failed to create particle system!" );
+	}
+#else
 	OgreParticleSystem::OgreParticleSystem( Ogre::ParticleSystemManager& rPSMgr, const String& rPSTempl ) : 
-																mParticleSysMgr( rPSMgr ), mParticleSys( NULL )
+		mParticleSysMgr( rPSMgr ), mParticleSys( NULL )
 	{
 		mParticleSys = mParticleSysMgr.createSystem( uniqueName::create( "ps_" ), rPSTempl );
 
 		YAKE_ASSERT( mParticleSys ).debug( "Failed to create particle system!" );
 	}
-
+#endif
 	//------------------------------------------------------
 	OgreParticleSystem::~OgreParticleSystem()
 	{
 		YAKE_ASSERT( mParticleSys );
+// for Ogre 1.1.0 "Dagon" compatibility
+#if OGRE_VERSION_MINOR >= 1 
+		mSceneMgr.destroyParticleSystem( mParticleSys );
+#else
 		mParticleSysMgr.destroySystem( mParticleSys->getName() );
+#endif
 	}
 
 	//------------------------------------------------------
@@ -123,3 +138,4 @@
 
 } // graphics
 } // yake
+

Modified: trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreViewport.cpp
===================================================================
--- trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreViewport.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreViewport.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -49,7 +49,8 @@
 		mViewport = pWnd->addViewport( mCamera->getCamera_(), 100, 0., 0., 1., 1. );
 		YAKE_ASSERT( mViewport ).error("viewport creation failed!");
 
-		mViewport->setBackgroundColour( Ogre::ColourValue(0.2,0.2,0.3) );
+		// default - is a black background
+		mViewport->setBackgroundColour( Ogre::ColourValue( 0, 0, 0 ) );
 	}
 
 	//------------------------------------------------------
@@ -96,6 +97,19 @@
 	}
 
 	//------------------------------------------------------
+	void OgreViewport::setBackgroundColor( const math::Color& col )
+	{
+	    mViewport->setBackgroundColour( COL_YAKE2OGRE( col ) );
+
+	}
+
+	//------------------------------------------------------
+	math::Color OgreViewport::getBackgroundColor() const
+	{
+	    return COL_OGRE2YAKE( mViewport->getBackgroundColour() );
+	}
+
+	//------------------------------------------------------
 	void OgreViewport::killViewport()
 	{
 		Ogre::RenderWindow* pWnd = mCore->getRenderWindow();

Modified: trunk/yake/src/yake/plugins/graphicsOgre/yakeGraphicsWorld.cpp
===================================================================
--- trunk/yake/src/yake/plugins/graphicsOgre/yakeGraphicsWorld.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/graphicsOgre/yakeGraphicsWorld.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -41,7 +41,7 @@
 #include <yake/plugins/graphicsOgre/graphicsOgreCore.h>
 #include <yake/plugins/graphicsOgre/graphicsOgreParticleSystem.h>
 #include <yake/plugins/graphicsOgre/graphicsOgreGeometryAccess.h>
-#define YAKE_USE_OSM
+
 #ifdef YAKE_USE_OSM
 #include "OgreOSMScene.h"
 #endif
@@ -171,7 +171,12 @@
 	IParticleSystem* GraphicalWorld::createParticleSystem( const String& rPSTemplateName )
 	{
 		YAKE_ASSERT( msCore ).debug("need a core!");
+// for Ogre 1.1.0 "Dagon" compatibility
+#if OGRE_VERSION_MINOR >= 1 
+		return new OgreParticleSystem( *msCore->getSceneMgr(), rPSTemplateName );
+#else
 		return new OgreParticleSystem( *msCore->getParticleSysMgr(), rPSTemplateName );
+#endif
 	}
 
 	//-----------------------------------------------------
@@ -251,7 +256,7 @@
 			if (contains(params,"tex_count"))
 				texCount = StringUtil::parseInt(params["tex_count"]);
 
-			Color colour(0.6f,0.6f,0.6f,1.0f);
+			math::Color colour(0.6f,0.6f,0.6f,1.0f);
 			if (contains(params,"colour.r"))
 				colour.r = StringUtil::parseReal(params["colour.r"]);
 			if (contains(params,"colour.g"))
@@ -354,7 +359,7 @@
 	}
 
 	//-----------------------------------------------------
-	IEntity* GraphicalWorld::pickEntity(const Ray& ray)
+	IEntity* GraphicalWorld::pickEntity(const math::Ray& ray)
 	{
 		YAKE_ASSERT( msCore );
 

Modified: trunk/yake/src/yake/plugins/inputOgre/InputSystemOgre.cpp
===================================================================
--- trunk/yake/src/yake/plugins/inputOgre/InputSystemOgre.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/inputOgre/InputSystemOgre.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -43,7 +43,7 @@
 	//-----------------------------------------------------------------------
 	MouseDeviceOgre::MouseDeviceOgre(Ogre::InputReader * inputReader) :
 				mInputReader(inputReader),
-				mPosition(Vector3::kZero)
+				mPosition(math::Vector3::kZero)
 	{
 		mButtons[0] = mButtons[1] = mButtons[2] = false;
 	}
@@ -68,7 +68,7 @@
 	}
 	
 	//-----------------------------------------------------------------------
-	Vector3 MouseDeviceOgre::getPosition() const
+	math::Vector3 MouseDeviceOgre::getPosition() const
 	{
 		return mPosition;
 	}

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeActor.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeActor.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeActor.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -1,28 +1,28 @@
 /*
-   ------------------------------------------------------------------------------------
-   This file is part of YAKE
-   Copyright  2004 The YAKE Team
-   For the latest information visit http://www.yake.org 
-   ------------------------------------------------------------------------------------
-   This program is free software; you can redistribute it and/or modify it under
-   the terms of the GNU Lesser General Public License as published by the Free Software
-   Foundation; either version 2 of the License, or (at your option) any later
-   version.
+------------------------------------------------------------------------------------
+This file is part of YAKE
+Copyright  2004 The YAKE Team
+For the latest information visit http://www.yake.org 
+------------------------------------------------------------------------------------
+This program is free software; you can redistribute it and/or modify it under
+the terms of the GNU Lesser General Public License as published by the Free Software
+Foundation; either version 2 of the License, or (at your option) any later
+version.
 
-   This program is distributed in the hope that it will be useful, but WITHOUT
-   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
-   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+This program is distributed in the hope that it will be useful, but WITHOUT
+ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
 
-   You should have received a copy of the GNU Lesser General Public License along with
-   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
-   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
-   http://www.gnu.org/copyleft/lesser.txt.
-   ------------------------------------------------------------------------------------
-   If you are interested in another license model contact the Yake Team via
-   E-Mail: team at yake.org.
-   For more information see the LICENSE file in the root directory of the
-   source code distribution.
-   ------------------------------------------------------------------------------------
+You should have received a copy of the GNU Lesser General Public License along with
+this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+http://www.gnu.org/copyleft/lesser.txt.
+------------------------------------------------------------------------------------
+If you are interested in another license model contact the Yake Team via
+E-Mail: team at yake.org.
+For more information see the LICENSE file in the root directory of the
+source code distribution.
+------------------------------------------------------------------------------------
 */
 #include <yake/plugins/physicsODE/yakePCH.h>
 #include <yake/plugins/physicsODE/OdeWorld.h>
@@ -32,106 +32,104 @@
 #include <yake/plugins/physicsODE/OdeShapes.h>
 
 namespace yake {
-namespace physics {
+	namespace physics {
 
-    //-----------------------------------------------------
-    //	OdeActor
-    //-----------------------------------------------------
-	
-    //-----------------------------------------------------
-    OdeActor::OdeActor( OdeWorld* pWorld, bool bDynamic ) :
-		mOdeWorld(pWorld),
+		//-----------------------------------------------------
+		//	OdeActor
+		//-----------------------------------------------------
+
+		//-----------------------------------------------------
+		OdeActor::OdeActor( OdeWorld* pWorld, bool bDynamic ) :
+	mOdeWorld(pWorld),
 		mBody(0)
-    {
+	{
 		if (bDynamic)
 		{
 			mBody = new OdeBody( mOdeWorld, *this );
 			YAKE_ASSERT( mBody ).error( "Failed to create body!" );
-			mBody->setPosition( Vector3::kZero );
-			mBody->setOrientation( Quaternion::kIdentity );
+			mBody->setPosition( math::Vector3::kZero );
+			mBody->setOrientation( math::Quaternion::kIdentity );
 		}
-		this->setPosition( Vector3::kZero );
-		this->setOrientation( Quaternion::kIdentity );
-    }
+		this->setPosition( math::Vector3::kZero );
+		this->setOrientation( math::Quaternion::kIdentity );
+	}
 
-    //-----------------------------------------------------
-    OdeActor::~OdeActor()
-    {
+	//-----------------------------------------------------
+	OdeActor::~OdeActor()
+	{
 		YAKE_SAFE_DELETE( mBody );
 		// destroy all shapes
 		mShapes.clear();
-    }
+	}
 
-    //-----------------------------------------------------
-    IWorld* OdeActor::getCreator() const
-    {
+	//-----------------------------------------------------
+	IWorld* OdeActor::getCreator() const
+	{
 		return mOdeWorld;
-    }
+	}
 
-    //-----------------------------------------------------
-    void OdeActor::setEnabled(const bool enabled)
-    {
+	//-----------------------------------------------------
+	void OdeActor::setEnabled(const bool enabled)
+	{
 		YAKE_ASSERT( 0 && "NOT IMPLEMENTED" );
-    }
+	}
 
-    //-----------------------------------------------------
-    bool OdeActor::isEnabled() const
-    {
+	//-----------------------------------------------------
+	bool OdeActor::isEnabled() const
+	{
 		return true;
-    }
+	}
 
-    //-----------------------------------------------------
-    OdeGeom* OdeActor::createTransformGeomIfNeeded(	OdeGeom* pGeom,
-	    const Vector3& rOffset,
-	    const Quaternion& rRelOrientation )
-    {
-		//if ( rOffset == Vector3::kZero && rRelOrientation == Quaternion::kIdentity )
-		//    return pGeom;
-
+	//-----------------------------------------------------
+	OdeGeom* OdeActor::createTransformGeom(	OdeGeom* pGeom,
+		const math::Vector3& rOffset,
+		const math::Quaternion& rRelOrientation )
+	{
 		OdeTransformGeom* pTrans = new OdeTransformGeom( mOdeWorld->_getOdeSpace(), this );
 		pTrans->attachGeom( pGeom );
 
-		pTrans->setPosition( rOffset );
-		pTrans->setOrientation( rRelOrientation );
+		pGeom->setPosition( rOffset );
+		pGeom->setOrientation( rRelOrientation );
 
 		return pTrans;
-    }
+	}
 
-    //-----------------------------------------------------
-    OdeGeom* OdeActor::createShapeFromDesc( const IShape::Desc& rShapeDesc )
-    {
-		IShape::Desc* pShapeDesc = &const_cast<IShape::Desc&>( rShapeDesc );
+	//-----------------------------------------------------
+	OdeGeom* OdeActor::createShapeFromDesc( const IShape::Desc& rShapeDesc )
+	{
+		YAKE_LOG_INFORMATION( String( "OdeActor | creating geom. Position " ) << rShapeDesc.position  );
+		const IShape::Desc* pShapeDesc = &( rShapeDesc );
 
 		IMaterial* pMaterial = this->getCreator()->getMaterial( pShapeDesc->material );
 
 		if ( !pMaterial )
 			pMaterial = this->getCreator()->getMaterial( "default" );
 
-		OdeMaterial* pOdeMaterial = pMaterial ? dynamic_cast<OdeMaterial*>( pMaterial ) : 0;
+		OdeMaterial* pOdeMaterial = pMaterial ? checked_cast<OdeMaterial*>( pMaterial ) : 0;
 		YAKE_ASSERT( pOdeMaterial );
 
 		OdeGeom* result = 0;
 
-		if ( IShape::SphereDesc* pSphereDesc = dynamic_cast<IShape::SphereDesc*>( pShapeDesc ) )
+		if ( const IShape::SphereDesc* pSphereDesc = checked_cast<const IShape::SphereDesc*>( pShapeDesc ) )
 		{
 			OdeSphere* pSphere = new OdeSphere( mOdeWorld->_getOdeSpace(), this, pSphereDesc->radius );
 
-			result = createTransformGeomIfNeeded( pSphere, rShapeDesc.position, rShapeDesc.orientation );
+			result = createTransformGeom( pSphere, rShapeDesc.position, rShapeDesc.orientation );
 		}
-		else if ( IShape::BoxDesc* pBoxDesc = dynamic_cast<IShape::BoxDesc*>( pShapeDesc ) )
+		else if ( const IShape::BoxDesc* pBoxDesc = checked_cast<const IShape::BoxDesc*>( pShapeDesc ) )
 		{
 			OdeBox* pBox = new OdeBox( mOdeWorld->_getOdeSpace(), 
 				this,
 				pBoxDesc->dimensions.x, 
 				pBoxDesc->dimensions.y,
 				pBoxDesc->dimensions.z  );
-			result = createTransformGeomIfNeeded( pBox, rShapeDesc.position, rShapeDesc.orientation );
+			result = createTransformGeom( pBox, rShapeDesc.position, rShapeDesc.orientation );
 		}
-		else if ( IShape::PlaneDesc* pPlaneDesc = dynamic_cast<IShape::PlaneDesc*>( pShapeDesc ) )
+		else if ( const IShape::PlaneDesc* pPlaneDesc = checked_cast<const IShape::PlaneDesc*>( pShapeDesc ) )
 		{
 			/// We are not making transform geom here.
 			/// Calculating absolute coordinates instead...
-			Vector3 normal( pPlaneDesc->orientation*pPlaneDesc->normal );
+			math::Vector3 normal( pPlaneDesc->orientation*pPlaneDesc->normal );
 			normal.normalise();
 
 			real d = pPlaneDesc->d + normal.dotProduct( pPlaneDesc->position ); 
@@ -144,15 +142,15 @@
 				d );
 			result = pPlane;
 		}
-		else if ( IShape::CapsuleDesc* pCapsuleDesc = dynamic_cast<IShape::CapsuleDesc*>( pShapeDesc ) )
+		else if ( const IShape::CapsuleDesc* pCapsuleDesc = checked_cast<const IShape::CapsuleDesc*>( pShapeDesc ) )
 		{
 			OdeCCylinder* pCapsule = new OdeCCylinder( mOdeWorld->_getOdeSpace(), 
 				this,
 				pCapsuleDesc->radius,
 				pCapsuleDesc->height  );
-			result = createTransformGeomIfNeeded( pCapsule, rShapeDesc.position, rShapeDesc.orientation );
+			result = createTransformGeom( pCapsule, rShapeDesc.position, rShapeDesc.orientation );
 		}
-		else if ( IShape::TriMeshDesc* pTriMeshDesc = dynamic_cast<IShape::TriMeshDesc*>( pShapeDesc ) )
+		else if ( const IShape::TriMeshDesc* pTriMeshDesc = checked_cast<const IShape::TriMeshDesc*>( pShapeDesc ) )
 		{
 			TriangleMeshId id = pTriMeshDesc->trimeshId_;
 			if (id == kTriangleMeshIdNone)
@@ -166,7 +164,7 @@
 
 			YAKE_ASSERT( pMesh ).error( "Mesh with such id wasn't found!" );
 
-			result = createTransformGeomIfNeeded( pMesh, rShapeDesc.position, rShapeDesc.orientation );
+			result = createTransformGeom( pMesh, rShapeDesc.position, rShapeDesc.orientation );
 		}
 
 		YAKE_ASSERT( result != 0 ).error( "Unsupported shape type!" );
@@ -180,71 +178,71 @@
 		{
 			mShapes.push_back( SharedPtr<OdeGeom>(result) );
 			// plane is not a movable geom. Its position is determined on creation!
-		// if (result->getType() != ST_PLANE)
-		// {
-		//     result->setPosition( pShapeDesc->position );
-		//     result->setOrientation( pShapeDesc->orientation );
-		// }
+			// if (result->getType() != ST_PLANE)
+			// {
+			//     result->setPosition( pShapeDesc->position );
+			//     result->setOrientation( pShapeDesc->orientation );
+			// }
 		}
 
 		return result;
-    }
+	}
 
-    //-----------------------------------------------------
-    bool operator == (const SharedPtr<OdeGeom>& lhs, const OdeGeom* rhs)
-    {
+	//-----------------------------------------------------
+	bool operator == (const SharedPtr<OdeGeom>& lhs, const OdeGeom* rhs)
+	{
 		return (lhs.get() == rhs);
-    }
+	}
 
-    //-----------------------------------------------------
-    void OdeActor::destroyShape( IShape* pShape )
-    {
-		OdeGeom* pGeom = dynamic_cast<OdeGeom*>( pShape );
+	//-----------------------------------------------------
+	void OdeActor::destroyShape( IShape* pShape )
+	{
+		OdeGeom* pGeom = checked_cast<OdeGeom*>( pShape );
 		ShapeList::iterator victim = std::find( mShapes.begin(), mShapes.end(), pGeom );
 		mShapes.erase( victim );
-    }
+	}
 
-    //-----------------------------------------------------
-    IShapePtrList OdeActor::getShapes() const
-    {
+	//-----------------------------------------------------
+	IShapePtrList OdeActor::getShapes() const
+	{
 		IShapePtrList ret;
 		//ret.reserve( mShapes.size() );
 		//std::copy( mShapes.begin(), mShapes.end(), std::back_inserter( mShapes ) );
 		for (ShapeList::const_iterator it = mShapes.begin(); it != mShapes.end(); ++it)
-			ret.push_back( dynamic_cast<IShape*>(it->get()) );
+			ret.push_back( checked_cast<IShape*>(it->get()) );
 		return ret;
-    }
+	}
 
-    //-----------------------------------------------------
-    // 	void OdeActor::postStep( real timeElapsed )
-    // 	{
-    // 		Vector< OdeActor* > its;
-    // 		for (CollisionList::iterator it = mCollisions.begin(); it != mCollisions.end(); ++it)
-    // 		{
-    // 			CollisionInfo& info = it->second;
-    // 			info.time += timeElapsed;
-    // 			if (info.time >= 0.1)
-    // 			{
-    // 				mLeaveCollisionSignal( this, it->first );
-    // 				its.push_back( it->first );
-    // 			}
-    // 		}
-    // 		VectorIterator< Vector< OdeActor* > > itErase(
-    // 			its.begin(), its.end() );
-    // 		while (itErase.hasMoreElements())
-    // 		{
-    // 			CollisionList::iterator itFind = mCollisions.find( itErase.getNext() );
-    // 			if (itFind != mCollisions.end())
-    // 				mCollisions.erase( itFind );
-    // 		}
-    // 		its.clear();
-    // 	}
+	//-----------------------------------------------------
+	// 	void OdeActor::postStep( real timeElapsed )
+	// 	{
+	// 		Vector< OdeActor* > its;
+	// 		for (CollisionList::iterator it = mCollisions.begin(); it != mCollisions.end(); ++it)
+	// 		{
+	// 			CollisionInfo& info = it->second;
+	// 			info.time += timeElapsed;
+	// 			if (info.time >= 0.1)
+	// 			{
+	// 				mLeaveCollisionSignal( this, it->first );
+	// 				its.push_back( it->first );
+	// 			}
+	// 		}
+	// 		VectorIterator< Vector< OdeActor* > > itErase(
+	// 			its.begin(), its.end() );
+	// 		while (itErase.hasMoreElements())
+	// 		{
+	// 			CollisionList::iterator itFind = mCollisions.find( itErase.getNext() );
+	// 			if (itFind != mCollisions.end())
+	// 				mCollisions.erase( itFind );
+	// 		}
+	// 		its.clear();
+	// 	}
 
 //#define DEBUG_COLLISIONS
 
-    //-----------------------------------------------------
-    void OdeActor::_collide( OdeActor* pOther, dGeomID geomA, dGeomID geomB, dJointGroup* contactJointGroup )
-    {
+	//-----------------------------------------------------
+	void OdeActor::_collide( OdeActor* pOther, dGeomID geomA, dGeomID geomB, dJointGroup* contactJointGroup )
+	{
 		YAKE_ASSERT( pOther ).debug( "Need the other object participating in the collision!" );
 		YAKE_ASSERT( contactJointGroup ).error( "Need a joint group for contact joints!" );
 
@@ -254,53 +252,77 @@
 
 		OdeGeom* pShapeA = reinterpret_cast<OdeGeom*>( dGeomGetData( geomA ) );
 		OdeGeom* pShapeB = reinterpret_cast<OdeGeom*>( dGeomGetData( geomB ) );
+		YAKE_ASSERT( pShapeA != NULL && pShapeB != NULL ).error( "shapes are corrupt!" );
 
 #ifdef DEBUG_COLLISIONS
-	YAKE_LOG( "Actor collision function entered..." );
+		YAKE_LOG( "Actor collision function entered..." );
 #endif 
 
-		const OdeMaterial& rMatA = *pShapeA->getMaterial();
-		const OdeMaterial& rMatB = *pShapeB->getMaterial();
-
 		dContact contact[ MAX_CONTACTS ];
 
 		// initiating collision detection
 		int numCollided = dCollide( geomA, geomB, MAX_CONTACTS, &contact[0].geom, sizeof( dContact ) );
 		if (numCollided == 0)
+		{
+#ifdef DEBUG_COLLISIONS
+			YAKE_LOG( "No collisions..." );
+#endif
 			return;
+		}
 
-		//HACK FIXME implement collision cache!!!
-		// fire collision events
-		CollisionCache::iterator itFind = mCollisions.find( pOther );
-		if ( itFind == mCollisions.end() )
-		{
-			// new collision
-			CollisionInfo info = 0;
-			mCollisions.insert( CollisionCache::value_type( pOther, info ) );
+#ifdef DEBUG_COLLISIONS
+		YAKE_LOG( "Firing collision signals" );
+#endif 
+		// collisions are fired...
+		this->mEnterCollisionSignal( ActorCollisionInfo( this, pShapeA, pOther, pShapeB ) );
+		pOther->mEnterCollisionSignal( ActorCollisionInfo( this, pShapeA, pOther, pShapeB ) );
 
-			//mEnterCollisionSignal( this, pOther );
-		}
-		else
+		const OdeMaterial* pMatA = pShapeA->getMaterial();
+		const OdeMaterial* pMatB = pShapeB->getMaterial();
+
+		// if materials are not supposed to produce any contact forces
+		// This is the case if we just want some collision detection and without
+		// any contact joints...
+		if ( pMatA == NULL || pMatB == NULL )
 		{
-			// still colliding, so reset timeout
-			itFind->second = 0;
+#ifdef DEBUG_COLLISIONS
+			YAKE_LOG( "collision detection without materials..." );
+#endif
+			return;
 		}
 
+		//HACK FIXME implement collision cache!!!
+		// fire collision events
+		//CollisionCache::iterator itFind = mCollisions.find( pOther );
+		//	if ( itFind == mCollisions.end() )
+		//	{
+		//	    // new collision
+		//	    CollisionInfo info = 0;
+		//	    mCollisions.insert( CollisionCache::value_type( pOther, info ) );
+		//
+		//	    //mEnterCollisionSignal( this, pOther );
+		//	}
+		//	else
+		//	{
+		//	    // still colliding, so reset timeout
+		//	    itFind->second = 0;
+		//	}
+
 		// calculate soft cfm parameter[0..10^-6] from softness [0..1]
-		float softness = ( rMatA.mSoftness + rMatB.mSoftness ) / 1000000.0f;
+		float softness = ( pMatA->mSoftness + pMatB->mSoftness ) / 1000000.0f;
 
 #ifdef DEBUG_COLLISIONS
 		YAKE_LOG( String("Collision: softness was set to ") << softness );
 #endif
 
-	    // create contact joints
-	    for ( int i = 0; i < numCollided; ++i )
-	    {
+		// create contact joints
+		for ( int i = 0; i < numCollided; ++i )
+		{
 			contact[i].surface.mode =
-			    dContactSoftERP
-			    |dContactSoftCFM
-			    |dContactBounce
-			    |dContactApprox1;
+				dContactSoftERP
+				|dContactSoftCFM
+				|dContactBounce
+				|dContactApprox1;
 
 			// Setting contact softness...
 			if ( softness > 0 )
@@ -313,15 +335,15 @@
 
 			// determine surface friction coefficients
 			// frictionCoefficient [0..1]
-			real frictionCoefficient = std::min( rMatA.mFriction, rMatB.mFriction );
+			real frictionCoefficient = std::min( pMatA->mFriction, pMatB->mFriction );
 
 #ifdef DEBUG_COLLISIONS
-		YAKE_LOG( String("Collision: frictionCoefficient was set to ") << frictionCoefficient );
+			YAKE_LOG( String("Collision: frictionCoefficient was set to ") << frictionCoefficient );
 #endif
 
 			contact[i].surface.mu = frictionCoefficient; 
 
-			float friction2 = std::min( rMatA.mFriction2, rMatB.mFriction2 ); 
+			float friction2 = std::min( pMatA->mFriction2, pMatB->mFriction2 ); 
 			if ( friction2 > 0.f )
 			{
 				contact[i].surface.mode |= dContactMu2;
@@ -336,11 +358,11 @@
 			//FIXME soft erp parameter should be correct
 			contact[i].surface.soft_erp = 0.9; 
 
-			real restitution = std::max( rMatA.mRestitution, rMatB.mRestitution );
+			real restitution = std::max( pMatA->mRestitution, pMatB->mRestitution );
 			contact[i].surface.bounce = restitution; 
 
 #ifdef DEBUG_COLLISIONS
-		YAKE_LOG( String("Collision: restitution was set to ") << restitution );
+			YAKE_LOG( String("Collision: restitution was set to ") << restitution );
 #endif
 
 			//FIXME bounce velocity needs to be tuned
@@ -350,13 +372,13 @@
 				contactJointGroup->id(),
 				contact + i );
 			dJointAttach ( contactJointID, dGeomGetBody( geomA ), dGeomGetBody( geomB ) );
-	    } // for each contact
-    }
+		} // for each contact
+	}
 
-    //-----------------------------------------------------
-    IShape* OdeActor::createShape( const IShape::Desc& rShapeDesc, real massOrDensity, IBody::quantityType type )
-    {
-		if ( mBody && dynamic_cast<const IShape::PlaneDesc*>( &rShapeDesc ) )
+	//-----------------------------------------------------
+	IShape* OdeActor::createShape( const IShape::Desc& rShapeDesc, real massOrDensity, IBody::quantityType type )
+	{
+		if ( mBody && checked_cast<const IShape::PlaneDesc*>( &rShapeDesc ) )
 			YAKE_ASSERT( false ).error( "Attempted to attach immovable plane shape to movable actor!" );
 
 		OdeGeom* pShape = createShapeFromDesc( rShapeDesc );
@@ -369,16 +391,16 @@
 
 			if (massOrDensity)
 			{
-			mBody->_applyMassDescFromShapeDesc( rShapeDesc, massOrDensity, type );
+				mBody->_applyMassDescFromShapeDesc( rShapeDesc, massOrDensity, type );
 			}
 		}
 
 		return pShape;
-    }
+	}
 
-    //-----------------------------------------------------
-    void OdeActor::setPosition( const Vector3& rPosition )
-    {
+	//-----------------------------------------------------
+	void OdeActor::setPosition( const math::Vector3& rPosition )
+	{
 		mPosition = rPosition;
 		if (mBody)
 			mBody->setPosition( rPosition );
@@ -389,11 +411,11 @@
 				i->get()->setPosition( mPosition );
 			}
 		}
-    }
+	}
 
-    //-----------------------------------------------------
-    void OdeActor::setOrientation( const Quaternion& rOrientation )
-    {
+	//-----------------------------------------------------
+	void OdeActor::setOrientation( const math::Quaternion& rOrientation )
+	{
 		mOrientation = rOrientation;
 
 		if (mBody)
@@ -405,36 +427,39 @@
 				i->get()->setOrientation( mOrientation );
 			}
 		}
-    }
+	}
 
-    //-----------------------------------------------------
-    Vector3 OdeActor::getPosition() const
-    {
+	//-----------------------------------------------------
+	math::Vector3 OdeActor::getPosition() const
+	{
 		if (mBody)
 			return mBody->getPosition();
+
 		return mPosition;
-    }
+	}
 
-    //-----------------------------------------------------
-    Quaternion OdeActor::getOrientation() const
-    {
+	//-----------------------------------------------------
+	math::Quaternion OdeActor::getOrientation() const
+	{
 		if (mBody)
 			return mBody->getOrientation();
+
 		return mOrientation;
-    }
+	}
 
-    //-----------------------------------------------------
-    IBody& OdeActor::getBody() const
-    {
+	//-----------------------------------------------------
+	IBody& OdeActor::getBody() const
+	{
 		YAKE_ASSERT( mBody );
 		return *mBody;
-    }
+	}
 
-    //-----------------------------------------------------
-    IBody* OdeActor::getBodyPtr() const
-    {
+	//-----------------------------------------------------
+	IBody* OdeActor::getBodyPtr() const
+	{
 		return mBody;
-    }
+	}
 
-} // physics
+	} // physics
 } // yake
+

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeBallJoint.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeBallJoint.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeBallJoint.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -55,7 +55,7 @@
 	}
 	
 	//-----------------------------------------------------
-	void OdeBallJoint::setAxis( size_t axisIndex, Vector3 const& rAxis )
+	void OdeBallJoint::setAxis( size_t axisIndex, const math::Vector3& rAxis )
 	{
 		YAKE_ASSERT( false ).error( "Ball joint doesn't have any axes!" );
 	}
@@ -79,7 +79,7 @@
 	}
 
 	//-----------------------------------------------------
-	void OdeBallJoint::setAnchor( size_t anchorIndex, Vector3 const& rAnchor )
+	void OdeBallJoint::setAnchor( size_t anchorIndex, const math::Vector3& rAnchor )
 	{
 		YAKE_ASSERT( anchorIndex < 1 ).error( "Ball joint has only one anchor! You are trying to set more..." );
 		

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeBody.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeBody.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeBody.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -51,11 +51,13 @@
 			mOdeBody->setForce( 0, 0, 0 );
 			mOdeBody->setLinearVel( 0, 0, 0 );
 			mOdeBody->setAngularVel( 0, 0, 0 );
+
 			dMassSetSphere( &mMass, 1, 1 );
-			setMass( 1 );
-			setPosition( Vector3(0,0,0) );
-			setOrientation( Quaternion::kIdentity );
+			mOdeBody->setMass( &mMass );
 
+			setPosition( math::Vector3(0,0,0) );
+			setOrientation( math::Quaternion::kIdentity );
+
 			mOdeWorld->_addBody( this );
 		}
 
@@ -76,7 +78,6 @@
  		void OdeBody::setMass( real mass )
 		{
  			dMassAdjust( &mMass, mass );
- 			
 			mOdeBody->setMass( &mMass );
 		}
 		
@@ -94,50 +95,61 @@
 		 */
 		void parseMassDesc( const IBody::MassDesc& desc, dMass* mass )
 		{
-			if ( const IBody::SphereMassDesc* sphereMassDesc = dynamic_cast<const IBody::SphereMassDesc*>( &desc ) )
+			if ( const IBody::SphereMassDesc* sphereMassDesc =
+				checked_cast<const IBody::SphereMassDesc*>( &desc ) )
 			{
 				if ( sphereMassDesc->qType == IBody::QT_DENSITY )
 					dMassSetSphere( mass, sphereMassDesc->quantity, sphereMassDesc->radius );
 				else
 					dMassSetSphereTotal( mass, sphereMassDesc->quantity, sphereMassDesc->radius );
 			}
-			else if ( const IBody::BoxMassDesc* boxMassDesc = dynamic_cast<const IBody::BoxMassDesc*>( &desc ) )
+			else if ( const IBody::BoxMassDesc* boxMassDesc = checked_cast<const IBody::BoxMassDesc*>( &desc ) )
 			{
 				if ( boxMassDesc->qType == IBody::QT_DENSITY )
-					dMassSetBox( mass, boxMassDesc->quantity, boxMassDesc->sizeX, boxMassDesc->sizeY, boxMassDesc->sizeZ );
+					dMassSetBox( mass, boxMassDesc->quantity, 
+						boxMassDesc->sizeX, boxMassDesc->sizeY, boxMassDesc->sizeZ );
 				else
-					dMassSetBoxTotal( mass, boxMassDesc->quantity, boxMassDesc->sizeX, boxMassDesc->sizeY, boxMassDesc->sizeZ );
+					dMassSetBoxTotal( mass, boxMassDesc->quantity, 
+						boxMassDesc->sizeX, boxMassDesc->sizeY, boxMassDesc->sizeZ );
 			}
-			else if ( const IBody::CapsuleMassDesc* capsuleMassDesc = dynamic_cast<const IBody::CapsuleMassDesc*>( &desc ) )
+			else if ( const IBody::CapsuleMassDesc* capsuleMassDesc = 
+				checked_cast<const IBody::CapsuleMassDesc*>( &desc ) )
 			{
 				if ( capsuleMassDesc->qType == IBody::QT_DENSITY )
 					dMassSetCappedCylinder( mass,
-												capsuleMassDesc->quantity,
-												2, 							// along Y axis
-												capsuleMassDesc->radius,
-												capsuleMassDesc->length );
+						capsuleMassDesc->quantity,
+						2, 							// along Y axis
+						capsuleMassDesc->radius,
+						capsuleMassDesc->length );
 				else
-					dMassSetCappedCylinderTotal( mass,
-												capsuleMassDesc->quantity,
-												2, 							// along Y axis
-												capsuleMassDesc->radius,
-												capsuleMassDesc->length );
+				    dMassSetCappedCylinderTotal( mass,
+					    capsuleMassDesc->quantity,
+					    2, 							// along Y axis
+					    capsuleMassDesc->radius,
+					    capsuleMassDesc->length );
 			}
-			else if ( const IBody::CylinderMassDesc* cylMassDesc = dynamic_cast<const IBody::CylinderMassDesc*>( &desc ) )
+			else if ( const IBody::CylinderMassDesc* cylMassDesc = 
+				checked_cast<const IBody::CylinderMassDesc*>( &desc ) )
 			{
 				if ( cylMassDesc->qType == IBody::QT_DENSITY )
 					dMassSetCylinder( mass,
-										cylMassDesc->quantity,
-										2,							// along Y axis
-										cylMassDesc->radius,
-										cylMassDesc->length );
+						cylMassDesc->quantity,
+						2,							// along Y axis
+						cylMassDesc->radius,
+						cylMassDesc->length );
 				else
 					dMassSetCylinderTotal( mass,
-										cylMassDesc->quantity,
-										2,							// along Y axis
-										cylMassDesc->radius,
-										cylMassDesc->length );
+						cylMassDesc->quantity,
+						2,							// along Y axis
+						cylMassDesc->radius,
+						cylMassDesc->length );
 			}
+			else if ( const IBody::MassDesc* massDesc = 
+				checked_cast<const IBody::MassDesc*>( &desc ) )
+			{
+			    // creating unit sphere
+			    dMassSetSphereTotal( mass, massDesc->quantity, 1 );
+			}
 			else
 			{
 				YAKE_ASSERT( 0 ).error( "Unsupported/unknown mass description type!" );
@@ -151,16 +163,16 @@
 		{
 			const IShape::Desc* pShapeDesc = &( rShapeDesc );
 			
-			if ( const IShape::SphereDesc* pSphereDesc = dynamic_cast<const IShape::SphereDesc*>( pShapeDesc ) )
+			if ( const IShape::SphereDesc* pSphereDesc = checked_cast<const IShape::SphereDesc*>( pShapeDesc ) )
 			{
 				this->addMass( IBody::SphereMassDesc( pSphereDesc->radius, massOrDensity, pSphereDesc->position, qType ) );
 			}
-			else if ( const IShape::BoxDesc* pBoxDesc = dynamic_cast<const IShape::BoxDesc*>( pShapeDesc ) )
+			else if ( const IShape::BoxDesc* pBoxDesc = checked_cast<const IShape::BoxDesc*>( pShapeDesc ) )
 			{
 				this->addMass( IBody::BoxMassDesc( pBoxDesc->dimensions.x, pBoxDesc->dimensions.y, pBoxDesc->dimensions.z, massOrDensity,
 					pBoxDesc->position, qType ) );
 			}
-			else if ( const IShape::CapsuleDesc* pCapsuleDesc = dynamic_cast<const IShape::CapsuleDesc*>( pShapeDesc ) )
+			else if ( const IShape::CapsuleDesc* pCapsuleDesc = checked_cast<const IShape::CapsuleDesc*>( pShapeDesc ) )
 			{
 				this->addMass( IBody::CapsuleMassDesc( pCapsuleDesc->radius, pCapsuleDesc->height, massOrDensity, pCapsuleDesc->position, qType ) );
 			}
@@ -174,7 +186,6 @@
 		void OdeBody::setMass( const MassDesc& rDesc )
 		{
 			parseMassDesc( rDesc, &mMass );
-			
 			mOdeBody->setMass( &mMass );
 		}
 		
@@ -195,7 +206,7 @@
 		void OdeBody::addForce( const Force& force )
 		{
 			//@todo apply force over several time steps according to duration.
-			const Vector3 totalForce = force.force * force.duration;
+			const math::Vector3 totalForce = force.force * force.duration;
 			if (force.frameType == RF_GLOBAL)
 				mOdeBody->addForce( totalForce.x, totalForce.y, totalForce.z );
 			else
@@ -203,162 +214,113 @@
 		}
 
 		//---------------------------------------------------
-		void OdeBody::addForce( Vector3 const& rForce )
+		void OdeBody::addForce( math::Vector3 const& rForce )
 		{
 			mOdeBody->addForce( rForce.x, rForce.y, rForce.z );
 		}
 		
 		//---------------------------------------------------
-		void OdeBody::addForceAtPos( Vector3 const& rForce, Vector3 const& rPos )
+		void OdeBody::addForceAtPos( math::Vector3 const& rForce, math::Vector3 const& rPos )
 		{
 			mOdeBody->addForceAtPos( rForce.x, rForce.y, rForce.z, rPos.x, rPos.y, rPos.z );
 		}
 		
 		//---------------------------------------------------
-		void OdeBody::addForceAtLocalPos( Vector3 const& rForce, Vector3 const& rPos )
+		void OdeBody::addForceAtLocalPos( math::Vector3 const& rForce, math::Vector3 const& rPos )
 		{
 			mOdeBody->addForceAtRelPos( rForce.x, rForce.y, rForce.z, rPos.x, rPos.y, rPos.z );
 		}
 
 		//---------------------------------------------------
-		void OdeBody::addLocalForce( Vector3 const& rForce )
+		void OdeBody::addLocalForce( math::Vector3 const& rForce )
 		{
 			mOdeBody->addRelForce( rForce.x, rForce.y, rForce.z );
 		}
 		
 		//---------------------------------------------------
-		void OdeBody::addLocalForceAtLocalPos( Vector3 const& rForce, Vector3 const& rPos )
+		void OdeBody::addLocalForceAtLocalPos( math::Vector3 const& rForce, math::Vector3 const& rPos )
 		{
 			mOdeBody->addRelForceAtRelPos( rForce.x, rForce.y, rForce.z, rPos.x, rPos.y, rPos.z );
 		}
 		
 		//---------------------------------------------------
-		void OdeBody::addLocalForceAtPos( Vector3 const& rForce, Vector3 const& rPos )
+		void OdeBody::addLocalForceAtPos( math::Vector3 const& rForce, math::Vector3 const& rPos )
 		{
 			mOdeBody->addRelForceAtPos( rForce.x, rForce.y, rForce.z, rPos.x, rPos.y, rPos.z );
 		}
 		
 		//---------------------------------------------------
-		void OdeBody::addTorque( Vector3 const& rTorque )
+		void OdeBody::addTorque( math::Vector3 const& rTorque )
 		{
 			mOdeBody->addTorque( rTorque.x, rTorque.y, rTorque.z );
 		}
 		
 		//---------------------------------------------------
-		void OdeBody::addLocalTorque( Vector3 const& rTorque )
+		void OdeBody::addLocalTorque( math::Vector3 const& rTorque )
 		{
 			mOdeBody->addRelTorque( rTorque.x, rTorque.y, rTorque.z );
 		}
 		
 		//---------------------------------------------------
-		void OdeBody::setLinearVelocity( Vector3 const& rVelocity )
+		void OdeBody::setLinearVelocity( math::Vector3 const& rVelocity )
 		{
 			mOdeBody->setLinearVel( rVelocity.x, rVelocity.y, rVelocity.z );
 		}
 		
 		//---------------------------------------------------
-		Vector3 OdeBody::getLinearVelocity() const
+		math::Vector3 OdeBody::getLinearVelocity() const
 		{
 			const dReal* v = mOdeBody->getLinearVel();
-			return Vector3( real(v[0]), real(v[1]), real(v[2]) );
+			return math::Vector3( static_cast<real>(v[0]), static_cast<real>(v[1]), static_cast<real>(v[2]) );
 		}
 		
 		//---------------------------------------------------
-		void OdeBody::setAngularVelocity( Vector3 const& rVelocity)
+		void OdeBody::setAngularVelocity( math::Vector3 const& rVelocity)
 		{
 			mOdeBody->setAngularVel( rVelocity.x, rVelocity.y, rVelocity.z );
 		}
 		
 		//---------------------------------------------------
-		Vector3 OdeBody::getAngularVelocity() const
+		math::Vector3 OdeBody::getAngularVelocity() const
 		{
 			const dReal* v = mOdeBody->getAngularVel();
-			return Vector3( real(v[0]), real(v[1]), real(v[2]) );
+			return math::Vector3( static_cast<real>(v[0]), static_cast<real>(v[1]), static_cast<real>(v[2]) );
 		}
 
 		//---------------------------------------------------
-		void OdeBody::setPosition(  Vector3 const& rPosition )
+		void OdeBody::setPosition( const math::Vector3& rPosition )
 		{
 			mOdeBody->setPosition( rPosition.x, rPosition.y, rPosition.z );
 		}
 		
 		//---------------------------------------------------
-		Vector3 OdeBody::getPosition() const
+		math::Vector3 OdeBody::getPosition() const
 		{
 			const dReal* pos = mOdeBody->getPosition();
-			return Vector3( real(pos[0]), real(pos[1]), real(pos[2]) );
+
+			return math::Vector3( static_cast<real>(pos[0]), 
+				static_cast<real>(pos[1]), 
+				static_cast<real>(pos[2]) );
 		}
 		
 		//---------------------------------------------------
-		void OdeBody::setOrientation( Quaternion const& rOrientation )
+		void OdeBody::setOrientation( const math::Quaternion& rOrientation )
 		{
 			dQuaternion q = { rOrientation.w, rOrientation.x, rOrientation.y, rOrientation.z };
 			mOdeBody->setQuaternion( q );
 		}
 		
 		//---------------------------------------------------
-		Quaternion OdeBody::getOrientation() const
+		math::Quaternion OdeBody::getOrientation() const
 		{
 			const dReal* q = mOdeBody->getQuaternion();
-			return Quaternion( real(q[0]), real(q[1]), real(q[2]), real(q[3]) );
+
+			return math::Quaternion( static_cast<real>(q[0]), 
+				static_cast<real>(q[1]), 
+				static_cast<real>(q[2]), 
+				static_cast<real>(q[3]) );
 		}
 		
-		
-// 		//---------------------------------------------------
-// 		void OdeBody::translateMass( const Vector3 & d )
-// 		{
-// 			dMassTranslate(&mMass, d.x, d.y, d.z);
-// 		}
-// 
-// 		//-----------------------------------------------------
-// 		IBody::MassType OdeBody::getType() const
-// 		{
-// 			return mMassType;
-// 		}
-// 
-// 		//-----------------------------------------------------
-// 		void OdeBody::setMassBox(real lx, real ly, real lz, real density)
-// 		{
-// 			mMassType = MT_BOX;
-// 			dMassSetBox( &mMass, density, lx, ly, lz );
-// 			YAKE_ASSERT( mOdeBody ).error("Need a body!");
-// 			mOdeBody->setMass( &mMass );
-// 		}
-// 
-// 		//-----------------------------------------------------
-// 		void OdeBody::setMassSphere(real r, real density)
-// 		{
-// 			mMassType = MT_SPHERE;
-// 			dMassSetSphere( &mMass, density, r );
-// 			YAKE_ASSERT( mOdeBody ).error("Need a body!");
-// 			mOdeBody->setMass( &mMass );
-// 		}
-// 
-// 		//-----------------------------------------------------
-// 		Vector3 OdeBody::getTorque() const
-// 		{
-// 			YAKE_ASSERT( mOdeBody ).error("Need a body!");
-// 			const dReal * torque = mOdeBody->getTorque();
-// 			return Vector3(torque[0], torque[1], torque[2]);
-// 		}
-// 
-// 		//-----------------------------------------------------
-// 		void OdeBody::setEnabled( bool enabled )
-// 		{
-// 			YAKE_ASSERT( mOdeBody ).error("Need a body!");
-// 			if (enabled)
-// 				mOdeBody->enable();
-// 			else
-// 				mOdeBody->disable();
-// 		}
-// 
-// 		//-----------------------------------------------------
-// 		OdeWorld* OdeBody::_getWorld() const
-// 		{
-// 			YAKE_ASSERT( mWorld ).error("Need a world!");
-// 			return mWorld;
-// 		}
-// 
 		//-----------------------------------------------------
 		dBody* OdeBody::_getOdeBody() const
 		{
@@ -367,3 +329,4 @@
 
 } // physics
 } // yake
+

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeFixedJoint.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeFixedJoint.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeFixedJoint.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -44,9 +44,9 @@
 	}
 
 	//-----------------------------------------------------
-	void OdeFixedJoint::attach( IBody& rBody1, IBody& rBody2 )
+	void OdeFixedJoint::attach( IBody* pBody1, IBody* pBody2 )
 	{
-		OdeJoint::attach( rBody1, rBody2 );
+		OdeJoint::attach( pBody1, pBody2 );
 		
 		dJointSetFixed( mOdeJoint->id() );
 	}
@@ -64,7 +64,7 @@
 	}
 	
 	//-----------------------------------------------------
-	void OdeFixedJoint::setAxis( size_t axisIndex, Vector3 const& rAxis )
+	void OdeFixedJoint::setAxis( size_t axisIndex, const math::Vector3& rAxis )
 	{
 		YAKE_ASSERT( false ).error( "Fixed joint doesn't have any axes!" );
 	}
@@ -76,7 +76,7 @@
 	}
 	
 	//-----------------------------------------------------
-	void OdeFixedJoint::setAnchor( size_t anchorIndex, Vector3 const& rAnchor )
+	void OdeFixedJoint::setAnchor( size_t anchorIndex, const math::Vector3& rAnchor )
 	{
 		YAKE_ASSERT( false ).error( "Fixed joint doesn't have any anchors!" );
 	}

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeHinge2Joint.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeHinge2Joint.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeHinge2Joint.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -55,7 +55,7 @@
 	}
 	
 	//-----------------------------------------------------
-	void OdeHinge2Joint::setAxis( size_t axisIndex, Vector3 const& rAxis )
+	void OdeHinge2Joint::setAxis( size_t axisIndex, const math::Vector3& rAxis )
 	{
 		YAKE_ASSERT( axisIndex < 2 ).error( "Hinge2 joint has only two axes! You are trying to set more..." );
 		
@@ -72,7 +72,7 @@
 	}
 	
 	//-----------------------------------------------------
-	void OdeHinge2Joint::setAnchor( size_t anchorIndex, Vector3 const& rAnchor )
+	void OdeHinge2Joint::setAnchor( size_t anchorIndex, const math::Vector3& rAnchor )
 	{
 		YAKE_ASSERT( anchorIndex < 1 ).error( "Hinge2 joint has only one anchor! You are trying to set more..." );
 		

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeHingeJoint.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeHingeJoint.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeHingeJoint.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -55,7 +55,7 @@
 	}
 	
 	//-----------------------------------------------------
-	void OdeHingeJoint::setAxis( size_t axisIndex, Vector3 const& rAxis )
+	void OdeHingeJoint::setAxis( size_t axisIndex, const math::Vector3& rAxis )
 	{
 		YAKE_ASSERT( axisIndex < 1 ).error( "Hinge joint has only one axis! You are trying to set more..." );
 		
@@ -69,7 +69,7 @@
 	}
 	
 	//-----------------------------------------------------
-	void OdeHingeJoint::setAnchor( size_t anchorIndex, Vector3 const& rAnchor )
+	void OdeHingeJoint::setAnchor( size_t anchorIndex, const math::Vector3& rAnchor )
 	{
 		YAKE_ASSERT( anchorIndex < 1 ).error( "Hinge joint has only one anchor! You are trying to set more..." );
 		

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeJoint.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeJoint.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeJoint.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -51,11 +51,14 @@
 	}
 	
 	//-----------------------------------------------------
-	void OdeJoint::attach( IBody& rBody1, IBody& rBody2 )
+	void OdeJoint::attach( IBody* pBody1, IBody* pBody2 )
 	{
-		mOdeJoint->attach( 
-					( static_cast<OdeBody&>( rBody1 ) )._getOdeBody()->id(),
-					( static_cast<OdeBody&>( rBody2 ) )._getOdeBody()->id() );
+		YAKE_ASSERT( pBody1 != 0 || pBody2 != 0 ).error( "both bodies are ZERO in joint attach function!" );
+
+		dBodyID id0 = pBody1 != 0 ? static_cast<OdeBody*>( pBody1 )->_getOdeBody()->id() : 0; 
+		dBodyID id1 = pBody2 != 0 ? static_cast<OdeBody*>( pBody2 )->_getOdeBody()->id() : 0; 
+
+		mOdeJoint->attach( id0, id1 );
 	}
 
 	//-----------------------------------------------------
@@ -78,32 +81,6 @@
 	{
 	}
 	
-// 		//-----------------------------------------------------
-// 		void OdeJoint::setSpring(real spring)
-// 		{
-// 			mSpringConstant = spring;
-// 			_applySpring();
-// 		}
-// 
-// 		//-----------------------------------------------------
-// 		void OdeJoint::setDamping(real damping)
-// 		{
-// 			mDampingConstant = damping;
-// 			_applySpring();
-// 		}
-// 
-// 		//-----------------------------------------------------
-// 		real OdeJoint::getSpring() const
-// 		{
-// 			return mSpringConstant;
-// 		}
-// 
-// 		//-----------------------------------------------------
-// 		real OdeJoint::getDamping() const
-// 		{
-// 			return mDampingConstant;
-// 		}
-// 
 	//-----------------------------------------------------
 	real OdeJoint::_getCFMFromSpring() const
 	{
@@ -145,20 +122,28 @@
 			break;
 		}
 	}
+
+	//-----------------------------------------------------
 	void OdeJoint::setSpring(real spring)
 	{
 		mSpringConstant = spring;
 		_applySpring();
 	}
+
+	//-----------------------------------------------------
 	real OdeJoint::getSpring() const
 	{
 		return mSpringConstant;
 	}
+
+	//-----------------------------------------------------
 	void OdeJoint::setDamping(real damping)
 	{
 		mDampingConstant = damping;
 		_applySpring();
 	}
+
+	//-----------------------------------------------------
 	real OdeJoint::getDamping() const
 	{
 		return mDampingConstant;
@@ -166,3 +151,4 @@
 
 } // physics
 } // yake
+

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeMaterial.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeMaterial.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeMaterial.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -36,7 +36,7 @@
 		mFriction(10),
 		mFriction2(5),
 		mLateralSlip(false),
-		mSlipNormal(Vector3::kZero),
+		mSlipNormal(math::Vector3::kZero),
 		mSlipLinearCoeff(0),
 		mSlipAngularCoeff(0),
 		mRestitution(0), // better value?
@@ -50,7 +50,7 @@
 		mFriction(desc.mFriction),
 		mFriction2(desc.mFriction),
 		mLateralSlip(false),
-		mSlipNormal(Vector3::kZero),
+		mSlipNormal(math::Vector3::kZero),
 		mSlipLinearCoeff(0),
 		mSlipAngularCoeff(0),
 		mRestitution( desc.mRestitution ),
@@ -96,3 +96,4 @@
 
 } // physics
 } // yake
+

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeRay.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeRay.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeRay.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -30,6 +30,7 @@
 
 namespace yake {
 namespace physics {
+	using namespace yake::math;
 
 	//-----------------------------------------------------
 	OdeRay::OdeRay(OdeWorld* world, const real length) :
@@ -66,10 +67,10 @@
 		{
 			mIntersects = true;
 			mIntersectionDepth = real(contact.geom.depth);
-			mIntersectionPoint = Vector3( contact.geom.pos[0], contact.geom.pos[1], contact.geom.pos[2] );
+			mIntersectionPoint = Vector3( real(contact.geom.pos[0]), real(contact.geom.pos[1]), real(contact.geom.pos[2]) );
 			// As we have passed dCollide the ray as the first parameter, the normal
 			// is oriented correctly for ray deflection from the surface.
-			mIntersectionNormal = Vector3( contact.geom.normal[0], contact.geom.normal[1], contact.geom.normal[2] );
+			mIntersectionNormal = Vector3( real(contact.geom.normal[0]), real(contact.geom.normal[1]), real(contact.geom.normal[2]) );
 		}
 	}
 	real OdeRay::length() const
@@ -117,7 +118,7 @@
 		if (mRay)
 		{
 			const dReal* pos = mRay->getPosition();
-			mPosition = Vector3(pos[0],pos[1],pos[2]);
+			mPosition = Vector3(real(pos[0]),real(pos[1]),real(pos[2]));
 		}
 		return mPosition;
     }

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeShapes.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeShapes.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeShapes.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -98,11 +98,12 @@
 	//-----------------------------------------------------
 	void OdeGeom::setMaterial( IMaterial* pMaterial )
 	{
-		mMaterial = static_cast<OdeMaterial*>( pMaterial );
+		mMaterial = checked_cast<OdeMaterial*>( pMaterial );
+		YAKE_ASSERT( mMaterial != NULL ).warning( "assigned empty material" );
 	}
 
 	//-----------------------------------------------------
-	void OdeGeom::setPosition( Vector3 const& rPosition )
+	void OdeGeom::setPosition( math::Vector3 const& rPosition )
 	{
 		if (getType() == ST_PLANE)
 			return;
@@ -111,49 +112,51 @@
 	}
 
 	//-----------------------------------------------------
-	Vector3 OdeGeom::getPosition() const
+	math::Vector3 OdeGeom::getPosition() const
 	{
 		if (getType() == ST_PLANE)
-			return Vector3::kZero;
+			return math::Vector3::kZero;
+
 		const dReal* pos = dGeomGetPosition( mOdeGeomID );
-		return Vector3( real(pos[0]), real(pos[1]), real(pos[2]) );
+		return math::Vector3( real(pos[0]), real(pos[1]), real(pos[2]) );
 	}
 
 	//-----------------------------------------------------
-	void OdeGeom::setOrientation( Quaternion const& rOrientation )
+	void OdeGeom::setOrientation( math::Quaternion const& rOrientation )
 	{
 		if (getType() == ST_PLANE)
 			return;
+
 		const dQuaternion q = { rOrientation.w, rOrientation.x, rOrientation.y, rOrientation.z };
 		dGeomSetQuaternion( mOdeGeomID, q );
 	}
 
 	//-----------------------------------------------------
-	Quaternion OdeGeom::getOrientation() const
+	math::Quaternion OdeGeom::getOrientation() const
 	{
 		if (getType() == ST_PLANE)
-			return Quaternion::kIdentity;
+			return math::Quaternion::kIdentity;
 
 		dQuaternion q;
 		dGeomGetQuaternion( mOdeGeomID, q );
 
-		return Quaternion( real(q[0]), real(q[1]), real(q[2]), real(q[3]) );
+		return math::Quaternion( real(q[0]), real(q[1]), real(q[2]), real(q[3]) );
 	}
 
 	//-----------------------------------------------------
-	Vector3 OdeGeom::getDerivedPosition() const
+	math::Vector3 OdeGeom::getDerivedPosition() const
 	{
-		dBodyID bodyId = dGeomGetBody( mOdeGeomID );
-		const dReal* pos = dBodyGetPosition( bodyId );
-		return Vector3( real(pos[0]), real(pos[1]), real(pos[2]) );
+		// return just usual geom position. 
+		// It is equal to body position if geom was attached to one
+		return getPosition();
 	}
 
 	//-----------------------------------------------------
-	Quaternion OdeGeom::getDerivedOrientation() const
+	math::Quaternion OdeGeom::getDerivedOrientation() const
 	{
-		dBodyID bodyId = dGeomGetBody( mOdeGeomID );
-		const dReal* q = dBodyGetQuaternion( bodyId );
-		return Quaternion( real(q[0]), real(q[1]), real(q[2]), real(q[3]) );
+		// return just usual geom orientation. 
+		// It is equal to body orientation if geom was attached to one
+		return getOrientation();
 	}
 
 	//-----------------------------------------------------
@@ -163,13 +166,13 @@
 	}
 
 	//-----------------------------------------------------
-	Vector3 OdeGeom::getPropertyVector3(const String& id) const
+	math::Vector3 OdeGeom::getPropertyVector3(const String& id) const
 	{
 		PropMap::const_iterator itFind = mProps.find( id );
 		YAKE_ASSERT(itFind != mProps.end());
 		if (itFind == mProps.end())
-			return Vector3();
-		return boost::any_cast<Vector3>(itFind->second);
+			return math::Vector3();
+		return boost::any_cast<math::Vector3>(itFind->second);
 	}
 
 	//-----------------------------------------------------
@@ -238,7 +241,7 @@
 		dReal* pCurrOrd = pVertices;
 		while (itV.hasMoreElements())
 		{
-			const Vector3& v = *itV.peekNextPtr();
+			const math::Vector3& v = *itV.peekNextPtr();
 			*pCurrOrd++ = v.x;
 			*pCurrOrd++ = v.y;
 			*pCurrOrd++ = v.z;
@@ -257,7 +260,7 @@
 			pCurrOrd = pNormals;
 			while (itN.hasMoreElements())
 			{
-				const Vector3& n = *itN.peekNextPtr();
+				const math::Vector3& n = *itN.peekNextPtr();
 				*pCurrOrd++ = n.x;
 				*pCurrOrd++ = n.y;
 				*pCurrOrd++ = n.z;
@@ -268,13 +271,35 @@
 		// serving up
 		dTriMeshDataID dataId = dGeomTriMeshDataCreate();
 
-		YAKE_ASSERT( sizeof(dReal) == sizeof(double) );
-
+#ifdef dDOUBLE
 		if ( !rNormals.empty() )
 		{
 			dGeomTriMeshDataBuildDouble1( dataId,
 				                            pVertices,
 				                            sizeof( dReal )*3,
+				                            int(rVertices.size()),
+				                            pIndices,
+				                            int(rIndices.size()),
+				                            sizeof( uint32 )*3,
+				                            pNormals );
+		}
+		else
+		{
+			dGeomTriMeshDataBuildDouble(  dataId,
+				                            pVertices,
+				                            sizeof( dReal )*3,
+				                            int(rVertices.size()),
+				                            pIndices,
+				                            int(rIndices.size()),
+				                            sizeof( uint32 )*3 );
+		}
+#endif
+#ifdef dSINGLE
+		if ( !rNormals.empty() )
+		{
+			dGeomTriMeshDataBuildSingle1( dataId,
+				                            pVertices,
+				                            sizeof( dReal )*3,
 				                            rVertices.size(),
 				                            pIndices,
 				                            rIndices.size(),
@@ -283,7 +308,7 @@
 		}
 		else
 		{
-			dGeomTriMeshDataBuildDouble(  dataId,
+			dGeomTriMeshDataBuildSingle(  dataId,
 				                            pVertices,
 				                            sizeof( dReal )*3,
 				                            rVertices.size(),
@@ -291,6 +316,7 @@
 				                            rIndices.size(),
 				                            sizeof( uint32 )*3 );
 		}
+#endif
 
 		dataToFill.normals = pNormals;
 		dataToFill.vertices = pVertices;
@@ -375,7 +401,7 @@
 
 		_setData( this );
 
-		mProps["dimensions"] = Vector3(sizex,sizey,sizez);
+		mProps["dimensions"] = math::Vector3(sizex,sizey,sizez);
 	}
 
 	//-----------------------------------------------------
@@ -398,10 +424,10 @@
 
 		YAKE_ASSERT( a != 0. || b != 0. || c != 0. ).error( "Invalid plane equation!" );
 
-		Vector3 normal = Vector3( a, b, c );
+		math::Vector3 normal = math::Vector3( a, b, c );
 
 		if ( normal.squaredLength() < 0.02 )
-			normal = Vector3( 0, 1, 0 );
+			normal = math::Vector3( 0, 1, 0 );
 		else
 			normal.normalise();
 
@@ -411,7 +437,7 @@
 
 		_setData( this );
 
-		mProps["normal"] = Vector3(a,b,c);
+		mProps["normal"] = math::Vector3(a,b,c);
 		mProps["d"] = d;
 	}
 
@@ -475,136 +501,75 @@
 	}
 
 	//-----------------------------------------------------
-	Vector3 OdeTransformGeom::getDerivedPosition() const
+	math::Vector3 OdeTransformGeom::getPosition() const
 	{
-		return (mAttachedGeom ?
-			(getPosition() + getDerivedOrientation() * mAttachedGeom->getPosition()) :
-			getPosition() );
+		return	mAttachedGeom ?	mAttachedGeom->getPosition() : OdeGeom::getPosition();
 	}
 
 	//-----------------------------------------------------
-	Quaternion OdeTransformGeom::getDerivedOrientation() const
+	math::Quaternion OdeTransformGeom::getOrientation() const
 	{
-		return (mAttachedGeom ?
-			mAttachedGeom->getDerivedOrientation() :
-			getOrientation() );
+		return mAttachedGeom ? mAttachedGeom->getOrientation() : OdeGeom::getOrientation();
 	}
 
 	//-----------------------------------------------------
-	void OdeTransformGeom::setPosition( Vector3 const& rPosition )
+	void OdeTransformGeom::setPosition( const math::Vector3& rPosition )
 	{
 		if (getType() == ST_PLANE)
+		{
+			YAKE_ASSERT( false ).warning( "You are trying to set position for non-placeable geom!!" );
 			return;
+		}
+		
 		YAKE_ASSERT( mAttachedGeom );
-		const dReal* pos = dGeomGetPosition( mOdeGeomID );
-		mAttachedGeom->setPosition( rPosition - Vector3(real(pos[0]), real(pos[1]), real(pos[2])) );
-		//dGeomSetPosition( mOdeGeomID, rPosition.x, rPosition.y, rPosition.z );
+		
+		mAttachedGeom->setPosition( rPosition );
 	}
 
 	//-----------------------------------------------------
-	Vector3 OdeTransformGeom::getPosition() const
+	math::Vector3 OdeTransformGeom::getDerivedPosition() const
 	{
 		if (getType() == ST_PLANE)
-			return Vector3::kZero;
+			return math::Vector3::kZero;
+
 		YAKE_ASSERT( mAttachedGeom );
 
-		const dReal* pos = dGeomGetPosition( mOdeGeomID );
-		dQuaternion q;
-		dGeomGetQuaternion( mOdeGeomID, q );
-		return Vector3( real(pos[0]), real(pos[1]), real(pos[2]) ) + 
-			Quaternion( real(q[0]), real(q[1]), real(q[2]), real(q[3]) ) * mAttachedGeom->getPosition();
+		math::Vector3 this_pos = OdeGeom::getPosition();
+		math::Quaternion this_orientation = OdeGeom::getOrientation();
+
+		return this_pos + this_orientation * mAttachedGeom->getPosition();
 	}
 
 	//-----------------------------------------------------
-	void OdeTransformGeom::setOrientation( Quaternion const& rOrientation )
+	void OdeTransformGeom::setOrientation( const math::Quaternion& rOrientation )
 	{
 		if (getType() == ST_PLANE)
+		{
+			YAKE_ASSERT( false ).warning( "You are trying to set orientation for non-placeable geom!!" );
 			return;
-		YAKE_ASSERT( mAttachedGeom );
-		const dQuaternion q = { rOrientation.w, rOrientation.x, rOrientation.y, rOrientation.z };
-		dGeomSetQuaternion( mOdeGeomID, q );
+		}
+
+		if ( mAttachedGeom != NULL )
+		    mAttachedGeom->setOrientation( rOrientation );
+		else
+		    OdeGeom::setOrientation( rOrientation );
 	}
 
 	//-----------------------------------------------------
-	Quaternion OdeTransformGeom::getOrientation() const
+	Quaternion OdeTransformGeom::getDerivedOrientation() const
 	{
 		if (getType() == ST_PLANE)
 			return Quaternion::kIdentity;
-		YAKE_ASSERT( mAttachedGeom );
-		dQuaternion q;
-		dGeomGetQuaternion( mOdeGeomID, q );
 
 		YAKE_ASSERT( mAttachedGeom );
 
-		return mAttachedGeom->getOrientation() * Quaternion( real(q[0]), real(q[1]), real(q[2]), real(q[3]) );
+		math::Quaternion this_orientation = OdeGeom::getOrientation();
+
+		Quaternion childOrientation = mAttachedGeom->getOrientation();
+		Quaternion result = this_orientation * childOrientation;
+		return  result;
 	}
 
-	// /*		//-----------------------------------------------------
-	// 		void OdeCollisionGeomBase::tfAttachGeom( ICollisionGeometry* pGeom )
-	// 		{ YAKE_ASSERT(1==0).error("not implemented"); }
-	// 		//-----------------------------------------------------
-	// 		ICollisionGeometry* OdeCollisionGeomBase::tfGetAttachedGeom() const
-	// 		{ return 0; }
-	// 		//-----------------------------------------------------
-	// 		Vector3 OdeCollisionGeomBase::planeGetNormal() const
-	// 		{ return Vector3::kZero; }
-	// 		//-----------------------------------------------------
-	// 		String OdeCollisionGeomBase::meshGetName() const
-	// 		{ return ""; }
-	// 		//-----------------------------------------------------
-	// 		real OdeCollisionGeomBase::planeGetDistance() const
-	// 		{ return 0; }
-	// 		//-----------------------------------------------------
-	// 		real OdeCollisionGeomBase::sphereGetRadius() const
-	// 		{ return 0; }
-	// 		//-----------------------------------------------------
-	// 		void OdeCollisionGeomBase::sphereSetRadius(const real radius)
-	// 		{}
-	// 		//-----------------------------------------------------
-	// 		Vector3 OdeCollisionGeomBase::boxGetDimensions() const
-	// 		{ return Vector3::kZero; }
-	// 		//-----------------------------------------------------
-	// 		Vector3 OdeCollisionGeomBase::rayGetOrigin() const
-	// 		{ return Vector3::kZero; }
-	// 		//-----------------------------------------------------
-	// 		Quaternion OdeCollisionGeomBase::rayGetOrientation() const
-	// 		{ return Quaternion::kIdentity; }
-	//
-	// 		//-----------------------------------------------------
-	// 		real OdeCollisionGeomSphere::sphereGetRadius() const
-	// 		{
-	// 			return static_cast<dSphere*>(mOdeGeom)->getRadius();
-	// 		}
-	//
-	// 		//-----------------------------------------------------
-	// 		void OdeCollisionGeomSphere::sphereSetRadius(const real radius)
-	// 		{
-	// 			static_cast<dSphere*>(mOdeGeom)->setRadius(radius);
-	// 		}
-	//
-	// 		//-----------------------------------------------------
-	// 		Vector3 OdeCollisionGeomBox::boxGetDimensions() const
-	// 		{
-	// 			dVector3 lengths;
-	// 			static_cast<dBox*>(mOdeGeom)->getLengths(lengths);
-	// 			return Vector3( lengths[0], lengths[1], lengths[2] );
-	// 		}
-	//
-	//
-	// 		//-----------------------------------------------------
-	// 		Vector3 OdeCollisionGeomPlane::planeGetNormal() const
-	// 		{
-	// 			dVector4 params;
-	// 			static_cast<dPlane*>(mOdeGeom)->getParams(params);
-	// 			return Vector3( params[0], params[1], params[2] );
-	// 		}
-	// 		//-----------------------------------------------------
-	// 		real OdeCollisionGeomPlane::planeGetDistance() const
-	// 		{
-	// 			dVector4 params;
-	// 			static_cast<dPlane*>(mOdeGeom)->getParams(params);
-	// 			return params[3];
-	// 		}
-
 } // physics
 } // yake
+

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeSliderJoint.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeSliderJoint.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeSliderJoint.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -55,7 +55,7 @@
 	}
 	
 	//-----------------------------------------------------
-	void OdeSliderJoint::setAxis( size_t axisIndex, Vector3 const& rAxis )
+	void OdeSliderJoint::setAxis( size_t axisIndex, const math::Vector3& rAxis )
 	{
 		YAKE_ASSERT( axisIndex < 1 ).error( "Slider joint has only one axis! You are trying to set more..." );
 		
@@ -69,7 +69,7 @@
 	}
 	
 	//-----------------------------------------------------
-	void OdeSliderJoint::setAnchor( size_t anchorIndex, Vector3 const& rAnchor )
+	void OdeSliderJoint::setAnchor( size_t anchorIndex, const math::Vector3& rAnchor )
 	{
 		YAKE_ASSERT( false ).error( "Slider joint doesn't have any anchors!" );
 	}

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeUniversalJoint.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeUniversalJoint.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeUniversalJoint.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -55,7 +55,7 @@
 	}
 	
 	//-----------------------------------------------------
-	void OdeUniversalJoint::setAxis( size_t axisIndex, Vector3 const& rAxis )
+	void OdeUniversalJoint::setAxis( size_t axisIndex, math::Vector3 const& rAxis )
 	{
 		YAKE_ASSERT( axisIndex < 2 ).error( "Universal joint has only two axes! You are trying to set more..." );
 		
@@ -72,7 +72,7 @@
 	}
 	
 	//-----------------------------------------------------
-	void OdeUniversalJoint::setAnchor( size_t anchorIndex, Vector3 const& rAnchor )
+	void OdeUniversalJoint::setAnchor( size_t anchorIndex, math::Vector3 const& rAnchor )
 	{
 		YAKE_ASSERT( anchorIndex < 1 ).error( "Universal joint has only one anchor! You are trying to set more..." );
 		
@@ -141,3 +141,4 @@
 
 } // physics
 } // yake
+

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeWorld.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeWorld.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeWorld.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -57,7 +57,9 @@
 		mOdeWorld->setAutoDisableSteps( 30 ); // ODE default: 10
 		mOdeWorld->setAutoDisableTime( 0 ); // ODE default: 0. (= ignore time)
 
-		mOdeWorld->setGravity( 0., -9.81, 0. );
+		// We do not set any default gravity setting
+		// as we don't want to enforce a specific coordinate system.
+		//	mOdeWorld->setGravity( 0., -9.81, 0. );
 		mOdeWorld->setCFM( 0.0005 );
 		mOdeWorld->setERP( 0.99 );
 
@@ -97,19 +99,19 @@
  	}
 		
 	//-----------------------------------------------------
-	void OdeWorld::setGlobalGravity( const Vector3& g )
+	void OdeWorld::setGlobalGravity( const math::Vector3& g )
 	{
 		YAKE_ASSERT( mOdeWorld );
 		mOdeWorld->setGravity( g.x, g.y, g.z );
 	}
 
 	//-----------------------------------------------------
-	Vector3 OdeWorld::getGlobalGravity() const
+	math::Vector3 OdeWorld::getGlobalGravity() const
 	{
 		YAKE_ASSERT( mOdeWorld );
 		dVector3 g;
 		mOdeWorld->getGravity( g );
-		return Vector3(real(g[0]), real(g[1]), real(g[2]));
+		return math::Vector3(real(g[0]), real(g[1]), real(g[2]));
 	}
 
 	//-----------------------------------------------------
@@ -126,7 +128,7 @@
 	void OdeWorld::destroyMaterial( IMaterialPtr pMaterial )
 	{
 		YAKE_ASSERT( pMaterial );
-		mMaterials.erase( mMaterials.find( dynamic_cast<OdeMaterial*>(pMaterial)->mName ) );
+		mMaterials.erase( mMaterials.find( checked_cast<OdeMaterial*>(pMaterial)->mName ) );
 	}
 
 	//-----------------------------------------------------
@@ -196,16 +198,14 @@
 	}
 
 	//-----------------------------------------------------
-	IJointPtr OdeWorld::createJoint( IJoint::DescBase const& rJointDesc )
+	IJointPtr OdeWorld::createJoint( const IJoint::DescBase& rJointDesc )
 	{
-		//@todo add joints "actor vs static env"
-		YAKE_ASSERT( rJointDesc.actor0 && rJointDesc.actor1 );
-		if (!rJointDesc.actor0 || !rJointDesc.actor1)
-			return 0;
+		YAKE_ASSERT( rJointDesc.actor0 != NULL || rJointDesc.actor1 != NULL ).error( "both actors are 0!" );
 
 		/// Bodies to attach
-		IBody& rBody1 = rJointDesc.actor0->getBody();
-		IBody& rBody2 = rJointDesc.actor1->getBody();
+		// if 0, then it is attachment to static environment
+		IBody* pBody1 = rJointDesc.actor0 ? rJointDesc.actor0->getBodyPtr() : 0;
+		IBody* pBody2 = rJointDesc.actor1 ? rJointDesc.actor1->getBodyPtr() : 0;
 		
 		/// Joint to return
 		OdeJoint* pJoint = 0;
@@ -215,14 +215,14 @@
 		case JT_FIXED:
 			{
 			pJoint = new OdeFixedJoint( this );
-			pJoint->attach( rBody1, rBody2 );
+			pJoint->attach( pBody1, pBody2 );
 			}
 			break;
 		case JT_HINGE:
 			{
 			pJoint = new OdeHingeJoint( this );
 			const IJoint::DescHinge& desc = static_cast<const IJoint::DescHinge&>( rJointDesc );
-			pJoint->attach( rBody1, rBody2 );
+			pJoint->attach( pBody1, pBody2 );
 			pJoint->setAnchor( 0, desc.anchor );
 			pJoint->setAxis( 0, desc.axis );
 			}
@@ -231,7 +231,7 @@
 			{
 			pJoint = new OdeHinge2Joint( this );
 			const IJoint::DescHinge2& desc = static_cast<const IJoint::DescHinge2&>( rJointDesc );
-			pJoint->attach( rBody1, rBody2 );
+			pJoint->attach( pBody1, pBody2 );
 			pJoint->setAnchor( 0, desc.anchor );
 			pJoint->setAxis( 0, desc.axis0 );
 			pJoint->setAxis( 1, desc.axis1 );
@@ -241,7 +241,7 @@
 			{
 			pJoint = new OdeUniversalJoint( this );
 			const IJoint::DescUniversal& desc = static_cast<const IJoint::DescUniversal&>( rJointDesc );
-			pJoint->attach( rBody1, rBody2 );
+			pJoint->attach( pBody1, pBody2 );
 			pJoint->setAnchor( 0, desc.anchor );
 			pJoint->setAxis( 0, desc.axis0 );
 			pJoint->setAxis( 1, desc.axis1 );
@@ -251,7 +251,7 @@
 			{
 			pJoint = new OdeBallJoint( this );
 			const IJoint::DescBall& desc = static_cast<const IJoint::DescBall&>( rJointDesc );
-			pJoint->attach( rBody1, rBody2 );
+			pJoint->attach( pBody1, pBody2 );
 			pJoint->setAnchor( 0, desc.anchor );
 			}
 			break;
@@ -259,7 +259,7 @@
 			{
 			pJoint = new OdeSliderJoint( this );
 			const IJoint::DescSlider& desc = static_cast<const IJoint::DescSlider&>( rJointDesc );
-			pJoint->attach( rBody1, rBody2 );
+			pJoint->attach( pBody1, pBody2 );
 			pJoint->setAxis( 0, desc.axis );
 			}
 			break;
@@ -305,7 +305,7 @@
 		mActors.push_back( SharedPtr<OdeActor>( pActor ) );
 		return pActor;
 	}
-	//-----------------------------------------------------
+	//----------------------------------------------------
 	bool operator==(const SharedPtr<OdeJoint>& lhs, const OdeJoint* rhs)
 	{
 		return (lhs.get() == rhs);
@@ -314,7 +314,7 @@
 	void OdeWorld::destroyJoint( IJointPtr pJoint )
 	{
 		YAKE_ASSERT( pJoint );
-		mJoints.erase( std::find(mJoints.begin(), mJoints.end(), dynamic_cast<OdeJoint*>(pJoint) ) );
+		mJoints.erase( std::find(mJoints.begin(), mJoints.end(), checked_cast<OdeJoint*>(pJoint) ) );
 	}
 	//-----------------------------------------------------
 	bool operator==(const SharedPtr<OdeActor>& lhs, const OdeActor* rhs)
@@ -325,14 +325,12 @@
 	void OdeWorld::destroyActor( IActorPtr pActor )
 	{
 		YAKE_ASSERT( pActor );
-		mActors.erase( std::find(mActors.begin(), mActors.end(), dynamic_cast<OdeActor*>(pActor) ) );
+		mActors.erase( std::find(mActors.begin(), mActors.end(), checked_cast<OdeActor*>(pActor) ) );
 	}
 	//-----------------------------------------------------
 	void OdeWorld::destroyAvatar( IAvatarPtr pAvatar )
 	{
 		YAKE_ASSERT( 0 && "NOT IMPLEMENTED" );
-		//YAKE_ASSERT( !pAvatar.expired() );
-		//mAvatars.erase( std::find(mAvatars.begin(), mAvatars.end(), dynamic_cast<OdeAvatar*>(pAvatar .lock().get()) ) );
 	}
 
 	//-----------------------------------------------------

Modified: trunk/yake/src/yake/samples/base/debug/yakeUnitTest.cpp
===================================================================
--- trunk/yake/src/yake/samples/base/debug/yakeUnitTest.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/samples/base/debug/yakeUnitTest.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -80,4 +80,5 @@
 #endif
 
 	return 0;
-}
\ No newline at end of file
+}
+

Modified: trunk/yake/src/yake/thread/yakeThread.cpp
===================================================================
--- trunk/yake/src/yake/thread/yakeThread.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yake/thread/yakeThread.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -49,4 +49,5 @@
 #endif
 
 }
-}
\ No newline at end of file
+}
+

Modified: trunk/yake/src/yapp/Makefile.am
===================================================================
--- trunk/yake/src/yapp/Makefile.am	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/Makefile.am	2006-03-19 17:54:00 UTC (rev 1302)
@@ -1,4 +1,3 @@
 INCLUDES = $(all_includes)
 METASOURCES = AUTO
-SUBDIRS = base loader model statemachine gui msg ent vehicle raf plugins \
-	samples
+SUBDIRS = base loader model gui msg vehicle raf plugins samples

Modified: trunk/yake/src/yapp/base/event/Makefile.am
===================================================================
--- trunk/yake/src/yapp/base/event/Makefile.am	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/base/event/Makefile.am	2006-03-19 17:54:00 UTC (rev 1302)
@@ -1,7 +1,7 @@
 INCLUDES = -I$(top_srcdir)/. -I$(top_srcdir)/dependencies/ttl $(all_includes)
 METASOURCES = AUTO
 lib_LTLIBRARIES = libyappEvents.la
-libyappEvents_la_SOURCES = yakeMessageId.cpp yakeMessageInstance.cpp\
-	yakeMessageManager.cpp yakeMessageQ.cpp yakeParamHolder.cpp
+libyappEvents_la_SOURCES = yakeMessageId.cpp yakeMessageInstance.cpp \
+	yakeMessageManager.cpp yakeMessageQ.cpp
 
 AM_CXXFLAGS = -rdynamic

Modified: trunk/yake/src/yapp/loader/yakeDotLinkLoader.cpp
===================================================================
--- trunk/yake/src/yapp/loader/yakeDotLinkLoader.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/loader/yakeDotLinkLoader.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -85,7 +85,7 @@
 			return;
 
 		using namespace data::dom;
-		using namespace base::templates;
+		using namespace yake::templates;
 
 		const String linkType = StringUtil::toLowerCase( rLinkNode.getAttributeValueAs<String>("type") );
 		//const String linkName = varGet<String>( rLinkNode.getId("id") );

Modified: trunk/yake/src/yapp/loader/yakeDotScene.cpp
===================================================================
--- trunk/yake/src/yapp/loader/yakeDotScene.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/loader/yakeDotScene.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -200,7 +200,7 @@
 	}
 	
 	//------------------------------------------------------
-	void DotSceneParser::readVector( const SharedPtr<dom::INode>& pNode, Vector3& rVec )
+	void DotSceneParser::readVector( const SharedPtr<dom::INode>& pNode, math::Vector3& rVec )
 	{
 		YAKE_ASSERT( pNode );
 		rVec.x = StringUtil::parseReal( pNode->getAttributeValueAs<String>("x") );
@@ -209,19 +209,19 @@
 	}
 
 	//------------------------------------------------------
-	void DotSceneParser::readPosition( const SharedPtr<dom::INode> & pNode, Vector3 & position )
+	void DotSceneParser::readPosition( const SharedPtr<dom::INode> & pNode, math::Vector3 & position )
 	{
 		readVector( pNode, position );
 	}
 
 	//------------------------------------------------------
-	void DotSceneParser::readScale( const SharedPtr<dom::INode>& pNode, Vector3& rScale )
+	void DotSceneParser::readScale( const SharedPtr<dom::INode>& pNode, math::Vector3& rScale )
 	{
 		readVector( pNode, rScale );
 	}
 	
 	//------------------------------------------------------
-	void DotSceneParser::readRotation( const SharedPtr<dom::INode>& pNode, Quaternion& rotation )
+	void DotSceneParser::readRotation( const SharedPtr<dom::INode>& pNode, math::Quaternion& rotation )
 	{
 		YAKE_ASSERT( pNode );
 		if ( pNode->getAttributeValueAs<String>("qx") != "" )
@@ -233,7 +233,7 @@
 		}
 		else if ( pNode->getAttributeValueAs<String>("axisX") != "" )
 		{
-			Vector3 axis;
+			math::Vector3 axis;
 			axis.x = StringUtil::parseReal( pNode->getAttributeValueAs<String>("axisX") );
 			axis.y = StringUtil::parseReal( pNode->getAttributeValueAs<String>("axisY") );
 			axis.z = StringUtil::parseReal( pNode->getAttributeValueAs<String>("axisZ") );
@@ -241,7 +241,7 @@
 		}
 		else if ( pNode->getAttributeValueAs<String>("angleX") != "" )
 		{
-			Vector3 axis;
+			math::Vector3 axis;
 			axis.x = StringUtil::parseReal( pNode->getAttributeValueAs<String>("angleX") );
 			axis.y = StringUtil::parseReal( pNode->getAttributeValueAs<String>("angleY") );
 			axis.z = StringUtil::parseReal( pNode->getAttributeValueAs<String>("angleZ") );
@@ -250,7 +250,7 @@
 		}
 	}
 	//------------------------------------------------------
-	void DotSceneParser::readColour( const SharedPtr<dom::INode>& pNode, Color& colour )
+	void DotSceneParser::readColour( const SharedPtr<dom::INode>& pNode, math::Color& colour )
 	{
 		YAKE_ASSERT( pNode );
 		

Modified: trunk/yake/src/yapp/loader/yakeModelMovableLinkCreator.cpp
===================================================================
--- trunk/yake/src/yapp/loader/yakeModelMovableLinkCreator.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/loader/yakeModelMovableLinkCreator.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -34,7 +34,7 @@
 
 	YAKE_REGISTER_CONCRETE( ModelMovableLinkCreator );
 
-	Movable* getMovableFromModel(	complex::Model & rModel, const data::dom::INode& rNode )
+	Movable* getMovableFromModel( complex::Model& rModel, const data::dom::INode& rNode )
 	{
 		// parse
 		String sourceType = StringUtil::toLowerCase(rNode.getAttributeValueAs<String>("type"));
@@ -42,45 +42,49 @@
 		String sourceMovableType = StringUtil::toLowerCase(rNode.getAttributeValueAs<String>("elementtype"));
 		String sourceMovableName = (rNode.getAttributeValueAs<String>("element"));
 		
-		std::cout << "Searching movable: " << std::endl; 
-		std::cout << "    type: " << sourceType << std::endl; 
-		std::cout << "    submodel: " << sourceModelName << std::endl; 
-		std::cout << "    movable type: " << sourceMovableType << std::endl; 
-		std::cout << "    movable name: " << sourceMovableName << std::endl; 
+		YAKE_LOG( "Searching movable: " ); 
+		YAKE_LOG( "    type: " + sourceType );
+		YAKE_LOG( "    submodel: " + sourceModelName );
+		YAKE_LOG( "    movable type: " + sourceMovableType );
+		YAKE_LOG( "    movable name: " + sourceMovableName );
 		
 		// retrieve source movable
 		Movable* pMovable = 0;
-		if (sourceType == "graphical")
+		if ( sourceType == "graphical" )
 		{
 			YAKE_ASSERT( sourceMovableType == "graphics.scenenode" );
-			std::cout << "Searching for graphical named '" << sourceModelName << "'" << std::endl;
+			YAKE_LOG( "Searching for graphical named '" + sourceModelName + "'" );
+
 			Graphical* pG = rModel.getGraphicalByName( sourceModelName );
 			YAKE_ASSERT( pG );
+
 			pMovable = pG->getSceneNode( sourceMovableName, true );
 		}
-		else if (sourceType == "physical")
+		else if ( sourceType == "physical" )
 		{
-			std::cout << "Searching for physical named '" << sourceModelName << "'" << std::endl;
+			YAKE_LOG( "Searching for physical named '" + sourceModelName + "'" );
+
 			Physical* pP = rModel.getPhysicalByName( sourceModelName );
 			YAKE_ASSERT( pP );
+
 			if (sourceMovableType == "physics.actor" || sourceMovableType == "physics.complex")
 				pMovable = pP->getActorByName( sourceMovableName );
-			//else if (sourceMovableType == "physics.complex")
-			//	pMovable = pP->getActorByName( sourceMovableName ).get();
 		}
-		YAKE_ASSERT( pMovable );
+
+		YAKE_ASSERT( pMovable != NULL ).error( "Couldn't find movable '" + sourceMovableName + "'. Bailing out." );
 		return pMovable;
 	}
 
-	ModelLink* ModelMovableLinkCreator::createLink(	complex::Model & rModel, 
+	ModelLink* ModelMovableLinkCreator::createLink(	complex::Model& rModel, 
 							const data::dom::INode& rSourceNode,
 							const data::dom::INode& rTargetNode )
 	{
-		using namespace ::yake::data::dom;
+		using namespace yake::data::dom;
 
 		// retrieve source movable
 		Movable* pSourceMovable = getMovableFromModel( rModel, rSourceNode );
 		YAKE_ASSERT( pSourceMovable );
+
 		if (!pSourceMovable)
 			return 0;
 
@@ -93,10 +97,13 @@
 		// link them up
 		ModelMovableLink* pLink = new ModelMovableLink();
 		YAKE_ASSERT( pLink );
+
 		pLink->setSource( pSourceMovable );
 		pLink->subscribeToPositionChanged( pTargetMovable );
 		pLink->subscribeToOrientationChanged( pTargetMovable );
+
 		return pLink;
 	}
 }
 }
+

Modified: trunk/yake/src/yapp/loader/yakeXODEParser.cpp
===================================================================
--- trunk/yake/src/yapp/loader/yakeXODEParser.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/loader/yakeXODEParser.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -24,7 +24,6 @@
 	 source code distribution.
 	 ------------------------------------------------------------------------------------
 */
-
 #include <yapp/base/yappPCH.h>
 #include <yapp/base/yapp.h>
 #include <yapp/loader/yakeXODEParser.h>
@@ -79,1046 +78,1095 @@
 
 		// parse completed. Firing signal!
 		sigParseEnded_();
-	}
+    }
 
-	//------------------------------------------------------
-	void XODEParser::readWorld( const NodeSharedPtr pWorldNode )
-	{
-		// Assuming single space in <world>
-		NodeSharedPtr pSpaceNode = pWorldNode->getNodeByName( "space" );
-		YAKE_ASSERT( pSpaceNode );
+    //------------------------------------------------------
+    void XODEParser::readWorld( const NodeSharedPtr pWorldNode )
+    {
+	// Assuming single space in <world>
+	NodeSharedPtr pSpaceNode = pWorldNode->getNodeByName( "space" );
+	YAKE_ASSERT( pSpaceNode );
 
-		YAKE_LOG( "XODE: finding space... " + String( pSpaceNode.get() ? "Yes!" : "No :(" ) );
+	YAKE_LOG( "XODE: finding space... " + String( pSpaceNode.get() ? "Yes!" : "No :(" ) );
 
-		readSpace( pSpaceNode, "world" );
-	}
+	readSpace( pSpaceNode, "world" );
+    }
 
-	//------------------------------------------------------
-	void XODEParser::reset()
-	{
-		//TODO is this really needed?
-		mDocNode.reset();
-	}
+    //------------------------------------------------------
+    void XODEParser::reset()
+    {
+	//TODO is this really needed?
+	mDocNode.reset();
+    }
 
-	//------------------------------------------------------
-	void XODEParser::readSpace( const NodeSharedPtr pSpaceNode, const String& parent )
+    //------------------------------------------------------
+    void XODEParser::readSpace( const NodeSharedPtr pSpaceNode, const String& parent )
+    {
+	YAKE_LOG( "XODE: reading space ..." );
+
+	const dom::NodeList& nodes = pSpaceNode->getNodes();
+	for (dom::NodeList::const_iterator it = nodes.begin(); it != nodes.end(); ++it)
 	{
-		YAKE_LOG( "XODE: reading space ..." );
+	    String nodeName =
+		yake::StringUtil::toLowerCase( (*it)->getName() );
 
-		const dom::NodeList& nodes = pSpaceNode->getNodes();
-		for (dom::NodeList::const_iterator it = nodes.begin(); it != nodes.end(); ++it)
-		{
-			String nodeName =
-				yake::StringUtil::toLowerCase( (*it)->getName() );
-
-			if ( nodeName == "body" )
-			{
-				readBody( *it, parent );
-			}
-			else if ( nodeName == "geom" )
-			{
-				readGeom( *it, parent );
-			}
-			else if ( nodeName == "bodygroup" )
-			{
-				//TODO bodygroup reading here
-				YAKE_LOG( "XODE: Bodygroup is not yet implemented in parser" ); 
-			}
-		}
+	    if ( nodeName == "body" )
+	    {
+		readBody( *it, parent );
+	    }
+	    else if ( nodeName == "geom" )
+	    {
+		readGeom( *it, parent );
+	    }
+	    else if ( nodeName == "bodygroup" )
+	    {
+		//TODO bodygroup reading here
+		YAKE_LOG( "XODE: Bodygroup is not yet implemented in parser" ); 
+	    }
+	    else if ( nodeName == "joint" )
+	    {
+		readJoint( *it, parent );
+	    }
 	}
+    }
 
-	/// Utility functor for use with std::find_if
-	//------------------------------------------------------
-	class NodeHunter : public std::unary_function<XODEParser::NodeSharedPtr&,bool>
-	{
+    /// Utility functor for use with std::find_if
+    //------------------------------------------------------
+    class NodeHunter : public std::unary_function<XODEParser::NodeSharedPtr&,bool>
+    {
 	public:
-		NodeHunter( const String& rNodeName ) : nodeName_( rNodeName )
-		{}
+	    NodeHunter( const String& rNodeName ) : nodeName_( rNodeName )
+	    {}
 
-		bool operator()( const XODEParser::NodeSharedPtr& pNode )
-		{
-			return pNode->getName() == nodeName_;
-		}
+	    bool operator()( const XODEParser::NodeSharedPtr& pNode )
+	    {
+		return pNode->getName() == nodeName_;
+	    }
 
 	private:
-		String nodeName_;
-	};
+	    String nodeName_;
+    };
 
-	//------------------------------------------------------
-	void XODEParser::readVector3( const NodeSharedPtr pVecNode, Vector3& rVec )
-	{
-		real x = StringUtil::parseReal( pVecNode->getAttributeValueAs<String>( "x" ) );
-		real y = StringUtil::parseReal( pVecNode->getAttributeValueAs<String>( "y" ) );
-		real z = StringUtil::parseReal( pVecNode->getAttributeValueAs<String>( "z" ) );
+    //------------------------------------------------------
+    void XODEParser::readVector3( const NodeSharedPtr pVecNode, math::Vector3& rVec )
+    {
+	real x = StringUtil::parseReal( pVecNode->getAttributeValueAs<String>( "x" ) );
+	real y = StringUtil::parseReal( pVecNode->getAttributeValueAs<String>( "y" ) );
+	real z = StringUtil::parseReal( pVecNode->getAttributeValueAs<String>( "z" ) );
 
-		rVec = Vector3( x, y, z );
-	}
+	rVec = math::Vector3( x, y, z );
+    }
 
-	//------------------------------------------------------
-	void XODEParser::readScale( const NodeSharedPtr pScaleNode, Vector3& rScale )
+    //------------------------------------------------------
+    void XODEParser::readScale( const NodeSharedPtr pScaleNode, math::Vector3& rScale )
+    {
+	readVector3( pScaleNode, rScale );
+    }
+
+    //------------------------------------------------------
+    void XODEParser::readPosition( const NodeSharedPtr pPosNode, math::Vector3& rPos )
+    {
+	readVector3( pPosNode, rPos );
+    }
+
+    //------------------------------------------------------
+    /**
+     * Reads quaternion from pQuatNode to rQuat
+     * Ignores aformat attribute
+     * @param pQuatNode
+     * @param rQuat
+     */
+    void XODEParser::readQuaternion( const NodeSharedPtr pQuatNode, math::Quaternion& rQuat )
+    {
+	real x = StringUtil::parseReal( pQuatNode->getAttributeValueAs<String>( "x" ) );
+	real y = StringUtil::parseReal( pQuatNode->getAttributeValueAs<String>( "y" ) );
+	real z = StringUtil::parseReal( pQuatNode->getAttributeValueAs<String>( "z" ) );
+	real w = StringUtil::parseReal( pQuatNode->getAttributeValueAs<String>( "w" ) );
+
+	rQuat = math::Quaternion( w, x, y, z );
+    }
+
+    //------------------------------------------------------
+    /**
+     *	Reads angle and axis x, y, z attributes and spawns quaternion with them in rRot
+     * @param pRotNode
+     * @param rRot
+     */
+    void XODEParser::readAxisAngleRot( const NodeSharedPtr pRotNode, math::Quaternion& rRot )
+    {
+	real x = StringUtil::parseReal( pRotNode->getAttributeValueAs<String>( "x" ) );
+	real y = StringUtil::parseReal( pRotNode->getAttributeValueAs<String>( "y" ) );
+	real z = StringUtil::parseReal( pRotNode->getAttributeValueAs<String>( "z" ) );
+	real angle = StringUtil::parseReal( pRotNode->getAttributeValueAs<String>( "angle" ) );
+
+	rRot.FromAngleAxis( angle, math::Vector3( x, y, z ) );
+    }
+
+    //------------------------------------------------------
+    void XODEParser::readRotation( const NodeSharedPtr pRotNode, math::Quaternion& rRot )
+    {
+	const dom::NodeList& nodes = pRotNode->getNodes();
+
+	for (dom::NodeList::const_iterator it = nodes.begin(); it != nodes.end(); ++it)
 	{
-		readVector3( pScaleNode, rScale );
-	}
+	    String nodeName = StringUtil::toLowerCase( (*it)->getName() );
 
-	//------------------------------------------------------
-	void XODEParser::readPosition( const NodeSharedPtr pPosNode, Vector3& rPos )
-	{
-		readVector3( pPosNode, rPos );
+	    if ( nodeName == "quaternion" )
+	    {
+		readQuaternion( *it, rRot );
+	    }
+	    else if ( nodeName == "euler" )
+	    {
+		YAKE_ASSERT( false ).error( "euler is NYI" );
+	    }
+	    else if ( nodeName == "axisangle" )
+	    {
+		readAxisAngleRot( *it, rRot );
+	    }
 	}
+    }
 
-	//------------------------------------------------------
-	/**
-	* Reads quaternion from pQuatNode to rQuat
-	* Ignores aformat attribute
-	* @param pQuatNode
-	* @param rQuat
-	*/
-	void XODEParser::readQuaternion( const NodeSharedPtr pQuatNode, Quaternion& rQuat )
+    //------------------------------------------------------
+    void XODEParser::readTransform( const NodeSharedPtr pTransformNode, Transform& rTrans )
+    {
+	const dom::NodeList& nodes = pTransformNode->getNodes();
+
+	for (dom::NodeList::const_iterator it = nodes.begin(); it != nodes.end(); ++it)
 	{
-		real x = StringUtil::parseReal( pQuatNode->getAttributeValueAs<String>( "x" ) );
-		real y = StringUtil::parseReal( pQuatNode->getAttributeValueAs<String>( "y" ) );
-		real z = StringUtil::parseReal( pQuatNode->getAttributeValueAs<String>( "z" ) );
-		real w = StringUtil::parseReal( pQuatNode->getAttributeValueAs<String>( "w" ) );
+	    String nodeName =
+		StringUtil::toLowerCase( (*it)->getName() );
 
-		rQuat = Quaternion( w, x, y, z );
+	    if ( nodeName == "position" )
+	    {
+		readPosition( *it, rTrans.position_ );
+	    }
+	    else if ( nodeName == "rotation" )
+	    {
+		readRotation( *it, rTrans.rotation_ );
+	    }
+	    else if ( nodeName == "scale" )
+	    {
+		readScale( *it, rTrans.scale_ );
+	    }
+	    else if ( nodeName == "matrix4f" )
+	    {
+		YAKE_ASSERT( false ).error( "matrix4f is NYI" );
+	    }
 	}
+    }
 
-	//------------------------------------------------------
-	/**
-	*	Reads angle and axis x, y, z attributes and spawns quaternion with them in rRot
-	* @param pRotNode
-	* @param rRot
-	*/
-	void XODEParser::readAxisAngleRot( const NodeSharedPtr pRotNode, Quaternion& rRot )
+    //------------------------------------------------------
+    void XODEParser::readMassShape( const NodeSharedPtr pMShapeNode, const String& parent,
+	    const Transform& rParentTransform )
+    {
+	real density = 0; //default ...
+
+	// if density is provided...
+	String strDensity = pMShapeNode->getAttributeValueAs<String>( "density" );
+	if ( !strDensity.empty() ) 
 	{
-		real x = StringUtil::parseReal( pRotNode->getAttributeValueAs<String>( "x" ) );
-		real y = StringUtil::parseReal( pRotNode->getAttributeValueAs<String>( "y" ) );
-		real z = StringUtil::parseReal( pRotNode->getAttributeValueAs<String>( "z" ) );
-		real angle = StringUtil::parseReal( pRotNode->getAttributeValueAs<String>( "angle" ) );
-
-		rRot.FromAngleAxis( angle, Vector3( x, y, z ) );
+	    density = StringUtil::parseReal( strDensity );
+	    YAKE_LOG( "XODE: reading mass_shape with density = " + strDensity + " " );
 	}
 
-	//------------------------------------------------------
-	void XODEParser::readRotation( const NodeSharedPtr pRotNode, Quaternion& rRot )
+	const dom::NodeList& nodes = pMShapeNode->getNodes();
+	for ( NodeListIter it = nodes.begin(); it != nodes.end(); ++it)
 	{
-		const dom::NodeList& nodes = pRotNode->getNodes();
+	    String nodeName = StringUtil::toLowerCase( (*it)->getName() );
 
-		for (dom::NodeList::const_iterator it = nodes.begin(); it != nodes.end(); ++it)
-		{
-			String nodeName =
-				StringUtil::toLowerCase( (*it)->getName() );
+	    YAKE_LOG( "XODE: reading mass_shape that is " + nodeName + " " );
 
-			if ( nodeName == "quaternion" )
-			{
-				readQuaternion( *it, rRot );
-			}
-			else if ( nodeName == "euler" )
-			{
-				YAKE_ASSERT( false ).error( "euler is NYI" );
-			}
-			else if ( nodeName == "axisangle" )
-			{
-				readAxisAngleRot( *it, rRot );
-			}
-		}
-	}
+	    IBody::MassDesc* physicsMassDesc = NULL;
 
-	//------------------------------------------------------
-	void XODEParser::readTransform( const NodeSharedPtr pTransformNode, Transform& rTrans )
-	{
-		const dom::NodeList& nodes = pTransformNode->getNodes();
+	    if ( nodeName == "cylinder" )
+	    {
+		real radius, length;
+		readCylinder( *it, radius, length );
 
-		for (dom::NodeList::const_iterator it = nodes.begin(); it != nodes.end(); ++it)
-		{
-			String nodeName =
-				StringUtil::toLowerCase( (*it)->getName() );
+		physicsMassDesc = new IBody::CylinderMassDesc( radius, length, density,
+			rParentTransform.position_,
+			IBody::QT_DENSITY );
+	    }
+	    else if ( nodeName == "sphere" )
+	    {
+		real radius; readSphere( *it, radius );
 
-			if ( nodeName == "position" )
-			{
-				readPosition( *it, rTrans.position_ );
-			}
-			else if ( nodeName == "rotation" )
-			{
-				readRotation( *it, rTrans.rotation_ );
-			}
-			else if ( nodeName == "scale" )
-			{
-				readScale( *it, rTrans.scale_ );
-			}
-			else if ( nodeName == "matrix4f" )
-			{
-				YAKE_ASSERT( false ).error( "matrix4f is NYI" );
-			}
-		}
-	}
+		physicsMassDesc = new IBody::SphereMassDesc(radius, density,
+			rParentTransform.position_,
+			IBody::QT_DENSITY );
+	    }
+	    else if ( nodeName == "box" )
+	    {
+		real sX, sY, sZ;
+		readBox( *it, sX, sY, sZ );
 
-	//------------------------------------------------------
-	void XODEParser::readMassShape( const NodeSharedPtr pMShapeNode, const String& parent,
-		const Transform& rParentTransform )
-	{
-		real density = 0; //default ...
+		physicsMassDesc = new IBody::BoxMassDesc( sX, sY, sZ, density,
+			rParentTransform.position_,
+			IBody::QT_DENSITY );
+	    }
+	    else if ( nodeName == "cappedCylinder" )
+	    {
+		real radius, length;
+		readCappedCylinder( *it, radius, length );
 
-		// if density is provided...
-		String strDensity = pMShapeNode->getAttributeValueAs<String>( "density" );
-		if ( !strDensity.empty() ) 
-		{
-			density = StringUtil::parseReal( strDensity );
-			YAKE_LOG( "XODE: reading mass_shape with density = " + strDensity + " " );
-		}
+		physicsMassDesc = new IBody::CapsuleMassDesc( radius, length, density,
+			rParentTransform.position_,
+			IBody::QT_DENSITY );
+	    }
 
-		const dom::NodeList& nodes = pMShapeNode->getNodes();
-		for ( NodeListIter it = nodes.begin(); it != nodes.end(); ++it)
-		{
-			String nodeName = StringUtil::toLowerCase( (*it)->getName() );
+	    if ( physicsMassDesc != NULL )
+	    {
 
-			YAKE_LOG( "XODE: reading mass_shape that is " + nodeName + " " );
+		MassDesc desc;
+		desc.mass_.reset( physicsMassDesc );
+		desc.parentName_ = parent;
 
-			IBody::MassDesc* physicsMassDesc = NULL;
+		// TODO set the other mass params!
+		// parent name, etc.
+		sigMass_( desc );
+		// TODO needed?? massDescriptions_[ name ] = desc;
+	    }
+	}
+    }
 
-			if ( nodeName == "cylinder" )
-			{
-				real radius, length;
-				readCylinder( *it, radius, length );
+    //------------------------------------------------------
+    void XODEParser::readMassAdjust( const NodeSharedPtr pMAdjustNode, const String& parent )
+    {
+	real total = StringUtil::parseReal( pMAdjustNode->getAttributeValueAs<String>( "total" ) );
 
-				physicsMassDesc = new IBody::CylinderMassDesc( radius, length, density,
-					rParentTransform.position_,
-					IBody::QT_DENSITY );
-			}
-			else if ( nodeName == "sphere" )
-			{
-				real radius; readSphere( *it, radius );
+	YAKE_LOG_INFORMATION( "XODE: read mass adjust - " + pMAdjustNode->getAttributeValueAs<String>( "total" ) );
 
-				physicsMassDesc = new IBody::SphereMassDesc(radius, density,
-					rParentTransform.position_,
-					IBody::QT_DENSITY );
-			}
-			else if ( nodeName == "box" )
-			{
-				real sX, sY, sZ;
-				readBox( *it, sX, sY, sZ );
+	MassDesc desc;
+	desc.parentName_ = parent;
+	desc.mass_.reset( new IBody::MassDesc( total, math::Vector3::kZero, IBody::QT_MASS ) );
 
-				physicsMassDesc = new IBody::BoxMassDesc( sX, sY, sZ, density,
-					rParentTransform.position_,
-					IBody::QT_DENSITY );
-			}
-			else if ( nodeName == "cappedCylinder" )
-			{
-				real radius, length;
-				readCappedCylinder( *it, radius, length );
+	sigMass_( desc );
+    }
 
-				physicsMassDesc = new IBody::CapsuleMassDesc( radius, length, density,
-					rParentTransform.position_,
-					IBody::QT_DENSITY );
-			}
+    //------------------------------------------------------
+    void XODEParser::readMass( const NodeSharedPtr pMassNode, const String& parent, const Transform& rParentTransform )
+    {
+	const dom::NodeList& nodes = pMassNode->getNodes();
 
-			if ( physicsMassDesc != NULL )
-			{
+	// Seek transform
+	Transform massTransform;
 
-				MassDesc desc;
-				desc.mass_.reset( physicsMassDesc );
-				desc.parentName_ = parent;
+	NodeHunter hunter( "transform" );
+	NodeListIter iTrans =
+	    std::find_if<NodeListIter,NodeHunter>( nodes.begin(), nodes.end(), hunter );
 
-				// TODO set the other mass params!
-				// parent name, etc.
-				sigMass_( desc );
-				// TODO needed?? massDescriptions_[ name ] = desc;
-			}
-		}
+	if ( iTrans != nodes.end() )
+	{
+	    readTransform( *iTrans, massTransform );
 	}
 
-	//------------------------------------------------------
-	void XODEParser::readMassAdjust( const NodeSharedPtr pMAdjustNode, const String& parent )
+	if ( !rParentTransform.isIdentity() )
 	{
-		real total = StringUtil::parseReal( pMAdjustNode->getAttributeValueAs<String>( "total" ) );
-
-		MassDesc desc;
-		desc.parentName_ = parent;
-		desc.mass_.reset( new IBody::MassDesc( total, Vector3::kZero, IBody::QT_MASS ) );
-
-		sigMass_( desc );
+	    massTransform = massTransform.getDerivedTransform( rParentTransform );
 	}
 
-	//------------------------------------------------------
-	void XODEParser::readMass( const NodeSharedPtr pMassNode, const String& parent, const Transform& rParentTransform )
+	for ( NodeListIter it = nodes.begin(); it != nodes.end(); ++it)
 	{
-		const dom::NodeList& nodes = pMassNode->getNodes();
+	    String nodeName =
+		StringUtil::toLowerCase( (*it)->getName() );
 
-		// Seek transform
-		Transform massTransform;
+	    if ( nodeName == "mass_shape" )
+	    {
+		readMassShape( *it, parent, massTransform );
+	    }
+	    else if ( nodeName == "adjust" )
+	    {
+		readMassAdjust( *it, parent );
+	    }
+	    else if ( nodeName == "mass" )
+	    {
+		readMass( *it, parent, massTransform );
+	    }
+	}
 
-		NodeHunter hunter( "transform" );
-		NodeListIter iTrans =
-			std::find_if<NodeListIter,NodeHunter>( nodes.begin(), nodes.end(), hunter );
+    }
 
-		if ( iTrans != nodes.end() )
-		{
-			readTransform( *iTrans, massTransform );
-		}
+    //------------------------------------------------------
+    // This method is called on any unknown extension
+    void XODEParser::readExtension( const NodeSharedPtr, 
+	    const String& parent, 
+	    const Transform& parentTransformIfAny )
+    {
+	// this virtual method should be overriden by any parser that wants to parse xode extensions
+    }
 
-		if ( !rParentTransform.isIdentity() )
-		{
-			massTransform = massTransform.getDerivedTransform( rParentTransform );
-		}
+    //------------------------------------------------------
+    void XODEParser::readBody( const NodeSharedPtr pBodyNode, const String& parent )
+    {
+	const String name = pBodyNode->getAttributeValueAs<String>( "name" );
+	YAKE_LOG( "XODE: reading body " + name );
 
-		for ( NodeListIter it = nodes.begin(); it != nodes.end(); ++it)
-		{
-			String nodeName =
-				StringUtil::toLowerCase( (*it)->getName() );
+	// Setting up body description...
+	BodyDesc desc;
+	desc.name_ = name;
+	desc.parentName_ = parent;
 
-			if ( nodeName == "mass_shape" )
-			{
-				readMassShape( *it, parent, massTransform );
-			}
-			else if ( nodeName == "adjust" )
-			{
-				readMassAdjust( *it, parent );
-			}
-			else if ( nodeName == "mass" )
-			{
-				readMass( *it, parent, massTransform );
-			}
-		}
+	const dom::NodeList& nodes = pBodyNode->getNodes();
 
-	}
+	// Seek transform
+	NodeHunter hunter( "transform" );
+	NodeListIter iTrans =
+	    std::find_if<NodeListIter,NodeHunter>( nodes.begin(), nodes.end(), hunter );
 
-	//------------------------------------------------------
-	void XODEParser::readBody( const NodeSharedPtr pBodyNode, const String& parent )
+	Transform bodyTransform;
+	if ( iTrans != nodes.end() )
 	{
-		const String name = pBodyNode->getAttributeValueAs<String>( "name" );
-		YAKE_LOG( "XODE: reading body " + name );
+	    YAKE_LOG( "XODE: body " + name + " has transform " );
 
-		// Setting up body description...
-		BodyDesc desc;
-		desc.name_ = name;
-		desc.parentName_ = parent;
+	    readTransform( *iTrans, bodyTransform );
 
-		const dom::NodeList& nodes = pBodyNode->getNodes();
+	    if ( !bodyTransform.isIdentity() )
+	    {
+		desc.transform_ = bodyTransform;
+	    }
+	}
 
-		// Seek transform
-		NodeHunter hunter( "transform" );
-		NodeListIter iTrans =
-			std::find_if<NodeListIter,NodeHunter>( nodes.begin(), nodes.end(), hunter );
+	// fire signal!
+	sigBody_( desc );
+	// TODO add to collection?
 
-		Transform bodyTransform;
-		if ( iTrans != nodes.end() )
-		{
-			YAKE_LOG( "XODE: body " + name + " has transform " );
+	for (dom::NodeList::const_iterator it = nodes.begin(); it != nodes.end(); ++it)
+	{
+	    String nodeName = StringUtil::toLowerCase( (*it)->getName() );
 
-			readTransform( *iTrans, bodyTransform );
+	    YAKE_LOG( "XODE: body " + name + " has node #" + nodeName );
 
-			if ( !bodyTransform.isIdentity() )
-			{
-				desc.transform_ = bodyTransform;
-			}
-		}
+	    if ( nodeName == "geom" )
+	    {
+		readGeom( *it, name, bodyTransform );
+	    }
+	    else if ( nodeName == "mass" )
+	    {
+		readMass( *it, name, bodyTransform );
+	    }
+	    else if ( nodeName == "joint" )
+	    {
+		readJoint( *it, name, bodyTransform );
+	    }
+	    else if ( nodeName == "ext" )
+	    {
+		readExtension( *it, name, bodyTransform );
+	    }
+	}
+    }
 
-		// fire signal!
-		sigBody_( desc );
-		// TODO add to collection?
+    //------------------------------------------------------
+    /**
+     *	 Searches for <ext name="material"> node, parses it, creates material and returns ptr to created material
+     * If no node, returns NULL
+     * @param pNode - node to search
+     */
+    void XODEParser::readMaterialExt( const NodeSharedPtr pNode, const String& parent )
+    {
+	YAKE_LOG( "XODE: entered readMaterialExt..." );
 
-		for (dom::NodeList::const_iterator it = nodes.begin(); it != nodes.end(); ++it)
-		{
-			String nodeName = StringUtil::toLowerCase( (*it)->getName() );
+	const dom::NodeList& nodes = pNode->getNodes();
 
-			YAKE_LOG( "XODE: body " + name + " has node #" + nodeName );
+	// Looking for ext
+	// TODO maybe we need some advanced searching here?
+	// like finding all ext nodes or finding <ext name="material">?
+	// For now finding ext would be enough
+	NodeHunter hunter( "ext" );
+	NodeListIter iExt =
+	    std::find_if<NodeListIter,NodeHunter>( nodes.begin(), nodes.end(), hunter );
 
-			if ( nodeName == "geom" )
-			{
-				readGeom( *it, name, bodyTransform );
-			}
-			else if ( nodeName == "mass" )
-			{
-				readMass( *it, name, bodyTransform );
-			}
-			else if ( nodeName == "joint" )
-			{
-				readJoint( *it, name, bodyTransform );
-			}
-		}
+	if ( iExt == nodes.end() )
+	{
+	    YAKE_LOG( "XODE: didn't find extension... " );
+	    return;
 	}
 
-	//------------------------------------------------------
-	/**
-	*	 Searches for <ext name="material"> node, parses it, creates material and returns ptr to created material
-	* If no node, returns NULL
-	* @param pNode - node to search
-	*/
-	void XODEParser::readMaterialExt( const NodeSharedPtr pNode, const String& parent )
+	YAKE_LOG( "XODE: found extension... processing... :) " );
+
+	if ( (*iExt)->getAttributeValueAs<String>( "name" ) != "material" )
 	{
-		YAKE_LOG( "XODE: entered readMaterialExt..." );
+	    YAKE_LOG( "XODE: extension is not material" );
+	}
 
-		const dom::NodeList& nodes = pNode->getNodes();
+	YAKE_LOG( "XODE: the extension IS material! Parsing..." );
 
-		// Looking for ext
-		// TODO maybe we need some advanced searching here?
-		// like finding all ext nodes or finding <ext name="material">?
-		// For now finding ext would be enough
-		NodeHunter hunter( "ext" );
-		NodeListIter iExt =
-			std::find_if<NodeListIter,NodeHunter>( nodes.begin(), nodes.end(), hunter );
+	const dom::NodeList& extNodes = (*iExt)->getNodes();
+	//HACK assuming first node is "params"
+	NodeSharedPtr pParamsNode = *extNodes.begin();
 
-		if ( iExt == nodes.end() )
-		{
-			YAKE_LOG( "XODE: didn't find extension... " );
-			return;
-		}
+	// parsing
+	IMaterial::Desc desc;
 
-		YAKE_LOG( "XODE: found extension... processing... :) " );
+	String strFriction = pParamsNode->getAttributeValueAs<String>( "friction" );
+	String strRestitution = pParamsNode->getAttributeValueAs<String>( "bouncecoeff" );
+	String strSoftness = pParamsNode->getAttributeValueAs<String>( "soften" );
 
-		if ( (*iExt)->getAttributeValueAs<String>( "name" ) != "material" )
-		{
-			YAKE_LOG( "XODE: extension is not material" );
-		}
+	YAKE_LOG( "XODE: read friction = " + strFriction );
+	YAKE_LOG( "XODE: read restitution = " + strRestitution );
+	YAKE_LOG( "XODE: read softness = " + strSoftness );
 
-		YAKE_LOG( "XODE: the extension IS material! Parsing..." );
+	desc.mFriction = StringUtil::parseReal( strFriction );
+	desc.mRestitution = StringUtil::parseReal( strRestitution );
+	desc.mSoftness = StringUtil::parseReal( strSoftness );
 
-		const dom::NodeList& extNodes = (*iExt)->getNodes();
-		//HACK assuming first node is "params"
-		NodeSharedPtr pParamsNode = *extNodes.begin();
+	//TODO fill in all other description params!
+	// parent name, etc
+	MaterialDesc matDesc;
+	matDesc.name_ = parent + "material"; // TODO make something totally yake::Unique here?
+	matDesc.material_ = desc;
+	matDesc.parentName_ = parent;
 
-		// parsing
-		IMaterial::Desc desc;
+	sigMaterial_( matDesc );
+    }
 
-		String strFriction = pParamsNode->getAttributeValueAs<String>( "friction" );
-		String strRestitution = pParamsNode->getAttributeValueAs<String>( "bouncecoeff" );
-		String strSoftness = pParamsNode->getAttributeValueAs<String>( "soften" );
+    //------------------------------------------------------
+    /**
+     * Reads geom xode node
+     * No folded bodies, geoms, spaces processed.
+     * @param pGeomNode
+     * @param pParentObject
+     */
+    void XODEParser::readGeom(	const NodeSharedPtr pGeomNode, const String& parent, 
+	    const Transform& rParentTransform, bool absoluteTransform )
+    {
+	const String name = pGeomNode->getAttributeValueAs<String>( "name" );
+	YAKE_LOG( "XODE: reading geom " + name );
 
-		YAKE_LOG( "XODE: read friction = " + strFriction );
-		YAKE_LOG( "XODE: read restitution = " + strRestitution );
-		YAKE_LOG( "XODE: read softness = " + strSoftness );
+	const dom::NodeList& nodes = pGeomNode->getNodes();
 
-		desc.mFriction = StringUtil::parseReal( strFriction );
-		desc.mRestitution = StringUtil::parseReal( strRestitution );
-		desc.mSoftness = StringUtil::parseReal( strSoftness );
+	// Looking for transform
+	NodeHunter hunter( "transform" );
+	NodeListIter iTrans =
+	    std::find_if<NodeListIter,NodeHunter>( nodes.begin(), nodes.end(), hunter );
 
-		//TODO fill in all other description params!
-		// parent name, etc
-		MaterialDesc matDesc;
-		matDesc.name_ = parent + "material"; // TODO make something totally yake::Unique here?
-		matDesc.material_ = desc;
-		matDesc.parentName_ = parent;
+	Transform geomTransform;
 
-		sigMaterial_( matDesc );
+	if ( iTrans != nodes.end() )
+	{
+	    YAKE_LOG( "XODE: readGeom() [" + name + "] : geom has transform " );
+
+	    readTransform( *iTrans, geomTransform );
 	}
 
-	//------------------------------------------------------
-	/**
-	* Reads geom xode node
-	* No folded bodies, geoms, spaces processed.
-	* @param pGeomNode
-	* @param pParentObject
-	*/
-	void XODEParser::readGeom(	const NodeSharedPtr pGeomNode, const String& parent, const Transform& rParentTransform )
-	{
-		const String name = pGeomNode->getAttributeValueAs<String>( "name" );
-		YAKE_LOG( "XODE: reading geom " + name );
+	// if transform is absolute, we need to provide derived transform
+	if ( absoluteTransform )
+	    geomTransform = geomTransform.getDerivedTransform( rParentTransform );
 
-		const dom::NodeList& nodes = pGeomNode->getNodes();
+	YAKE_LOG( "XODE: scanning other geom properties..." );
 
-		// Looking for transform
-		NodeHunter hunter( "transform" );
-		NodeListIter iTrans =
-			std::find_if<NodeListIter,NodeHunter>( nodes.begin(), nodes.end(), hunter );
+	for (dom::NodeList::const_iterator it = nodes.begin(); it != nodes.end(); ++it)
+	{
+	    String nodeName = StringUtil::toLowerCase( (*it)->getName() );
 
-		Transform geomTransform;
+	    YAKE_LOG( "XODE: geom [" + name + "] has node #" + nodeName );
 
-		if ( iTrans != nodes.end() )
-		{
-			YAKE_LOG( "XODE: readGeom() [" + name + "] : geom has transform " );
+	    IShape::Desc* shapeDesc = NULL;
 
-			readTransform( *iTrans, geomTransform );
-		}
+	    if ( nodeName == "geom" )
+	    {
+		// reading folded geom -> absolute transform is provided
+		// parent ( actor ) remains the same
+		readGeom( *it, parent, geomTransform, true );
+	    }
+	    if ( nodeName == "box" )
+	    {
+		real sizeX, sizeY, sizeZ;
+		readBox( *it, sizeX, sizeY, sizeZ );
 
-		YAKE_LOG( "XODE: scanning other geom properties..." );
+		sizeX *= rParentTransform.scale_.x;
+		sizeY *= rParentTransform.scale_.y;
+		sizeZ *= rParentTransform.scale_.z;
 
-		for (dom::NodeList::const_iterator it = nodes.begin(); it != nodes.end(); ++it)
-		{
-			String nodeName = StringUtil::toLowerCase( (*it)->getName() );
+		String strSizeX; strSizeX << sizeX;
+		String strSizeY; strSizeY << sizeY;
+		String strSizeZ; strSizeZ << sizeZ;
 
-			YAKE_LOG( "XODE: geom [" + name + "] has node #" + nodeName );
+		YAKE_LOG( "XODE: box with sizes: " + strSizeX + ", " + strSizeY + ", " + strSizeZ );
 
-			IShape::Desc* shapeDesc = NULL;
+		shapeDesc = new IShape::BoxDesc( math::Vector3( sizeX, sizeY, sizeZ ), "",
+			geomTransform.position_, geomTransform.rotation_ );
+	    }
+	    else if ( nodeName == "cappedCylinder" )
+	    {
+		real radius, length;
+		readCappedCylinder( *it, radius, length );
 
-			if ( nodeName == "box" )
-			{
-				real sizeX, sizeY, sizeZ;
-				readBox( *it, sizeX, sizeY, sizeZ );
+		real scale = ( rParentTransform.scale_.x
+			+ rParentTransform.scale_.y
+			+ rParentTransform.scale_.z ) /3;
 
-				sizeX *= rParentTransform.scale_.x;
-				sizeY *= rParentTransform.scale_.y;
-				sizeZ *= rParentTransform.scale_.z;
+		radius *= scale;
+		length *= scale;
 
-				String strSizeX; strSizeX << sizeX;
-				String strSizeY; strSizeY << sizeY;
-				String strSizeZ; strSizeZ << sizeZ;
+		shapeDesc = new IShape::CapsuleDesc( length,
+			radius,
+			"",
+			geomTransform.position_,
+			geomTransform.rotation_ );
+	    }
+	    else if ( nodeName == "cone" )
+	    {
+		real radius, length;
+		readCone( *it, radius, length );
 
-				YAKE_LOG( "XODE: box with sizes: " + strSizeX + ", " + strSizeY + ", " + strSizeZ );
+		real scale = ( rParentTransform.scale_.x
+			+ rParentTransform.scale_.y
+			+ rParentTransform.scale_.z ) /3;
 
-				shapeDesc = new IShape::BoxDesc( Vector3( sizeX, sizeY, sizeZ ), "",
-					geomTransform.position_, geomTransform.rotation_ );
-			}
-			else if ( nodeName == "cappedCylinder" )
-			{
-				real radius, length;
-				readCappedCylinder( *it, radius, length );
+		radius *= scale;
+		length *= scale;
 
-				real scale = ( rParentTransform.scale_.x
-					+ rParentTransform.scale_.y
-					+ rParentTransform.scale_.z ) /3;
+		YAKE_ASSERT( false ).error( "NOT implemented in Yake" ); //TODO
+	    }
+	    else if ( nodeName == "cylinder" )
+	    {
+		real radius, length;
+		readCylinder( *it, radius, length );
 
-				radius *= scale;
-				length *= scale;
+		real scale = ( rParentTransform.scale_.x
+			+ rParentTransform.scale_.y
+			+ rParentTransform.scale_.z ) /3;
 
-				shapeDesc = new IShape::CapsuleDesc( length,
-					radius,
-					"",
-					geomTransform.position_,
-					geomTransform.rotation_ );
-			}
-			else if ( nodeName == "cone" )
-			{
-				real radius, length;
-				readCone( *it, radius, length );
+		radius *= scale;
+		length *= scale;
 
-				real scale = ( rParentTransform.scale_.x
-					+ rParentTransform.scale_.y
-					+ rParentTransform.scale_.z ) /3;
+		shapeDesc = new IShape::CapsuleDesc( length,
+			radius,
+			"",
+			geomTransform.position_,
+			geomTransform.rotation_ );
+	    }
+	    else if ( nodeName == "plane" )
+	    {
+		real a, b, c, d;
+		readPlane( *it, a, b, c, d );
+		shapeDesc = new IShape::PlaneDesc( math::Vector3( a, b, c ),
+			d,
+			"",
+			geomTransform.position_,
+			geomTransform.rotation_ );
+	    }
+	    else if ( nodeName == "ray" )
+	    {
+		real length;
+		readRay( *it, length );
 
-				radius *= scale;
-				length *= scale;
+		real scale = ( rParentTransform.scale_.x
+			+ rParentTransform.scale_.y
+			+ rParentTransform.scale_.z ) /3;
 
-				YAKE_ASSERT( false ).error( "NOT implemented in Yake" ); //TODO
-			}
-			else if ( nodeName == "cylinder" )
-			{
-				real radius, length;
-				readCylinder( *it, radius, length );
+		length *= scale;
 
-				real scale = ( rParentTransform.scale_.x
-					+ rParentTransform.scale_.y
-					+ rParentTransform.scale_.z ) /3;
+		YAKE_ASSERT( false ).error( "NOT implemented in Yake" ); //TODO
+	    }
+	    else if ( nodeName == "sphere" )
+	    {
+		real radius;
+		readSphere( *it, radius );
 
-				radius *= scale;
-				length *= scale;
+		real scale = ( rParentTransform.scale_.x
+			+ rParentTransform.scale_.y
+			+ rParentTransform.scale_.z ) /3;
 
-				shapeDesc = new IShape::CapsuleDesc( length,
-					radius,
-					"",
-					geomTransform.position_,
-					geomTransform.rotation_ );
-			}
-			else if ( nodeName == "plane" )
-			{
-				real a, b, c, d;
-				readPlane( *it, a, b, c, d );
-				shapeDesc = new IShape::PlaneDesc( Vector3( a, b, c ),
-					d,
-					"",
-					geomTransform.position_,
-					geomTransform.rotation_ );
-			}
-			else if ( nodeName == "ray" )
-			{
-				real length;
-				readRay( *it, length );
+		radius *= scale;
 
-				real scale = ( rParentTransform.scale_.x
-					+ rParentTransform.scale_.y
-					+ rParentTransform.scale_.z ) /3;
+		shapeDesc = new IShape::SphereDesc(
+			radius,
+			"",
+			geomTransform.position_,
+			geomTransform.rotation_ );
+	    }
+	    else if ( nodeName == "trimesh" )
+	    {
+		TriangleMeshDesc::VertexVector vertices;
+		TriangleMeshDesc::IndexVector indices;
 
-				length *= scale;
+		readTrimesh( *it, vertices, indices );
 
-				YAKE_ASSERT( false ).error( "NOT implemented in Yake" ); //TODO
-			}
-			else if ( nodeName == "sphere" )
-			{
-				real radius;
-				readSphere( *it, radius );
+		TriangleMeshDesc::VertexVector scaledVertices;
 
-				real scale = ( rParentTransform.scale_.x
-					+ rParentTransform.scale_.y
-					+ rParentTransform.scale_.z ) /3;
+		ConstVectorIterator< TriangleMeshDesc::VertexVector > iV( vertices.begin(), vertices.end() );
 
-				radius *= scale;
+		while ( iV.hasMoreElements() )
+		{
+		    const math::Vector3& vertex = iV.getNext();
+		    scaledVertices.push_back( vertex * rParentTransform.scale_ );
+		}
 
-				shapeDesc = new IShape::SphereDesc(
-					radius,
-					"",
-					geomTransform.position_,
-					geomTransform.rotation_ );
-			}
-			else if ( nodeName == "trimesh" )
-			{
-				TriangleMeshDesc::VertexVector vertices;
-				TriangleMeshDesc::IndexVector indices;
+		TriangleMeshDesc dataDesc( vertices, indices );
 
-				readTrimesh( *it, vertices, indices );
+		shapeDesc = new IShape::TriMeshDesc( dataDesc, "",
+			geomTransform.position_, geomTransform.rotation_ );
+	    }
+	    else if ( nodeName == "ext" )
+	    {
+		readExtension( *it, name, rParentTransform );
+	    }
 
-				TriangleMeshDesc::VertexVector scaledVertices;
+	    if ( shapeDesc != NULL )
+	    {
+		//TODO fill in all other description params!
+		// parent name, etc
+		GeomDesc geomDesc;
+		geomDesc.name_ = name;
+		geomDesc.parentName_ = parent;
+		geomDesc.shape_.reset( shapeDesc );
 
-				ConstVectorIterator< TriangleMeshDesc::VertexVector > iV( vertices.begin(), vertices.end() );
+		sigGeom_( geomDesc );
 
-				while ( iV.hasMoreElements() )
-				{
-					const Vector3& vertex = iV.getNext();
-					scaledVertices.push_back( vertex * rParentTransform.scale_ );
-				}
+		// read material after geom definition was found.
+		// TODO is this a right place to read material?
+		// 
+		readMaterialExt( *it, name );
+	    }
+	}
 
-				TriangleMeshDesc dataDesc( vertices, indices );
+	YAKE_LOG( "XODE: Leaving readGeom()" );
+    }
 
-				shapeDesc = new IShape::TriMeshDesc( dataDesc, "",
-					geomTransform.position_, geomTransform.rotation_ );
-			}
+    //------------------------------------------------------
+    void XODEParser::readBox( const NodeSharedPtr pNode, real& sizeX, real& sizeY, real& sizeZ )
+    {
+	sizeX = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "sizex" ) );
+	sizeY = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "sizey" ) );
+	sizeZ = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "sizez" ) );
+    }
 
-			if ( shapeDesc != NULL )
-			{
-				//TODO fill in all other description params!
-				// parent name, etc
-				GeomDesc geomDesc;
-				geomDesc.name_ = name;
-				geomDesc.parentName_ = parent;
-				geomDesc.shape_.reset( shapeDesc );
+    //------------------------------------------------------
+    void XODEParser::readCappedCylinder( const NodeSharedPtr pNode, real& radius, real& length )
+    {
+	radius = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "radius" ) );
+	length = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "length" ) );
+    }
 
-				sigGeom_( geomDesc );
+    //------------------------------------------------------
+    void XODEParser::readCone( const NodeSharedPtr pNode, real& radius, real& length )
+    {
+	radius = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "radius" ) );
+	length = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "length" ) );
+    }
 
-				// read material after geom definition was found.
-				// TODO is this a right place to read material?
-				// 
-				readMaterialExt( *it, name );
-			}
-		}
+    //------------------------------------------------------
+    void XODEParser::readCylinder( const NodeSharedPtr pNode, real& radius, real& length )
+    {
+	radius = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "radius" ) );
+	length = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "length" ) );
+    }
 
-		YAKE_LOG( "XODE: Leaving readGeom()" );
-	}
+    //------------------------------------------------------
+    void XODEParser::readPlane( const NodeSharedPtr pNode, real& a, real& b, real& c, real& d )
+    {
+	a = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "a" ) );
+	b = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "b" ) );
+	c = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "c" ) );
+	d = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "d" ) );
+    }
 
-	//------------------------------------------------------
-	void XODEParser::readBox( const NodeSharedPtr pNode, real& sizeX, real& sizeY, real& sizeZ )
-	{
-		sizeX = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "sizex" ) );
-		sizeY = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "sizey" ) );
-		sizeZ = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "sizez" ) );
-	}
+    //------------------------------------------------------
+    void XODEParser::readRay( const NodeSharedPtr pNode, real& length )
+    {
+	length = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "length" ) );
+    }
 
-	//------------------------------------------------------
-	void XODEParser::readCappedCylinder( const NodeSharedPtr pNode, real& radius, real& length )
-	{
-		radius = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "radius" ) );
-		length = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "length" ) );
-	}
+    //------------------------------------------------------
+    void XODEParser::readSphere( const NodeSharedPtr pNode, real& radius )
+    {
+	radius = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "radius" ) );
+    }
 
-	//------------------------------------------------------
-	void XODEParser::readCone( const NodeSharedPtr pNode, real& radius, real& length )
-	{
-		radius = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "radius" ) );
-		length = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "length" ) );
-	}
+    //------------------------------------------------------
+    void XODEParser::readTrimesh( const NodeSharedPtr pMeshNode,
+	    TriangleMeshDesc::VertexVector& rVertices,
+	    TriangleMeshDesc::IndexVector& rIndices )
+    {
+	const dom::NodeList& nodes = pMeshNode->getNodes();
 
-	//------------------------------------------------------
-	void XODEParser::readCylinder( const NodeSharedPtr pNode, real& radius, real& length )
+	for ( NodeListIter it = nodes.begin(); it != nodes.end(); ++it )
 	{
-		radius = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "radius" ) );
-		length = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "length" ) );
-	}
+	    String nodeName = StringUtil::toLowerCase( (*it)->getName() );
 
-	//------------------------------------------------------
-	void XODEParser::readPlane( const NodeSharedPtr pNode, real& a, real& b, real& c, real& d )
-	{
-		a = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "a" ) );
-		b = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "b" ) );
-		c = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "c" ) );
-		d = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "d" ) );
-	}
+	    YAKE_LOG( "XODE: reading " + nodeName + " trimesh now..." );
 
-	//------------------------------------------------------
-	void XODEParser::readRay( const NodeSharedPtr pNode, real& length )
-	{
-		length = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "length" ) );
+	    if ( nodeName == "vertices" )
+	    {
+		readVertices( *it, rVertices );
+	    }
+	    else if ( nodeName == "triangles" )
+	    {
+		readIndices( *it, rIndices );
+	    }
 	}
+    }
 
-	//------------------------------------------------------
-	void XODEParser::readSphere( const NodeSharedPtr pNode, real& radius )
-	{
-		radius = StringUtil::parseReal( pNode->getAttributeValueAs<String>( "radius" ) );
-	}
+    //------------------------------------------------------
+    void XODEParser::readVertices( const NodeSharedPtr pNode, TriangleMeshDesc::VertexVector& rVertices )
+    {
+	const dom::NodeList& nodes = pNode->getNodes();
 
-	//------------------------------------------------------
-	void XODEParser::readTrimesh( const NodeSharedPtr pMeshNode,
-		TriangleMeshDesc::VertexVector& rVertices,
-		TriangleMeshDesc::IndexVector& rIndices )
+	for ( NodeListIter it = nodes.begin(); it != nodes.end(); ++it )
 	{
-		const dom::NodeList& nodes = pMeshNode->getNodes();
+	    String nodeName = StringUtil::toLowerCase( (*it)->getName() );
 
-		for ( NodeListIter it = nodes.begin(); it != nodes.end(); ++it )
-		{
-			String nodeName = StringUtil::toLowerCase( (*it)->getName() );
+	    if ( nodeName == "v" )
+	    {
+		real x = StringUtil::parseReal( (*it)->getAttributeValueAs< String >( "x" ) );
+		real y = StringUtil::parseReal( (*it)->getAttributeValueAs< String >( "y" ) );
+		real z = StringUtil::parseReal( (*it)->getAttributeValueAs< String >( "z" ) );
 
-			YAKE_LOG( "XODE: reading " + nodeName + " trimesh now..." );
-
-			if ( nodeName == "vertices" )
-			{
-				readVertices( *it, rVertices );
-			}
-			else if ( nodeName == "triangles" )
-			{
-				readIndices( *it, rIndices );
-			}
-		}
+		rVertices.push_back( math::Vector3( x, y, z ) );
+	    }
 	}
+    }
 
-	//------------------------------------------------------
-	void XODEParser::readVertices( const NodeSharedPtr pNode, TriangleMeshDesc::VertexVector& rVertices )
-	{
-		const dom::NodeList& nodes = pNode->getNodes();
+    //------------------------------------------------------
+    void XODEParser::readIndices( const NodeSharedPtr pNode, TriangleMeshDesc::IndexVector& rIndices )
+    {
+	const dom::NodeList& nodes = pNode->getNodes();
 
-		for ( NodeListIter it = nodes.begin(); it != nodes.end(); ++it )
-		{
-			String nodeName = StringUtil::toLowerCase( (*it)->getName() );
+	typedef int32 IndexT;
 
-			if ( nodeName == "v" )
-			{
-				real x = StringUtil::parseReal( (*it)->getAttributeValueAs< String >( "x" ) );
-				real y = StringUtil::parseReal( (*it)->getAttributeValueAs< String >( "y" ) );
-				real z = StringUtil::parseReal( (*it)->getAttributeValueAs< String >( "z" ) );
-
-				rVertices.push_back( Vector3( x, y, z ) );
-			}
-		}
-	}
-
-	//------------------------------------------------------
-	void XODEParser::readIndices( const NodeSharedPtr pNode, TriangleMeshDesc::IndexVector& rIndices )
+	for ( NodeListIter it = nodes.begin(); it != nodes.end(); ++it )
 	{
-		const dom::NodeList& nodes = pNode->getNodes();
+	    String nodeName =
+		StringUtil::toLowerCase( (*it)->getName() );
 
-		typedef int32 IndexT;
+	    if ( nodeName == "t" )
+	    {
+		IndexT ia = StringUtil::parseInt( (*it)->getAttributeValueAs< String >( "ia" ) );
+		IndexT ib = StringUtil::parseInt( (*it)->getAttributeValueAs< String >( "ib" ) );
+		IndexT ic = StringUtil::parseInt( (*it)->getAttributeValueAs< String >( "ic" ) );
 
-		for ( NodeListIter it = nodes.begin(); it != nodes.end(); ++it )
-		{
-			String nodeName =
-				StringUtil::toLowerCase( (*it)->getName() );
+		rIndices.push_back( ia );
+		rIndices.push_back( ib );
+		rIndices.push_back( ic );
+	    }
+	}
+    }
 
-			if ( nodeName == "t" )
-			{
-				IndexT ia = StringUtil::parseInt( (*it)->getAttributeValueAs< String >( "ia" ) );
-				IndexT ib = StringUtil::parseInt( (*it)->getAttributeValueAs< String >( "ib" ) );
-				IndexT ic = StringUtil::parseInt( (*it)->getAttributeValueAs< String >( "ic" ) );
+    //------------------------------------------------------
+    void XODEParser::readJoint( const NodeSharedPtr pJointNode,
+	    const String& parent,
+	    const Transform& rParentTransform )
+    {
+	JointDesc desc;
+	desc.parentName_ = parent;
+	desc.transform_ = rParentTransform;
 
-				rIndices.push_back( ia );
-				rIndices.push_back( ib );
-				rIndices.push_back( ic );
-			}
-		}
-	}
+	// reading joint... creating description.
 
-	//------------------------------------------------------
-	void XODEParser::readJoint( const NodeSharedPtr pJointNode,
-		const String& parent,
-		Transform& rParentTransform )
-	{
-		JointDesc desc;
-		desc.parentName_ = parent;
-		desc.transform_ = rParentTransform;
+	const dom::NodeList& nodes = pJointNode->getNodes();
+	const String name = pJointNode->getAttributeValueAs<String>( "name" );
 
-		// reading joint... creating description.
+	desc.name_ = name;
 
-		const dom::NodeList& nodes = pJointNode->getNodes();
-		String name = pJointNode->getName();
+	YAKE_LOG( "XODE: reading joint '" + name + "' ..." );
 
-		desc.name_ = name;
+	// Looking for link1
+	NodeHunter link1Hunter( "link1" );
+	NodeListIter iLink1 =
+	    std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), link1Hunter );
 
-		YAKE_LOG( "XODE: reading joint '" + name + "' ..." );
+	String body1Name;
+	// <link1 .. can be omitted. Parent is then considered 
+	// to be the first body.
+	// See .xode description for explanation.
+	if ( iLink1 == nodes.end() )
+	    body1Name = parent;
+	else
+	    body1Name = (*iLink1)->getAttributeValueAs<String>( "body" );
 
-		// Looking for link2
-		NodeHunter linkHunter( "link2" );
-		NodeListIter iLink =
-			std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), linkHunter );
+	desc.body1_ = body1Name;
 
-		YAKE_ASSERT( iLink != nodes.end() ).error( "2nd body name is not present in joint definition!" );
+	// Looking for link2
+	NodeHunter linkHunter( "link2" );
+	NodeListIter iLink =
+	    std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), linkHunter );
 
-		String body2Name = (*iLink)->getAttributeValueAs<String>( "body" );
+	YAKE_ASSERT( iLink != nodes.end() ).error( "2nd body name is not present in joint definition!" );
 
-		desc.otherBody_ = body2Name;
+	String body2Name = (*iLink)->getAttributeValueAs<String>( "body" );
 
-		YAKE_LOG( "XODE: the joint connects two actors:" );
-		YAKE_LOG( "XODE: 1:" + parent );
-		YAKE_LOG( "XODE: 2:" + body2Name );
+	desc.body2_ = body2Name;
 
-		// Looking for transform
-		NodeHunter hunter( "transform" );
-		NodeListIter iTrans =
-			std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), hunter );
+	YAKE_LOG( "XODE: the joint connects two actors:" );
+	YAKE_LOG( "XODE: 1:" + body1Name );
+	YAKE_LOG( "XODE: 2:" + body2Name );
 
-		Transform jointTransform;
-		if ( iTrans != nodes.end() )
-		{
-			YAKE_LOG( "XODE: joint has transform " );
+	// Looking for transform
+	NodeHunter hunter( "transform" );
+	NodeListIter iTrans =
+	    std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), hunter );
 
-			readTransform( *iTrans, jointTransform );
-		}
+	Transform jointTransform;
+	if ( iTrans != nodes.end() )
+	{
+	    YAKE_LOG( "XODE: joint has transform " );
 
-		if ( !rParentTransform.isIdentity() )
-		{
-			jointTransform = jointTransform.getDerivedTransform( rParentTransform );
-		}
+	    readTransform( *iTrans, jointTransform );
+	}
 
-		for ( NodeListIter it = nodes.begin(); it != nodes.end(); ++it )
-		{
-			String nodeName = StringUtil::toLowerCase( (*it)->getName() );
+	if ( !rParentTransform.isIdentity() )
+	{
+	    jointTransform = jointTransform.getDerivedTransform( rParentTransform );
+	}
 
-			IJoint::DescBase* jointDesc = NULL;
+	for ( NodeListIter it = nodes.begin(); it != nodes.end(); ++it )
+	{
+	    String nodeName = StringUtil::toLowerCase( (*it)->getName() );
 
-			YAKE_LOG( "XODE: reading " + nodeName + " now..." );
+	    IJoint::DescBase* jointDesc = NULL;
 
-			if ( nodeName == "ball" )
-			{
-				jointDesc = readBall( *it, jointTransform );
-			}
-			else if ( nodeName == "fixed" )
-			{
-				jointDesc = readFixed( *it, jointTransform );
-			}
-			else if ( nodeName == "hinge" )
-			{
-				jointDesc = readHinge( *it, jointTransform );
-			}
-			else if ( nodeName == "hinge2" )
-			{
-				jointDesc = readHinge2( *it, jointTransform );
-			}
-			else if ( nodeName == "slider" )
-			{
-				jointDesc = readSlider( *it, jointTransform );
-			}
-			else if ( nodeName == "universal" )
-			{
-				jointDesc = readUniversal( *it, jointTransform );
-			}
-			else if ( nodeName == "amotor" )
-			{
-				YAKE_ASSERT( false ).error( "amotor joint type is not supported!" );
-			}
+	    YAKE_LOG( "XODE: reading " + nodeName + " now..." );
 
-			if ( jointDesc != NULL )
-			{
-				desc.joint_.reset( jointDesc );
+	    if ( nodeName == "ball" )
+	    {
+		jointDesc = readBall( *it, jointTransform );
+	    }
+	    else if ( nodeName == "fixed" )
+	    {
+		jointDesc = readFixed( *it, jointTransform );
+	    }
+	    else if ( nodeName == "hinge" )
+	    {
+		jointDesc = readHinge( *it, jointTransform );
+	    }
+	    else if ( nodeName == "hinge2" )
+	    {
+		jointDesc = readHinge2( *it, jointTransform );
+	    }
+	    else if ( nodeName == "slider" )
+	    {
+		jointDesc = readSlider( *it, jointTransform );
+	    }
+	    else if ( nodeName == "universal" )
+	    {
+		jointDesc = readUniversal( *it, jointTransform );
+	    }
+	    else if ( nodeName == "amotor" )
+	    {
+		YAKE_ASSERT( false ).error( "amotor joint type is not supported!" );
+	    }
 
-				sigJoint_( desc );
-			}
-		}
+	    if ( jointDesc != NULL )
+	    {
+		desc.joint_.reset( jointDesc );
 
+		sigJoint_( desc );
+	    }
 	}
 
-	//------------------------------------------------------
-	IJoint::DescBase* XODEParser::readBall( const NodeSharedPtr pJointNode, Transform& rJointTransform )
-	{
-		YAKE_LOG( "XODE: reading ball joint description..." );
+    }
 
-		const dom::NodeList& nodes = pJointNode->getNodes();
+    //------------------------------------------------------
+    IJoint::DescBase* XODEParser::readBall( const NodeSharedPtr pJointNode, const Transform& rJointTransform )
+    {
+	YAKE_LOG( "XODE: reading ball joint description..." );
 
-		typedef dom::NodeList::const_iterator NodeListIter;
+	const dom::NodeList& nodes = pJointNode->getNodes();
 
-		// Looking for anchor
-		NodeHunter anchorHunter( "anchor" );
-		NodeListIter iAnchor =
-			std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), anchorHunter );
+	typedef dom::NodeList::const_iterator NodeListIter;
 
-		YAKE_ASSERT( iAnchor != nodes.end() ).error( "Anchor was not defined for ball joint!" );
+	// Looking for anchor
+	NodeHunter anchorHunter( "anchor" );
+	NodeListIter iAnchor =
+	    std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), anchorHunter );
 
-		Vector3 anchor;
+	YAKE_ASSERT( iAnchor != nodes.end() ).error( "Anchor was not defined for ball joint!" );
 
-		readAnchor( *iAnchor, anchor, rJointTransform );
+	math::Vector3 anchor;
 
-		IJoint::DescBase* desc = new IJoint::DescBall( NULL, NULL, anchor );
+	readAnchor( *iAnchor, anchor, rJointTransform );
 
-		YAKE_LOG( "XODE: Finished processing ball joint description." );
+	IJoint::DescBase* desc = new IJoint::DescBall( NULL, NULL, anchor );
 
-		return desc;
-	}
+	YAKE_LOG( "XODE: Finished processing ball joint description." );
 
-	//------------------------------------------------------
-	IJoint::DescBase* XODEParser::readFixed( const NodeSharedPtr pJointNode, Transform& rJointTransform )
-	{
-		YAKE_LOG( "Reading fixed joint description..." );
+	return desc;
+    }
 
-		IJoint::DescBase* desc = new IJoint::DescFixed( NULL, NULL );
+    //------------------------------------------------------
+    IJoint::DescBase* XODEParser::readFixed( const NodeSharedPtr pJointNode, const Transform& rJointTransform )
+    {
+	YAKE_LOG( "Reading fixed joint description..." );
 
-		YAKE_LOG( "Finished processing fixed joint description." );
+	IJoint::DescBase* desc = new IJoint::DescFixed( NULL, NULL );
 
-		return desc;
-	}
+	YAKE_LOG( "Finished processing fixed joint description." );
 
-	//------------------------------------------------------
-	IJoint::DescBase* XODEParser::readHinge( const NodeSharedPtr pJointNode, Transform& rJointTransform )
-	{
-		YAKE_LOG( "Reading hinge joint description..." );
+	return desc;
+    }
 
-		const dom::NodeList& nodes = pJointNode->getNodes();
+    //------------------------------------------------------
+    IJoint::DescBase* XODEParser::readHinge( const NodeSharedPtr pJointNode, const Transform& rJointTransform )
+    {
+	YAKE_LOG( "Reading hinge joint description..." );
 
-		// Looking for anchor
-		NodeHunter anchorHunter( "anchor" );
-		NodeListIter iAnchor =
-			std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), anchorHunter );
+	const dom::NodeList& nodes = pJointNode->getNodes();
 
-		YAKE_ASSERT( iAnchor != nodes.end() ).error( "Anchor was not defined for hinge joint!" );
+	// Looking for anchor
+	NodeHunter anchorHunter( "anchor" );
+	NodeListIter iAnchor =
+	    std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), anchorHunter );
 
-		// Looking for axis
-		NodeHunter axisHunter( "axis" );
-		NodeListIter iAxis =
-			std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), axisHunter );
+	YAKE_ASSERT( iAnchor != nodes.end() ).error( "Anchor was not defined for hinge joint!" );
 
-		YAKE_ASSERT( iAxis != nodes.end() ).error( "Axis was not defined for hinge joint!" );
+	// Looking for axis
+	NodeHunter axisHunter( "axis" );
+	NodeListIter iAxis =
+	    std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), axisHunter );
 
-		Vector3 anchor;
-		Vector3 axis;
+	YAKE_ASSERT( iAxis != nodes.end() ).error( "Axis was not defined for hinge joint!" );
 
-		readAnchor( *iAnchor, anchor, rJointTransform );
-		readAxis( *iAxis, axis, rJointTransform );
+	math::Vector3 anchor;
+	math::Vector3 axis;
 
-		IJoint::DescBase* desc = new IJoint::DescHinge( NULL, NULL, axis, anchor );
+	readAnchor( *iAnchor, anchor, rJointTransform );
+	readAxis( *iAxis, axis, rJointTransform );
 
-		YAKE_LOG( "Finished processing hinge joint description." );
+	IJoint::DescBase* desc = new IJoint::DescHinge( NULL, NULL, axis, anchor );
 
-		return desc;
-	}
+	YAKE_LOG( "Finished processing hinge joint description." );
 
-	//------------------------------------------------------
-	IJoint::DescBase* XODEParser::readHinge2( const NodeSharedPtr pJointNode, Transform& rJointTransform )
-	{
-		YAKE_LOG( "Reading hinge2 joint description..." );
+	return desc;
+    }
 
-		const dom::NodeList& nodes = pJointNode->getNodes();
+    //------------------------------------------------------
+    IJoint::DescBase* XODEParser::readHinge2( const NodeSharedPtr pJointNode, const Transform& rJointTransform )
+    {
+	YAKE_LOG( "Reading hinge2 joint description..." );
 
-		// Looking for anchor
-		NodeHunter anchorHunter( "anchor" );
-		NodeListIter iAnchor =
-			std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), anchorHunter );
+	const dom::NodeList& nodes = pJointNode->getNodes();
 
-		YAKE_ASSERT( iAnchor != nodes.end() ).error( "Anchor was not defined for hinge2 joint!" );
+	// Looking for anchor
+	NodeHunter anchorHunter( "anchor" );
+	NodeListIter iAnchor =
+	    std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), anchorHunter );
 
-		// Looking for axis
-		NodeHunter axisHunter( "axis" );
-		NodeListIter iAxis0 =
-			std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), axisHunter );
+	YAKE_ASSERT( iAnchor != nodes.end() ).error( "Anchor was not defined for hinge2 joint!" );
 
-		YAKE_ASSERT( iAxis0 != nodes.end() ).error( "Axis0 was not defined for hinge2 joint!" );
+	// Looking for axis
+	NodeHunter axisHunter( "axis" );
+	NodeListIter iAxis0 =
+	    std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), axisHunter );
 
-		NodeListIter iAxis1 =
-			std::find_if<NodeListIter, NodeHunter>( iAxis0 + 1, nodes.end(), axisHunter );
+	YAKE_ASSERT( iAxis0 != nodes.end() ).error( "Axis0 was not defined for hinge2 joint!" );
 
-		YAKE_ASSERT( iAxis1 != nodes.end() ).error( "Axis1 was not defined for hinge2 joint!" );
+	NodeListIter iAxis1 =
+	    std::find_if<NodeListIter, NodeHunter>( iAxis0 + 1, nodes.end(), axisHunter );
 
-		Vector3 anchor;
-		Vector3 axis0;
-		Vector3 axis1;
+	YAKE_ASSERT( iAxis1 != nodes.end() ).error( "Axis1 was not defined for hinge2 joint!" );
 
-		readAnchor( *iAnchor, anchor, rJointTransform );
-		readAxis( *iAxis0, axis0, rJointTransform );
-		readAxis( *iAxis1, axis1, rJointTransform );
+	math::Vector3 anchor;
+	math::Vector3 axis0;
+	math::Vector3 axis1;
 
-		IJoint::DescBase* desc = new IJoint::DescHinge2( NULL, NULL, axis0, axis1, anchor );
+	readAnchor( *iAnchor, anchor, rJointTransform );
+	readAxis( *iAxis0, axis0, rJointTransform );
+	readAxis( *iAxis1, axis1, rJointTransform );
 
-		YAKE_LOG( "XODE: finished processing hinge2 joint description." );
+	IJoint::DescBase* desc = new IJoint::DescHinge2( NULL, NULL, axis0, axis1, anchor );
 
-		return desc;
-	}
+	YAKE_LOG( "XODE: finished processing hinge2 joint description." );
 
-	//------------------------------------------------------
-	IJoint::DescBase* XODEParser::readSlider( const NodeSharedPtr pJointNode, Transform& rJointTransform )
-	{
-		YAKE_LOG( "XODE: reading slider joint description..." );
+	return desc;
+    }
 
-		const dom::NodeList& nodes = pJointNode->getNodes();
+    //------------------------------------------------------
+    IJoint::DescBase* XODEParser::readSlider( const NodeSharedPtr pJointNode, const Transform& rJointTransform )
+    {
+	YAKE_LOG( "XODE: reading slider joint description..." );
 
-		// Looking for axis
-		NodeHunter axisHunter( "axis" );
-		NodeListIter iAxis =
-			std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), axisHunter );
+	const dom::NodeList& nodes = pJointNode->getNodes();
 
-		YAKE_ASSERT( iAxis != nodes.end() ).error( "Axis was not defined for slider joint!" );
+	// Looking for axis
+	NodeHunter axisHunter( "axis" );
+	NodeListIter iAxis =
+	    std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), axisHunter );
 
-		Vector3 axis;
+	YAKE_ASSERT( iAxis != nodes.end() ).error( "Axis was not defined for slider joint!" );
 
-		readAxis( *iAxis, axis, rJointTransform );
+	math::Vector3 axis;
 
-		IJoint::DescBase* desc = new IJoint::DescSlider( NULL, NULL, axis );
+	readAxis( *iAxis, axis, rJointTransform );
 
-		YAKE_LOG( "XODE: finished processing slider joint description." );
+	IJoint::DescBase* desc = new IJoint::DescSlider( NULL, NULL, axis );
 
-		return desc;
-	}
+	YAKE_LOG( "XODE: finished processing slider joint description." );
 
-	//------------------------------------------------------
-	IJoint::DescBase* XODEParser::readUniversal( const NodeSharedPtr pJointNode, Transform& rJointTransform )
-	{
-		YAKE_LOG( "XODE: reading universal joint description..." );
+	return desc;
+    }
 
-		const dom::NodeList& nodes = pJointNode->getNodes();
+    //------------------------------------------------------
+    IJoint::DescBase* XODEParser::readUniversal( const NodeSharedPtr pJointNode, const Transform& rJointTransform )
+    {
+	YAKE_LOG( "XODE: reading universal joint description..." );
 
-		// Looking for anchor
-		NodeHunter anchorHunter( "anchor" );
-		NodeListIter iAnchor =
-			std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), anchorHunter );
+	const dom::NodeList& nodes = pJointNode->getNodes();
 
-		YAKE_ASSERT( iAnchor != nodes.end() ).error( "Anchor was not defined for universal joint!" );
+	// Looking for anchor
+	NodeHunter anchorHunter( "anchor" );
+	NodeListIter iAnchor =
+	    std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), anchorHunter );
 
-		// Looking for axis
-		NodeHunter axisHunter( "axis" );
-		NodeListIter iAxis0 =
-			std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), axisHunter );
+	YAKE_ASSERT( iAnchor != nodes.end() ).error( "Anchor was not defined for universal joint!" );
 
-		YAKE_ASSERT( iAxis0 != nodes.end() ).error( "Axis0 was not defined for universal joint!" );
+	// Looking for axis
+	NodeHunter axisHunter( "axis" );
+	NodeListIter iAxis0 =
+	    std::find_if<NodeListIter, NodeHunter>( nodes.begin(), nodes.end(), axisHunter );
 
-		NodeListIter iAxis1 =
-			std::find_if<NodeListIter, NodeHunter>( iAxis0 + 1, nodes.end(), axisHunter );
+	YAKE_ASSERT( iAxis0 != nodes.end() ).error( "Axis0 was not defined for universal joint!" );
 
-		YAKE_ASSERT( iAxis1 != nodes.end() ).error( "Axis1 was not defined for universal joint!" );
+	NodeListIter iAxis1 =
+	    std::find_if<NodeListIter, NodeHunter>( iAxis0 + 1, nodes.end(), axisHunter );
 
-		Vector3 anchor;
-		Vector3 axis0;
-		Vector3 axis1;
+	YAKE_ASSERT( iAxis1 != nodes.end() ).error( "Axis1 was not defined for universal joint!" );
 
-		readAnchor( *iAnchor, anchor, rJointTransform );
-		readAxis( *iAxis0, axis0, rJointTransform );
-		readAxis( *iAxis1, axis1, rJointTransform );
+	math::Vector3 anchor;
+	math::Vector3 axis0;
+	math::Vector3 axis1;
 
-		IJoint::DescBase* desc = new IJoint::DescUniversal( NULL, NULL, axis0, axis1, anchor );
+	readAnchor( *iAnchor, anchor, rJointTransform );
+	readAxis( *iAxis0, axis0, rJointTransform );
+	readAxis( *iAxis1, axis1, rJointTransform );
 
-		YAKE_LOG( "XODE: finished processing universal joint description." );
+	IJoint::DescBase* desc = new IJoint::DescUniversal( NULL, NULL, axis0, axis1, anchor );
 
-		return desc;
-	}
+	YAKE_LOG( "XODE: finished processing universal joint description." );
 
-	//------------------------------------------------------
-	void XODEParser::readAnchor( const NodeSharedPtr pAnchorNode,
-		Vector3& rAnchor,
-		Transform& rJointTransform )
-	{
-		YAKE_LOG( "XODE: reading anchor..." );
+	return desc;
+    }
 
-		rAnchor.x = StringUtil::parseReal( pAnchorNode->getAttributeValueAs<String>( "x" ) );
-		rAnchor.y = StringUtil::parseReal( pAnchorNode->getAttributeValueAs<String>( "y" ) );
-		rAnchor.z = StringUtil::parseReal( pAnchorNode->getAttributeValueAs<String>( "z" ) );
+    //------------------------------------------------------
+    void XODEParser::readAnchor( const NodeSharedPtr pAnchorNode,
+	    math::Vector3& rAnchor,
+	    const Transform& rJointTransform )
+    {
+	YAKE_LOG( "XODE: reading anchor..." );
 
-		rAnchor = rJointTransform.position_ + rJointTransform.rotation_*( rJointTransform.scale_*rAnchor );
-	}
+	rAnchor.x = StringUtil::parseReal( pAnchorNode->getAttributeValueAs<String>( "x" ) );
+	rAnchor.y = StringUtil::parseReal( pAnchorNode->getAttributeValueAs<String>( "y" ) );
+	rAnchor.z = StringUtil::parseReal( pAnchorNode->getAttributeValueAs<String>( "z" ) );
 
-	//------------------------------------------------------
-	void XODEParser::readAxis(	const NodeSharedPtr pAxisNode,
-		Vector3& rAxis,
-		Transform& rJointTransform )
-	{
-		YAKE_LOG( "XODE: reading axis..." );
+	rAnchor = rJointTransform.position_ + rJointTransform.rotation_*( rJointTransform.scale_*rAnchor );
+    }
 
-		rAxis.x = StringUtil::parseReal( pAxisNode->getAttributeValueAs<String>( "x" ) );
-		rAxis.y = StringUtil::parseReal( pAxisNode->getAttributeValueAs<String>( "y" ) );
-		rAxis.z = StringUtil::parseReal( pAxisNode->getAttributeValueAs<String>( "z" ) );
+    //------------------------------------------------------
+    void XODEParser::readAxis(	const NodeSharedPtr pAxisNode,
+	    math::Vector3& rAxis,
+	    const Transform& rJointTransform )
+    {
+	YAKE_LOG( "XODE: reading axis..." );
 
-		/// TODO What about all other axis params?
+	rAxis.x = StringUtil::parseReal( pAxisNode->getAttributeValueAs<String>( "x" ) );
+	rAxis.y = StringUtil::parseReal( pAxisNode->getAttributeValueAs<String>( "y" ) );
+	rAxis.z = StringUtil::parseReal( pAxisNode->getAttributeValueAs<String>( "z" ) );
 
-		rAxis = rJointTransform.rotation_*rAxis;
-	}
+	/// TODO What about all other axis params?
 
+	rAxis = rJointTransform.rotation_*rAxis;
+    }
+
 } //xode
 } //parser
 } //data

Modified: trunk/yake/src/yapp/model/Makefile.am
===================================================================
--- trunk/yake/src/yapp/model/Makefile.am	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/model/Makefile.am	2006-03-19 17:54:00 UTC (rev 1302)
@@ -3,5 +3,6 @@
 
 lib_LTLIBRARIES = libyappModel.la
 libyappModel_la_SOURCES = yakeComplexModel.cpp yakeGraphical.cpp \
-	yakePhysical.cpp yakeActor.cpp yakeModelLink.cpp yakeModelMovableLink.cpp
+		yakePhysical.cpp yakeActor.cpp yakeModelLink.cpp yakeModelMovableLink.cpp \
+	yakeGraphicalDataImporter.cpp yakePhysicalDataImporter.cpp
 libyappModel_la_LIBADD = $(top_builddir)/src/yapp/loader/libyappLoader.la

Modified: trunk/yake/src/yapp/model/yakeComplexModel.cpp
===================================================================
--- trunk/yake/src/yapp/model/yakeComplexModel.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/model/yakeComplexModel.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -187,17 +187,23 @@
 		YAKE_ASSERT( pTarget );
 		if (!pSource || !pTarget)
 			return 0;
-		ModelMovableLink* pLink = 0;
+
+		ModelMovableLink* pLink = NULL;
 		MovableLinkMap::iterator itFind = mMovableLinkMap.find( pSource );
-		if (itFind == mMovableLinkMap.end())
+		
+		if (itFind != mMovableLinkMap.end())
 		{
+			YAKE_LOG_INFORMATION( "It seems that link already exists. Trying to determine..." );
+			pLink = dynamic_cast<ModelMovableLink*>( itFind->second );
+		}
+		
+		if ( pLink == NULL )
+		{
 			pLink = new ModelMovableLink();
 			pLink->setSource( pSource );
 			mMovableLinkMap.insert( std::make_pair(pSource,pLink) );
 			mControllers.push_back( SharedPtr<IObjectController>(pLink) );
 		}
-		else
-			pLink = itFind->second;
 		
 		pLink->subscribeToPositionChanged( pTarget );
 		pLink->subscribeToOrientationChanged( pTarget );
@@ -206,13 +212,61 @@
 	}
 
 	//-----------------------------------------------------
+	ModelMovableWorldLink* Model::addWorldLink( Movable* pSource, Movable* pTarget )
+	{
+		YAKE_ASSERT( pSource != NULL ).warning( "Source movable doesn't exist" );
+		YAKE_ASSERT( pTarget != NULL ).warning( "Target movable doesn't exist" );
+
+		if (!pSource || !pTarget)
+			return 0;
+
+		ModelMovableWorldLink* pLink = NULL;
+		MovableLinkMap::iterator itFind = mMovableLinkMap.find( pSource );
+		
+		if ( itFind != mMovableLinkMap.end() )
+		{
+			YAKE_LOG_INFORMATION( "It seems that link already exists. Trying to determine..." );
+			pLink = dynamic_cast<ModelMovableWorldLink*>( itFind->second );
+		}
+		
+		if ( pLink == NULL )
+		{
+			YAKE_LOG_INFORMATION( "This is new link. Creating." );
+
+			pLink = new ModelMovableWorldLink();
+			pLink->setSource( pSource );
+			mMovableLinkMap.insert( std::make_pair(pSource,pLink) );
+			mControllers.push_back( SharedPtr<IObjectController>(pLink) );
+
+			YAKE_LOG_INFORMATION( "Controller created." );
+		}
+		
+		YAKE_LOG_INFORMATION( "Subscribing to controller signals..." );
+
+		pLink->subscribeToPositionChanged( pTarget );
+		pLink->subscribeToOrientationChanged( pTarget );
+
+		YAKE_LOG_INFORMATION( "Done. Link setup." );
+		return pLink;
+	}
+
+	//-----------------------------------------------------
 	void Model::updatePhysics( real timeElapsed )
 	{
+	    // updating all body affectors applied to all physicals...
+	    PhysicalMap::iterator ph_end = mPhysicals.end();
+	    for( PhysicalMap::iterator ph = mPhysicals.begin(); ph != ph_end; ++ph )
+	    {
+		ph->second->updateAffectors( timeElapsed );
+	    }
 	}
 	
 	//-----------------------------------------------------
 	void Model::updateGraphics( real timeElapsed )
 	{
+		// FIXME this assumes model does have only graphics controllers!
+		// So should there be some separate updateControllers method?
+		//
 		for (CtrlrList::const_iterator it = mControllers.begin(); it != mControllers.end(); ++it)
 		{
 			(*it)->update( timeElapsed );
@@ -222,3 +276,4 @@
 } // ns complex
 } // ns model
 } // ns yake
+

Modified: trunk/yake/src/yapp/model/yakeModelMovableLink.cpp
===================================================================
--- trunk/yake/src/yapp/model/yakeModelMovableLink.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/model/yakeModelMovableLink.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -37,16 +37,24 @@
 	{
 	}
 	SignalConnection ModelMovableLink::subscribeToPositionChanged( Movable* pMovable )
-	{
+	{	
+		const Vector3 srcPos = getSource()->getPosition();
+		pMovable->setPosition( srcPos );
+
 		return mPositionSignal.connect( Bind1( &Movable::setPosition, pMovable ) );
 	}
+
 	SignalConnection ModelMovableLink::subscribeToOrientationChanged( Movable* pMovable )
 	{
+		const Quaternion srcOrientation = getSource()->getOrientation();
+		pMovable->setOrientation( srcOrientation );
+
 		return mOrientationSignal.connect( Bind1( &Movable::setOrientation, pMovable ) );
 	}
+
 	void ModelMovableLink::update( real timeElapsed )
 	{
-		Movable * pSource = getSource();
+		const Movable* pSource = getSource();
 		YAKE_ASSERT( pSource ).debug("no update source -> no updates");
 		if (!pSource)
 			return;
@@ -64,5 +72,48 @@
 		}
 	}
 
+	YAKE_REGISTER_CONCRETE( ModelMovableWorldLink );
+	ModelMovableWorldLink::ModelMovableWorldLink()
+	{
+	}
+	SignalConnection ModelMovableWorldLink::subscribeToPositionChanged( Movable* pMovable )
+	{	
+		const Vector3 srcPos = getSource()->getDerivedPosition();
+		pMovable->setPosition( srcPos );
+
+		return mPositionSignal.connect( Bind1( &Movable::setPosition, pMovable ) );
+	}
+
+	SignalConnection ModelMovableWorldLink::subscribeToOrientationChanged( Movable* pMovable )
+	{
+		const Quaternion srcOrientation = getSource()->getDerivedOrientation();
+		pMovable->setOrientation( srcOrientation );
+
+		return mOrientationSignal.connect( Bind1( &Movable::setOrientation, pMovable ) );
+	}
+
+	void ModelMovableWorldLink::update( real timeElapsed )
+	{
+		const Movable* pSource = getSource();
+
+		YAKE_ASSERT( pSource ).error("no update source -> no updates");
+
+		if ( pSource == NULL )
+			return;
+
+		Vector3 position = pSource->getDerivedPosition();
+		if (mLastPosition != position)
+		{
+			mPositionSignal( position );
+			mLastPosition = position;
+		}
+		Quaternion orientation = pSource->getDerivedOrientation();
+		if (mLastOrientation != orientation)
+		{
+			mOrientationSignal( orientation );
+			mLastOrientation = orientation;
+		}
+	}
 }
 }
+

Modified: trunk/yake/src/yapp/model/yakePhysical.cpp
===================================================================
--- trunk/yake/src/yapp/model/yakePhysical.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/model/yakePhysical.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -93,5 +93,34 @@
 			return itFind->second;
 	}
 
+	//-----------------------------------------------------
+	void Physical::addAffector( SharedPtr<physics::IBodyAffector> pAffector, const String& rName )
+	{
+	    mAffectors.push_back( std::make_pair( rName, pAffector ) );
+	}
+
+	//-----------------------------------------------------
+	void Physical::updateAffectors( real timeElapsed )
+	{
+		AffectorList::iterator aff_end = mAffectors.end();
+		for( AffectorList::iterator af = mAffectors.begin(); af != aff_end; ++af )
+		{
+			physics::IActorPtr actor = getActorByName( (*af).first );
+
+			YAKE_ASSERT( actor != NULL ).warning( "affector refers to non-existent actor" );
+			if ( actor == NULL )
+				continue;
+
+			physics::IBody* body = actor->getBodyPtr();
+
+			YAKE_ASSERT( body != NULL ).warning( "trying to apply affector to actor without a body" );
+			if ( body != NULL )
+			{
+				(*af).second->applyTo( *body, timeElapsed );
+			}
+		}
+	}
+
 }
 }
+

Modified: trunk/yake/src/yapp/model/yakePhysicalDataImporter.cpp
===================================================================
--- trunk/yake/src/yapp/model/yakePhysicalDataImporter.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/model/yakePhysicalDataImporter.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -39,6 +39,10 @@
 
 		// create actor
 		physics::IActorPtr pDynActor = physicalWorld_->createActor( physics::ACTOR_DYNAMIC );
+
+		// we need to zero out the mass..
+		pDynActor->getBodyPtr()->setMass( 0 );
+
 		YAKE_ASSERT( pDynActor != NULL ).error( "Failed to create actor!" );
 
 		// set transform. TODO what about scale?
@@ -75,6 +79,8 @@
 		}
 		else
 		{
+			YAKE_LOG( "XODE listener: geom parent not found... creating static actor. " );
+		    
 			// create static actor
 			parentActor = physicalWorld_->createActor( physics::ACTOR_STATIC );
 
@@ -175,10 +181,11 @@
 
 			// search for connected actors
 
-			YAKE_LOG( "XODE listener: searching for actors [0]: " + desc.parentName_ + ", [1]: " + desc.otherBody_ );
+			YAKE_LOG( "XODE listener: processing " + desc.name_ + " ... " );
+			YAKE_LOG( "XODE listener: searching for actors [0]: " + desc.body1_ + ", [1]: " + desc.body2_ );
 
-			ActorMap::iterator actor0 = actors_.find( desc.parentName_ );
-			ActorMap::iterator actor1 = actors_.find( desc.otherBody_ );
+			ActorMap::iterator actor0 = actors_.find( desc.body1_ );
+			ActorMap::iterator actor1 = actors_.find( desc.body2_ );
 
 			if ( actor0 == actors_.end() || actor1 == actors_.end() )
 			{
@@ -204,3 +211,4 @@
 
 } // model
 } // yake
+

Modified: trunk/yake/src/yapp/plugins/ceguiOgreRendererAdapter/plugin.cpp
===================================================================
--- trunk/yake/src/yapp/plugins/ceguiOgreRendererAdapter/plugin.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/plugins/ceguiOgreRendererAdapter/plugin.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -72,13 +72,24 @@
 		//HACK FIXME getAutoCreatedWindow assumes window was autocreated!
 		Ogre::RenderWindow* pWin = Ogre::Root::getSingleton().getAutoCreatedWindow();
 		YAKE_ASSERT( pWin ).error("Need a valid render window!");
+// for Ogre 1.1.0 "Dagon" compatibility
+#if OGRE_VERSION_MINOR >= 1 
+
 		mGUIRenderer = new CEGUI::OgreCEGUIRenderer(
 			pWin, 
 			Ogre::RENDER_QUEUE_OVERLAY, 
 			true, 
 			3000,
+			Ogre::Root::getSingleton().getSceneManager( "YakeSM" ) );
+#else
+		mGUIRenderer = new CEGUI::OgreCEGUIRenderer(
+			pWin, 
+			Ogre::RENDER_QUEUE_OVERLAY, 
+			true, 
+			3000,
 			Ogre::ST_GENERIC );
-			//Ogre::Root::getSingleton()._getCurrentSceneManager());
+#endif
+		
 	} catch (Ogre::Exception& e)
 	{
 		YAKE_EXCEPT("Failed to initialise CEGUI adapter!\n" + yake::String(e.getFullDescription().c_str()));
@@ -99,3 +110,4 @@
 {
 	return mGUIRenderer;
 }
+

Added: trunk/yake/src/yapp/plugins/terrainPhysMgr/TerrainOdeActor.cpp
===================================================================
--- trunk/yake/src/yapp/plugins/terrainPhysMgr/TerrainOdeActor.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/plugins/terrainPhysMgr/TerrainOdeActor.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -0,0 +1,151 @@
+/*
+ ------------------------------------------------------------------------------------
+ This file is part of YAKE
+ Copyright  2004 The YAKE Team
+ For the latest information visit http://www.yake.org 
+ ------------------------------------------------------------------------------------
+ This program is free software; you can redistribute it and/or modify it under
+ the terms of the GNU Lesser General Public License as published by the Free Software
+ Foundation; either version 2 of the License, or (at your option) any later
+ version.
+
+ This program is distributed in the hope that it will be useful, but WITHOUT
+ ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+ FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+ You should have received a copy of the GNU Lesser General Public License along with
+ this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+ Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+ http://www.gnu.org/copyleft/lesser.txt.
+ ------------------------------------------------------------------------------------
+ If you are interested in another license model contact the Yake Team via
+ E-Mail: team at yake.org.
+ For more information see the LICENSE file in the root directory of the
+ source code distribution.
+ ------------------------------------------------------------------------------------
+*/
+
+#include <algorithm>
+
+#include <yake/base/yake.h>
+#include <yake/physics/yakePhysicsPrerequisites.h>
+
+#include <yapp/plugins/terrainPhysMgr/TerrainOdeActor.h>
+#include <yapp/plugins/terrainPhysMgr/TerrainOdeShape.h>
+
+namespace yake
+{
+	namespace physics
+	{
+		TerrainCollisionDetectionActor::TerrainCollisionDetectionActor ( OdeWorld* pOdeWorld ) : OdeActor( pOdeWorld, false )
+		{
+			this->mEnterCollisionSignal.connect( Bind1( &TerrainCollisionDetectionActor::onCollision, this ) );
+		}
+		//------------------------------------------------------------------------------------
+
+		TerrainCollisionDetectionActor::~TerrainCollisionDetectionActor ()
+		{}
+		//------------------------------------------------------------------------------------
+
+		void TerrainCollisionDetectionActor::createTerrainCollisionDetectionShape( const math::Vector3& rDimensions,
+		        const math::Vector3& rPosition, Ogre::PagingLandScapeTileInfo* tileInfo )
+		{
+			OdeTerrainCollisionBox * pBox = new OdeTerrainCollisionBox( mOdeWorld->_getOdeSpace(),
+			                                this,
+			                                rDimensions.x,
+			                                rDimensions.y,
+			                                rDimensions.z,
+			                                tileInfo );
+
+			pBox->setPosition( rPosition );
+			pBox->setOrientation( math::Quaternion::kIdentity );
+
+			//set material NULL for awoiding collisions with this helper shape
+			pBox->setMaterial( NULL );
+
+			mShapes.push_back( SharedPtr<OdeTerrainCollisionBox>( pBox ) );
+			
+  			std::cerr << "Tile Ode BOX derived pos = " << pBox->getDerivedPosition() << std::endl;
+			std::cerr << "Tile Ode BOX pos = " << pBox->getPosition()<< std::endl;
+			std::cerr << "Tile Ode BOX dims = " << rDimensions << std::endl;
+			std::cerr << "--------------------------------\n";
+		}
+		//------------------------------------------------------------------------------------
+
+		void TerrainCollisionDetectionActor::createTerrainCollisionShape( const math::Vector3& rPosition, TriangleMeshDesc::VertexVector & vertices,
+			TriangleMeshDesc::IndexVector & indexes)
+		{
+			std::cerr<<"Parent SN pos = "<<rPosition<<std::endl;
+			std::cerr<<"vertex number = "<<vertices.size()<<std::endl;
+			std::cerr<<"index number = "<<indexes.size()<<std::endl;
+			
+			TriangleMeshDesc meshDescriptor( vertices, indexes );
+
+			IShape::TriMeshDesc * pTriMeshDesc = new IShape::TriMeshDesc( meshDescriptor );
+
+			TriangleMeshId id = pTriMeshDesc->trimeshId_;
+
+			// build Triangle mesh by TriMeshDesc
+			if ( id == kTriangleMeshIdNone )
+			{
+				YAKE_LOG("Creating triangle mesh id");
+				id = mOdeWorld->createTriangleMesh( pTriMeshDesc->trimesh_ );
+				YAKE_ASSERT( id != kTriangleMeshIdNone );
+			}
+			
+ 			OdeTriMesh::MeshData data = mOdeWorld->getMeshDataById( id );
+				
+			//finaly create ODE trimesh object
+ 			OdeTriMesh * pMesh = new OdeTriMesh( mOdeWorld->_getOdeSpace(), this, data.id );
+			YAKE_ASSERT( pMesh ).error( "Mesh with such id wasn't found!" );
+			
+			//setting material
+			IMaterial* pMaterial =  this->getCreator()->getMaterial( "default" );
+
+ 			OdeMaterial * tmpMaterial = dynamic_cast< OdeMaterial*>( pMaterial);
+			
+			YAKE_ASSERT( tmpMaterial).error( "null material!" );
+
+			pMesh->setMaterial( tmpMaterial);
+
+			pMesh->setPosition( rPosition);
+			pMesh->setOrientation( math::Quaternion::kIdentity );
+
+			mShapes.push_back( SharedPtr<OdeGeom>( pMesh) );
+		}
+		//------------------------------------------------------------------------------------
+
+		void TerrainCollisionDetectionActor::onCollision( const ActorCollisionInfo & collisionInfo )
+		{	
+// 			OdeActor * pA = dynamic_cast<OdeActor*>( collisionInfo.pThis );
+//  			OdeActor * pB = dynamic_cast<OdeActor*>( collisionInfo.pOther );
+			
+// 			std::cerr<<"Actor "<<this->actorName<<" collided with actor "<<pB->actorName<<std::endl;
+			
+// 			TerrainCollisionDetectionActor * pA = dynamic_cast<TerrainCollisionDetectionActor*>( collisionInfo.pOther );
+// 			TerrainCollisionDetectionActor * pB = dynamic_cast<TerrainCollisionDetectionActor*>( collisionInfo.pOther );
+			
+// 			if( pA || pB)
+//  			{
+//    				YAKE_LOG("AutoCollision detected!");
+//  				return;
+//  			}
+  			
+			OdeTerrainCollisionBox * terrainCollisionBbox = dynamic_cast< OdeTerrainCollisionBox *>( collisionInfo.pThisShape_ );
+
+			if ( terrainCollisionBbox == NULL )
+				terrainCollisionBbox = dynamic_cast< OdeTerrainCollisionBox *>( collisionInfo.pOtherShape_ );
+			if( terrainCollisionBbox == NULL)
+			{
+//    				YAKE_LOG("Can't get proper collision bbox!" );
+				return;
+			}
+			
+			Ogre::PagingLandScapeTileInfo * tileInfo = terrainCollisionBbox->getTileInfo();
+
+  			TerrainPhysicsManager::instance().processTile( tileInfo );
+		}
+		//------------------------------------------------------------------------------------
+		
+} // physics
+} // yake

Added: trunk/yake/src/yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.cpp
===================================================================
--- trunk/yake/src/yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -0,0 +1,364 @@
+#include <vector>
+
+#include <yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.h>
+
+#include <yake/base/yake.h>
+#include <yake/plugins/physicsODE/OdeWorld.h>
+#include <yake/plugins/physicsODE/OdeBody.h>
+#include <yake/plugins/physicsODE/OdeActor.h>
+#include <yake/plugins/physicsODE/OdeShapes.h>
+
+#include <yapp/plugins/terrainPhysMgr/TerrainOdeActor.h>
+#include <yapp/plugins/terrainPhysMgr/TerrainOdeShape.h>
+
+#include <yake/plugins/graphicsOgre/yakePCH.h>
+
+#include "OgrePagingLandScapeOptions.h"
+#include "OgrePagingLandScapeListener.h"
+#include "OgrePagingLandScapeTile.h"
+#include "OgrePagingLandScapeTileInfo.h"
+#include "OgrePagingLandScapeIndexBuffer.h"
+#include "OgrePagingLandScapeRenderable.h"
+#include "OgrePagingLandScapeTileManager.h"
+#include "OgrePagingLandScapeRaySceneQuery.h"
+
+using namespace std;
+using namespace Ogre;
+
+namespace yake
+{
+	namespace physics
+	{
+		PLSMTerrainPhysicsManager::PLSMTerrainPhysicsManager( ) :
+				sceneManager ( 0 ), pageLoadListener( 0 ), terrainCollisionDetectionActor( 0 ),  rayQuery(0),
+				graphicsWorld( 0)
+		{}
+		//---------------------------------------------------------------------------------------------
+
+		PLSMTerrainPhysicsManager::~PLSMTerrainPhysicsManager()
+		{
+			sceneManager->destroyQuery( rayQuery);
+			sceneManager->setOption( "removeLoadPageListener", pageLoadListener );
+			odeWorld->destroyActor( terrainCollisionDetectionActor );
+		}
+		//---------------------------------------------------------------------------------------------
+		
+		void PLSMTerrainPhysicsManager::init( Ogre::PagingLandScapeSceneManager * _sceneManager,
+				IWorld *_odeWorld, graphics::IWorld* _graphicsWorld)
+		{
+			this->graphicsWorld = _graphicsWorld;
+			
+			YAKE_LOG("Inititalizing Terrain Physics Manager...");
+			
+			this->odeWorld = dynamic_cast<OdeWorld *>( _odeWorld );
+
+			//add to physical world our new terrain actor
+			terrainCollisionDetectionActor = new TerrainCollisionDetectionActor( odeWorld );
+
+			odeWorld->addActor( terrainCollisionDetectionActor );
+
+			sceneManager = _sceneManager;
+
+			//create PageLoading event listener
+			pageLoadListener = new Ogre::PagingLandscapeDelegate( &( *this ),
+			                   &PLSMTerrainPhysicsManager::pageLoaded );
+
+			tileLoadListener = new Ogre::PagingLandscapeDelegate( &( *this ),
+			                   &PLSMTerrainPhysicsManager::tileLoaded );
+
+			// sceneManager->setOption( "addLoadPageListener", pageLoadListener );
+			sceneManager->setOption( "addLoadTileListener", tileLoadListener );
+			
+			rayQuery = sceneManager->createRayQuery( Ogre::Ray(Ogre::Vector3::ZERO, Ogre::Vector3::NEGATIVE_UNIT_Y));
+			
+			YAKE_ASSERT( rayQuery);
+		}
+		//---------------------------------------------------------------------------------------------
+
+		void PLSMTerrainPhysicsManager::tileLoaded( Ogre::PagingLandscapeEvent* event )
+		{
+			YAKE_LOG("Tile loaded event handler entered...");
+			//recover PLSM2's tile object
+			int pageX = event->mPagex;
+			int pageZ = event->mPagez;
+
+			Ogre::PagingLandScapePage * page = sceneManager->getPageManager()->getPage( pageX, pageZ );
+
+			PagingLandScapeTile * tile = page->getTile( event->mTilex, event->mTilez );
+
+			createCollisionBoundingBox( tile );
+		}
+		//---------------------------------------------------------------------------------------------
+
+		void PLSMTerrainPhysicsManager::pageLoaded( Ogre::PagingLandscapeEvent* event )
+		{
+			YAKE_LOG("Page loaded event handler entered...");
+			//recover PLSM2's tile object
+			int pageX = event->mPagex;
+			int pageZ = event->mPagez;
+			Ogre::PagingLandScapePage * page = sceneManager->getPageManager()->getPage( pageX, pageZ );
+
+			processAllTilesInPage( page, pageX, pageZ );
+		}
+		//---------------------------------------------------------------------------------------------
+
+		void PLSMTerrainPhysicsManager::processAllTilesInPage( Ogre::PagingLandScapePage * page, int pageX, int pageZ )
+		{
+			int tileQuantity = sceneManager->getOptions()->NumTiles;
+
+			PagingLandScapeTile * tile = 0;
+
+			for ( int i = 0; i < tileQuantity; ++i )
+			{
+				for ( int j = 0; j < tileQuantity; ++j )
+				{
+					tile = page->getTile( i, j );
+
+					createCollisionBoundingBox( tile );
+				}
+			}
+		}
+		//---------------------------------------------------------------------------------------------
+
+		void PLSMTerrainPhysicsManager::createCollisionBoundingBox( Ogre::PagingLandScapeTile* tile )
+		{
+ 			if ( find( alreadyLoadedCollisionDetectionTiles.begin(), alreadyLoadedCollisionDetectionTiles.end(), tile ) !=
+						 alreadyLoadedCollisionDetectionTiles.end() )
+ 				return;
+ 			else
+ 				alreadyLoadedCollisionDetectionTiles.push_back( tile);
+
+			Ogre::AxisAlignedBox tileBbox = tile->getWorldBbox();
+
+			Ogre::Vector3 tmpVector = tileBbox.getMaximum() - tileBbox.getMinimum();
+			math::Vector3 bboxDims = VEC_OGRE2YAKE( tmpVector );
+			
+			tmpVector = tile->getCenter();
+ 			math::Vector3 bboxCenter = VEC_OGRE2YAKE( tmpVector );
+  			
+ 			terrainCollisionDetectionActor ->createTerrainCollisionDetectionShape( bboxDims, bboxCenter, tile->getInfo() );
+			
+			 ///uncoment to create a tile visual BBox
+			if( graphicsWorld != 0)
+			{
+				graphics::ISceneNode* pTerrainSN = graphicsWorld->createSceneNode();
+	
+				graphics::IEntity* pTerrainE = graphicsWorld->createEntity( "box_1x1x1.mesh" );
+	
+				pTerrainE->setMaterial("box");
+	
+				pTerrainSN->attachEntity( pTerrainE );
+	
+				pTerrainSN->setScale( bboxDims );
+	
+				pTerrainSN->setPosition( bboxCenter );
+	
+				model::Graphical* pG = new model::Graphical();
+				
+				pG->addSceneNode( pTerrainSN );
+			}
+		}
+		//---------------------------------------------------------------------------------------------
+
+		void PLSMTerrainPhysicsManager::convertIndexDataForOde( Ogre::IndexData* indexData, TriangleMeshDesc::IndexVector &
+			destBuffer) 
+		{
+			// code snipet from OgreOde project
+			Ogre::HardwareIndexBufferSharedPtr ibuf = indexData->indexBuffer;
+			
+			bool use32bitindexes = ( ibuf->getType() == Ogre::HardwareIndexBuffer::IT_32BIT);
+			
+			unsigned short* pShort = 0;
+			unsigned int* pInt = 0;
+
+			if (use32bitindexes) 
+				pInt = static_cast<unsigned int*>(ibuf->lock( Ogre::HardwareBuffer::HBL_READ_ONLY));
+			else 
+				pShort = static_cast<unsigned short*>(ibuf->lock( Ogre::HardwareBuffer::HBL_READ_ONLY));
+
+			size_t numTris = indexData->indexCount / 3;
+			size_t index_offset = 0;
+			
+			destBuffer.resize( indexData->indexCount);
+						
+			for( size_t k = 0; k < numTris; ++k)
+			{
+				unsigned int vindex = use32bitindexes? *pInt++ : *pShort++;
+				destBuffer[index_offset + 0] = vindex;
+				
+				vindex = use32bitindexes? *pInt++ : *pShort++;
+				destBuffer[index_offset + 1] = vindex;
+				
+				vindex = use32bitindexes? *pInt++ : *pShort++;
+				destBuffer[index_offset + 2] = vindex;
+
+				index_offset += 3;
+			}
+			
+			ibuf->unlock();
+		}
+		//------------------------------------------------------------------------------------
+
+		class OdeVertexConverter
+		{
+			public:
+				OdeVertexConverter( Ogre::Vector3 & parentSNPosition) : pSN( parentSNPosition) {};
+				
+				math::Vector3 operator()( const Ogre::Vector3 & val)
+				{
+					Ogre::Vector3 result = val - pSN;
+					
+					return VEC_OGRE2YAKE( result);
+				}
+				//------------------------------------------------------------------------------------
+
+			protected:
+				Ogre::Vector3 pSN;
+		};
+		//------------------------------------------------------------------------------------
+
+		void PLSMTerrainPhysicsManager::processTile( Ogre::PagingLandScapeTileInfo * tileInfo )
+		{
+			Ogre::PagingLandScapePage * page = 
+					sceneManager->getPageManager()->getPage( tileInfo->pageX, tileInfo->pageZ );
+
+			YAKE_ASSERT( page ).error( "Page pointer is invalid!" );
+
+			Ogre::PagingLandScapeTile * tile = page->getTile( tileInfo->tileX, tileInfo->tileZ ) ;
+
+			YAKE_ASSERT( tile ).error( "Tile pointer is invalid!" );
+
+ 			if ( find( alreadyLoadedCollisionTiles.begin(), alreadyLoadedCollisionTiles.end(), tile ) !=
+				alreadyLoadedCollisionTiles.end() )
+ 				return; // nothing to be done because tile already processed 
+ 			else
+			{
+// 				YAKE_LOG( ( "--->>>>Got new tile for creating ode trimesh<<<<---" ) );
+// 				std::cerr << "Page ( " << tileInfo->pageX << ", " << tileInfo->pageZ << ")" << std::endl;
+// 				std::cerr << "Tile ( " << tileInfo->tileX << ", " << tileInfo->tileZ << ")" << std::endl;
+
+				alreadyLoadedCollisionTiles.push_back( tile );
+			}
+			
+			Ogre::PagingLandScapeRenderable* rend = tile->getRenderable();
+
+			YAKE_ASSERT( rend ).error( "Renderable pointer is invalid!" );
+
+			vector< void*> params;
+			int renderLevel = 0;
+
+			params.push_back( &tileInfo->pageX );
+			params.push_back( &tileInfo->pageZ );
+			params.push_back( &tileInfo->tileX );
+			params.push_back( &tileInfo->tileZ );
+			params.push_back( &renderLevel );
+
+			sceneManager->getOption( "PageGetTileVertexData_2", &params );
+			
+			//get tile parenent SN position
+			Ogre::SceneNode * sceneNode = tile->getSceneNode();
+			Ogre::Vector3 parentSNPosition = sceneNode->getWorldPosition();
+		
+			// get vertices
+			int * numVtx = ( ( int* ) params[ 5 ] );
+			Ogre::Vector3 * ogreVertices = ( ( Ogre::Vector3* ) params[ 6 ] );
+			
+			TriangleMeshDesc::VertexVector vertices( *numVtx, math::Vector3( 0, 0, 0 ) );
+			
+			std::transform( ogreVertices, ogreVertices + *numVtx, vertices.begin(), OdeVertexConverter( parentSNPosition) );
+
+			// get  indexes
+			Ogre::IndexData* indexData = ( ( Ogre::IndexData* ) params[ 7 ] );
+			YAKE_ASSERT( indexData->indexCount).error( "There is no indexes!");
+			
+			TriangleMeshDesc::IndexVector indexes;
+			convertIndexDataForOde( indexData, indexes);
+					
+			terrainCollisionDetectionActor->createTerrainCollisionShape( VEC_OGRE2YAKE( parentSNPosition), vertices, indexes);
+			
+			delete[] ogreVertices;
+		}
+		//------------------------------------------------------------------------------------
+		
+		real PLSMTerrainPhysicsManager::getHeightAt( const math::Vector3& position)
+		{
+			return getHeightAt( VEC_YAKE2OGRE( position));
+		}
+		//------------------------------------------------------------------------------------
+		
+		real PLSMTerrainPhysicsManager::getHeightAt( const Ogre::Vector3& position)
+		{
+			// register ray query for getHeightAt function
+			ray.setOrigin( position);
+			ray.setDirection( Ogre::Vector3::UNIT_Y);
+	
+			rayQuery->setRay( ray);
+			rayQuery->setQueryMask( Ogre::RSQ_Height);
+			
+			Ogre::RaySceneQueryResult & result = rayQuery->execute(); 
+			Ogre::RaySceneQueryResult::iterator i = result.begin(); 
+ 			
+			Ogre::Real terrainHeight;
+			
+			if (i != result.end() && i->worldFragment) 
+				terrainHeight = i->worldFragment->singleIntersection.y;
+			
+			std::cerr<<"Terrain Height  =  "<< terrainHeight;
+			
+			return position.y - terrainHeight;//helperQueryListener.heightAt;
+		}
+		//------------------------------------------------------------------------------------
+
+		Ogre::AxisAlignedBox PLSMTerrainPhysicsManager::calcActorAABB(  IActor * _actor)
+		{
+			OdeActor * actor = dynamic_cast<OdeActor * >( _actor);
+			YAKE_ASSERT( actor).error( "Wrong actor type - expected OdeActor...");
+			
+			IShapePtrList shapesList = actor->getShapes();
+			
+			ConstDequeIterator< IShapePtrList> itShape( shapesList );
+
+			Ogre::AxisAlignedBox resultAABB;
+			
+			// iterate over all shapes and found their containing AABB
+			while (itShape.hasMoreElements())
+			{
+				const physics::IShapePtr pShape = itShape.getNext();
+			
+				OdeGeom * odeGeom = dynamic_cast<OdeGeom*>( pShape);
+				YAKE_ASSERT( odeGeom).error( "Wrong shape type - expected OdeGeom...");
+				
+				dGeomID odeGeomID = odeGeom->_getOdeGeomID();
+				
+				dReal odeAABB[6];
+				dGeomGetAABB( odeGeomID, odeAABB); // catch ODE AABB
+				
+				Ogre::AxisAlignedBox  ogreAABB( odeAABB[0], odeAABB[2], odeAABB[4], //mx, my, mz 
+						odeAABB[1], odeAABB[3], odeAABB[5]); //Mx, My, Mz
+				
+				resultAABB.merge( ogreAABB);
+			}
+			return resultAABB;
+		}
+		//------------------------------------------------------------------------------------
+
+		void PLSMTerrainPhysicsManager::placeActorOnTerrain( const math::Vector3 & position, IActor * _actor)
+		{
+			//Actualy, on the ground we will place actor AABB 
+			Ogre::AxisAlignedBox actorAABB = calcActorAABB( _actor) ; 
+			
+			Ogre::Vector3 actorPosition = actorAABB.getCenter();
+			
+			Ogre::Vector3 actorDims = actorAABB.getMaximum() - actorAABB.getMinimum();
+			
+			real terrainHeightAtActorPos = getHeightAt( actorPosition);
+			
+			actorPosition.y -= terrainHeightAtActorPos;
+			actorPosition.y += actorDims.y / 2.0;
+			
+			_actor->setPosition( VEC_OGRE2YAKE( actorPosition));
+		}
+		//------------------------------------------------------------------------------------
+
+	}
+}

Modified: trunk/yake/src/yapp/raf/yakeApplication.cpp
===================================================================
--- trunk/yake/src/yapp/raf/yakeApplication.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/raf/yakeApplication.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -25,6 +25,7 @@
    ------------------------------------------------------------------------------------
 */
 #include <yapp/raf/pch.h>
+#include <yapp/raf/yakePrerequisites.h>
 #include <yapp/raf/yakeApplicationState.h>
 #include <yapp/raf/yakeApplication.h>
 #if YAKE_RAF_USES_CEGUI == 1
@@ -42,7 +43,6 @@
 namespace yake {
 namespace raf {
 
-	//
 	template<class SystemType>
 		SystemType* findSystem(AssocVector<String,SharedPtr<SystemType> >& systems, const String& name)
 	{
@@ -68,9 +68,9 @@
 			SharedPtr<SystemType> pSys;
 			try {
 				if (sysName.empty())
-					pSys = create_default<SystemType>();
+					pSys = yake::templates::create_default<SystemType>();
 				else
-					pSys = create<SystemType>( sysName );
+					pSys = yake::templates::create<SystemType>( sysName );
 			}
 			catch (yake::Exception& e)
 			{
@@ -172,7 +172,7 @@
 #if YAKE_RAF_USES_CEGUI == 1
 	void Application::initCEGUI()
 	{
-		const String file = "ceguiOgreRendererAdapter";
+		const String file = "CEGUIOgreAdapter";
 		yake::base::Library* pDynLib = new yake::base::Library( file ); //@FIXME. MEMORY LEAK.
 		YAKE_ASSERT( pDynLib ).debug( "Out of memory" );
 
@@ -486,3 +486,4 @@
 
 } // namespace raf
 } // namespace yake
+

Modified: trunk/yake/src/yapp/raf/yakeApplicationState.cpp
===================================================================
--- trunk/yake/src/yapp/raf/yakeApplicationState.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/raf/yakeApplicationState.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -110,3 +110,4 @@
 
 } // namespace raf
 } // namespace yake
+

Modified: trunk/yake/src/yapp/raf/yakeRtApplicationState.cpp
===================================================================
--- trunk/yake/src/yapp/raf/yakeRtApplicationState.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/raf/yakeRtApplicationState.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -204,3 +204,4 @@
 
 } // namespace raf
 } // namespace yake
+

Modified: trunk/yake/src/yapp/samples/Makefile.am
===================================================================
--- trunk/yake/src/yapp/samples/Makefile.am	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/samples/Makefile.am	2006-03-19 17:54:00 UTC (rev 1302)
@@ -1,3 +1,3 @@
 INCLUDES = $(all_includes)
 METASOURCES = AUTO
-SUBDIRS = base misc gui raf model graphics
+SUBDIRS = base misc gui raf model graphics ode_terrain_demo

Modified: trunk/yake/src/yapp/samples/base/vehicle/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/base/vehicle/yakeDemo.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/samples/base/vehicle/yakeDemo.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -69,7 +69,7 @@
 		graphics::ISceneNode* pSN = getGraphicalWorld()->createSceneNode();
 		graphics::IEntity* pE = getGraphicalWorld()->createEntity("sphere_d1.mesh");
 		pSN->attachEntity( pE );
-		const Vector3 scale = Vector3::kUnitScale * mVehicle->getWheelInterface(wheelId)->getRadius();
+		const math::Vector3 scale = math::Vector3::kUnitScale * mVehicle->getWheelInterface(wheelId)->getRadius();
 		pSN->setScale( scale );
 		mComplex->addLink( mVehicle->getWheelInterface(wheelId), pSN );
 	}
@@ -82,13 +82,13 @@
 		// create a light
 		graphics::ILight* pLight = getGraphicalWorld()->createLight();
 		pLight->setType( graphics::ILight::LT_DIRECTIONAL );
-		pLight->setDirection( Vector3(0,-1,1) );
+		pLight->setDirection( math::Vector3(0,-1,1) );
 		getGraphicalWorld()->createSceneNode("lightnode0")->attachLight( pLight );
 
 		// position camera and look at the razor
 		getDefaultCamera()->setNearClipDistance( 1 );
-		getDefaultCamera()->setFixedYawAxis(Vector3::kUnitY);
-		getDefaultCamera()->setPosition(Vector3(0,0,-40));
+		getDefaultCamera()->setFixedYawAxis(math::Vector3::kUnitY);
+		getDefaultCamera()->setPosition(math::Vector3(0,0,-40));
 
 		// create ground
 		mGround = new model::complex::Model();
@@ -98,24 +98,33 @@
 			graphics::IEntity* pGroundE = getGraphicalWorld()->createEntity("plane_1x1.mesh");
 			pGroundE->setMaterial("box");
 			pGroundSN->attachEntity( pGroundE );
-			pGroundSN->setScale( Vector3(200,1,200) );
-			pGroundSN->setPosition( Vector3(0,-10,0) );
+			pGroundSN->setScale( math::Vector3(200,1,200) );
+			pGroundSN->setPosition( math::Vector3(0,-10,0) );
 
 			model::Graphical* pG = new model::Graphical();
 			pG->addSceneNode( pGroundSN );
 			mGround->addGraphical( pG );
 
-			getPhysicalWorld()->setGlobalGravity( Vector3( 0, -9.81, 0 ) ); 
+			getPhysicalWorld()->setGlobalGravity( math::Vector3( 0, -9.81, 0 ) ); 
 
 			// physical
 			physics::IActorPtr pGroundPlane = getPhysicalWorld()->createActor( physics::ACTOR_STATIC );
-			pGroundPlane->createShape( physics::IShape::PlaneDesc( Vector3(0,1,0), -10 ) );
+			pGroundPlane->createShape( physics::IShape::PlaneDesc( math::Vector3(0,1,0), -10 ) );
 
 			model::Physical* pP = new model::Physical();
 			pP->addActor( pGroundPlane, "groundPlane" );
 			mGround->addPhysical( pP );
 		}
 
+		// create container (e.g. for graphical objects and links)
+		mComplex = new model::complex::Model();
+
+		model::Graphical* pG = new model::Graphical();
+		model::Physical* pPh = new model::Physical;
+
+		mComplex->addGraphical( SharedPtr<model::Graphical>(pG) );
+		mComplex->addPhysical( SharedPtr<model::Physical>(pPh) );
+
 		// vehicle
 		SharedPtr<vehicle::IVehicleSystem> pVS = //create<vehicle::IVehicleSystem>("generic");
 			SharedPtr<vehicle::IVehicleSystem>(new vehicle::GenericVehicleSystem());
@@ -127,20 +136,20 @@
 
 		vehicle::VehicleTemplate tpl;
 		tpl.mChassis.mChassisShapes.push_back(
-			new physics::IShape::BoxDesc(Vector3(1,1,2)) );
+			new physics::IShape::BoxDesc(math::Vector3(1,1,2)) );
 		// mount points:
 		// mount point for left thruster
 		tpl.mMountPoints["left"] = 
-			vehicle::VehicleTemplate::MountPointTpl( Vector3(7,0,0), Vector3(1,0,0) );
+			vehicle::VehicleTemplate::MountPointTpl( math::Vector3(7,0,0), math::Vector3(1,0,0) );
 		// mount point for right thruster
 		tpl.mMountPoints["right"] = 
-			vehicle::VehicleTemplate::MountPointTpl( Vector3(-7,0,0), Vector3(-1,0,0) );
+			vehicle::VehicleTemplate::MountPointTpl( math::Vector3(-7,0,0), math::Vector3(-1,0,0) );
 		// mount point for rear thruster
 		tpl.mMountPoints["rear"] = 
-			vehicle::VehicleTemplate::MountPointTpl( Vector3(0,0,-8), Vector3(0,0,-1) );
+			vehicle::VehicleTemplate::MountPointTpl( math::Vector3(0,0,-8), math::Vector3(0,0,-1) );
 		// mount point for front thruster
 		tpl.mMountPoints["front"] = 
-			vehicle::VehicleTemplate::MountPointTpl( Vector3(0,0,7), Vector3(0,0,1) );
+			vehicle::VehicleTemplate::MountPointTpl( math::Vector3(0,0,7), math::Vector3(0,0,1) );
 		// thrusters:
 		tpl.mEngines["left"] = new vehicle::VehicleTemplate::ThrusterTpl(0.,10.,"left");
 		tpl.mEngines["right"] = new vehicle::VehicleTemplate::ThrusterTpl(0.,10.,"right");
@@ -153,19 +162,14 @@
 		// e.g.: vehicle::VehicleTemplate* tpl = pVS->getTemplate("jet");
 
 		// instantiate
-		mVehicle = pVS->create("jet", *getPhysicalWorld() );
+		mVehicle = pVS->create( "jet", *getPhysicalWorld(), *pPh );
 #endif
 
-		// create container (e.g. for graphical objects and links)
-		mComplex = new model::complex::Model();
-		model::Graphical* pG = new model::Graphical();
-		mComplex->addGraphical( SharedPtr<model::Graphical>(pG) );
-
 		// create visuals
 		// - ship body
 		graphics::ISceneNode* pSN = getGraphicalWorld()->createSceneNode( "root" );
 		pSN->attachEntity( getGraphicalWorld()->createEntity("razor.mesh") );
-		pSN->setScale( Vector3::kUnitScale * razorMeshScale );
+		pSN->setScale( math::Vector3::kUnitScale * razorMeshScale );
 		pG->addSceneNode(pSN);
 
 		YAKE_LOG( "Creating thruster visuals" );
@@ -175,6 +179,7 @@
 		_createThrusterVisual( "front", "backward", *pSN );
 		_createThrusterVisual( "rear", "forward", *pSN );
 		_createThrusterVisual( "bottom", "upward", *pSN );
+		_createThrusterVisual( "top", "downward", *pSN );
 
 		// - wheel visuals
 		if (mVehicle->getWheelInterface("frontWheel"))
@@ -235,6 +240,10 @@
 		mActionMap.reg( ACTIONID_UP,
 			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_PGUP, KAM_CONTINUOUS ) );
 		mActionMap.subscribeToActionId( ACTIONID_UP, boost::bind(&TheMainState::onUp,this) );
+
+		mActionMap.reg( ACTIONID_DOWN,
+			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_PGDOWN, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_DOWN, boost::bind(&TheMainState::onDown,this) );
 	}
 
 	virtual void onExit()
@@ -250,7 +259,7 @@
 		while (itEngine.hasMoreElements())
 		{
 			vehicle::IEngine* pEngine = itEngine.getNext();
-			pEngine->setThrottle( pEngine->getThrottle() - timeElapsed * 1.7 );
+			pEngine->setInputSignal( pEngine->getInputSignal() - timeElapsed * 1.7 );
 		}
 
 		real steering0 = 0;
@@ -260,15 +269,17 @@
 		{
 			const input::ActionId activeId = itAction.getNext();
 			if (activeId == input::ACTIONID_STRAFE_LEFT)
-				mVehicle->getEngineInterface("right")->setThrottle(1.);
+				mVehicle->getEngineInterface("right")->setInputSignal(1.);
 			else if (activeId == input::ACTIONID_STRAFE_RIGHT)
-				mVehicle->getEngineInterface("left")->setThrottle(1.);
+				mVehicle->getEngineInterface("left")->setInputSignal(1.);
 			else if (activeId == input::ACTIONID_FORWARD)
-				mVehicle->getEngineInterface("forward")->setThrottle(1.);
+				mVehicle->getEngineInterface("forward")->setInputSignal(1.);
 			else if (activeId == input::ACTIONID_REVERSE)
-				mVehicle->getEngineInterface("backward")->setThrottle(1.);
+				mVehicle->getEngineInterface("backward")->setInputSignal(1.);
 			else if (activeId == input::ACTIONID_UP)
-				mVehicle->getEngineInterface("upward")->setThrottle(1.);
+				mVehicle->getEngineInterface("upward")->setInputSignal(1.);
+			else if (activeId == input::ACTIONID_DOWN)
+				mVehicle->getEngineInterface("downward")->setInputSignal(1.);
 			else if (activeId == input::ACTIONID_LEFT)
 				steering0 -= 0.3;
 			else if (activeId == input::ACTIONID_RIGHT)
@@ -276,12 +287,13 @@
 		}
 		mVehicle->setSteering( 0, steering0 );
 
-		mVehicle->updateSimulation( timeElapsed );
+		//mVehicle->updateSimulation( timeElapsed );
 		mComplex->updatePhysics( timeElapsed );
 
 		_updateThrusterPs();
 		getDefaultCamera()->lookAt(mVehicle->getChassisPosition());
 		mComplex->updateGraphics( timeElapsed );
+		//YAKE_LOG_INFORMATION( String( "pos: " ) << mVehicle->getChassisPosition() );
 
 		mActiveActions.clear();
 	}
@@ -299,6 +311,8 @@
 	{ mActiveActions.insert( input::ACTIONID_REVERSE ); }
 	void onUp()
 	{ mActiveActions.insert( input::ACTIONID_UP ); }
+	void onDown()
+	{ mActiveActions.insert( input::ACTIONID_DOWN ); }
 	void onFrontWheelLeft()
 	{ mActiveActions.insert( input::ACTIONID_LEFT ); }
 	void onFrontWheelRight()
@@ -320,7 +334,7 @@
 			std::pair<String,graphics::IParticleSystem*> p = itM.getNext();
 			const String mtPtId = p.first;
 			graphics::IParticleSystem* ps = p.second;
-			const real throttle = mVehicle->getEngineInterface(mtPtId)->getThrottle();
+			const real throttle = mVehicle->getEngineInterface(mtPtId)->getInputSignal();
 
 			real rate = throttle * mEmitterEmissionRate[ mtPtId ];
 			ps->setEmissionRate( 0, rate );

Modified: trunk/yake/src/yapp/samples/gui/console/yakeConsoleDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/gui/console/yakeConsoleDemo.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/samples/gui/console/yakeConsoleDemo.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -349,8 +349,8 @@
 	 */
 	void initGui()
 	{
-		//mGuiRendererAdapter = loadPlugin( "CEGUIOgreAdapter" );
-		mGuiRendererAdapter = loadPlugin( "ceguiOgreRendererAdapter" );
+		mGuiRendererAdapter = loadPlugin( "CEGUIOgreAdapter" );
+		//mGuiRendererAdapter = loadPlugin( "ceguiOgreRendererAdapter" );
 		YAKE_ASSERT( mGuiRendererAdapter );
 
 		YAKE_LOG( "Starting adapter version " + mGuiRendererAdapter->getName() );

Modified: trunk/yake/src/yapp/samples/misc/cmdrmayhem/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/misc/cmdrmayhem/yakeDemo.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/samples/misc/cmdrmayhem/yakeDemo.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -14,7 +14,7 @@
 struct TheConfiguration : public raf::ApplicationConfiguration
 {
 	virtual StringVector getLibraries()
-	{ return MakeStringVector() << "graphicsOgre" << "inputOgre" << "physicsOde"; }
+	{ return MakeStringVector() << "graphicsOgre" << "inputOgre" << "physicsODE"; }
 
 	//virtual StringVector getScriptingSystems()
 	//{ return MakeStringVector() << "lua"; }
@@ -103,15 +103,15 @@
 		// create a light
 		graphics::ILight* pLight = getGraphicalWorld()->createLight();
 		pLight->setType( graphics::ILight::LT_DIRECTIONAL );
-		pLight->setDirection( Vector3(0,-1,1) );
+		pLight->setDirection( math::Vector3(0,-1,1) );
 		getGraphicalWorld()->createSceneNode("lightnode0")->attachLight( pLight );
 
 		getGraphicalWorld()->setShadowsEnabled( true );
 
 		// position camera and look at the ninja
 		getDefaultCamera()->setNearClipDistance( 1 );
-		getDefaultCamera()->setFixedYawAxis(Vector3::kUnitY);
-		getDefaultCamera()->setPosition(Vector3(7,4,-7));
+		getDefaultCamera()->setFixedYawAxis(math::Vector3::kUnitY);
+		getDefaultCamera()->setPosition(math::Vector3(7,4,-7));
 
 		// create ground
 		mGround = new model::complex::Model();
@@ -123,8 +123,8 @@
 			pGroundE->setMaterial("box");
 			pGroundE->setCastsShadow( false );
 			pGroundSN->attachEntity( pGroundE );
-			pGroundSN->setScale( Vector3(100,1,100) );
-			pGroundSN->setPosition( Vector3(0,groundHeight,0) );
+			pGroundSN->setScale( math::Vector3(100,1,100) );
+			pGroundSN->setPosition( math::Vector3(0,groundHeight,0) );
 
 			model::Graphical* pG = new model::Graphical();
 			pG->addSceneNode( pGroundSN );
@@ -132,7 +132,7 @@
 
 			// physical
 			physics::IActorPtr pGroundPlane = getPhysicalWorld()->createActor( physics::ACTOR_STATIC );
-			pGroundPlane->createShape( physics::IShape::PlaneDesc( Vector3(0,1,0), groundHeight ) );
+			pGroundPlane->createShape( physics::IShape::PlaneDesc( math::Vector3(0,1,0), groundHeight ) );
 
 			model::Physical* pP = new model::Physical();
 			pP->addActor( pGroundPlane, "groundPlane" );
@@ -152,8 +152,8 @@
 		// create player/avatar
 		mPlayerRep = getPhysicalWorld()->createAvatar(
 				physics::IAvatar::Desc(
-						Vector3(0.5,2,0), // dimensions
-						Vector3::kZero // initial position
+						math::Vector3(0.5,2,0), // dimensions
+						math::Vector3::kZero // initial position
 					) 
 			);
 		YAKE_ASSERT( mPlayerRep );
@@ -165,7 +165,7 @@
 			pG->addSceneNode( pSN );
 			graphics::IEntity* pE = getGraphicalWorld()->createEntity("sphere_d1.mesh");
 			pSN->attachEntity( pE );
-			pSN->setScale( 0.5 * Vector3::kUnitScale );
+			pSN->setScale( 0.5 * math::Vector3::kUnitScale );
 
 			model::ModelMovableLink* pLink = new model::ModelMovableLink();
 			mComplex->addGraphicsController( pLink );
@@ -175,7 +175,7 @@
 		}
 
 		// top-down camera controller
-		mTopDownCtrlr.setOffset( Vector3(10,10,-10) );
+		mTopDownCtrlr.setOffset( math::Vector3(10,10,-10) );
 		mTopDownCtrlr.setCamera( getDefaultCamera() );
 	}
 	virtual void onDestroyScene()
@@ -222,28 +222,28 @@
 	{
 		mActionMap.update();
 
-		Vector3 projViewDir = mTopDownCtrlr.getOffset();
+		math::Vector3 projViewDir = mTopDownCtrlr.getOffset();
 		projViewDir.y = 0.;
 		if (projViewDir.length() <= 0.01)
-			projViewDir = Vector3::kUnitZ;
+			projViewDir = math::Vector3::kUnitZ;
 		projViewDir.normalise();
-		Quaternion projViewRot;
-		projViewRot.FromAxes( projViewDir.crossProduct( Vector3::kUnitY ), Vector3::kUnitY, -projViewDir );
+		math::Quaternion projViewRot;
+		projViewRot.FromAxes( projViewDir.crossProduct( math::Vector3::kUnitY ), math::Vector3::kUnitY, -projViewDir );
 
 		const real maxVel = real(3.0);
-		Vector3 playerTargetVel;
+		math::Vector3 playerTargetVel;
 		ConstDequeIterator< ActionIdList > itAction( mActiveActions );
 		while (itAction.hasMoreElements())
 		{
 			const input::ActionId activeId = itAction.getNext();
 			if (activeId == input::ACTIONID_FORWARD)
-				playerTargetVel += Vector3(0,0,+1);
+				playerTargetVel += math::Vector3(0,0,+1);
 			else if (activeId == input::ACTIONID_REVERSE)
-				playerTargetVel += Vector3(0,0,-1);
+				playerTargetVel += math::Vector3(0,0,-1);
 			else if (activeId == input::ACTIONID_LEFT)
-				playerTargetVel += Vector3(+1,0,0);
+				playerTargetVel += math::Vector3(+1,0,0);
 			else if (activeId == input::ACTIONID_RIGHT)
-				playerTargetVel += Vector3(-1,0,0);
+				playerTargetVel += math::Vector3(-1,0,0);
 			else if (activeId == input::ACTIONID_UP)
 				mPlayerRep->jump();
 			else if (activeId == input::ACTIONID_DOWN)
@@ -262,15 +262,15 @@
 
 		{ // top-down controller
 			const real dist = timeElapsed * 4.;
-			Vector3 offset = mTopDownCtrlr.getOffset();
+			math::Vector3 offset = mTopDownCtrlr.getOffset();
 			if (this->getApp().getKeyboard()->isKeyDown(input::KC_I))
-				offset += dist * Vector3::kUnitZ;
+				offset += dist * math::Vector3::kUnitZ;
 			if (this->getApp().getKeyboard()->isKeyDown(input::KC_K))
-				offset += - dist * Vector3::kUnitZ;
+				offset += - dist * math::Vector3::kUnitZ;
 			if (this->getApp().getKeyboard()->isKeyDown(input::KC_J))
-				offset += dist * Vector3::kUnitX;
+				offset += dist * math::Vector3::kUnitX;
 			if (this->getApp().getKeyboard()->isKeyDown(input::KC_L))
-				offset += - dist * Vector3::kUnitX;
+				offset += - dist * math::Vector3::kUnitX;
 			mTopDownCtrlr.setOffset( offset );
 		}
 

Modified: trunk/yake/src/yapp/samples/model/XODE/yakeXODELoaderDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/model/XODE/yakeXODELoaderDemo.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/samples/model/XODE/yakeXODELoaderDemo.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -86,8 +86,8 @@
 		mPWorld = getPhysicsSystem().createWorld();
 		YAKE_ASSERT( mPWorld );
 
-		// objects
-		setupWorld();
+	    // objects
+	    setupWorld();
 
 		YAKE_LOG( "World was all set up!" );
 		YAKE_LOG( "Running simulation..." );
@@ -114,9 +114,9 @@
 
 		YAKE_LOG( "Simulation complete. Cleaning up..." );
 
-		YAKE_SAFE_DELETE( mPhysical );
+	    YAKE_SAFE_DELETE( mPhysical );
 
-		mPWorld.reset();
+	    mPWorld.reset();
 	}
 };
 
@@ -149,6 +149,6 @@
 	std::cin.get();
 #endif
 
-	return 0;
+    return 0;
 }
 

Modified: trunk/yake/src/yapp/samples/model/dotLink/yakeDotLinkDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/model/dotLink/yakeDotLinkDemo.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/samples/model/dotLink/yakeDotLinkDemo.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -259,5 +259,5 @@
 	std::cin.get();
 #endif
 
-	return 0;
+    return 0;
 }

Modified: trunk/yake/src/yapp/vehicle/yakeDotVehicle.cpp
===================================================================
--- trunk/yake/src/yapp/vehicle/yakeDotVehicle.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/vehicle/yakeDotVehicle.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -125,28 +125,37 @@
 				}
 			}
 		}
+		pN = n.getNodeByName( "ref" ); // reference to xode
+		if ( pN.get() )
+		{
+		    // reading physical body name from "xode" attribute
+		    mpCurrVehTpl->mChassis.mPhysicsBody = pN->getAttributeValueAs<String>( "xode" );
+		}
 	}
+
 	void DotVehicleParser::parseShapeBox( const data::dom::INode& n, const String& matId )
 	{
-		Vector3 dim;
+		math::Vector3 dim;
 		dim.x = StringUtil::parseReal( n.getAttributeValueAs<String>("x") );
 		dim.y = StringUtil::parseReal( n.getAttributeValueAs<String>("y") );
 		dim.z = StringUtil::parseReal( n.getAttributeValueAs<String>("z") );
-		Vector3 pos;
+		math::Vector3 pos;
 		if (n.getNodeByName("position"))
 			parsePosition( *n.getNodeByName("position"), pos );
 		mpCurrVehTpl->mChassis.mChassisShapes.push_back(
 			new physics::IShape::BoxDesc( dim, matId, pos ) );
 	}
+
 	void DotVehicleParser::parseShapeSphere( const data::dom::INode& n, const String& matId )
 	{
 		real radius = StringUtil::parseReal( n.getAttributeValueAs<String>("radius") );
-		Vector3 pos;
+		math::Vector3 pos;
 		if (n.getNodeByName("position"))
 			parsePosition( *n.getNodeByName("position"), pos );
 		mpCurrVehTpl->mChassis.mChassisShapes.push_back(
 			new physics::IShape::SphereDesc( radius, matId, pos ) );
 	}
+
 	void DotVehicleParser::parseEngine( const data::dom::INode& n )
 	{
 		String id = n.getAttributeValueAs<String>("name");
@@ -157,16 +166,44 @@
 
 		if (type == "MountedThruster")
 		{
+			String thrusterType = n.getAttributeValueAs<String>("thrusterType");
+			if ( thrusterType.empty() )
+			    thrusterType = "linear"; // FIXME compatibility with old data files
+			
 			String mtPt = n.getAttributeValueAs<String>("mountPoint");
 			YAKE_ASSERT( !mtPt.empty() );
 
-			SharedPtr<data::dom::INode> pForcesN = n.getNodeByName("forces");
-			YAKE_ASSERT( pForcesN.get() );
+			// TODO basic implementation. Make it pretty :D
 
-			mpCurrVehTpl->mEngines[ id ] = new VehicleTemplate::ThrusterTpl(
-				StringUtil::parseReal( pForcesN->getAttributeValueAs<String>("min") ),
-				StringUtil::parseReal( pForcesN->getAttributeValueAs<String>("max") ),
-				mtPt );
+			if ( thrusterType == "linear" )
+			{
+			    SharedPtr<data::dom::INode> pForcesN = n.getNodeByName("forces");
+			    YAKE_ASSERT( pForcesN.get() );
+
+			    VehicleTemplate::ThrusterTpl* pTemplate = new VehicleTemplate::ThrusterTpl;
+
+			    pTemplate->minForce = StringUtil::parseReal( pForcesN->getAttributeValueAs<String>("min") );
+			    pTemplate->maxForce = StringUtil::parseReal( pForcesN->getAttributeValueAs<String>("max") );
+			    pTemplate->gain = 0; // not needed
+			    pTemplate->mountPt = mtPt;
+			    pTemplate->type = "linear";
+
+			    mpCurrVehTpl->mEngines[ id ] = pTemplate;
+			}
+			else if ( thrusterType == "gain" )
+			{
+			    SharedPtr<data::dom::INode> pParams = n.getNodeByName("params");
+			    YAKE_ASSERT( pParams.get() );
+			    
+			    VehicleTemplate::ThrusterTpl* pTemplate = new VehicleTemplate::ThrusterTpl;
+			    pTemplate->minForce = 0; // not needed
+			    pTemplate->maxForce = 0; // not needed
+			    pTemplate->gain = StringUtil::parseReal( pParams->getAttributeValueAs<String>("gain") );
+			    pTemplate->mountPt = mtPt;
+			    pTemplate->type = "gain";
+
+			    mpCurrVehTpl->mEngines[ id ] = pTemplate;
+			}
 		}
 		else if (type == "CarEngine")
 		{
@@ -222,17 +259,17 @@
 		const String thisId = n.getAttributeValueAs<String>("name");
 		YAKE_ASSERT( !thisId.empty() );
 
-		Vector3 position;
+		math::Vector3 position;
 		SharedPtr<INode> pNode = n.getNodeByName("position");
 		if (pNode.get())
 			parsePosition( *pNode, position );
 
-		Quaternion orientation;
+		math::Quaternion orientation;
 		pNode = n.getNodeByName("orientation");
 		if (pNode.get())
 			parseOrientation( *pNode, orientation );
 
-		Vector3 direction;
+		math::Vector3 direction;
 		pNode = n.getNodeByName("direction");
 		if (pNode.get())
 			parseDirection( *pNode, direction );
@@ -283,12 +320,12 @@
 			return;
 		YAKE_ASSERT( mpCurrVehTpl->mWheels.find( name ) == mpCurrVehTpl->mWheels.end() )( name ).debug("duplicate wheel name. overriding values.");
 
-		Vector3 position;
+		math::Vector3 position;
 		SharedPtr<data::dom::INode> pN = n.getNodeByName("position");
 		if (pN.get())
 			parsePosition( *pN, position );
 
-		Quaternion rotation( Quaternion::kIdentity );
+		math::Quaternion rotation( math::Quaternion::kIdentity );
 		pN = n.getNodeByName("orientation");
 		if (pN.get())
 			parseOrientation( *pN, rotation );
@@ -318,19 +355,19 @@
 
 
 	}
-	void DotVehicleParser::parsePosition( const data::dom::INode& n, Vector3& ret )
+	void DotVehicleParser::parsePosition( const data::dom::INode& n, math::Vector3& ret )
 	{
 		ret.x = StringUtil::parseReal( n.getAttributeValueAs<String>("x") );
 		ret.y = StringUtil::parseReal( n.getAttributeValueAs<String>("y") );
 		ret.z = StringUtil::parseReal( n.getAttributeValueAs<String>("z") );
 	}
-	void DotVehicleParser::parseDirection( const data::dom::INode& n, Vector3& ret )
+	void DotVehicleParser::parseDirection( const data::dom::INode& n, math::Vector3& ret )
 	{
 		ret.x = StringUtil::parseReal( n.getAttributeValueAs<String>("x") );
 		ret.y = StringUtil::parseReal( n.getAttributeValueAs<String>("y") );
 		ret.z = StringUtil::parseReal( n.getAttributeValueAs<String>("z") );
 	}
-	void DotVehicleParser::parseOrientation( const data::dom::INode& n, Quaternion& ret )
+	void DotVehicleParser::parseOrientation( const data::dom::INode& n, math::Quaternion& ret )
 	{
 		if ( n.getAttributeValueAs<String>("qx") != "" )
 		{
@@ -341,7 +378,7 @@
 		}
 		else if ( n.getAttributeValueAs<String>("axisX") != "" )
 		{
-			Vector3 axis;
+			math::Vector3 axis;
 			axis.x = StringUtil::parseReal( n.getAttributeValueAs<String>("axisX") );
 			axis.y = StringUtil::parseReal( n.getAttributeValueAs<String>("axisY") );
 			axis.z = StringUtil::parseReal( n.getAttributeValueAs<String>("axisZ") );
@@ -349,7 +386,7 @@
 		}
 		else if ( n.getAttributeValueAs<String>("angleX") != "" )
 		{
-			Vector3 axis;
+			math::Vector3 axis;
 			axis.x = StringUtil::parseReal( n.getAttributeValueAs<String>("angleX") );
 			axis.y = StringUtil::parseReal( n.getAttributeValueAs<String>("angleY") );
 			axis.z = StringUtil::parseReal( n.getAttributeValueAs<String>("angleZ") );
@@ -360,3 +397,4 @@
 
 } // namespace vehicle
 } // namespace yake
+

Modified: trunk/yake/src/yapp/vehicle/yakeMountPoint.cpp
===================================================================
--- trunk/yake/src/yapp/vehicle/yakeMountPoint.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/vehicle/yakeMountPoint.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -35,8 +35,8 @@
 	// Class: MountPoint
 	//-----------------------------------------------------
 	MountPoint::MountPoint() :
-		mPosition(Vector3::kZero),
-		mOrientation(Quaternion::kIdentity),
+		mPosition(math::Vector3::kZero),
+		mOrientation(math::Quaternion::kIdentity),
 		mParent(0),
 		mOverrideParent(0)
 	{
@@ -90,44 +90,54 @@
 		mMountables.erase( itFind );
 		mountable->onDetached();
 	}
-	Vector3 MountPoint::getDirection() const
+	math::Vector3 MountPoint::getDirection() const
 	{ 
-		return getDerivedOrientation() * Vector3::kUnitZ; 
+		// direction in local coordinates
+		//
+		return mOrientation * math::Vector3::kUnitZ; 
 	}
-	void MountPoint::setDirection( const Vector3& dir)
+	void MountPoint::setDirection( const math::Vector3& dir)
 	{
-		const Vector3 currDir = getDirection();
-		const Vector3 newDir = dir.normalisedCopy();
-		//@fixme Use tolerance for equality tests!
-		if (newDir == currDir)
+		const real tolerance = real(0.001);
+		const math::Vector3 currDir = getDirection();
+		const math::Vector3 newDir = dir.normalisedCopy();
+
+		if ( newDir == currDir )
 			return;
-		if (newDir == -currDir)
+
+		if ( newDir.dotProduct( currDir ) + 1 <= tolerance ) // tolerance check. TODO tolerance globally? for math
 		{
-			real angle = 0.;
-			Vector3 axis(Vector3::kUnitY);
-			mOrientation.ToAngleAxis(angle,axis);
-			mOrientation.FromAngleAxis(angle+Math::PI,axis);
+		    	real angle = 0.;
+		    	math::Vector3 axis;
+		    	mOrientation.ToAngleAxis( angle, axis );
+
+			// adding another 180 grads
+			angle += math::Math::PI;
+
+			// setting new orientation
+			mOrientation.FromAngleAxis( angle, axis );			
+			
 			return;
 		}
 		mOrientation = currDir.getRotationTo( newDir ) * mOrientation;
 	}
-	void MountPoint::setPosition(const Vector3& rPosition)
+	void MountPoint::setPosition(const math::Vector3& rPosition)
 	{
 		mPosition = rPosition;
 	}
-	Vector3 MountPoint::getPosition() const
+	math::Vector3 MountPoint::getPosition() const
 	{
 		return mPosition;
 	}
-	void MountPoint::setOrientation( const Quaternion& q )
+	void MountPoint::setOrientation( const math::Quaternion& q )
 	{
 		mOrientation = q;
 	}
-	Quaternion MountPoint::getOrientation() const
+	math::Quaternion MountPoint::getOrientation() const
 	{
 		return mOrientation;
 	}
-	Vector3 MountPoint::getDerivedPosition() const
+	math::Vector3 MountPoint::getDerivedPosition() const
 	{
 		if (mOverrideParent)
 			return mOverrideParent->getOrientation() * mPosition + mOverrideParent->getPosition();
@@ -135,7 +145,7 @@
 			return mParent->getDerivedOrientation() * mPosition + mParent->getDerivedPosition();
 		return mPosition;
 	}
-	Quaternion MountPoint::getDerivedOrientation() const
+	math::Quaternion MountPoint::getDerivedOrientation() const
 	{
 		if (mOverrideParent)
 			return mOverrideParent->getOrientation() * mOrientation;
@@ -154,3 +164,4 @@
 
 } // namespace vehicle
 } // namespace yake
+

Modified: trunk/yake/src/yapp/vehicle/yakeNativeOde.cpp
===================================================================
--- trunk/yake/src/yapp/vehicle/yakeNativeOde.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/vehicle/yakeNativeOde.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -59,10 +59,10 @@
 	{
 		mVehicleTemplates.clear();
 	}
-	IVehicle* GenericVehicleSystem::create(const VehicleTemplate& tpl, physics::IWorld& PWorld)
+	IVehicle* GenericVehicleSystem::create(const VehicleTemplate& tpl, physics::IWorld& PWorld, model::Physical& physModel )
 	{
 		GenericVehicle* pV = new GenericVehicle();
-		pV->_create( tpl, PWorld );
+		pV->_create( tpl, PWorld, physModel );
 		return pV;
 	}
 	bool GenericVehicleSystem::loadTemplates(const String& fn)
@@ -96,13 +96,13 @@
 	//		return 0;
 	//	return tpl->clone();
 	//}
-	IVehicle* GenericVehicleSystem::create(const String& tplId, physics::IWorld& PWorld)
+	IVehicle* GenericVehicleSystem::create(const String& tplId, physics::IWorld& PWorld, model::Physical& physModel)
 	{
 		const VehicleTemplate* tpl = getTemplate( tplId );
 		YAKE_ASSERT( tpl );
 		if (!tpl)
 			return 0;
-		return create(*tpl,PWorld);
+		return create(*tpl,PWorld,physModel);
 	}
 	void GenericVehicleSystem::_onVehicleTpl(vehicle::DotVehicleParser& parser, const String& tplId)
 	{
@@ -221,12 +221,12 @@
 			return 0;
 		return itFind->second;
 	}
-	Vector3 GenericVehicle::getChassisPosition() const
+	math::Vector3 GenericVehicle::getChassisPosition() const
 	{
 		YAKE_ASSERT( mpChassis );
 		return mpChassis->getPosition();
 	}
-	Quaternion GenericVehicle::getChassisOrientation() const
+	math::Quaternion GenericVehicle::getChassisOrientation() const
 	{
 		YAKE_ASSERT( mpChassis );
 		return mpChassis->getOrientation();
@@ -236,6 +236,7 @@
 		YAKE_ASSERT( mpChassis );
 		return mpChassis;
 	}
+	
 	void GenericVehicle::_createMountPoint(const String& id, const VehicleTemplate::MountPointTpl& mtPtTpl,MountPoint* parentMtPt)
 	{
 		MountPoint* thisMtPt = new GenericMountPoint();
@@ -266,19 +267,44 @@
 			_createMountPoint( mptTplEntry.first, childMtPtTpl, thisMtPt );
 		}
 	}
-	void GenericVehicle::_create(const VehicleTemplate& tpl, physics::IWorld& PWorld )
+	void GenericVehicle::_create(const VehicleTemplate& tpl, physics::IWorld& PWorld, model::Physical& physModel )
 	{
-		// chassis
-		mpChassis = PWorld.createActor( physics::ACTOR_DYNAMIC );
-		mpChassis->setPosition( tpl.mChassis.mPosition );
-		//mpChassis->setOrientation( tpl.mChassis.mOrientation );
-		ConstDequeIterator< VehicleTemplate::ShapeTplList > itShapeTpl( tpl.mChassis.mChassisShapes );
-		while (itShapeTpl.hasMoreElements())
+		YAKE_LOG( "Creating vehicle from template..." );
+		if ( tpl.mChassis.mPhysicsBody != "" ) // i.e. chassis is defined as reference to physical body
 		{
+		    YAKE_LOG( "External physical body found. Searching provided model for it..." );
+
+		    // searching for actor in provided model
+		    physics::IActorPtr actor = physModel.getActorByName( tpl.mChassis.mPhysicsBody );
+
+		    YAKE_ASSERT( actor != NULL ).error( "Actor '" + tpl.mChassis.mPhysicsBody 
+			    +  "' was not found in physical model! Are you sure you provided the right model???" );
+
+		    YAKE_LOG( "Found. OK." );
+		    // initial position is determined by body position
+		    mpChassis = actor;
+		}
+		else // chassis is defined in .vehicle itself
+		{
+		    YAKE_LOG( "External physical body not found. Looking for body definition in .vehicle file." );
+		    // chassis
+		    mpChassis = PWorld.createActor( physics::ACTOR_DYNAMIC );
+
+		    // adding chassis to physical model here...
+		    // TODO: naming convention for chassis. 
+		    // No more than one chassis per model now ;)
+		    physModel.addActor( mpChassis, "vehicle_chassis" );
+
+		    mpChassis->setPosition( tpl.mChassis.mPosition );
+		    //mpChassis->setOrientation( tpl.mChassis.mOrientation );
+		    ConstDequeIterator< VehicleTemplate::ShapeTplList > itShapeTpl( tpl.mChassis.mChassisShapes );
+		    while (itShapeTpl.hasMoreElements())
+		    {
 			mpChassis->createShape( *itShapeTpl.getNext() );
+		    }
+		    mpChassis->getBody().setMass( tpl.mChassis.mMass );
 		}
-		mpChassis->getBody().setMass( tpl.mChassis.mMass );
-
+		
 		// mount points
 		ConstDequeIterator< VehicleTemplate::MountPointTplList > itMP( tpl.mMountPoints );
 		while (itMP.hasMoreElements())
@@ -322,19 +348,33 @@
 				if (thrusterTpl)
 				{
 					// thruster itself
-					GenericThruster* pEngine = new GenericThruster();
-					mEngines[ engineTplEntry.first ] = pEngine;
-					pEngine->setMinimumForce( thrusterTpl->minForce );
-					pEngine->setMaximumForce( thrusterTpl->maxForce );
-					pEngine->setThrottle(0.);
-					subscribeToUpdateEngineSimulation(
-						boost::bind( &GenericThruster::updateSimulation, pEngine, _1 ) );
+					IThruster* pThruster = NULL;
+					if ( thrusterTpl->type == "linear" )
+					{
+					    GenericLinearThruster* pEngine = new GenericLinearThruster();
+					    pThruster = pEngine; 
+					    mEngines[ engineTplEntry.first ] = pEngine;
+					    pEngine->setMinimumForce( thrusterTpl->minForce );
+					    pEngine->setMaximumForce( thrusterTpl->maxForce );
+					    pEngine->setInputSignal(0.);
+					    subscribeToUpdateEngineSimulation(
+						    boost::bind( &GenericLinearThruster::updateSimulation, pEngine, _1 ) );
+					}
+					else if ( thrusterTpl->type == "gain" )
+					{
+					    GenericThruster* pEngine = new GenericThruster();
+					    pThruster = pEngine; 
+					    mEngines[ engineTplEntry.first ] = pEngine;
+					    pEngine->setGain( thrusterTpl->gain );
+					    subscribeToUpdateEngineSimulation(
+						    boost::bind( &GenericThruster::updateSimulation, pEngine, _1 ) );
+					}
 
 					// the thruster is attached to a mount point, create wrapper:
 					if (thrusterTpl->mountPt != MPID_NO_PARENT)
 					{
 						GenericMountedThruster* pMounted = new GenericMountedThruster();
-						pMounted->setThruster( pEngine );
+						pMounted->setThruster( pThruster );
 
 						pMounted->addTarget( mpChassis->getBodyPtr() );
 
@@ -423,7 +463,7 @@
 				{
 					pE = GWorld.createEntity("sphere_1d.mesh");
 					pSN->attachEntity( pE );
-					pSN->setScale( Vector3::kUnitScale * pShape->getPropertyReal("radius") );
+					pSN->setScale( math::Vector3::kUnitScale * pShape->getPropertyReal("radius") );
 				}
 				break;
 			default:
@@ -500,8 +540,8 @@
 		{
 			mpJoint = PWorld.createJoint( physics::IJoint::DescHinge2( 
 				chassisObj, mpWheel, 
-				tpl.mOrientation * Vector3::kUnitY,
-				tpl.mOrientation * Vector3::kUnitX,
+				tpl.mOrientation * math::Vector3::kUnitY,
+				tpl.mOrientation * math::Vector3::kUnitX,
 				tpl.mPosition ) );
 
 			mpJoint->setSpring( tpl.mSuspensionSpring );
@@ -579,8 +619,8 @@
 	{
 		YAKE_ASSERT( mpChassis );
 		YAKE_ASSERT( mpWheel );
-		const Vector3 chassisDir = mpChassis->getOrientation() * Vector3::kUnitZ;
-		const Vector3 wheelMovementDir = mpWheel->getBody().getLinearVelocity().normalisedCopy();
+		const math::Vector3 chassisDir = mpChassis->getOrientation() * math::Vector3::kUnitZ;
+		const math::Vector3 wheelMovementDir = mpWheel->getBody().getLinearVelocity().normalisedCopy();
 		mSkid = 1. - chassisDir.dotProduct( wheelMovementDir );
 		if (mSkid < 0)
 			mSkid = 0.;
@@ -589,35 +629,45 @@
 	{
 		return mRadius;
 	}
-	Vector3 OdeWheel::getPosition() const
+	math::Vector3 OdeWheel::getPosition() const
 	{
 		YAKE_ASSERT( mpWheel );
 		return mpWheel->getPosition();
 	}
-	Quaternion OdeWheel::getOrientation() const
+	math::Vector3 OdeWheel::getDerivedPosition() const
 	{
 		YAKE_ASSERT( mpWheel );
+		return mpWheel->getDerivedPosition();
+	}
+	math::Quaternion OdeWheel::getOrientation() const
+	{
+		YAKE_ASSERT( mpWheel );
 		return mpWheel->getOrientation();
 	}
+	math::Quaternion OdeWheel::getDerivedOrientation() const
+	{
+		YAKE_ASSERT( mpWheel );
+		return mpWheel->getDerivedOrientation();
+	}
 	void OdeWheel::_applyDriveTq( const real tq )
 	{
 		//std::cout << "DTQ=" << tq << "\n";
-		//_applyTq( Vector3::kUnitX * tq );
+		//_applyTq( math::Vector3::kUnitX * tq );
 
 		if (mBrakeRatio > 0.01)
-			_applyBrakeTq( Vector3::kUnitX * mBrakeRatio * 1.5 );
+			_applyBrakeTq( math::Vector3::kUnitX * mBrakeRatio * 1.5 );
 
 		const real targetVel = tq < 0. ? -40 : 40;
 		_applyMotor( targetVel, - tq * 0.0075 );
 	}
-	void OdeWheel::_applyTq( const Vector3& torque )
+	void OdeWheel::_applyTq( const math::Vector3& torque )
 	{
 		mpWheel->getBody().addTorque( mpWheel->getOrientation() * torque );
 	}
-	void OdeWheel::_applyBrakeTq( const Vector3 & torque )
+	void OdeWheel::_applyBrakeTq( const math::Vector3 & torque )
 	{
-		Vector3 linVel = mpWheel->getBody().getLinearVelocity();
-		Vector3 dir = mpWheel->getOrientation() * Vector3::kUnitX;
+		math::Vector3 linVel = mpWheel->getBody().getLinearVelocity();
+		math::Vector3 dir = mpWheel->getOrientation() * math::Vector3::kUnitX;
 		if (dir.dotProduct(linVel) > 0)
 		{
 			std::cout << "BRK+\n";
@@ -650,21 +700,53 @@
 	//-----------------------------------------------------
 	// Class: GenericThruster
 	//-----------------------------------------------------
-	GenericThruster::GenericThruster() : mThrottle(0)
+	GenericThruster::GenericThruster() : mVoltage( 0 ), mGain( 1.0 )
 	{
 	}
-	void GenericThruster::setThrottle( real throttle )
+	void GenericThruster::setInputSignal( real voltage )
 	{
-		mThrottle = (throttle < 0.) ? 0. : ((throttle > 1.) ? 1. : throttle);
+	    mVoltage = voltage;
 	}
-	real GenericThruster::getThrottle() const
+	real GenericThruster::getInputSignal() const
 	{
-		return mThrottle;
+	    return mVoltage;
 	}
 	void GenericThruster::updateSimulation( real timeElapsed )
 	{
-		setForce( getMinimumForce() + mThrottle * ( getMaximumForce() - getMinimumForce() ) );
+	   setForce( mVoltage * mGain ); 
 	}
+	void GenericThruster::setGain( real gain )
+	{
+	    mGain = gain;
+	}
+	real GenericThruster::getGain() const
+	{
+	    return mGain;
+	}
+	
+	//-----------------------------------------------------
+	// Class: GenericLinearThruster
+	//-----------------------------------------------------
+	GenericLinearThruster::GenericLinearThruster() : mVoltage( 0 )
+	{
+	}
+	void GenericLinearThruster::setInputSignal( real voltage )
+	{
+		mVoltage = voltage;
+	}
+	real GenericLinearThruster::getInputSignal() const
+	{
+		return mVoltage;
+	}
+	void GenericLinearThruster::updateSimulation( real timeElapsed )
+	{
+	    real abs_force = getMinimumForce() + math::Math::Abs( mVoltage ) * ( getMaximumForce() - getMinimumForce() );
+	    
+	    if ( abs_force > getMaximumForce() )
+		abs_force = getMaximumForce();
+	    
+	    setForce( math::Math::Sign( mVoltage )*abs_force );
+	}
 
 	//-----------------------------------------------------
 	// Class: GenericMountedThruster
@@ -675,19 +757,26 @@
 	void GenericMountedThruster::onApplyToTargets()
 	{
 		YAKE_ASSERT(mThruster);
+
 		if (!mThruster)
 			return;
+		
+		if ( mThruster->getForce() == 0 )
+		    return;
+
 		const MountPoint* mp = getMountPoint();
-		const Vector3 pos = mp ? mp->getDerivedPosition() : Vector3::kZero;
-		const Quaternion rot = mp ? mp->getDerivedOrientation() : Quaternion::kIdentity;
-		const Vector3 f = mThruster->getForce() * ( rot * -Vector3::kUnitZ );
-		
+		const math::Vector3 pos = mp ? mp->getDerivedPosition() : math::Vector3::kZero;
+		const math::Quaternion rot = mp ? mp->getDerivedOrientation() : math::Quaternion::kIdentity;
+		const math::Vector3 f = mThruster->getForce() * ( rot * -math::Vector3::kUnitZ );
+
 		ConstDequeIterator< BodyPtrList > itBody( mTargets );
 		while (itBody.hasMoreElements())
 		{
 			physics::IBody* pBody = itBody.getNext();
+			
 			pBody->addForceAtPos( f, pos );
 		}
 	}
 } // namespace vehicle
 } // namespace yake
+

Modified: trunk/yake/src/yapp/vehicle/yakeOdeEngine.cpp
===================================================================
--- trunk/yake/src/yapp/vehicle/yakeOdeEngine.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/vehicle/yakeOdeEngine.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -228,3 +228,4 @@
 	}
 } // namespace vehicle
 } // namespace yake
+

Modified: trunk/yake/src/yapp/vehicle/yakeVehicle.cpp
===================================================================
--- trunk/yake/src/yapp/vehicle/yakeVehicle.cpp	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/src/yapp/vehicle/yakeVehicle.cpp	2006-03-19 17:54:00 UTC (rev 1302)
@@ -64,38 +64,37 @@
 	}
 
 	//-----------------------------------------------------
-	// Class: IThruster
+	// Class: ILinearThruster
 	//-----------------------------------------------------
-	IThruster::IThruster() :
+	ILinearThruster::ILinearThruster() :
 		mMinForce(0.),
-		mMaxForce(1.),
-		mForce(0.)
+		mMaxForce(1.)
 	{
 	}
-	IThruster::~IThruster()
+	ILinearThruster::~ILinearThruster()
 	{
 	}
-	void IThruster::setForce( real force )
+	void ILinearThruster::setForce( real force )
 	{
 		mForce = force;
 	}
-	void IThruster::setMinimumForce( real force )
+	void ILinearThruster::setMinimumForce( real force )
 	{
 		mMinForce = force;
 	}
-	real IThruster::getMinimumForce() const
+	real ILinearThruster::getMinimumForce() const
 	{
 		return mMinForce;
 	}
-	void IThruster::setMaximumForce( real force )
+	void ILinearThruster::setMaximumForce( real force )
 	{
 		mMaxForce = force;
 	}
-	real IThruster::getMaximumForce() const
+	real ILinearThruster::getMaximumForce() const
 	{
 		return mMaxForce;
 	}
-	real IThruster::getForce() const
+	real ILinearThruster::getForce() const
 	{
 		return mForce;
 	}
@@ -133,3 +132,4 @@
 
 } // namespace vehicle
 } // namespace yake
+

Modified: trunk/yake/yake/audio/yakeAudio.h
===================================================================
--- trunk/yake/yake/audio/yakeAudio.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/audio/yakeAudio.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -32,3 +32,4 @@
 #include <yake/audio/yakeAudible.h>
 
 #endif
+

Modified: trunk/yake/yake/audio/yakeAudioSystem.h
===================================================================
--- trunk/yake/yake/audio/yakeAudioSystem.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/audio/yakeAudioSystem.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -75,14 +75,19 @@
 	{
 	public:
 		virtual ~ISource() {}
-		virtual void setVelocity( const Vector3 & velocity ) = 0;
-		virtual Vector3 getVelocity() const = 0;
+		virtual void setVelocity( const math::Vector3 & velocity ) = 0;
+		virtual math::Vector3 getVelocity() const = 0;
 
 		virtual void setSoundData( ISoundData* pSoundData ) = 0;
 		//virtual void setSoundData( const String & resourceName ) = 0;
 		virtual void play() = 0;
 		virtual void stop() = 0;
 		virtual void pause() = 0;
+
+		virtual Vector3 getDerivedPosition() const
+		{ return this->getPosition(); }
+		virtual Quaternion getDerivedOrientation() const
+		{ return this->getOrientation(); }
 	};
 
 	/** A listener in a world.
@@ -91,8 +96,13 @@
 	{
 	public:
 		virtual ~IListener() {}
-		virtual void setVelocity( const Vector3 & velocity ) = 0;
-		virtual Vector3 getVelocity() const = 0;
+		virtual void setVelocity( const math::Vector3 & velocity ) = 0;
+		virtual math::Vector3 getVelocity() const = 0;
+
+		virtual Vector3 getDerivedPosition() const
+		{ return this->getPosition(); }
+		virtual Quaternion getDerivedOrientation() const
+		{ return this->getOrientation(); }
 	};
 
 	/** Represents an environment in which an audio simulation takes place.

Modified: trunk/yake/yake/audio/yakePCH.h
===================================================================
--- trunk/yake/yake/audio/yakePCH.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/audio/yakePCH.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -30,3 +30,4 @@
 #include <yake/base/yake.h>
 
 #endif
+

Modified: trunk/yake/yake/base/math/yakeColor.h
===================================================================
--- trunk/yake/yake/base/math/yakeColor.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/math/yakeColor.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -35,7 +35,7 @@
 #	include "yakePrerequisites.h"
 #endif
 // Yake
-#include "yakeMath.h"
+#include "yake/base/math/yakeMath.h"
 
 //============================================================================
 //    INTERFACE STRUCTURES / UTILITY CLASSES
@@ -142,3 +142,4 @@
 #include <yake/base/math/yakeColor.inl>
 
 #endif // YAKE_BASE_MATH_COLOR_H
+

Modified: trunk/yake/yake/base/math/yakeColor.inl
===================================================================
--- trunk/yake/yake/base/math/yakeColor.inl	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/math/yakeColor.inl	2006-03-19 17:54:00 UTC (rev 1302)
@@ -250,3 +250,4 @@
 
 } // math
 } // yake
+

Modified: trunk/yake/yake/base/math/yakeGeometry.h
===================================================================
--- trunk/yake/yake/base/math/yakeGeometry.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/math/yakeGeometry.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -114,3 +114,4 @@
 }
 }
 #endif
+

Modified: trunk/yake/yake/base/math/yakeMath.h
===================================================================
--- trunk/yake/yake/base/math/yakeMath.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/math/yakeMath.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -32,10 +32,10 @@
 //============================================================================
 // Standard headers
 #ifndef YAKE_BASE_PREREQUISITES_H
-#	include "yakePrerequisites.h"
+#	include "yake/base/yakePrerequisites.h"
 #endif
 // Yake
-#include "yakeRand.h"
+#include "yake/base/math/yakeRand.h"
 
 //============================================================================
 //    INTERFACE STRUCTURES / UTILITY CLASSES
@@ -235,3 +235,4 @@
 } // yake
 
 #endif // YAKE_BASE_MATH_MATH_H
+

Modified: trunk/yake/yake/base/math/yakeMatrix3.h
===================================================================
--- trunk/yake/yake/base/math/yakeMatrix3.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/math/yakeMatrix3.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -32,11 +32,11 @@
 //============================================================================
 // Standard headers
 #ifndef YAKE_BASE_PREREQUISITES_H
-#	include "yakePrerequisites.h"
+#	include "yake/base/yakePrerequisites.h"
 #endif
 // Yake
-#include "yakeMath.h"
-#include "yakeVector3.h"
+#include "yake/base/math/yakeMath.h"
+#include "yake/base/math/yakeVector3.h"
 
 // NB All code adapted from Wild Magic 0.2 Matrix math (free source code)
 // http://www.magic-software.com
@@ -228,3 +228,4 @@
 } // yake
 
 #endif // YAKE_BASE_MATH_MATRIX3_H
+

Modified: trunk/yake/yake/base/math/yakeQuaternion.h
===================================================================
--- trunk/yake/yake/base/math/yakeQuaternion.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/math/yakeQuaternion.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -32,10 +32,10 @@
 //============================================================================
 // Standard headers
 #ifndef YAKE_BASE_PREREQUISITES_H
-#	include "yakePrerequisites.h"
+#	include "yake/base/math/yakePrerequisites.h"
 #endif
 // Yake
-#include "yakeMath.h"
+#include "yake/base/math/yakeMath.h"
 
 //============================================================================
 //    INTERFACE STRUCTURES / UTILITY CLASSES
@@ -52,19 +52,19 @@
         inline Quaternion (
             real fW = 1.0,
             real fX = 0.0, real fY = 0.0, real fZ = 0.0)
-		{
+	{
 			w = fW;
 			x = fX;
 			y = fY;
 			z = fZ;
-		}
+	}
         inline Quaternion (const Quaternion& rkQ)
-		{
+	{
 			w = rkQ.w;
 			x = rkQ.x;
 			y = rkQ.y;
 			z = rkQ.z;
-		}
+	}
 	inline Quaternion ( real angle, const Vector3 & axis )
 	{
 		this->FromAngleAxis( angle, axis );
@@ -81,13 +81,13 @@
         void ToAxes (Vector3& xAxis, Vector3& yAxis, Vector3& zAxis) const;
 
         inline Quaternion& operator= (const Quaternion& rkQ)
-		{
-			w = rkQ.w;
-			x = rkQ.x;
-			y = rkQ.y;
-			z = rkQ.z;
-			return *this;
-		}
+	{
+		w = rkQ.w;
+		x = rkQ.x;
+		y = rkQ.y;
+		z = rkQ.z;
+		return *this;
+	}
         Quaternion operator+ (const Quaternion& rkQ) const;
         Quaternion operator- (const Quaternion& rkQ) const;
         Quaternion operator* (const Quaternion& rkQ) const;
@@ -136,11 +136,16 @@
         static const Quaternion kIdentity;
 
         real w, x, y, z;
-	};
+    };
 
+    inline std::ostream& operator << ( std::ostream& lhs, const Quaternion& rhs )
+    {
+	lhs << rhs.x << " " << rhs.y << " " << rhs.z << " " << rhs.w;
+	return lhs;
+    }
+
 } // math
 } // yake
 
-#endif // YAKE_BASE_MATH_QUATERNION_H
+#endif // YAKE_MATH_QUATERNION_H
 
-

Modified: trunk/yake/yake/base/math/yakeVector3.h
===================================================================
--- trunk/yake/yake/base/math/yakeVector3.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/math/yakeVector3.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -32,11 +32,11 @@
 //============================================================================
 // Standard headers
 #ifndef YAKE_BASE_PREREQUISITES_H
-#	include "yakePrerequisites.h"
+#	include "yake/base/yakePrerequisites.h"
 #endif
 // Yake
-#include "yakeMath.h"
-#include "yakeQuaternion.h"
+#include "yake/base/math/yakeMath.h"
+#include "yake/base/math/yakeQuaternion.h"
 
 //============================================================================
 //    INTERFACE STRUCTURES / UTILITY CLASSES
@@ -415,15 +415,16 @@
         static const Vector3 kUnitX;
         static const Vector3 kUnitY;
         static const Vector3 kUnitZ;
-        static const Vector3 kUnitScale;
+	static const Vector3 kUnitScale;
 
     };
-	inline ::std::ostream& operator << ( ::std::ostream& lhs, const Vector3 & rhs )
-	{
-		lhs << rhs.x << " " << rhs.y << " " << rhs.z;
-		return lhs;
-	}
 
+    inline std::ostream& operator << ( std::ostream& lhs, const Vector3& rhs )
+    {
+	lhs << rhs.x << " " << rhs.y << " " << rhs.z;
+	return lhs;
+    }
+
 } // math
 } // yake
 

Modified: trunk/yake/yake/base/mpl/yakeBuildArguments.h
===================================================================
--- trunk/yake/yake/base/mpl/yakeBuildArguments.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/mpl/yakeBuildArguments.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -31,7 +31,7 @@
 //    IMPLEMENTATION HEADERS
 //============================================================================
 // Yake
-#include "yakeBuildIteration.h"
+#include "yake/base/mpl/yakeBuildIteration.h"
 
 //============================================================================
 //    INTERFACE STRUCTURES / UTILITY CLASSES

Modified: trunk/yake/yake/base/mpl/yakeBuildIteration.h
===================================================================
--- trunk/yake/yake/base/mpl/yakeBuildIteration.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/mpl/yakeBuildIteration.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -56,3 +56,4 @@
 #define YAKE_ITER_FON_N( INTERFACE ) YAKE_ITER_FON_9( INTERFACE )
 
 #endif // YAKE_BASE_MPL_BUILDITERATION_H
+

Modified: trunk/yake/yake/base/native/yakeNative.h
===================================================================
--- trunk/yake/yake/base/native/yakeNative.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/native/yakeNative.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -86,3 +86,4 @@
 } // yake
 
 #endif // YAKE_BASE_NATIVE_NATIVE_H
+

Modified: trunk/yake/yake/base/templates/yakePointer.h
===================================================================
--- trunk/yake/yake/base/templates/yakePointer.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/templates/yakePointer.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -32,7 +32,7 @@
 //============================================================================
 // Standard headers
 #ifndef YAKE_BASEPREREQUISITES_H
-#	include "../yakePrerequisites.h"
+#	include <yake/base/yakePrerequisites.h>
 #endif
 // Boost
 #include <boost/shared_ptr.hpp>
@@ -91,7 +91,7 @@
 	};
 
 	template<class T, class U>
-    bool operator==(SharedPtr<T> const & a, SharedPtr<U> const & b)
+	bool operator==(SharedPtr<T> const & a, SharedPtr<U> const & b)
 	{
 		return (::boost::shared_ptr<T>(a) == ::boost::shared_ptr<U>(b) );
 	}

Modified: trunk/yake/yake/base/templates/yakeRegistry.h
===================================================================
--- trunk/yake/yake/base/templates/yakeRegistry.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/templates/yakeRegistry.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -32,7 +32,7 @@
 //============================================================================
 // Standard headers
 #ifndef YAKE_BASEPREREQUISITES_H
-#include "../yakePrerequisites.h"
+#include "yake/base/yakePrerequisites.h"
 #endif
 // Yake
 #include <yake/base/yakeException.h>

Modified: trunk/yake/yake/base/yake.h
===================================================================
--- trunk/yake/yake/base/yake.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/yake.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -54,3 +54,4 @@
 } // yake
 
 #endif // YAKE_BASE_YAKE_H
+

Modified: trunk/yake/yake/base/yakeConfigFile.h
===================================================================
--- trunk/yake/yake/base/yakeConfigFile.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/yakeConfigFile.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -32,7 +32,7 @@
 //============================================================================
 // Standard headers
 #ifndef YAKE_BASE_PREREQUISITES_H
-#	include "yakePrerequisites.h"
+#	include <yake/base/yakePrerequisites.h>
 #endif
 
 //============================================================================
@@ -145,3 +145,4 @@
 } // yake
 
 #endif // YAKE_BASE_CONFIGFILE_H
+

Modified: trunk/yake/yake/base/yakeLibrary.h
===================================================================
--- trunk/yake/yake/base/yakeLibrary.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/yakeLibrary.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -66,7 +66,7 @@
 } // base
 } // yake
 
-// todo plattform independent library extension?
+// todo platform independent library extension?
 // windows : ".dll"
 // linux : ".so"
 #define YAKE_USE_LIB( dllname ) \
@@ -74,3 +74,4 @@
 	YAKE_ASSERT( pDynLib##dllname ).debug( "Out of memory." );
 
 #endif // YAKE_BASE_LIBRARY_H
+

Modified: trunk/yake/yake/base/yakeMovable.h
===================================================================
--- trunk/yake/yake/base/yakeMovable.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/yakeMovable.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -51,7 +51,6 @@
 */
 class YAKE_BASE_API Movable
 {
-	YAKE_DECLARE_CLASS( yake::Movable );
 protected:
 	Movable();
 // Class
@@ -60,12 +59,15 @@
 
 // Methods
 public:
-	virtual void setPosition( const Vector3& rPosition ) = 0;
-	virtual void setOrientation( const Quaternion& rOrientation ) = 0;
-	virtual Vector3 getPosition() const = 0;
-	virtual Quaternion getOrientation() const = 0;
+	virtual void setPosition( const math::Vector3& rPosition ) = 0;
+	virtual void setOrientation( const math::Quaternion& rOrientation ) = 0;
+	virtual math::Vector3 getPosition() const = 0;
+	virtual math::Quaternion getOrientation() const = 0;
+	virtual math::Vector3 getDerivedPosition() const = 0;
+	virtual math::Quaternion getDerivedOrientation() const = 0;
+	
 
-	inline virtual void translate( const Vector3& rDelta )
+	inline virtual void translate( const math::Vector3& rDelta )
 	{
 		setPosition( getPosition() + rDelta );
 	}

Modified: trunk/yake/yake/base/yakeProcessor.h
===================================================================
--- trunk/yake/yake/base/yakeProcessor.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/yakeProcessor.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -154,3 +154,4 @@
 } // yake
 
 #endif // YAKE_BASE_PROCESSOR_H
+

Modified: trunk/yake/yake/base/yakeString.h
===================================================================
--- trunk/yake/yake/base/yakeString.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/yakeString.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -54,6 +54,15 @@
 		lhs += ss.str();
 		return lhs;
 	}
+
+	template<typename T>
+	String operator << ( const String& lhs, const T& rhs)
+	{
+		StrStream ss;
+		ss << rhs;
+		return lhs + ss.str();
+	}
+
 	typedef Vector<String> StringVector;
 
 	class YAKE_BASE_API StringUtil

Modified: trunk/yake/yake/base/yakeTaggedListenerManager.h
===================================================================
--- trunk/yake/yake/base/yakeTaggedListenerManager.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/base/yakeTaggedListenerManager.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -40,7 +40,7 @@
 		listeners_.push_back( listener_list::value_type(listener,mode) );
 		if (!tag.empty())
 		{
-			tag_listener_map::const_iterator it = listenerMap_.find(tag);
+			typename tag_listener_map::const_iterator it = listenerMap_.find(tag);
 			YAKE_ASSERT( it == listenerMap_.end() );
 			if (it != listenerMap_.end())
 				listenerMap_.insert( tag_listener_map::value_type( tag, listener ) );
@@ -49,7 +49,7 @@
 	template<typename T_listener>
 	typename ListenerManager<T_listener>::listener_type* ListenerManager<T_listener>::getListener(const std::string& tag) const
 	{
-			tag_listener_map::const_iterator it = listenerMap_.find(tag);
+			typename tag_listener_map::const_iterator it = listenerMap_.find(tag);
 			YAKE_ASSERT( it != listenerMap_.end() );
 			if (it == listenerMap_.end())
 				return 0;

Modified: trunk/yake/yake/graphics/yakeGeometryAccess.h
===================================================================
--- trunk/yake/yake/graphics/yakeGeometryAccess.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/graphics/yakeGeometryAccess.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -62,15 +62,15 @@
 
 		virtual bool lockPositions( uint32 start, uint32 count, bool bRead = false ) = 0;
 		virtual bool unlockPositions() = 0;
-		virtual bool setPosition( uint32 index, const Vector3 & position ) = 0;
+		virtual bool setPosition( uint32 index, const math::Vector3 & position ) = 0;
 
 		virtual bool lockTexCoords( uint16 set, uint32 start, uint32 count, bool bRead = false ) = 0;
 		virtual bool unlockTexCoords( uint16 set ) = 0;
-		virtual bool setTexCoord( uint16 set, uint16 index, const Vector3 & uv ) = 0;
+		virtual bool setTexCoord( uint16 set, uint16 index, const math::Vector3 & uv ) = 0;
 
 		virtual bool lockColours( uint32 start, uint32 count, bool bRead = false ) = 0;
 		virtual bool unlockColours() = 0;
-		virtual bool setColour( uint32 index, const Color & colour ) = 0;
+		virtual bool setColour( uint32 index, const math::Color & colour ) = 0;
 
 		virtual bool lockIndices( uint32 start, uint32 count ) = 0;
 		virtual bool setIndex( uint32 index, uint32 value ) = 0;
@@ -94,19 +94,19 @@
 
 		virtual bool lockPositions( uint32 start, uint32 count, bool bRead = false ) = 0;
 		virtual bool unlockPositions() = 0;
-		virtual bool setPosition( uint32 index, const Vector3 & position ) = 0;
+		virtual bool setPosition( uint32 index, const math::Vector3 & position ) = 0;
 
 		virtual bool lockNormals( uint32 start, uint32 count, bool bRead = false ) = 0;
 		virtual bool unlockNormals() = 0;
-		virtual bool setNormal( uint32 index, const Vector3 & normal ) = 0;
+		virtual bool setNormal( uint32 index, const math::Vector3 & normal ) = 0;
 
 		virtual bool lockTexCoords( uint16 set, uint32 start, uint32 count, bool bRead = false ) = 0;
 		virtual bool unlockTexCoords( uint16 set ) = 0;
-		virtual bool setTexCoord( uint16 set, uint16 index, const Vector3 & uv ) = 0;
+		virtual bool setTexCoord( uint16 set, uint16 index, const math::Vector3 & uv ) = 0;
 
 		virtual bool lockColours( uint32 start, uint32 count, bool bRead = false ) = 0;
 		virtual bool unlockColours() = 0;
-		virtual bool setColour( uint32 index, const Color & colour ) = 0;
+		virtual bool setColour( uint32 index, const math::Color& colour ) = 0;
 
 		virtual bool lockIndices( uint32 start, uint32 count ) = 0;
 		virtual bool setIndex( uint32 index, uint32 value ) = 0;

Modified: trunk/yake/yake/graphics/yakeGraphicalWorld.h
===================================================================
--- trunk/yake/yake/graphics/yakeGraphicalWorld.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/graphics/yakeGraphicalWorld.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -42,6 +42,16 @@
 namespace yake {
 namespace graphics {
 
+	enum SceneDetailLevel
+	{
+	    /// Only points are rendered.
+	    SDL_POINTS = 1,
+	    /// Wireframe models are rendered.
+	    SDL_WIREFRAME = 2,
+	    /// Solid polygons are rendered.
+	    SDL_SOLID = 3
+	};
+
 	/**
 	*/
 	class YAKE_GRAPHICS_INTERFACE_API IParticleSystem : public GraphicsEntity
@@ -92,8 +102,8 @@
 		virtual void setEnabled( bool enabled ) = 0;
  		virtual void setCastsShadows( bool enabled ) = 0;
 
-		virtual void setDiffuseColour( const Color & colour ) = 0;
-		virtual void setSpecularColour( const Color & colour ) = 0;
+		virtual void setDiffuseColour( const math::Color& colour ) = 0;
+		virtual void setSpecularColour( const math::Color& colour ) = 0;
 
 		virtual void setAttenuation( real range, real constant, real linear, real quadratic ) = 0;
 		virtual real getAttenuationRange() const = 0;
@@ -110,8 +120,8 @@
 
 		/** Synonims for set/getOrientation.  Meaningful only for directional and spot lights
 		*/
-		virtual void setDirection( const Vector3& rDirection ) = 0;
-		virtual Vector3 getDirection() const = 0;
+		virtual void setDirection( const math::Vector3& rDirection ) = 0;
+		virtual math::Vector3 getDirection() const = 0;
 	};
 
 	/** A concrete instance of a mesh in a graphical world.
@@ -123,8 +133,9 @@
 		
 		virtual ISkeleton* getSkeleton() const = 0;
 		virtual void setVisible( bool visible ) = 0;
-		virtual void setMaterial( const String & materialName ) = 0;
-		virtual void setSubEntityMaterial( const String & subEntity, const String & materialName ) = 0;
+		virtual void setMaterial( const String& materialName ) = 0;
+		virtual void setSubEntityMaterial( const String& subEntity, const String& materialName ) = 0;
+		virtual void setRenderDetail( SceneDetailLevel sdl ) = 0;
 		//virtual void setReceivesShadows( bool receivesShadows ) = 0;
 		virtual void setCastsShadow( bool castsShadow ) = 0;
 	};
@@ -134,16 +145,6 @@
 	class YAKE_GRAPHICS_INTERFACE_API ICamera : public GraphicsEntity, public Movable
 	{
 	public:
-		enum SceneDetailLevel
-		{
-		/// Only points are rendered.
-			SDL_POINTS = 1,
-		/// Wireframe models are rendered.
-			SDL_WIREFRAME = 2,
-		/// Solid polygons are rendered.
-			SDL_SOLID = 3
-		};
-
 		enum ProjectionType
 		{
 			PT_ORTHOGRAPHIC,
@@ -183,30 +184,30 @@
 		Note that the 'up' vector for the camera will automatically be recalculated based on the
 		current 'up' vector (i.e. the roll will remain the same).
 		 */
-		virtual void setDirection( const Vector3& rVec ) = 0;
+		virtual void setDirection( const math::Vector3& rVec ) = 0;
 
         /** Gets the camera's direction.
 		*/
-		virtual Vector3 getDirection() const = 0;
+		virtual math::Vector3 getDirection() const = 0;
 
         /** Gets the camera's up vector.
 		 */
-		virtual Vector3 getUp() const = 0;
+		virtual math::Vector3 getUp() const = 0;
 
         /** Gets the camera's right vector.
 		 */
-		virtual Vector3 getRight() const = 0;
+		virtual math::Vector3 getRight() const = 0;
 		
 		virtual void setFixedYawEnabled( bool enabled ) = 0;
-		virtual void setFixedYawAxis( const Vector3& yawAxis ) = 0;
+		virtual void setFixedYawAxis( const math::Vector3& yawAxis ) = 0;
 	
 		/** Moves movable's position by the vector offset provided along it's own axes (relative to orientation).
 	 	*/
-		virtual void moveRelative( const Vector3& rVec ) = 0;
-		virtual void lookAt( const Vector3& target ) = 0;
+		virtual void moveRelative( const math::Vector3& rVec ) = 0;
+		virtual void lookAt( const math::Vector3& target ) = 0;
 
-		inline void rotate( const Quaternion& q );
-		inline void rotate( const Vector3& axis, real degrees );
+		inline void rotate( const math::Quaternion& q );
+		inline void rotate( const math::Vector3& axis, real degrees );
 		inline void pitch( const real degrees );
 		virtual void yaw( const real degrees ) = 0;
 		virtual void roll( const  real degrees ) = 0;
@@ -215,27 +216,27 @@
 			position.
 			@param screenX, screenY position where the ray intersects the viewport, in normalised screen coords [0,1]
 		*/
-		virtual Ray createCameraToViewportRay(const real screenX, const real screenY) const;
+		virtual math::Ray createCameraToViewportRay(const real screenX, const real screenY) const;
 
 		/** Retrieve the projection matrix. The matrix conforms to the right-handed rules.
 		*/
-		virtual Matrix4 getProjectionMatrix() const = 0;
-		virtual Matrix4 getViewMatrix() const = 0;
+		virtual math::Matrix4 getProjectionMatrix() const = 0;
+		virtual math::Matrix4 getViewMatrix() const = 0;
 	};
 
-	void ICamera::rotate(const Vector3 & axis, real degrees)
+	void ICamera::rotate(const math::Vector3& axis, real degrees)
 	{
-		Quaternion q;
-		q.FromAngleAxis(Math::AngleUnitsToRadians(degrees),axis);
-		rotate(q);
+	    math::Quaternion q;
+	    q.FromAngleAxis( math::Math::AngleUnitsToRadians(degrees), axis );
+	    rotate(q);
 	}
-	void ICamera::rotate(const Quaternion & q)
+	void ICamera::rotate(const math::Quaternion & q)
 	{
 		setOrientation( q * getOrientation() );
 	}
 	void ICamera::pitch( const real degrees )
 	{
-		const Vector3 xAxis = getOrientation() * Vector3::kUnitX;
+		const math::Vector3 xAxis = getOrientation() * math::Vector3::kUnitX;
 		rotate(xAxis, degrees);
 	}
 
@@ -261,10 +262,10 @@
 		};
 
 		/** Returns the position in parent's transform space. */
-		virtual Vector3 getPosition() const = 0;
+		virtual math::Vector3 getPosition() const = 0;
 		
 		/** Returns scene node position in transform space specified by ts parameter. */
-		virtual Vector3 getPosition( TransformSpace ts ) const = 0;
+		virtual math::Vector3 getPosition( TransformSpace ts ) const = 0;
 		
 		/** Adds a node as a child to this node.
 		*/
@@ -302,10 +303,12 @@
 
 		/** Set the scale for this node relative to the local coordinate system.
 		*/
-		virtual void setScale( const Vector3 & scale ) = 0;
+		virtual void setScale( const math::Vector3 & scale ) = 0;
 
-		virtual Vector3 getScale() const = 0;
+		virtual math::Vector3 getScale() const = 0;
 
+		virtual void setInheritScale( bool inherit ) = 0;
+
 		/** Returns a list of all child scene nodes of this scene node.
 		*/
 		virtual void getChildren( SceneNodePtrList& ret, bool bRecursive = false ) const = 0;
@@ -357,31 +360,31 @@
 
 		/** Return the position as transformed through the hierarchy of nodes.
 		*/
-		virtual Vector3 getDerivedPosition() const = 0;
+		virtual math::Vector3 getDerivedPosition() const = 0;
 
 		/** Return the position as transformed through the hierarchy of nodes.
 		*/
-		virtual void getDerivedPosition( Vector3& retPos ) const = 0;
+		virtual void getDerivedPosition( math::Vector3& retPos ) const = 0;
 
 		/** Return the orientation as transformed through the hierarchy of nodes.
 		*/
-		virtual Quaternion getDerivedOrientation() const = 0;
+		virtual math::Quaternion getDerivedOrientation() const = 0;
 
 		/** Return the orientation as transformed through the hierarchy of nodes.
 		*/
-		virtual void getDerivedOrientation( Quaternion& retRot ) const = 0;
+		virtual void getDerivedOrientation( math::Quaternion& retRot ) const = 0;
 
 		/** Translate this scene node by a given amount.
 			@param rDelta amount of translation.
 			@param relativeTo TransformSpace to use for the translation.
 		*/
-		virtual void translate( const Vector3& rDelta, const TransformSpace relativeTo = TS_PARENT ) = 0;
+		virtual void translate( const math::Vector3& rDelta, const TransformSpace relativeTo = TS_PARENT ) = 0;
 
 		/** Rotate this scene node by a given amount.
 			@param rDelta amount of rotation.
 			@param relativeTo TransformSpace to use for the rotation.
 		*/
-		virtual void rotate( const Quaternion& rDelta, const TransformSpace relativeTo = TS_PARENT ) = 0;
+		virtual void rotate( const math::Quaternion& rDelta, const TransformSpace relativeTo = TS_PARENT ) = 0;
 	};
 
 	/** Viewport abstract interface.
@@ -394,6 +397,8 @@
 		virtual ICamera* getAttachedCamera() const = 0;
 		virtual void setDimensions( real left, real top, real width, real height ) = 0;
 		virtual void setZ( int z ) = 0;
+		virtual void setBackgroundColor( const math::Color& col ) = 0;
+		virtual math::Color getBackgroundColor() const = 0;
 	};
 
 	class IMeshGeometryAccess;
@@ -445,7 +450,7 @@
 		virtual real getRenderWindowWidth() const = 0;
 		virtual real getRenderWindowHeight() const = 0;
 
-		virtual IEntity* pickEntity(const Ray& ray) = 0;
+		virtual IEntity* pickEntity(const math::Ray& ray) = 0;
 
 		YAKE_MEMBERSIGNAL_PUREINTERFACE( public, void(real), PreRender );
 		YAKE_MEMBERSIGNAL_PUREINTERFACE( public, void(real), PostRender );
@@ -462,3 +467,4 @@
 } // yake
 
 #endif // YAKE_GRAPHICALWORLD_H
+

Modified: trunk/yake/yake/graphics/yakeGraphicsSystem.h
===================================================================
--- trunk/yake/yake/graphics/yakeGraphicsSystem.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/graphics/yakeGraphicsSystem.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -99,3 +99,4 @@
 } // yake
 
 #endif // YAKE_GRAPHICSSYSTEM_H
+

Modified: trunk/yake/yake/object/ClassAndObjectIdManager.inl
===================================================================
--- trunk/yake/yake/object/ClassAndObjectIdManager.inl	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/object/ClassAndObjectIdManager.inl	2006-03-19 17:54:00 UTC (rev 1302)
@@ -103,7 +103,7 @@
 	template<typename classentry_type,typename objectid_type>
 	ResultCode ClassAndObjectIdManager<classentry_type,objectid_type>::registerClassId(const ClassId clsId, const classdata_type& data)
 	{
-		ClassMap::const_iterator it = classes_.find( clsId );
+		typename ClassMap::const_iterator it = classes_.find( clsId );
 		if (it != classes_.end())
 		{
 			if (classIds_.find( clsId ) != classIds_.end())
@@ -124,7 +124,7 @@
 	template<typename classentry_type,typename objectid_type>
 	objectid_type ClassAndObjectIdManager<classentry_type,objectid_type>::createObjectId(const typename objectid_type::ClassId clsId)
 	{
-		ClassMap::iterator it = classes_.find( clsId );
+		typename ClassMap::iterator it = classes_.find( clsId );
 		if (it == classes_.end())
 			return ObjectId::kNull;
 		uint16 no = it->second.nextSerialNo();
@@ -137,7 +137,7 @@
 	template<typename classentry_type,typename objectid_type>
 	ResultCode ClassAndObjectIdManager<classentry_type,objectid_type>::addObjectId(const ObjectId& objId)
 	{
-		ClassMap::iterator it = classes_.find( objId.classId() );
+		typename ClassMap::iterator it = classes_.find( objId.classId() );
 		if (it == classes_.end())
 			return RC_UNKNOWN_CLASS;
 		return it->second.addObjectId(objId);
@@ -145,7 +145,7 @@
 	template<typename classentry_type,typename objectid_type>
 	typename objectid_type::ObjectIdSet ClassAndObjectIdManager<classentry_type,objectid_type>::getObjectIds(const ClassId clsId) const
 	{
-		ClassMap::const_iterator it = classes_.find( clsId );
+		typename ClassMap::const_iterator it = classes_.find( clsId );
 		if (it == classes_.end())
 			return ObjectIdSet();
 		return it->second.getObjectIds();
@@ -153,16 +153,16 @@
 	template<typename classentry_type,typename objectid_type>
 	ResultCode ClassAndObjectIdManager<classentry_type,objectid_type>::removeObjectId(const ObjectId& objId)
 	{
-		ClassMap::iterator it = classes_.find( objId.classId() );
+		typename ClassMap::iterator it = classes_.find( objId.classId() );
 		if (it == classes_.end())
 			return RC_UNKNOWN_CLASS;
 		return it->second.removeObjectId( objId );
 	}
 	template<typename classentry_type,typename objectid_type>
-	typename const classentry_type::data_type& ClassAndObjectIdManager<classentry_type,objectid_type>::getClassData(const ClassId clsId) const
+	const typename classentry_type::data_type& ClassAndObjectIdManager<classentry_type,objectid_type>::getClassData(const ClassId clsId) const
 	{
-		ClassMap::const_iterator it = classes_.find( clsId );
+		typename ClassMap::const_iterator it = classes_.find( clsId );
 		if (it == classes_.end())
 			throw "ClassAndObjectIdManager<>::getClassData(): Class entry not found!";
 		return it->second.getData();
-	}
\ No newline at end of file
+	}

Modified: trunk/yake/yake/object/ObjectContainer.h
===================================================================
--- trunk/yake/yake/object/ObjectContainer.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/object/ObjectContainer.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -69,7 +69,7 @@
 		assert( !exists );
 		if (exists)
 			return false;
-		id2obj_.insert( IdObjMap::value_type(objId,obj) );
+		id2obj_.insert( typename IdObjMap::value_type(objId,obj) );
 		return true;
 	}
 	template<typename object_type,typename objectid_type>
@@ -78,7 +78,7 @@
 		assert( !objId.isNull() );
 		if (objId.isNull())
 			return 0;
-		IdObjMap::iterator it = id2obj_.find( objId );
+		typename IdObjMap::iterator it = id2obj_.find( objId );
 		assert( it != id2obj_.end() );
 		if (it == id2obj_.end())
 			return 0;
@@ -92,7 +92,7 @@
 		assert( !objId.isNull() );
 		if (objId.isNull())
 			return 0;
-		IdObjMap::const_iterator it = id2obj_.find( objId );
+		typename IdObjMap::const_iterator it = id2obj_.find( objId );
 		assert( it != id2obj_.end() );
 		if (it == id2obj_.end())
 			return 0;

Modified: trunk/yake/yake/object/ObjectManager.h
===================================================================
--- trunk/yake/yake/object/ObjectManager.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/object/ObjectManager.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -153,7 +153,7 @@
 		ClassIdSet ids = objMgr.getRegisteredClasses();
 		idMap.clear();
 		ClassId lastId = minId;
-		for (ClassIdSet::const_iterator itId = ids.begin(); itId != ids.end(); ++itId)
+		for (typename ClassIdSet::const_iterator itId = ids.begin(); itId != ids.end(); ++itId)
 		{
 			idMap.insert( std::make_pair(lastId++,*itId) );
 		}

Modified: trunk/yake/yake/object/ObjectManager.inl
===================================================================
--- trunk/yake/yake/object/ObjectManager.inl	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/object/ObjectManager.inl	2006-03-19 17:54:00 UTC (rev 1302)
@@ -56,7 +56,7 @@
 		assert( !id.empty() );
 		if (id.empty())
 			return std::make_pair(RC_INVALID_INPUT,0);
-		StringToClassIdMap::const_iterator it = strIdAliases_.find( id );
+		typename StringToClassIdMap::const_iterator it = strIdAliases_.find( id );
 		if (it == strIdAliases_.end())
 			return std::make_pair(RC_NOT_FOUND,0);
 		return std::make_pair(RC_OK,it->second);
@@ -94,7 +94,7 @@
 		if (rc != RC_OK)
 			return rc;
 
-		strIdAliases_.insert( StringToClassIdMap::value_type(name,clsId) );
+		strIdAliases_.insert( typename StringToClassIdMap::value_type(name,clsId) );
 
 		return RC_OK;
 	}
@@ -199,7 +199,7 @@
 	void ObjectManager<obj_type,objectid_type>::destroyAllObjects()
 	{
 		IdObjMap objs = objs_; // copy!
-		for (IdObjMap::const_iterator it = objs.begin(); it != objs.end(); ++it)
+		for (typename IdObjMap::const_iterator it = objs.begin(); it != objs.end(); ++it)
 		{
 			destroyObject( it->second );
 		}
@@ -215,7 +215,7 @@
 		assert( !obj->id().isNull() );
 		if (!obj->id().isNull())
 		{
-			IdObjMap::iterator it = objs_.find( obj->id() );
+			typename IdObjMap::iterator it = objs_.find( obj->id() );
 			if (it != objs_.end())
 				objs_.erase( obj->id() );
 		}
@@ -225,7 +225,7 @@
 		if (!idMgr_.hasClass( clsId ))
 		{
 			// try alias
-			ClassIdMap::const_iterator it = idAliases_.find( clsId );
+			typename ClassIdMap::const_iterator it = idAliases_.find( clsId );
 			assert( it != idAliases_.end() );
 			if (it == idAliases_.end())
 				return; //@FIXME or throw ?
@@ -245,7 +245,7 @@
 		data.destroy_( obj );
 	}
 	template<typename obj_type, typename objectid_type>
-	typename ObjectManager<obj_type,objectid_type>::object_type* ObjectManager<obj_type,objectid_type>::createObject(const std::string& id, const objectid_type& userObjId = objectid_type::kNull)
+	typename ObjectManager<obj_type,objectid_type>::object_type* ObjectManager<obj_type,objectid_type>::createObject(const std::string& id, const objectid_type& userObjId )
 	{
 		// check params
 		assert( !id.empty() );
@@ -259,7 +259,7 @@
 		return this->createObject( ret.second, userObjId );
 	}
 	template<typename obj_type, typename objectid_type>
-	typename ObjectManager<obj_type,objectid_type>::object_type* ObjectManager<obj_type,objectid_type>::createObject(const ClassId clsId, const objectid_type& userObjId = objectid_type::kNull)
+	typename ObjectManager<obj_type,objectid_type>::object_type* ObjectManager<obj_type,objectid_type>::createObject(const ClassId clsId, const objectid_type& userObjId)
 	{
 		if (!userObjId.isNull())
 		{
@@ -272,7 +272,7 @@
 		if (!idMgr_.hasClass( theClsId ))
 		{
 			// try alias
-			ClassIdMap::const_iterator it = idAliases_.find( theClsId );
+			typename ClassIdMap::const_iterator it = idAliases_.find( theClsId );
 			assert( it != idAliases_.end() );
 			if (it == idAliases_.end())
 				return 0;

Modified: trunk/yake/yake/object/common.h
===================================================================
--- trunk/yake/yake/object/common.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/object/common.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -48,10 +48,6 @@
 
 	/** Common types */
 
-	typedef unsigned __int16 uint16;
-	typedef unsigned __int32 uint32;
-	typedef unsigned __int8 uint8;
-
 	enum ResultCode
 	{
 		RC_OK,
@@ -82,7 +78,7 @@
 		@return true if element was erased, false if element couldn't be found in the container.
 	*/
 	template<typename T>
-		bool safeErase( T& container, typename const T::value_type value)
+		bool safeErase( T& container, const typename T::value_type value)
 	{
 		typename T::iterator it = std::find(container.begin(), container.end(), value);
 		if (it == container.end())
@@ -94,7 +90,7 @@
 		@return true if element was found in the container, false if not.
 	*/
 	template<typename T>
-		bool contains( const T& container, typename const T::value_type& value)
+		bool contains( const T& container, const typename T::value_type& value)
 	{
 		return (container.end() != std::find(container.begin(), container.end(), value));
 	}
@@ -102,7 +98,7 @@
 		@return true if element was found in the container, false if not.
 	*/
 	template<typename T>
-		bool map_contains( const T& container, typename const T::key_type key)
+		bool map_contains( const T& container, const typename T::key_type key)
 	{
 		return (container.end() != container.find(key));
 	}
@@ -111,3 +107,4 @@
 } // namespace yake
 
 #endif
+

Modified: trunk/yake/yake/physics/yakeAffectorZone.h
===================================================================
--- trunk/yake/yake/physics/yakeAffectorZone.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/physics/yakeAffectorZone.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -140,3 +140,4 @@
 }
 
 #endif
+

Modified: trunk/yake/yake/physics/yakePhysicsActor.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsActor.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/physics/yakePhysicsActor.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -45,13 +45,21 @@
 		virtual void onAddShape(IShape* pShape);
 	};
 
+	/** Structure describes collision event between two actors.
+	 * Respective collided shapes are supplied.
+	 */
 	struct ActorCollisionInfo
 	{
 		IActor*	pThis;
+		IShape* pThisShape_;
+
 		IActor*	pOther;
-		ActorCollisionInfo( IActor* pThisActor = 0, IActor* pOtherActor = 0) :
-			pThis( pThisActor ),
-			pOther( pOtherActor )
+		IShape* pOtherShape_;
+
+		ActorCollisionInfo( IActor* pThisActor = 0, IShape* pThisShape = 0, 
+				    IActor* pOtherActor = 0, IShape* pOtherShape = 0 ) :
+			pThis( pThisActor ), pThisShape_( pThisShape ),
+			pOther( pOtherActor ), pOtherShape_( pOtherShape )
 		{}
 	};
 
@@ -84,20 +92,22 @@
 		virtual IBody* getBodyPtr() const = 0;
 		virtual IBody& getBody() const = 0;
 
-		virtual void setPosition(const Vector3& position) = 0;
-		virtual Vector3 getPosition() const = 0;
+		// inherited from yake::Movable
+	//	virtual void setPosition(const math::Vector3& position) = 0;
+	//	virtual math::Vector3 getPosition() const = 0;
 
-		virtual void setOrientation( const Quaternion & rkOrientation ) = 0;
-		virtual Quaternion getOrientation() const = 0;
+	//	virtual void setOrientation( const math::Quaternion & rkOrientation ) = 0;
+	//	virtual math::Quaternion getOrientation() const = 0;
 
 		virtual void setEnabled(const bool enabled) = 0;
 		virtual bool isEnabled() const = 0;
 
-		YAKE_MEMBERSIGNAL_PUREINTERFACE( public, void(ActorCollisionInfo&), CollisionEntered )
-		YAKE_MEMBERSIGNAL_PUREINTERFACE( public, void(ActorCollisionInfo&), CollisionExited )
+		YAKE_MEMBERSIGNAL_PUREINTERFACE( public, void(const ActorCollisionInfo&), CollisionEntered )
+		YAKE_MEMBERSIGNAL_PUREINTERFACE( public, void(const ActorCollisionInfo&), CollisionExited )
 	};
 	YAKE_PHYSICS_COMMON_POINTERS( IActor );
 
 }
 }
 #endif
+

Modified: trunk/yake/yake/physics/yakePhysicsAffectors.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsAffectors.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/physics/yakePhysicsAffectors.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -73,7 +73,7 @@
 
 	/** A directional constant acceleration affector. Actually it could be used for dynamic accelerations, too.
 	*/
-	class ConstantDirectionalAccelerationBodyAffector : public ConstantAccelerationBodyAffector<Vector3>
+	class ConstantDirectionalAccelerationBodyAffector : public ConstantAccelerationBodyAffector<math::Vector3>
 	{
 		YAKE_DECLARE_CONCRETE( ConstantDirectionalAccelerationBodyAffector, "yake.constant_directional_acceleration" )
 	public:
@@ -91,22 +91,21 @@
 	{
 		YAKE_DECLARE_CONCRETE( BodyConstantSphericalAccelerationAffector, "yake.constant_spherical_acceleration" )
 	protected:
-		Vector3		mPoint;
+		math::Vector3		mPoint;
 	public:
-		BodyConstantSphericalAccelerationAffector( const Vector3 & point = Vector3::kZero, const real acc = 1. ) : 
+		BodyConstantSphericalAccelerationAffector( const math::Vector3 & point = math::Vector3::kZero, const real acc = 1. ) : 
 			mPoint( point ), 
 			ConstantAccelerationBodyAffector<real>( acc )
 		{ }
 
 		virtual void applyTo( IBody & rBody, const real timeElapsed )
 		{
-			Vector3 direction = rBody.getActor().getPosition() - mPoint;
+			math::Vector3 direction = rBody.getActor().getPosition() - mPoint;
 			direction.normalise();
 			rBody.addForce( direction * mAcceleration * rBody.getMass() );
 		}
 	};
 
-
 }
 }
 

Modified: trunk/yake/yake/physics/yakePhysicsAvatar.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsAvatar.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/physics/yakePhysicsAvatar.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -51,23 +51,23 @@
 	public:
 		struct Desc
 		{
-			Desc(	const Vector3 & rkDimensions = Vector3(0,2,0),
-					const Vector3 & rkPosition = Vector3::kZero,
-					const Quaternion & rkOrientation = Quaternion::kIdentity) :
+			Desc(	const math::Vector3 & rkDimensions = math::Vector3(0,2,0),
+					const math::Vector3 & rkPosition = math::Vector3::kZero,
+					const math::Quaternion & rkOrientation = math::Quaternion::kIdentity) :
 				position( rkPosition ),
 				orientation( rkOrientation ),
 				dimensions( rkDimensions )
 			{}
-			Vector3		position;
-			Quaternion	orientation;
-			Vector3		dimensions;
+			math::Vector3		position;
+			math::Quaternion	orientation;
+			math::Vector3		dimensions;
 		};
 	public:
 
-		virtual void setDimensions( const Vector3 & rkDimensions ) = 0;
+		virtual void setDimensions( const math::Vector3 & rkDimensions ) = 0;
 		virtual void setInfluenceByDynamics( const real ratio ) = 0;
 
-		virtual void setTargetVelocity( const Vector3 & rkTargetVelocity ) = 0;
+		virtual void setTargetVelocity( const math::Vector3 & rkTargetVelocity ) = 0;
 		virtual void jump() = 0;
 		virtual bool isJumping() const = 0;
 		virtual void duck(const bool yes) = 0;
@@ -82,3 +82,4 @@
 }
 
 #endif
+

Modified: trunk/yake/yake/physics/yakePhysicsBody.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsBody.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/physics/yakePhysicsBody.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -43,14 +43,14 @@
 
 	struct YAKE_PHYSICS_API Force
 	{
-		Vector3			force;
+		math::Vector3			force;
 		real				duration;
 		ReferenceFrame	frameType;
 
 		Force() :
 			duration(0)
 		{}
-		Force( const Vector3& f, const real t, const ReferenceFrame rf = RF_GLOBAL ) :
+		Force( const math::Vector3& f, const real t, const ReferenceFrame rf = RF_GLOBAL ) :
 			force(f),
 			duration(t),
 			frameType(rf)
@@ -100,20 +100,20 @@
 			}
 			void reset()
 			{
-				linVelocity = Vector3::kZero;
-				angVelocity = Vector3::kZero;
-				massOffset = Vector3::kZero;
+				linVelocity = math::Vector3::kZero;
+				angVelocity = math::Vector3::kZero;
+				massOffset = math::Vector3::kZero;
 				totalMass = real(1.);
 			}
-			Vector3		linVelocity;
-			Vector3		angVelocity;
+			math::Vector3		linVelocity;
+			math::Vector3		angVelocity;
 			real		totalMass;
-			Vector3		massOffset;
+			math::Vector3		massOffset;
 		};
 
 		struct MassDesc
 		{
-			MassDesc( real massOrDensity, const Vector3& rOffset = Vector3::kZero, quantityType type = QT_MASS ) :
+			MassDesc( real massOrDensity, const math::Vector3& rOffset = math::Vector3::kZero, quantityType type = QT_MASS ) :
 					quantity( massOrDensity ),
 					offset( rOffset ),
 					qType( type )
@@ -121,19 +121,19 @@
 
 			virtual ~MassDesc() {}
 
-			real 			quantity; /// For all of them. You can set total mass via setMass
-			Vector3		offset; /// Mass can be offseted. TODO Add rotation "offset"?
-			quantityType qType;
+			real 		quantity; /// For all of them. You can set total mass via setMass
+			math::Vector3		offset; /// Mass can be offseted. TODO Add rotation "offset"?
+			quantityType	qType;
 		};
 
 		struct SphereMassDesc : public MassDesc
 		{
 			SphereMassDesc(	real radiusValue,
-								real shapeDensity,
-								const Vector3& rOffset = Vector3::kZero,
-								quantityType type = QT_MASS ) :
-									MassDesc( shapeDensity, rOffset, type ),
-							 		radius( radiusValue )
+					real shapeDensity,
+					const math::Vector3& rOffset = math::Vector3::kZero,
+					quantityType type = QT_MASS ) :
+							MassDesc( shapeDensity, rOffset, type ),
+					 		radius( radiusValue )
 			{}
 
 			real radius;
@@ -142,32 +142,32 @@
 		struct BoxMassDesc : public MassDesc
 		{
 			BoxMassDesc(	real boxSizeX,
-							real boxSizeY,
-							real boxSizeZ,
-							real shapeDensity,
-							const Vector3& rOffset = Vector3::kZero,
-							quantityType type = QT_MASS ) :
-								MassDesc( shapeDensity, rOffset, type ),
-								sizeX( boxSizeX ),
-								sizeY( boxSizeY ),
-								sizeZ( boxSizeZ )
+					real boxSizeY,
+					real boxSizeZ,
+					real shapeDensity,
+					const math::Vector3& rOffset = math::Vector3::kZero,
+					quantityType type = QT_MASS ) :
+						MassDesc( shapeDensity, rOffset, type ),
+					 	sizeX( boxSizeX ),
+						sizeY( boxSizeY ),
+						sizeZ( boxSizeZ )
 			{}
 
-			real	sizeX;
+			real sizeX;
 			real sizeY;
 			real sizeZ;
 		};
 
 		struct CapsuleMassDesc : public MassDesc /// Corresponds to ODE CappedCylinder
 		{
-			CapsuleMassDesc(	real capRadius,
-								real capLength,
-								real shapeDensity,
-								const Vector3& rOffset = Vector3::kZero,
-								quantityType type = QT_MASS ) :
-									MassDesc( shapeDensity, rOffset, type ),
-									radius( capRadius ),
-									length( capLength )
+			CapsuleMassDesc( real capRadius,
+				         real capLength,
+					 real shapeDensity,
+				         const math::Vector3& rOffset = math::Vector3::kZero,
+					 quantityType type = QT_MASS ) :
+						MassDesc( shapeDensity, rOffset, type ),
+						radius( capRadius ),
+						length( capLength )
 			{}
 
 			real radius;
@@ -176,14 +176,14 @@
 
 		struct CylinderMassDesc : public MassDesc
 		{
-			CylinderMassDesc(	real cylRadius,
-								real cylLength,
-								real shapeDensity,
-								const Vector3& rOffset = Vector3::kZero,
-								quantityType type = QT_MASS ) :
-									MassDesc( shapeDensity, rOffset, type ),
-									radius( cylRadius ),
-									length( cylLength )
+			CylinderMassDesc( real cylRadius,
+					  real cylLength,
+					  real shapeDensity,
+					  const math::Vector3& rOffset = math::Vector3::kZero,
+					  quantityType type = QT_MASS ) :
+						MassDesc( shapeDensity, rOffset, type ),
+						radius( cylRadius ),
+						length( cylLength )
 			{}
 
 			real radius;
@@ -225,19 +225,19 @@
 
 		/** Sets the linear velocity of the body/actor directly, i.e. with immediate effect.
 		*/
-		virtual void setLinearVelocity( const Vector3& rVelocity ) = 0;
+		virtual void setLinearVelocity( const math::Vector3& rVelocity ) = 0;
 
 		/** Returns the current velocity of the body.
 		*/
-		virtual Vector3 getLinearVelocity() const = 0;
+		virtual math::Vector3 getLinearVelocity() const = 0;
 
 		/** Sets the angular velocity [rad/s] of the body/actor directly, i.e. with immediate effect.
 		*/
-		virtual void setAngularVelocity( const Vector3& rVelocity ) = 0;
+		virtual void setAngularVelocity( const math::Vector3& rVelocity ) = 0;
 
 		/** Returns the angular velocity of the body in [rad/s].
 		*/
-		virtual Vector3 getAngularVelocity() const = 0;
+		virtual math::Vector3 getAngularVelocity() const = 0;
 
 		/** Adds a force. The specifics are detailed in the Force object.
 		*/
@@ -245,42 +245,44 @@
 
 		/** Adds a force defined in the global reference frame. 
 		*/
-		virtual void addForce( const Vector3& rForce ) = 0;
+		virtual void addForce( const math::Vector3& rForce ) = 0;
 
 		/** Adds a force defined in the global reference frame, acting at a position defined
 			in the global reference frame.
 		*/
-		virtual void addForceAtPos( const Vector3& rForce, const Vector3& rPos ) = 0;
+		virtual void addForceAtPos( const math::Vector3& rForce, const math::Vector3& rPos ) = 0;
 
 		/** Adds a force defined in the global reference frame, acting at a position defined
 			in the local reference frame.
 		*/
-		virtual void addForceAtLocalPos( const Vector3& rForce, const Vector3& rPos ) = 0;
+		virtual void addForceAtLocalPos( const math::Vector3& rForce, const math::Vector3& rPos ) = 0;
 
 		/** Adds a force defined in the local reference frame.
 		*/
-		virtual void addLocalForce( const Vector3& rForce ) = 0;
+		virtual void addLocalForce( const math::Vector3& rForce ) = 0;
 
 		/** Adds a force defined in the local reference frame, acting at a position defined
 			in the local reference frame (relative to the actor the body object belongs to).
 		*/
-		virtual void addLocalForceAtLocalPos( const Vector3& rForce, const Vector3& rPos ) = 0;
+		virtual void addLocalForceAtLocalPos( const math::Vector3& rForce, const math::Vector3& rPos ) = 0;
 
 		/** Adds a force defined in the local reference frame, acting at a position defined
 			in the global reference frame.
 		*/
-		virtual void addLocalForceAtPos( const Vector3& rForce, const Vector3& rPos ) = 0;
+		virtual void addLocalForceAtPos( const math::Vector3& rForce, const math::Vector3& rPos ) = 0;
 
 		/** Adds a torque defined in the global reference frame.
 		*/
-		virtual void addTorque( const Vector3& rTorque ) = 0;
+		virtual void addTorque( const math::Vector3& rTorque ) = 0;
 
 		/** Adds a torque defined in the local reference frame.
 		*/
-		virtual void addLocalTorque( const Vector3& rTorque ) = 0;
+		virtual void addLocalTorque( const math::Vector3& rTorque ) = 0;
 	};
 	YAKE_PHYSICS_COMMON_POINTERS( IBody );
 
 }
 }
+
 #endif
+

Modified: trunk/yake/yake/physics/yakePhysicsBodyGroup.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsBodyGroup.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/physics/yakePhysicsBodyGroup.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -63,3 +63,4 @@
 }
 }
 #endif
+

Modified: trunk/yake/yake/physics/yakePhysicsJoint.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsJoint.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/physics/yakePhysicsJoint.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -108,7 +108,7 @@
 		struct DescFixed : DescBase
 		{
 			DescFixed(	IActor* pFirst,
-						IActor* pSecond ) :
+				IActor* pSecond ) :
 				DescBase( JT_FIXED,pFirst,pSecond )
 			{}
 		};
@@ -117,70 +117,70 @@
 		{
 			DescHinge(	IActor* pFirst,
 						IActor* pSecond,
-						const Vector3& rAxis,
-						const Vector3& rAnchor ) :
+						const math::Vector3& rAxis,
+						const math::Vector3& rAnchor ) :
 				DescBase( JT_HINGE,pFirst,pSecond ),
 				axis( rAxis ),
 				anchor( rAnchor )
 			{}
-			Vector3		axis;
-			Vector3		anchor;
+			math::Vector3		axis;
+			math::Vector3		anchor;
 		};
 
 		struct DescHinge2 : DescBase
 		{
 			DescHinge2(	IActor* pFirst,
 						IActor* pSecond,
-						const Vector3& rAxis0, 
-						const Vector3& rAxis1,
-						const Vector3& rAnchor ) :
+						const math::Vector3& rAxis0, 
+						const math::Vector3& rAxis1,
+						const math::Vector3& rAnchor ) :
 				DescBase( JT_HINGE2,pFirst,pSecond ),
 				axis0( rAxis0 ),
 				axis1( rAxis1 ),
 				anchor( rAnchor )
 			{}
-			Vector3		axis0;
-			Vector3		axis1;
-			Vector3		anchor;
+			math::Vector3		axis0;
+			math::Vector3		axis1;
+			math::Vector3		anchor;
 		};
 
 		struct DescBall : DescBase
 		{
 			DescBall(	IActor* pFirst,
-						IActor* pSecond,
-						const Vector3& rAnchor ) :
-				DescBase( JT_BALL, pFirst, pSecond ),
-				anchor( rAnchor )
+				IActor* pSecond,
+				const math::Vector3& rAnchor ) :
+			    DescBase( JT_BALL, pFirst, pSecond ),
+			    anchor( rAnchor )
 			{}
-			Vector3		anchor;
+			math::Vector3		anchor;
 		};
 	
 		struct DescSlider : DescBase
 		{
 			DescSlider(	IActor* pFirst,
 						IActor* pSecond,
-						const Vector3& rAxis ) :
+						const math::Vector3& rAxis ) :
 				DescBase( JT_SLIDER, pFirst, pSecond ),
 				axis( rAxis )
 			{}
-			Vector3		axis;
+			math::Vector3		axis;
 		};
 	
 		struct DescUniversal : DescBase
 		{
 			DescUniversal(	IActor* pFirst,
 							IActor* pSecond,
-							const Vector3& rAxis0, 
-							const Vector3& rAxis1,
-							const Vector3& rAnchor ) :
+							const math::Vector3& rAxis0, 
+							const math::Vector3& rAxis1,
+							const math::Vector3& rAnchor ) :
 				DescBase( JT_UNIVERSAL, pFirst, pSecond ),
 				axis0( rAxis0 ),
 				axis1( rAxis1 ),
 				anchor( rAnchor )
  			{}
- 			Vector3		axis0;
- 			Vector3		axis1;
-			Vector3		anchor;
+ 			math::Vector3		axis0;
+ 			math::Vector3		axis1;
+			math::Vector3		anchor;
  		};
 	public:
 		virtual ~IJoint() {}
@@ -190,9 +190,9 @@
 
 		virtual JointType getType() const = 0;
 		virtual size_t getNumAxis() const = 0;
-		virtual void setAxis(size_t axisIndex, const Vector3& rAxis) = 0;
+		virtual void setAxis(size_t axisIndex, const math::Vector3& rAxis) = 0;
 		virtual size_t getNumAnchors() const = 0;
-		virtual void setAnchor(size_t anchorIndex, const Vector3& rAnchor) = 0;
+		virtual void setAnchor(size_t anchorIndex, const math::Vector3& rAnchor) = 0;
 		virtual void setMotor(size_t axisIndex, real velocityTarget, real maximumForce) = 0;
 		virtual void setMotorEnabled(size_t axisIndex, bool enabled) = 0;
 		virtual void setLimits(size_t axisIndex, real low, real high) = 0;
@@ -214,3 +214,4 @@
 }
 }
 #endif
+

Modified: trunk/yake/yake/physics/yakePhysicsMaterial.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsMaterial.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/physics/yakePhysicsMaterial.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -77,3 +77,4 @@
 }
 }
 #endif
+

Modified: trunk/yake/yake/physics/yakePhysicsMotors.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsMotors.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/physics/yakePhysicsMotors.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -67,8 +67,8 @@
 		virtual void setAffectedBody( IBody& rBody ) = 0;
 		virtual void setVelocityTarget( const real velTarget ) = 0;
 		virtual void setMaximumForce( const real maxForce ) = 0;
-		virtual void setAxis0( const Vector3& rAxis ) = 0;
-		virtual void setAxis1( const Vector3& rAxis ) = 0;
+		virtual void setAxis0( const math::Vector3& rAxis ) = 0;
+		virtual void setAxis1( const math::Vector3& rAxis ) = 0;
 		virtual void set( const real velTarget, const real maxForce, bool enabled = true ) = 0;
 	};
 	YAKE_PHYSICS_COMMON_POINTERS( IAngularMotor );
@@ -81,7 +81,7 @@
 		virtual void setAffectedBody( IBody& rBody ) = 0;
 		virtual void setVelocityTarget( const real velTarget ) = 0;
 		virtual void setMaximumForce( const real maxForce ) = 0;
-		virtual void setAxis( const Vector3& rAxis ) = 0;
+		virtual void setAxis( const math::Vector3& rAxis ) = 0;
 		virtual void set( const real velTarget, const real maxForce, bool enabled = true ) = 0;
 	};
 	YAKE_PHYSICS_COMMON_POINTERS( ILinearMotor );

Modified: trunk/yake/yake/physics/yakePhysicsPrerequisites.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsPrerequisites.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/physics/yakePhysicsPrerequisites.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -79,12 +79,12 @@
 
 	struct TriangleMeshDesc
 	{
-		/** Important Notice: Vector3Vector, VertexVector, NormalVector and IndexVector HAVE to
+		/** Important Notice: math::Vector3Vector, VertexVector, NormalVector and IndexVector HAVE to
 			be vectors because they may be accessed like C arrays ( e.g. &arr[0] ).
 			Is this OK? Today, it's practically OK and tomorrow it'll be even more as it's part
 			of the first Technical Corrigendum.
 		*/
-		typedef std::vector<Vector3> Vector3Vector;
+		typedef std::vector<math::Vector3> Vector3Vector;
 		typedef Vector3Vector VertexVector;
 		typedef Vector3Vector NormalVector;
 		typedef uint32 IndexType;
@@ -109,7 +109,7 @@
 		}
 		
 		VertexVector	vertices;
-		IndexVector		indices;
+		IndexVector	indices;
 		NormalVector	normals;
 	};
 }

Modified: trunk/yake/yake/physics/yakePhysicsShape.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsShape.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/physics/yakePhysicsShape.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -35,110 +35,113 @@
 namespace physics {
 
 	/**
-		YAKE         ODE               NX
-		Plane        Plane             Plane
-		Box          Box               Box
-		Sphere       Sphere            Sphere
-		Capsule      Capped Cylinder   Capsule
-		Cylinder     ?                 ?           (could be approximated with a shorter capsule...)
-		Tri Mesh     TriMesh           Mesh
-		Voxel Set    ?                 ?
-		Transform    ?                 ?           (could be simulated)
-	*/
+	  YAKE         ODE               NX
+	  Plane        Plane             Plane
+	  Box          Box               Box
+	  Sphere       Sphere            Sphere
+	  Capsule      Capped Cylinder   Capsule
+	  Cylinder     ?                 ?           (could be approximated with a shorter capsule...)
+	  Tri Mesh     TriMesh           Mesh
+	  Voxel Set    ?                 ?
+	  Transform    ?                 ?           (could be simulated)
+	  */
 	enum ShapeType
 	{
-		ST_PLANE,
-		ST_BOX,
-		ST_SPHERE,
-		ST_CAPSULE,
-		ST_CYLINDER,
-		ST_TRIANGLE_MESH,
-		ST_VOXEL_SET,
-		ST_OTHER
+	    ST_PLANE,
+	    ST_BOX,
+	    ST_SPHERE,
+	    ST_CAPSULE,
+	    ST_CYLINDER,
+	    ST_TRIANGLE_MESH,
+	    ST_VOXEL_SET,
+	    ST_OTHER
 	};
 
 	class IMaterial;
-	/** A shape is what we formerly called "collision geom" in yake::physics. */
 	class YAKE_PHYSICS_API IShape : public Movable
 	{
-	public:
+	    public:
 		struct Desc
 		{
-			Desc(	const ShapeType type_,
-					const Vector3& rPosition = Vector3::kZero, 
-					const Quaternion& rOrientation = Quaternion::kIdentity,
-					const String& material_ = "" ) :
-				type( type_ ),
-				position( rPosition ),
-				orientation( rOrientation ),
-				material( material_ )
-			{}
+		    Desc(   const ShapeType type_,
+			    const math::Vector3& rPosition = math::Vector3::kZero, 
+			    const math::Quaternion& rOrientation = math::Quaternion::kIdentity,
+			    const String& material_ = "" ) :
+			type( type_ ),
+			position( rPosition ),
+			orientation( rOrientation ),
+			material( material_ )
+		    {}
 
-			virtual ~Desc() {}
-			//virtual Desc* clone() const = 0;
+		    virtual ~Desc() {}
+		    //virtual Desc* clone() const = 0;
 
-			ShapeType	type; // superfluous as shape type is determined by dynamic_cast on Desc struct...
-			Vector3		position;
-			Quaternion	orientation;
-			String		material;
+		    ShapeType	type; // superfluous as shape type is determined by dynamic_cast on Desc struct...
+		    math::Vector3		position;
+		    math::Quaternion	orientation;
+		    String		material;
 		};
+
 		struct SphereDesc : Desc
 		{
-			SphereDesc(	real radius_ = real(1.),
-						// base class:
-						const String& material_ = "",
-						const Vector3& rPosition = Vector3::kZero, 
-						const Quaternion& rOrientation = Quaternion::kIdentity
-						 ) :
-				Desc( ST_SPHERE, rPosition, rOrientation, material_ ),
-				radius( radius_ )
-			{}
-			real		radius;
+		    SphereDesc(	real radius_ = real(1.),
+			    // base class:
+			    const String& material_ = "",
+			    const math::Vector3& rPosition = math::Vector3::kZero, 
+			    const math::Quaternion& rOrientation = math::Quaternion::kIdentity
+			    ) :
+			Desc( ST_SPHERE, rPosition, rOrientation, material_ ),
+			radius( radius_ )
+		    {}
+		    real		radius;
 		};
+
 		struct BoxDesc : Desc
 		{
-			BoxDesc(	const Vector3& rDimensions = Vector3(1,1,1),
-						// base class:
-						const String& material_ = "",
-						const Vector3& rPosition = Vector3::kZero, 
-						const Quaternion& rOrientation = Quaternion::kIdentity
-						 ) :
-				Desc( ST_BOX, rPosition, rOrientation, material_ ),
-				dimensions( rDimensions )
-			{}
-			Vector3		dimensions;
+		    BoxDesc(	const math::Vector3& rDimensions = math::Vector3(1,1,1),
+			    // base class:
+			    const String& material_ = "",
+			    const math::Vector3& rPosition = math::Vector3::kZero, 
+			    const math::Quaternion& rOrientation = math::Quaternion::kIdentity
+			   ) :
+			Desc( ST_BOX, rPosition, rOrientation, material_ ),
+			dimensions( rDimensions )
+		    {}
+		    math::Vector3		dimensions;
 		};
+
 		struct PlaneDesc : Desc
 		{
-			PlaneDesc(	const Vector3& rNormal = Vector3(0,1,0),
-						const real d_ = real(1.),
-						// base class:
-						const String& material_ = "",
-						const Vector3& rPosition = Vector3::kZero, 
-						const Quaternion& rOrientation = Quaternion::kIdentity
-						 ) :
-				Desc( ST_PLANE, rPosition, rOrientation, material_ ),
-				normal( rNormal ),
-				d( d_ )
-			{}
-			Vector3		normal;
-			real		d;
+		    PlaneDesc(	const math::Vector3& rNormal = math::Vector3(0,1,0),
+			    const real d_ = real(1.),
+			    // base class:
+			    const String& material_ = "",
+			    const math::Vector3& rPosition = math::Vector3::kZero, 
+			    const math::Quaternion& rOrientation = math::Quaternion::kIdentity
+			    ) :
+			Desc( ST_PLANE, rPosition, rOrientation, material_ ),
+			normal( rNormal ),
+			d( d_ )
+		    {}
+		    math::Vector3		normal;
+		    real		d;
 		};
+
 		struct CapsuleDesc : Desc
 		{
-			CapsuleDesc(const real height_ = real(2.),
-						const real radius_ = real(1.),
-						// base class:
-						const String& material_ = "",
-						const Vector3& rPosition = Vector3::kZero, 
-						const Quaternion& rOrientation = Quaternion::kIdentity
-						 ) :
-				Desc( ST_CAPSULE, rPosition, rOrientation, material_ ),
-				height( height_ ),
-				radius( radius_ )
-			{}
-			real		height;
-			real		radius;
+		    CapsuleDesc(const real height_ = real(2.),
+			    const real radius_ = real(1.),
+			    // base class:
+			    const String& material_ = "",
+			    const math::Vector3& rPosition = math::Vector3::kZero, 
+			    const math::Quaternion& rOrientation = math::Quaternion::kIdentity
+			    ) :
+			Desc( ST_CAPSULE, rPosition, rOrientation, material_ ),
+			height( height_ ),
+			radius( radius_ )
+		    {}
+		    real		height;
+		    real		radius;
 		};
 
 		struct TriMeshDesc : Desc
@@ -146,8 +149,8 @@
 		    TriMeshDesc(	const TriangleMeshDesc trimesh,
 			    // base class:
 			    const String& material_ = "",
-			    const Vector3& rPosition = Vector3::kZero, 
-			    const Quaternion& rOrientation = Quaternion::kIdentity
+			    const math::Vector3& rPosition = math::Vector3::kZero, 
+			    const math::Quaternion& rOrientation = math::Quaternion::kIdentity
 			    ) :
 				Desc( ST_TRIANGLE_MESH, rPosition, rOrientation, material_ ),
 				trimesh_( trimesh ),
@@ -156,8 +159,8 @@
 		    TriMeshDesc(	const TriangleMeshId trimeshId,
 			    // base class:
 			    const String& material_ = "",
-			    const Vector3& rPosition = Vector3::kZero, 
-			    const Quaternion& rOrientation = Quaternion::kIdentity
+			    const math::Vector3& rPosition = math::Vector3::kZero, 
+			    const math::Quaternion& rOrientation = math::Quaternion::kIdentity
 			    ) :
 				Desc( ST_TRIANGLE_MESH, rPosition, rOrientation, material_ ),
 				trimeshId_( trimeshId )
@@ -165,16 +168,18 @@
 		    TriangleMeshDesc	trimesh_;
 			TriangleMeshId		trimeshId_;
 		};
-	public:
+
+	    public:
 		virtual ~IShape() {}
 
 		virtual ShapeType getType() const = 0;
 		virtual void setMaterial( IMaterial* pMaterial ) = 0;
+		virtual IMaterial* getMaterial() const = 0;
 
-		//virtual Vector3 getDerivedPosition() const = 0;
-		//virtual Quaternion getDerivedOrientation() const = 0;
+		//virtual math::Vector3 getDerivedPosition() const = 0;
+		//virtual math::Quaternion getDerivedOrientation() const = 0;
 
-		virtual Vector3 getPropertyVector3(const String&) const = 0;
+		virtual math::Vector3 getPropertyVector3(const String&) const = 0;
 		virtual real getPropertyReal(const String&) const = 0;
 	};
 	YAKE_PHYSICS_COMMON_POINTERS( IShape );

Modified: trunk/yake/yake/physics/yakePhysicsWorld.h
===================================================================
--- trunk/yake/yake/physics/yakePhysicsWorld.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/physics/yakePhysicsWorld.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -79,10 +79,11 @@
 		virtual const StringVector getCurrentSolverParams() const = 0;
 		virtual void setCurrentSolverParam( const String& rName, const boost::any& rValue ) = 0;
 
-		virtual void setGlobalGravity( const Vector3& g ) = 0;
-		virtual Vector3 getGlobalGravity() const = 0;
+		virtual void setGlobalGravity( const math::Vector3& g ) = 0;
+		virtual math::Vector3 getGlobalGravity() const = 0;
 
 		virtual void step(const real timeElapsed) = 0;
+		virtual real getStepSize() const = 0;
 
 		YAKE_MEMBERSIGNAL_PUREINTERFACE( public, void(void), PreStep )
 		YAKE_MEMBERSIGNAL_PUREINTERFACE( public, void(real), PostStep )
@@ -92,3 +93,4 @@
 }
 }
 #endif
+

Modified: trunk/yake/yake/plugins/graphicsOgre/graphicsOgreCamera.h
===================================================================
--- trunk/yake/yake/plugins/graphicsOgre/graphicsOgreCamera.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/graphicsOgre/graphicsOgreCamera.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -41,43 +41,45 @@
 		virtual ~OgreCamera();
 
 		// Movable
-		virtual void setPosition( const Vector3 & position );
-		virtual Vector3 getPosition() const;
-		virtual void setOrientation( const Quaternion & orientation );
-		virtual Quaternion getOrientation() const;
-		
+		virtual void setPosition( const math::Vector3& position );
+		virtual void setOrientation( const math::Quaternion& orientation );
+		virtual math::Vector3 getPosition() const;
+		virtual math::Quaternion getOrientation() const;
+		virtual math::Vector3 getDerivedPosition() const;
+		virtual math::Quaternion getDerivedOrientation() const;
+
 		void setDetailLevel(SceneDetailLevel sd);
 
-        /** Retrieves the level of detail that the camera will render.
+		/** Retrieves the level of detail that the camera will render.
 		 */
 		SceneDetailLevel getDetailLevel(void) const;
 
-        /** Sets the camera's direction vector.
+		/** Sets the camera's direction vector.
 		@remarks
 		Note that the 'up' vector for the camera will automatically be recalculated based on the
 		current 'up' vector (i.e. the roll will remain the same).
 				 */
-		virtual void setDirection( const Vector3& rVec );
+		virtual void setDirection( const math::Vector3& rVec );
 
-        /** Gets the camera's direction.
+		/** Gets the camera's direction.
 		 */
-		virtual Vector3 getDirection() const;
+		virtual math::Vector3 getDirection() const;
 
         /** Gets the camera's up vector.
 		 */
-		virtual Vector3 getUp() const;
+		virtual math::Vector3 getUp() const;
 
         /** Gets the camera's right vector.
 		 */
-		virtual Vector3 getRight() const;
+		virtual math::Vector3 getRight() const;
 		
 		virtual void setFixedYawEnabled( bool enabled );
-		virtual void setFixedYawAxis( const Vector3& yawAxis );
+		virtual void setFixedYawAxis( const math::Vector3& yawAxis );
 	
 		/** Moves movable's position by the vector offset provided along it's own axes (relative to orientation).
 		 */
-		virtual void moveRelative( const Vector3& rVec );
-		virtual void lookAt( const Vector3& target );
+		virtual void moveRelative( const math::Vector3& rVec );
+		virtual void lookAt( const math::Vector3& target );
 		virtual void yaw( const real degrees );
 		virtual void roll( const  real degrees );
 
@@ -85,8 +87,8 @@
 		// ICamera
 		virtual void setProjectionType( const ProjectionType type );
 		virtual ProjectionType getProjectionType() const;
-		virtual Matrix4 getProjectionMatrix() const;
-		virtual Matrix4 getViewMatrix() const;
+		virtual math::Matrix4 getProjectionMatrix() const;
+		virtual math::Matrix4 getViewMatrix() const;
 		virtual void setNearClipDistance( real clipDistance );
 		virtual real getNearClipDistance() const;
 		virtual void setFarClipDistance( real clipDistance );
@@ -102,9 +104,9 @@
 		Ogre::SceneManager*	mSceneMgr;
 		Ogre::Camera*		mCam;
 	};
-
 }
 }
 }
 
 #endif
+

Modified: trunk/yake/yake/plugins/graphicsOgre/graphicsOgreCore.h
===================================================================
--- trunk/yake/yake/plugins/graphicsOgre/graphicsOgreCore.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/graphicsOgre/graphicsOgreCore.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -97,3 +97,4 @@
 }
 
 #endif
+

Modified: trunk/yake/yake/plugins/graphicsOgre/graphicsOgreEntity.h
===================================================================
--- trunk/yake/yake/plugins/graphicsOgre/graphicsOgreEntity.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/graphicsOgre/graphicsOgreEntity.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -1,7 +1,7 @@
 /*
    ------------------------------------------------------------------------------------
    This file is part of YAKE
-   Copyright ? 2004 The YAKE Team
+   Copyright  2004 The YAKE Team
    For the latest information visit http://www.yake.org 
    ------------------------------------------------------------------------------------
    This program is free software; you can redistribute it and/or modify it under
@@ -47,6 +47,8 @@
 		virtual void setMaterial( const String& materialName );
 		virtual void setSubEntityMaterial( const String& subEntity, const String& materialName );
 		virtual void setCastsShadow( bool castsShadow );
+		
+		virtual void setRenderDetail( SceneDetailLevel sdl );
 
 		Ogre::Entity* getEntity_() const
 		{ return mEntity; }
@@ -60,3 +62,4 @@
 }
 
 #endif
+

Modified: trunk/yake/yake/plugins/graphicsOgre/graphicsOgreGeometryAccess.h
===================================================================
--- trunk/yake/yake/plugins/graphicsOgre/graphicsOgreGeometryAccess.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/graphicsOgre/graphicsOgreGeometryAccess.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -29,7 +29,6 @@
 
 using namespace yake::base::mpl;
 using namespace yake::base::templates;
-using namespace yake::math;
 
 namespace yake {
 namespace graphics {
@@ -86,19 +85,19 @@
 
 		virtual bool lockPositions( uint32 start, uint32 count, bool bRead = false );
 		virtual bool unlockPositions();
-		virtual bool setPosition( uint32 index, const Vector3 & position );
+		virtual bool setPosition( uint32 index, const math::Vector3 & position );
 
 		virtual bool lockNormals( uint32 start, uint32 count, bool bRead = false );
 		virtual bool unlockNormals();
-		virtual bool setNormal( uint32 index, const Vector3 & normal );
+		virtual bool setNormal( uint32 index, const math::Vector3 & normal );
 
 		virtual bool lockTexCoords( uint16 set, uint32 start, uint32 count, bool bRead = false );
 		virtual bool unlockTexCoords( uint16 set );
-		virtual bool setTexCoord( uint16 set, uint16 index, const Vector3 & uv );
+		virtual bool setTexCoord( uint16 set, uint16 index, const math::Vector3 & uv );
 
 		virtual bool lockColours( uint32 start, uint32 count, bool bRead = false );
 		virtual bool unlockColours();
-		virtual bool setColour( uint32 index, const Color & colour );
+		virtual bool setColour( uint32 index, const math::Color& colour );
 
 		virtual bool lockIndices( uint32 start, uint32 count );
 		virtual bool setIndex( uint32 index, uint32 value );
@@ -111,3 +110,4 @@
 } // yake
 
 #endif
+

Modified: trunk/yake/yake/plugins/graphicsOgre/graphicsOgreLight.h
===================================================================
--- trunk/yake/yake/plugins/graphicsOgre/graphicsOgreLight.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/graphicsOgre/graphicsOgreLight.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -52,18 +52,18 @@
 		virtual real getSpotlightOuterAngle() const;
 		virtual real getSpotlightFalloff() const;
 
-		virtual void setDiffuseColour( const Color& colour );
-		virtual void setSpecularColour( const Color& colour );
+		virtual void setDiffuseColour( const math::Color& colour );
+		virtual void setSpecularColour( const math::Color& colour );
 
 		virtual void setEnabled( bool enabled );
 		virtual void setCastsShadows( bool enabled );
 
-		virtual void setPosition( const Vector3 & position );
-		virtual Vector3 getPosition() const;
-		virtual void setOrientation( const Quaternion & orientation );
-		virtual Quaternion getOrientation() const;
-		virtual void setDirection( const Vector3& direction );
-		virtual Vector3 getDirection() const;
+		virtual void setPosition( const math::Vector3 & position );
+		virtual math::Vector3 getPosition() const;
+		virtual void setOrientation( const math::Quaternion & orientation );
+		virtual math::Quaternion getOrientation() const;
+		virtual void setDirection( const math::Vector3& direction );
+		virtual math::Vector3 getDirection() const;
 
 		virtual const String& getName() { return mLight->getName(); }
 
@@ -79,3 +79,4 @@
 }
 
 #endif
+

Modified: trunk/yake/yake/plugins/graphicsOgre/graphicsOgreNode.h
===================================================================
--- trunk/yake/yake/plugins/graphicsOgre/graphicsOgreNode.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/graphicsOgre/graphicsOgreNode.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -41,22 +41,24 @@
 		OgreNode( Ogre::SceneNode * node, GraphicalWorld& owningWorld, Ogre::SceneManager * sceneMgr );
 		virtual ~OgreNode();
 
-		virtual void setPosition( const Vector3 & position );
-		virtual Vector3 getPosition() const;
-		virtual Vector3 getPosition( TransformSpace ts ) const;
-		virtual void setOrientation( const Quaternion & orientation );
-		virtual Quaternion getOrientation() const;
+		virtual void setPosition( const math::Vector3 & position );
+		virtual math::Vector3 getPosition() const;
+		virtual math::Vector3 getPosition( TransformSpace ts ) const;
+		virtual void setOrientation( const math::Quaternion & orientation );
+		virtual math::Quaternion getOrientation() const;
 
-		virtual void setScale( const Vector3 & scale );
-		virtual Vector3 getScale() const;
+		virtual void setScale( const math::Vector3 & scale );
+		virtual math::Vector3 getScale() const;
 
-		virtual Vector3 getDerivedPosition() const;
-		virtual void getDerivedPosition( Vector3& retPos ) const;
-		virtual Quaternion getDerivedOrientation() const;
-		virtual void getDerivedOrientation( Quaternion& retRot ) const;
-		virtual void translate( const Vector3& rDelta, const TransformSpace relativeTo = TS_PARENT );
-		virtual void rotate( const Quaternion& rDelta, const TransformSpace relativeTo = TS_PARENT );
+		virtual void setInheritScale( bool inherit );
 
+		virtual math::Vector3 getDerivedPosition() const;
+		virtual void getDerivedPosition( math::Vector3& retPos ) const;
+		virtual math::Quaternion getDerivedOrientation() const;
+		virtual void getDerivedOrientation( math::Quaternion& retRot ) const;
+		virtual void translate( const math::Vector3& rDelta, const TransformSpace relativeTo = TS_PARENT );
+		virtual void rotate( const math::Quaternion& rDelta, const TransformSpace relativeTo = TS_PARENT );
+
 		virtual void addChildNode( ISceneNode* pNode );
 		virtual ISceneNode* createChildNode( const String& name = "" );
 		virtual void attachEntity( IEntity* pEntity );
@@ -84,15 +86,15 @@
 		OgreNode* _getParent() const;
 	protected:
 		typedef SceneNodePtrList NodeList;
-		NodeList					mChildren;
-		EntityPtrList			mEntities;
-		LightPtrList			mLights;
-		CameraPtrList			mCameras;
+		NodeList		mChildren;
+		EntityPtrList		mEntities;
+		LightPtrList		mLights;
+		CameraPtrList		mCameras;
 		ParticleSystemPtrList	mParticleSystems;
 
 		Ogre::SceneNode* 		mSceneNode;
 		Ogre::SceneManager*	mSceneMgr;
-		OgreNode*				mParentNode;
+		OgreNode*		mParentNode;
 		GraphicalWorld&		mWorld;
 	};
 
@@ -101,3 +103,4 @@
 }
 
 #endif
+

Modified: trunk/yake/yake/plugins/graphicsOgre/graphicsOgreParticleSystem.h
===================================================================
--- trunk/yake/yake/plugins/graphicsOgre/graphicsOgreParticleSystem.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/graphicsOgre/graphicsOgreParticleSystem.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -33,7 +33,12 @@
 	class OgreParticleSystem : public graphics::IParticleSystem
 	{
 	public:
+// for Ogre 1.1.0 "Dagon" compatibility
+#if OGRE_VERSION_MINOR >= 1 
+		OgreParticleSystem( Ogre::SceneManager& rSMgr, const String& rPSTemplateName);
+#else
 		OgreParticleSystem( Ogre::ParticleSystemManager& rPSMgr, const String& rPSTemplateName);
+#endif
 		virtual ~OgreParticleSystem();
 
 		virtual void setVisible( bool visible );
@@ -51,7 +56,12 @@
 		}
 
 	protected:
+// for Ogre 1.1.0 "Dagon" compatibility
+#if OGRE_VERSION_MINOR >= 1 
+		Ogre::SceneManager&	mSceneMgr;
+#else
 		Ogre::ParticleSystemManager&	mParticleSysMgr;
+#endif
 		Ogre::ParticleSystem*			mParticleSys;
 	};
 
@@ -59,3 +69,4 @@
 } // yake
 
 #endif
+

Modified: trunk/yake/yake/plugins/graphicsOgre/graphicsOgreViewport.h
===================================================================
--- trunk/yake/yake/plugins/graphicsOgre/graphicsOgreViewport.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/graphicsOgre/graphicsOgreViewport.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -45,6 +45,10 @@
 
 		virtual void setDimensions( real left, real top, real width, real height );
 		virtual void setZ( int z );
+
+		virtual void setBackgroundColor( const math::Color& col );
+		virtual math::Color getBackgroundColor() const;
+
 	protected:
 		void killViewport();
 	protected:

Modified: trunk/yake/yake/plugins/graphicsOgre/yakeGraphicsSystem.h
===================================================================
--- trunk/yake/yake/plugins/graphicsOgre/yakeGraphicsSystem.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/graphicsOgre/yakeGraphicsSystem.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -39,6 +39,14 @@
 #	define YAKE_GRAPHICS_CONCRETE_API DLLIMPORT
 #endif
 
+#if YAKE_PLATFORM == PLATFORM_WIN32
+#	define YAKE_USE_OSM
+#	pragma message("Compiling graphicsOGRE with OSM support.")
+#else
+#	pragma message("Compiling graphicsOGRE without OSM support.")
+#endif
+
+
 #include <yake/plugins/graphicsOgre/yakeGraphicsWorld.h>
 
 //============================================================================
@@ -82,8 +90,10 @@
 		virtual const std::type_info & get_type_info()
 		{ return typeid(GraphicsSystem); }
 
+		OgreCore* _getCore() { return mCore; }
+
 	private: // data
-		OgreCore * mCore;
+		OgreCore* mCore;
 	};
 
 } // ogre3d

Modified: trunk/yake/yake/plugins/graphicsOgre/yakeGraphicsWorld.h
===================================================================
--- trunk/yake/yake/plugins/graphicsOgre/yakeGraphicsWorld.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/graphicsOgre/yakeGraphicsWorld.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -87,7 +87,7 @@
 		virtual real getRenderWindowWidth() const;
 		virtual real getRenderWindowHeight() const;
 
-		virtual IEntity* pickEntity(const Ray& ray);
+		virtual IEntity* pickEntity(const math::Ray& ray);
 
 		static void setCore( OgreCore* core );
 

Modified: trunk/yake/yake/plugins/graphicsOgre/yakePCH.h
===================================================================
--- trunk/yake/yake/plugins/graphicsOgre/yakePCH.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/graphicsOgre/yakePCH.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -24,8 +24,8 @@
    source code distribution.
    ------------------------------------------------------------------------------------
 */
-#ifndef __INC_PCH_H__
-#define __INC_PCH_H__
+#ifndef __INC_OGRE_PCH_H__
+#define __INC_OGRE_PCH_H__
 
 #include <yake/base/yake.h>
 
@@ -72,4 +72,5 @@
 	{ \
 	}
 
-#endif // __INC_PCH_H__
+#endif // __INC_OGRE_PCH_H__
+

Modified: trunk/yake/yake/plugins/inputOgre/InputSystemOgre.h
===================================================================
--- trunk/yake/yake/plugins/inputOgre/InputSystemOgre.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/inputOgre/InputSystemOgre.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -32,7 +32,6 @@
 };
 
 namespace yake {
-	using namespace math;
 namespace input {
 
 	//-----------------------------------------------------------------------
@@ -53,11 +52,11 @@
 		virtual void poll();
 
 	protected:
-		Ogre::InputReader	* mInputReader;
+		Ogre::InputReader*		mInputReader;
 		bool				mButtons[3];
-		Vector3				mPosition;
-		Vector3				mScale;
-		Rectangle			mClip;
+		math::Vector3			mPosition;
+		math::Vector3			mScale;
+		math::Rectangle			mClip;
 	};
 
 	//-----------------------------------------------------------------------
@@ -106,3 +105,4 @@
 }
 }
 #endif
+

Modified: trunk/yake/yake/plugins/physicsODE/OdeActor.h
===================================================================
--- trunk/yake/yake/plugins/physicsODE/OdeActor.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/physicsODE/OdeActor.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -47,10 +47,12 @@
 
 		virtual IWorld* getCreator() const;
 
-		virtual void setPosition( const Vector3& rPosition );
-		virtual void setOrientation( const Quaternion& rOrientation );
-		virtual Vector3 getPosition() const;
-		virtual Quaternion getOrientation() const;
+		virtual void setPosition( const math::Vector3& rPosition );
+		virtual void setOrientation( const math::Quaternion& rOrientation );
+		virtual math::Vector3 getPosition() const;
+		virtual math::Quaternion getOrientation() const;
+		virtual math::Vector3 getDerivedPosition() const { return getPosition(); }
+		virtual math::Quaternion getDerivedOrientation() const { return getOrientation(); }
 		
 		virtual IShape* createShape( const IShape::Desc& rShapeDesc, real massOrDensity = 0.0f, IBody::quantityType type = IBody::QT_MASS );
 		virtual void destroyShape( IShape* pShape );
@@ -59,11 +61,11 @@
 		virtual void setEnabled(const bool enabled);
 		virtual bool isEnabled() const;
 
-		YAKE_MEMBERSIGNAL_VIRTUALIMPL(public, void(ActorCollisionInfo&), CollisionEntered)
-		YAKE_MEMBERSIGNAL_FIRE_FN1(public, CollisionEntered, ActorCollisionInfo& info, info)
+		YAKE_MEMBERSIGNAL_VIRTUALIMPL(public, void(const ActorCollisionInfo&), CollisionEntered)
+		YAKE_MEMBERSIGNAL_FIRE_FN1(public, CollisionEntered, const ActorCollisionInfo& info, info)
 
-		YAKE_MEMBERSIGNAL_VIRTUALIMPL(public, void(ActorCollisionInfo&), CollisionExited)
-		YAKE_MEMBERSIGNAL_FIRE_FN1(public, CollisionExited, ActorCollisionInfo& info, info)
+		YAKE_MEMBERSIGNAL_VIRTUALIMPL(public, void(const ActorCollisionInfo&), CollisionExited)
+		YAKE_MEMBERSIGNAL_FIRE_FN1(public, CollisionExited, const ActorCollisionInfo& info, info)
 	
 		// Ode helpers
 		void _collide( OdeActor* pOther, dGeomID geomA, dGeomID geomB, dJointGroup* pContactJointGroup );
@@ -74,10 +76,10 @@
 		IBody::MassDesc* createMassDescFromShapeDesc( const IShape::Desc& rShapeDesc, real massOrDensity, IBody::quantityType qType );
 		
 		OdeGeom* createShapeFromDesc( const IShape::Desc& rShapeDesc );
-		OdeGeom* createTransformGeomIfNeeded( OdeGeom* pGeom, const Vector3& rOffset, const Quaternion& rRelOrientation );
+		OdeGeom* createTransformGeom( OdeGeom* pGeom, const math::Vector3& rOffset, const math::Quaternion& rRelOrientation );
 
-		Vector3							mPosition;
-		Quaternion						mOrientation;
+		math::Vector3						mPosition;
+		math::Quaternion					mOrientation;
 		
 		OdeBody*						mBody; 
 		OdeWorld*						mOdeWorld;
@@ -87,10 +89,13 @@
 		
 		typedef real CollisionInfo;
 		typedef std::map< OdeActor*, CollisionInfo > CollisionCache;
-		CollisionCache					mCollisions;
+		CollisionCache						mCollisions;
+
+		SigCollisionEnteredType	    mEnterCollisionSignal;
 	};
 
 } // physics
 } // yake
 
 #endif
+

Modified: trunk/yake/yake/plugins/physicsODE/OdeAvatar.h
===================================================================
--- trunk/yake/yake/plugins/physicsODE/OdeAvatar.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/physicsODE/OdeAvatar.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -47,15 +47,17 @@
 
 		bool init(const IAvatar::Desc&);
 
-		virtual void setPosition( const Vector3& rPosition );
-		virtual void setOrientation( const Quaternion& rOrientation );
-		virtual Vector3 getPosition() const;
-		virtual Quaternion getOrientation() const;
+		virtual void setPosition( const math::Vector3& rPosition );
+		virtual void setOrientation( const math::Quaternion& rOrientation );
+		virtual math::Vector3 getPosition() const;
+		virtual math::Vector3 getDerivedPosition() const { return getPosition(); }//FIXME is this enough? 
+		virtual math::Quaternion getOrientation() const;
+		virtual math::Quaternion getDerivedOrientation() const { return getOrientation(); }//FIXME is this enough?
 
-		virtual void setDimensions( const Vector3 & rkDimensions );
+		virtual void setDimensions( const math::Vector3& rkDimensions );
 		virtual void setInfluenceByDynamics( const real ratio );
 
-		virtual void setTargetVelocity( const Vector3 & rkTargetVelocity );
+		virtual void setTargetVelocity( const math::Vector3& rkTargetVelocity );
 		virtual void jump();
 		virtual bool isJumping() const;
 		virtual void duck(const bool yes);
@@ -73,12 +75,12 @@
 		void onPostStepInternal(const real dt);
 		void _updateRayData();
 	private:
-		mutable Vector3					mPosition;
-		mutable Quaternion				mOrientation;
+		mutable math::Vector3					mPosition;
+		mutable math::Quaternion				mOrientation;
 
-		Vector3							mDimensions;
+		math::Vector3						mDimensions;
 		real							mDynamicsInfluence;
-		Vector3							mTargetVelocity;
+		math::Vector3						mTargetVelocity;
 
 		bool							mJumping;
 		bool							mJumpStartInProgress;
@@ -93,7 +95,7 @@
 		double							mRayLength;
 
 		double							mSphereRadius;
-		Vector3							mSphereOffset;
+		math::Vector3						mSphereOffset;
 
 		real							mHeightAboveGround;
 		real							mHeightAboveGroundDuck;
@@ -107,3 +109,4 @@
 } // yake
 
 #endif
+

Modified: trunk/yake/yake/plugins/physicsODE/OdeBody.h
===================================================================
--- trunk/yake/yake/plugins/physicsODE/OdeBody.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/physicsODE/OdeBody.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -49,26 +49,28 @@
 			virtual void setMass( const MassDesc& rDesc );
 			virtual void addMass( const MassDesc& rDesc );
 
-			virtual void setLinearVelocity( Vector3 const& rVelocity );
-			virtual Vector3 getLinearVelocity() const;
-			virtual void setAngularVelocity( Vector3 const& rVelocity);
-			virtual Vector3 getAngularVelocity() const;
+			virtual void setLinearVelocity( math::Vector3 const& rVelocity );
+			virtual math::Vector3 getLinearVelocity() const;
+			virtual void setAngularVelocity( math::Vector3 const& rVelocity);
+			virtual math::Vector3 getAngularVelocity() const;
 			
 			virtual void addForce( const Force& force );
-			virtual void addForce( Vector3 const& rForce );
-			virtual void addForceAtPos( Vector3 const& rForce, Vector3 const& rPos );
-			virtual void addForceAtLocalPos( const Vector3& rForce, const Vector3& rPos );
-			virtual void addLocalForce( Vector3 const& rForce );
-			virtual void addLocalForceAtLocalPos( Vector3 const& rForce, Vector3 const& rPos );
-			virtual void addLocalForceAtPos( Vector3 const& rForce, Vector3 const& rPos );
-			virtual void addTorque( Vector3 const& rTorque );
-			virtual void addLocalTorque( Vector3 const& rTorque );
+			virtual void addForce( math::Vector3 const& rForce );
+			virtual void addForceAtPos( math::Vector3 const& rForce, math::Vector3 const& rPos );
+			virtual void addForceAtLocalPos( const math::Vector3& rForce, const math::Vector3& rPos );
+			virtual void addLocalForce( math::Vector3 const& rForce );
+			virtual void addLocalForceAtLocalPos( math::Vector3 const& rForce, math::Vector3 const& rPos );
+			virtual void addLocalForceAtPos( math::Vector3 const& rForce, math::Vector3 const& rPos );
+			virtual void addTorque( math::Vector3 const& rTorque );
+			virtual void addLocalTorque( math::Vector3 const& rTorque );
 			
 			// helpers for OdeActor
-			virtual void setPosition( const Vector3 & position );
-			virtual Vector3 getPosition() const;
-			virtual void setOrientation( const Quaternion & orientation );
-			virtual Quaternion getOrientation() const;
+			virtual void setPosition( const math::Vector3 & position );
+			virtual void setOrientation( const math::Quaternion & orientation );
+			virtual math::Vector3 getPosition() const;
+			virtual math::Quaternion getOrientation() const;
+			virtual math::Vector3 getDerivedPosition() const { return this->getPosition(); }
+			virtual math::Quaternion getDerivedOrientation() const { return this->getOrientation(); }
 
 			
 // 			virtual void setMassBox(real lx, real ly, real lz, real density = 1.);
@@ -77,9 +79,9 @@
 // 			/// void dMassAdd (dMass *a, const dMass *b);
 // 			virtual real getMass() const;
 // //			virtual MassType getType() const;
-// 			virtual void translateMass( const Vector3 & d );
+// 			virtual void translateMass( const math::Vector3 & d );
 // 
-// 			virtual Vector3 getTorque() const;
+// 			virtual math::Vector3 getTorque() const;
 // 
 // 			virtual void setEnabled( bool enabled );
 
@@ -102,3 +104,4 @@
 } // yake
 
 #endif
+

Modified: trunk/yake/yake/plugins/physicsODE/OdeJoint.h
===================================================================
--- trunk/yake/yake/plugins/physicsODE/OdeJoint.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/physicsODE/OdeJoint.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -44,15 +44,18 @@
 		public:
 			virtual ~OdeJoint();
 
-			virtual void attach( IBody& rBody1, IBody& rBody2 );
+			/** Attach joint to bodies. If one of the bodies is 0, then attach
+			 * to static environment.
+			 */
+			virtual void attach( IBody* pBody1, IBody* pBody2 );
 
 			//virtual JointType getType() const;
 			
 			//virtual size_t getNumAxis() const;
-			//virtual void setAxis( size_t axisIndex, Vector3 const& rAxis );
+			//virtual void setAxis( size_t axisIndex, math::Vector3 const& rAxis );
 			
 			//virtual size_t getNumAnchors() const;
-			//virtual void setAnchor( size_t anchorIndex, Vector3 const& rAnchor );
+			//virtual void setAnchor( size_t anchorIndex, math::Vector3 const& rAnchor );
 			
 			//virtual void setMotor( size_t axisIndex, real velocityTarget, real maximumForce );
 			
@@ -95,10 +98,10 @@
 			virtual JointType getType() const;
 			
 			virtual size_t getNumAxis() const;
-			virtual void setAxis( size_t axisIndex, Vector3 const& rAxis );
+			virtual void setAxis( size_t axisIndex, math::Vector3 const& rAxis );
 			
 			virtual size_t getNumAnchors() const;
-			virtual void setAnchor( size_t anchorIndex, Vector3 const& rAnchor );
+			virtual void setAnchor( size_t anchorIndex, math::Vector3 const& rAnchor );
 			
 			virtual void setMotor( size_t axisIndex, real velocityTarget, real maximumForce );
 			virtual void setMotorEnabled( size_t axisIndex, bool enabled );
@@ -117,10 +120,10 @@
 			virtual JointType getType() const;
 			
 			virtual size_t getNumAxis() const;
-			virtual void setAxis( size_t axisIndex, Vector3 const& rAxis );
+			virtual void setAxis( size_t axisIndex, math::Vector3 const& rAxis );
 			
 			virtual size_t getNumAnchors() const;
-			virtual void setAnchor( size_t anchorIndex, Vector3 const& rAnchor );
+			virtual void setAnchor( size_t anchorIndex, math::Vector3 const& rAnchor );
 			
 			virtual void setMotor( size_t axisIndex, real velocityTarget, real maximumForce );
 			virtual void setMotorEnabled( size_t axisIndex, bool enabled );
@@ -140,10 +143,10 @@
 			virtual JointType getType() const;
 			
 			virtual size_t getNumAxis() const;
-			virtual void setAxis( size_t axisIndex, Vector3 const& rAxis );
+			virtual void setAxis( size_t axisIndex, math::Vector3 const& rAxis );
 			
 			virtual size_t getNumAnchors() const;
-			virtual void setAnchor( size_t anchorIndex, Vector3 const& rAnchor );
+			virtual void setAnchor( size_t anchorIndex, math::Vector3 const& rAnchor );
 			
 			virtual void setMotor( size_t axisIndex, real velocityTarget, real maximumForce );
 			virtual void setMotorEnabled( size_t axisIndex, bool enabled );
@@ -156,15 +159,15 @@
 		public:
 			OdeFixedJoint( OdeWorld* pWorld );
 
-			virtual void attach( IBody& rBody1, IBody& rBody2 );
+			virtual void attach( IBody* pBody1, IBody* pBody2 );
 			
 			virtual JointType getType() const;
 			
 			virtual size_t getNumAxis() const;
-			virtual void setAxis( size_t axisIndex, Vector3 const& rAxis );
+			virtual void setAxis( size_t axisIndex, math::Vector3 const& rAxis );
 			
 			virtual size_t getNumAnchors() const;
-			virtual void setAnchor( size_t anchorIndex, Vector3 const& rAnchor );
+			virtual void setAnchor( size_t anchorIndex, math::Vector3 const& rAnchor );
 			
 			virtual void setMotor( size_t axisIndex, real velocityTarget, real maximumForce );
 			virtual void setMotorEnabled( size_t axisIndex, bool enabled );
@@ -180,10 +183,10 @@
 			virtual JointType getType() const;
 			
 			virtual size_t getNumAxis() const;
-			virtual void setAxis( size_t axisIndex, Vector3 const& rAxis );
+			virtual void setAxis( size_t axisIndex, math::Vector3 const& rAxis );
 			
 			virtual size_t getNumAnchors() const;
-			virtual void setAnchor( size_t anchorIndex, Vector3 const& rAnchor );
+			virtual void setAnchor( size_t anchorIndex, math::Vector3 const& rAnchor );
 			
 			virtual void setMotor( size_t axisIndex, real velocityTarget, real maximumForce );
 			virtual void setMotorEnabled( size_t axisIndex, bool enabled );
@@ -203,10 +206,10 @@
 			virtual JointType getType() const;
 			
 			virtual size_t getNumAxis() const;
-			virtual void setAxis( size_t axisIndex, Vector3 const& rAxis );
+			virtual void setAxis( size_t axisIndex, math::Vector3 const& rAxis );
 			
 			virtual size_t getNumAnchors() const;
-			virtual void setAnchor( size_t anchorIndex, Vector3 const& rAnchor );
+			virtual void setAnchor( size_t anchorIndex, math::Vector3 const& rAnchor );
 			
 			virtual void setMotor( size_t axisIndex, real velocityTarget, real maximumForce );
 			virtual void setMotorEnabled( size_t axisIndex, bool enabled );
@@ -221,3 +224,4 @@
 } // yake
 
 #endif
+

Modified: trunk/yake/yake/plugins/physicsODE/OdeMaterial.h
===================================================================
--- trunk/yake/yake/plugins/physicsODE/OdeMaterial.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/physicsODE/OdeMaterial.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -50,8 +50,7 @@
 		real					mRestitution;
 		real					mFriction2;
 		bool					mLateralSlip;
-//		ISlipNormalSource*		mSlipNormalSource;
-		Vector3					mSlipNormal;
+		math::Vector3				mSlipNormal;
 		real					mSlipLinearCoeff;
 		real					mSlipAngularCoeff;
 
@@ -62,3 +61,4 @@
 } // yake
 
 #endif
+

Modified: trunk/yake/yake/plugins/physicsODE/OdeRay.h
===================================================================
--- trunk/yake/yake/plugins/physicsODE/OdeRay.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/physicsODE/OdeRay.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -46,17 +46,19 @@
 		real length() const;
 		bool intersects() const;
 		real intersectionDepth() const;
-		Vector3 intersectionPoint() const;
-		Vector3 intersectionNormal() const;
+		math::Vector3 intersectionPoint() const;
+		math::Vector3 intersectionNormal() const;
 
-		virtual void setPosition( Vector3 const& rPosition);
-		virtual Vector3 getPosition() const;
+		virtual void setPosition( math::Vector3 const& rPosition);
+		virtual math::Vector3 getPosition() const;
+		virtual math::Vector3 getDerivedPosition() const { return getPosition(); }//FIXME is this enough? 
 
-		virtual void setOrientation( Quaternion const& rOrientation );
-		virtual Quaternion getOrientation() const;
+		virtual void setOrientation( math::Quaternion const& rOrientation );
+		virtual math::Quaternion getOrientation() const;
+		virtual math::Quaternion getDerivedOrientation() const { return getOrientation(); }//FIXME is this enough?
 
-		void setDirection(const Vector3&);
-		Vector3 getDirection() const;
+		void setDirection(const math::Vector3&);
+		math::Vector3 getDirection() const;
 
 		void ignore(dGeomID);
 
@@ -74,13 +76,13 @@
 		dRay*		mRay;
 		OdeWorld*	mWorld;
 		real		mLength;
-		mutable Vector3	mPosition;
-		mutable Vector3	mDirection;
+		mutable math::Vector3	mPosition;
+		mutable math::Vector3	mDirection;
 
 		bool		mIntersects;
 		real		mIntersectionDepth;
-		Vector3		mIntersectionPoint;
-		Vector3		mIntersectionNormal;
+		math::Vector3	mIntersectionPoint;
+		math::Vector3	mIntersectionNormal;
 
 		typedef std::deque<dGeomID> GeomIdList;
 		GeomIdList	mIgnoreGeoms;
@@ -90,3 +92,4 @@
 } // yake
 
 #endif
+

Modified: trunk/yake/yake/plugins/physicsODE/OdeShapes.h
===================================================================
--- trunk/yake/yake/plugins/physicsODE/OdeShapes.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/physicsODE/OdeShapes.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -54,15 +54,15 @@
 			OdeActor* getOwner() const
 			{ return mOwner; }
 
-			virtual void setPosition( Vector3 const& rPosition);
-			virtual Vector3 getPosition() const;
-			virtual void setOrientation( Quaternion const& rOrientation );
-			virtual Quaternion getOrientation() const;
+			virtual void setPosition( math::Vector3 const& rPosition);
+			virtual math::Vector3 getPosition() const;
+			virtual void setOrientation( math::Quaternion const& rOrientation );
+			virtual math::Quaternion getOrientation() const;
 
-			virtual Vector3 getDerivedPosition() const;
-			virtual Quaternion getDerivedOrientation() const;
+			virtual math::Vector3 getDerivedPosition() const;
+			virtual math::Quaternion getDerivedOrientation() const;
 
-			virtual Vector3 getPropertyVector3(const String&) const;
+			virtual math::Vector3 getPropertyVector3(const String&) const;
 			virtual real getPropertyReal(const String&) const;
 
 		protected:
@@ -86,16 +86,16 @@
 			
 			virtual ShapeType getType() const;
 			
-			virtual void setPosition( Vector3 const& rPosition);
-			virtual Vector3 getPosition() const;
-			virtual void setOrientation( Quaternion const& rOrientation );
-			virtual Quaternion getOrientation() const;
+			virtual void setPosition( math::Vector3 const& rPosition);
+			virtual math::Vector3 getPosition() const;
+			virtual void setOrientation( math::Quaternion const& rOrientation );
+			virtual math::Quaternion getOrientation() const;
 
 			void attachGeom( OdeGeom* pGeom );
 			OdeGeom* getAttachedGeom() const;
 		
-			virtual Vector3 getDerivedPosition() const;
-			virtual Quaternion getDerivedOrientation() const;
+			virtual math::Vector3 getDerivedPosition() const;
+			virtual math::Quaternion getDerivedOrientation() const;
 		private:
 			OdeGeom*	mAttachedGeom;
 		};
@@ -164,3 +164,4 @@
 } // yake
 
 #endif
+

Modified: trunk/yake/yake/plugins/physicsODE/OdeWorld.h
===================================================================
--- trunk/yake/yake/plugins/physicsODE/OdeWorld.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/plugins/physicsODE/OdeWorld.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -31,9 +31,6 @@
 #include "yake/plugins/physicsODE/OdeShapes.h"
 
 namespace yake {
-
-	using namespace math;
-
 namespace physics {
 
 		class OdeBody;
@@ -52,33 +49,36 @@
 			virtual IJointPtr createJoint( const IJoint::DescBase& rkJointDesc );
 			virtual IActorPtr createActor( const IActor::Desc& rActorDesc = IActor::Desc( ACTOR_MOVABLE ) );
 			virtual IAvatarPtr createAvatar( const IAvatar::Desc& rkAvatarDesc );
+	
 			virtual IMaterialPtr getMaterial( const String& id ) const;
-			virtual IMaterialPtr createMaterial( const IMaterial::Desc & rkMatDesc, const String& id = "" );
+			virtual IMaterialPtr createMaterial( const IMaterial::Desc& rkMatDesc, const String& id = "" );
 			virtual void destroyJoint( IJointPtr pJoint );
 			virtual void destroyActor( IActorPtr pActor );
 			virtual void destroyAvatar( IAvatarPtr pAvatar );
 			virtual void destroyMaterial( IMaterialPtr pMaterial );
 			
-			virtual TriangleMeshId createTriangleMesh( TriangleMeshDesc const& rTrimeshDesc );
+			virtual TriangleMeshId createTriangleMesh( const TriangleMeshDesc& rTrimeshDesc );
 
 			virtual Deque<ShapeType> getSupportedShapes( bool bStatic = true, bool bDynamic = true) const;
 			virtual Deque<JointType> getSupportedJoints() const;
 			virtual Deque<String> getSupportedSolvers() const;
-			virtual bool useSolver( String const& rSolver );
+			virtual bool useSolver( const String& rSolver );
 			virtual String getCurrentSolver() const;
 			virtual const StringVector getCurrentSolverParams() const;
-			virtual void setCurrentSolverParam( String const& rName, boost::any const& rValue );
+			virtual void setCurrentSolverParam( const String& rName, const boost::any& rValue );
 
 			virtual void step( const real timeElapsed );
-			virtual void setGlobalGravity( const Vector3& g );
-			virtual Vector3 getGlobalGravity() const;
+			virtual real getStepSize() const { return _getStepSize(); }
 
-			YAKE_MEMBERSIGNAL_VIRTUALIMPL( public, void, PreStep )
-			YAKE_MEMBERSIGNAL_FIRE_FN0( public, PreStep )
-			YAKE_MEMBERSIGNAL_VIRTUALIMPL( public, void, PostStep )
-			YAKE_MEMBERSIGNAL_FIRE_FN1( public, PostStep, real t, t )
-			YAKE_MEMBERSIGNAL_VIRTUALIMPL( public, void, PreStepInternal )
-			YAKE_MEMBERSIGNAL_FIRE_FN1( public, PreStepInternal, const real dt, dt )
+			virtual void setGlobalGravity( const math::Vector3& g );
+			virtual math::Vector3 getGlobalGravity() const;
+
+			YAKE_MEMBERSIGNAL_VIRTUALIMPL( public, void, PreStep );
+			YAKE_MEMBERSIGNAL_FIRE_FN0( public, PreStep );
+			YAKE_MEMBERSIGNAL_VIRTUALIMPL( public, void, PostStep );
+			YAKE_MEMBERSIGNAL_FIRE_FN1( public, PostStep, real t, t );
+			YAKE_MEMBERSIGNAL_VIRTUALIMPL( public, void, PreStepInternal );
+			YAKE_MEMBERSIGNAL_FIRE_FN1( public, PreStepInternal, const real dt, dt );
 			YAKE_MEMBERSIGNAL( public, void(const real), PostStepInternal )
 		public:
 

Modified: trunk/yake/yake/prop/prerequisites.h
===================================================================
--- trunk/yake/yake/prop/prerequisites.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/prop/prerequisites.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -20,4 +20,5 @@
 
 } // namespace yake
 
-#endif
\ No newline at end of file
+#endif
+

Modified: trunk/yake/yake/prop/prop_def.h
===================================================================
--- trunk/yake/yake/prop/prop_def.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/prop/prop_def.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -60,4 +60,5 @@
 	{ return new Prop(*this,defaultValue_,readOnly_); }
 } // namespace yake
 
-#endif
\ No newline at end of file
+#endif
+

Modified: trunk/yake/yake/prop/prop_holder.h
===================================================================
--- trunk/yake/yake/prop/prop_holder.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/prop/prop_holder.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -1,7 +1,8 @@
 #ifndef YAKE_PROP_HOLDER_H
 #define YAKE_PROP_HOLDER_H
 
-#include "prerequisites.h"
+#include "yake/prop/prerequisites.h"
+#include "yake/prop/rtti_class.h"
 #include <iostream> // std::cout for warnings
 
 namespace yake {
@@ -22,7 +23,7 @@
 		template<typename T_value>
 		bool getValue(const std::string& name, T_value& retValue) const
 		{
-			StringPropPtrMap::const_iterator it = props_.find(name);
+			typename StringPropPtrMap::const_iterator it = props_.find(name);
 			if (it == props_.end())
 				return false;
 			assert( it->second );
@@ -31,7 +32,7 @@
 		template<typename T_value>
 		bool setValue(const std::string& name, const T_value& value)
 		{
-			StringPropPtrMap::iterator it = props_.find(name);
+			typename StringPropPtrMap::iterator it = props_.find(name);
 			if (it == props_.end())
 				return false;
 			assert( it->second );
@@ -52,14 +53,14 @@
 	private:
 		void initProps(const RttiClass& cls, StringPropPtrMap& props)
 		{
-			const RttiClass::ParentClassList& parentClsList = cls.getParents();
-			RttiClass::ParentClassList::const_iterator itClsEnd = parentClsList.end();
-			for (RttiClass::ParentClassList::const_iterator itCls = parentClsList.begin(); itCls != itClsEnd; ++itCls)
+			const typename RttiClass::ParentClassList& parentClsList = cls.getParents();
+			typename RttiClass::ParentClassList::const_iterator itClsEnd = parentClsList.end();
+			for ( typename RttiClass::ParentClassList::const_iterator itCls = parentClsList.begin(); itCls != itClsEnd; ++itCls)
 				initProps(**itCls, props);
 
 			const PropDefMap& defs = cls.getPropDefs();
-			PropDefMap::const_iterator itDefEnd = defs.end();
-			for (PropDefMap::const_iterator itDef = defs.begin(); itDef != itDefEnd; ++itDef)
+			typename PropDefMap::const_iterator itDefEnd = defs.end();
+			for ( typename PropDefMap::const_iterator itDef = defs.begin(); itDef != itDefEnd; ++itDef)
 			{
 				const PropDef& def = itDef->second;
 				if (def.name().empty())
@@ -67,7 +68,7 @@
 					std::cout << "warning: empty property name in class '" << cls.name() << "'. skipping.\n";
 					continue;
 				}
-				StringPropPtrMap::const_iterator itFind = props.find(def.name());
+				typename StringPropPtrMap::const_iterator itFind = props.find(def.name());
 				if (itFind == props.end())
 				{
 					props[ def.name() ] = def.create();
@@ -99,3 +100,4 @@
 } // namespace yake
 
 #endif
+

Modified: trunk/yake/yake/prop/rtti_class.h
===================================================================
--- trunk/yake/yake/prop/rtti_class.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/prop/rtti_class.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -109,7 +109,11 @@
 				out << "  File: " << file << "@" << line << "\n";
 			msg_ = out.str();
 		}
-		const char* what() const
+		virtual ~RttiException() throw()
+		{
+		    // empty implementation. Required to avoid "looser throw specifier error".
+		}
+		const char* what() const throw ()
 		{ return msg_.c_str(); }
 	private:
 		std::string		msg_;
@@ -119,8 +123,10 @@
 #define THROW_RTTI_LOC(MSG,LOC) \
 	throw RttiException(MSG,LOC,__FILE__,__LINE__)
 
+#if YAKE_COMPILER == COMPILER_MSVC
 #pragma warning(push)
 #pragma warning(disable: 4290) // C4290: C++ exception specification ignored except to indicate a function is not __declspec(nothrow)
+#endif
 	struct RttiClassMgr
 	{
 		// insert into existing hierarchy
@@ -131,13 +137,19 @@
 		typedef std::map<std::string,RttiClass*> StringClassPtrMap;
 		StringClassPtrMap	classes_;
 	};
+#if YAKE_COMPILER == COMPILER_MSVC
 #pragma warning(pop)
-	inline RttiClass* RttiClassMgr::get(const std::string& clsName) const
+#endif
+	inline RttiClass* RttiClassMgr::get(const std::string& clsName) const throw ()
 	{
 		StringClassPtrMap::const_iterator it = classes_.find(clsName);
 		return (it == classes_.end()) ? 0 : it->second;
 	}
-	inline void RttiClassMgr::insert(RttiClass* cls)
+#if YAKE_COMPILER == COMPILER_MSVC
+#pragma warning(push)
+#pragma warning(disable: 4290) // C4290: C++ exception specification ignored except to indicate a function is not __declspec(nothrow)
+#endif
+	inline void RttiClassMgr::insert(RttiClass* cls) throw(yake::RttiException)
 	{
 		assert( cls );
 		if (!cls)
@@ -168,6 +180,9 @@
 
 		// post-process
 	}
+#if YAKE_COMPILER == COMPILER_MSVC
+#pragma warning(pop)
+#endif
 	inline void RttiClass::add(const PropDef & propdef)
 	{
 		props_[ propdef.name() ] = propdef;

Modified: trunk/yake/yake/samples/common/yakeExampleApplication.h
===================================================================
--- trunk/yake/yake/samples/common/yakeExampleApplication.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/samples/common/yakeExampleApplication.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -12,7 +12,7 @@
 #include <iostream>
 
 namespace yake {
-	using namespace base::templates;
+	using namespace yake::templates;
 namespace exapp {
 
 // todo: kick the plugin approach or combine it with class registry

Modified: trunk/yake/yake/scripting/yakeScriptingSystem.h
===================================================================
--- trunk/yake/yake/scripting/yakeScriptingSystem.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/scripting/yakeScriptingSystem.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -171,3 +171,4 @@
 
 
 #endif
+

Modified: trunk/yake/yake/statemachine/fsm_core.h
===================================================================
--- trunk/yake/yake/statemachine/fsm_core.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/statemachine/fsm_core.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -185,7 +185,7 @@
 			{
 				out << "  state '" << it->first << "'\n";
 				const event_state_map& evt2state = it->second.offgoing_transitions;
-				for (event_state_map::const_iterator itT = evt2state.begin(); itT != evt2state.end(); ++itT)
+				for ( typename event_state_map::const_iterator itT = evt2state.begin(); itT != evt2state.end(); ++itT)
 				{
 					out << "    event '" << itT->first << "' -> state '" << itT->second << "'\n";
 				}
@@ -214,14 +214,14 @@
 		template<typename enter_state_op_t, typename exit_state_op_t>
 		void processEventCb(const event_type& evt, enter_state_op_t& enterOp, exit_state_op_t& exitOp)
 		{
-			const state_map::const_iterator it = states_.find( curr_ );
+			const typename state_map::const_iterator it = states_.find( curr_ );
 			if (it == states_.end())
 			{
 				std::cerr << "error: machine<>::processEventCb():\n   invalid current state.\n\n";
 				return;
 			}
 			const event_state_map& evt2state = it->second.offgoing_transitions;
-			const event_state_map::const_iterator itFindTransition = evt2state.find(evt);
+			const typename event_state_map::const_iterator itFindTransition = evt2state.find(evt);
 			if (itFindTransition == evt2state.end())
 			{
 				std::cerr << "error: machine<>::processEventCb():\n   transition not found! (evt=" << evt << ", src=" << it->first << ")\n\n";
@@ -247,7 +247,7 @@
 	template<typename _state_type, typename _event_type>
 	void machine<_state_type,_event_type>::setState(const state_type& dest)
 	{
-		const state_map::const_iterator it = states_.find( dest );
+		const typename state_map::const_iterator it = states_.find( dest );
 		if (it == states_.end())
 		{
 			std::cerr << "error: machine<>::setState():\n   unregistered state.\n\n";
@@ -293,10 +293,10 @@
 	template<typename _state_type, typename _event_type>
 	void machine<_state_type,_event_type>::addState(const state_type& state)
 	{
-		state_map::iterator it = states_.find( state );
+		typename state_map::iterator it = states_.find( state );
 		if (it == states_.end())
 		{
-			states_.insert( state_map::value_type(state,state_e()) );
+			states_.insert( typename state_map::value_type(state,state_e()) );
 			return;
 		}
 #ifdef _DEBUG
@@ -311,14 +311,14 @@
 			std::cerr << "error: machine<>::addTransition():\n   source and destination are identical!\n\n";
 			return;
 		}
-		state_map::iterator it = states_.find( src );
+		typename state_map::iterator it = states_.find( src );
 		if (it == states_.end())
 		{
 			std::cerr << "error: machine<>::addTransition():\n   unregistered source state!\n\n";
 			return;
 		}
 		{
-			const state_map::const_iterator itDest = states_.find( dest );
+			const typename state_map::const_iterator itDest = states_.find( dest );
 			if (itDest == states_.end())
 			{
 				std::cerr << "error: machine<>::addTransition():\n   unregistered destination state!\n\n";
@@ -333,7 +333,7 @@
 			return;
 		}
 #endif
-		evt2state.insert( event_state_map::value_type( evt, dest) );
+		evt2state.insert( typename event_state_map::value_type( evt, dest) );
 #ifdef _DEBUG
 		std::cout << "machine<>::addTransition(): from=" << src << " evt=" << evt << " dest=" << dest << "\n";
 #endif
@@ -346,9 +346,10 @@
 	template<typename _state_type, typename _event_type>
 	size_t machine<_state_type,_event_type>::numOffgoingTransitions(const state_type& src) const
 	{
-		const state_map::const_iterator it = states_.find( src );
+		const typename state_map::const_iterator it = states_.find( src );
 		return ( (it == states_.end()) ? 0 : it->second.offgoing_transitions.size() );
 	}
 } // namespace fsm
 
 #endif
+

Modified: trunk/yake/yake/thread/ZThreadMutexForwarder.h
===================================================================
--- trunk/yake/yake/thread/ZThreadMutexForwarder.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/thread/ZThreadMutexForwarder.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -81,4 +81,5 @@
 } // namespace thread
 } // namespace yake
 
-#endif
\ No newline at end of file
+#endif
+

Modified: trunk/yake/yake/thread/ZThreadThreadForwarder.h
===================================================================
--- trunk/yake/yake/thread/ZThreadThreadForwarder.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/thread/ZThreadThreadForwarder.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -116,4 +116,5 @@
 } // namespace thread
 } // namespace yake
 
-#endif
\ No newline at end of file
+#endif
+

Modified: trunk/yake/yake/thread/yakeThread.h
===================================================================
--- trunk/yake/yake/thread/yakeThread.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/thread/yakeThread.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -192,4 +192,5 @@
 } // namespace thread
 } // namespace yake
 
-#endif
\ No newline at end of file
+#endif
+

Modified: trunk/yake/yake/thread/yakeThreadPrerequisites.h
===================================================================
--- trunk/yake/yake/thread/yakeThreadPrerequisites.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yake/thread/yakeThreadPrerequisites.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -40,4 +40,5 @@
 
 #define YAKE_THREAD_EXCEPT(m,s) throw( yake::Exception(m,s,__FILE__,__LINE__) )
 
-#endif
\ No newline at end of file
+#endif
+

Modified: trunk/yake/yapp/common/yakeCameraControllers.h
===================================================================
--- trunk/yake/yapp/common/yakeCameraControllers.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/common/yakeCameraControllers.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -10,36 +10,36 @@
 
 		void setCamera(graphics::ICamera*);
 
-		void setTarget( const Point3& );
-		void setOffset( const Vector3& );
-		Vector3 getOffset() const;
+		void setTarget( const math::Point3& );
+		void setOffset( const math::Vector3& );
+		math::Vector3 getOffset() const;
 
 		void update(const real dt);
 	private:
-		Point3				mTargetPos;
+		math::Point3		mTargetPos;
 		graphics::ICamera*	mCam;
-		Vector3				mCamOffset;
+		math::Vector3		mCamOffset;
 	};
 	/** @todo move into .inl file! */
 	TopDownCameraController::TopDownCameraController() :
 		mCam(0),
-		mTargetPos(Point3::kZero),
-		mCamOffset(Vector3(2,0,2))
+		mTargetPos(math::Point3::kZero),
+		mCamOffset(math::Vector3(2,0,2))
 	{
 	}
 	void TopDownCameraController::setCamera(graphics::ICamera* cam)
 	{
 		mCam = cam;
 	}
-	void TopDownCameraController::setTarget( const Point3& pt )
+	void TopDownCameraController::setTarget( const math::Point3& pt )
 	{
 		mTargetPos = pt;
 	}
-	void TopDownCameraController::setOffset( const Vector3& offset )
+	void TopDownCameraController::setOffset( const math::Vector3& offset )
 	{
 		mCamOffset = offset;
 	}
-	Vector3 TopDownCameraController::getOffset() const
+	math::Vector3 TopDownCameraController::getOffset() const
 	{
 		return mCamOffset;
 	}
@@ -47,7 +47,7 @@
 	{
 		if (!mCam)
 			return;
-		const Point3 targetCamPos = mTargetPos + mCamOffset;
+		const math::Point3 targetCamPos = mTargetPos + mCamOffset;
 		mCam->translate( 0.5 * (targetCamPos - mCam->getPosition()) );
 		mCam->lookAt( mTargetPos );
 	}
@@ -55,3 +55,4 @@
 } // namespace yake
 
 #endif
+

Modified: trunk/yake/yapp/loader/yakeDotScene.h
===================================================================
--- trunk/yake/yapp/loader/yakeDotScene.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/loader/yakeDotScene.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -53,9 +53,9 @@
 		
 		struct Transform
 		{
-			Vector3		position;
-			Quaternion	rotation;
-			Vector3		scale; 
+			math::Vector3		position;
+			math::Quaternion	rotation;
+			math::Vector3		scale; 
 		};
 		
 		struct NodeDesc : public Desc
@@ -73,34 +73,34 @@
 		
 		struct CameraDesc : public Desc
 		{
-			real								fov;
-			real								aspectRatio;
+			real					fov;
+			real					aspectRatio;
 			graphics::ICamera::ProjectionType	projectionType;
-			String								trackTargetName;
-			Vector3								normal;
+			String					trackTargetName;
+			math::Vector3				normal;
 			
 			struct Clipping
 			{
 				real nearClip;
 				real farClip;
-			}									clipping;
+			} clipping;
 		};
 		
 		struct LightDesc : public Desc
 		{
 			graphics::ILight::LightType	type;
-			bool						visible;
-			bool						castsShadows;
-			Color						diffuseColor;
-			Color						specularColor;
-			Vector3					normal;
+			bool				visible;
+			bool				castsShadows;
+			math::Color			diffuseColor;
+			math::Color			specularColor;
+			math::Vector3			normal;
 			
 			struct Range
 			{
 				real inner;
 				real outer;
 				real falloff;
-			} 							range;
+			} range;
 			
 			struct Attenuation
 			{
@@ -177,14 +177,14 @@
 		virtual void readNode( const SharedPtr<dom::INode>& pNode, String parentNodeName );
 		virtual void readEntity( const SharedPtr<dom::INode>& pNode, String parentNodeName );
 		
-		virtual void readRotation( const SharedPtr<dom::INode>& pNode, Quaternion& rotation );
-		virtual void readPosition( const SharedPtr<dom::INode>& pNode, Vector3& position );
-		virtual void readScale( const SharedPtr<dom::INode>& pNode, Vector3& rScale );
-		virtual void readVector( const SharedPtr<dom::INode>& pNode, Vector3& rVec );
+		virtual void readRotation( const SharedPtr<dom::INode>& pNode, math::Quaternion& rotation );
+		virtual void readPosition( const SharedPtr<dom::INode>& pNode, math::Vector3& position );
+		virtual void readScale( const SharedPtr<dom::INode>& pNode, math::Vector3& rScale );
+		virtual void readVector( const SharedPtr<dom::INode>& pNode, math::Vector3& rVec );
 		
 		virtual void readLight( const SharedPtr<dom::INode>& pNode, String parentNodeName );
 		
-		virtual void readColour( const SharedPtr<dom::INode>& pNode, Color& colour );
+		virtual void readColour( const SharedPtr<dom::INode>& pNode, math::Color& colour );
 		virtual void readLightRange( const SharedPtr<dom::INode>& pNode, LightDesc& );
 		virtual void readLightAttenuation( const SharedPtr<dom::INode>& pNode, LightDesc& );
 		

Modified: trunk/yake/yapp/loader/yakeXODE.h
===================================================================
--- trunk/yake/yapp/loader/yakeXODE.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/loader/yakeXODE.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -1,176 +0,0 @@
-/*
-   ------------------------------------------------------------------------------------
-   This file is part of YAKE
-   Copyright ? 2004 The YAKE Team
-   For the latest information visit http://www.yake.org 
-   ------------------------------------------------------------------------------------
-   This program is free software; you can redistribute it and/or modify it under
-   the terms of the GNU Lesser General Public License as published by the Free Software
-   Foundation; either version 2 of the License, or (at your option) any later
-   version.
-
-   This program is distributed in the hope that it will be useful, but WITHOUT
-   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
-   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
-
-   You should have received a copy of the GNU Lesser General Public License along with
-   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
-   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
-   http://www.gnu.org/copyleft/lesser.txt.
-   ------------------------------------------------------------------------------------
-   If you are interested in another license model contact the Yake Team via
-   E-Mail: team at yake.org.
-   For more information see the LICENSE file in the root directory of the
-   source code distribution.
-   ------------------------------------------------------------------------------------
-*/
-#ifndef YAKE_DATA_DOTSCENE_H
-#define YAKE_DATA_DOTSCENE_H
-
-#include <yake/data/yakeData.h>
-#include <yapp/model/yakePhysical.h>
-
-namespace yake {
-namespace data {
-namespace parser {
-namespace xode {
-
-using namespace yake::app; // model::Physical
-
-	/** XODEParser base class providing default implementation for DOM parsing.
-	* \todo read lights, environment, external references ..
-	*/
-	class XODEParser
-	{
-	public:
-		XODEParser( model::Physical& rBaseModel );
-		virtual ~XODEParser() {}
-
-		String getName() const
-		{ 
-			return "yake.data.xode";
-		}
-
-		virtual Version getVersion() const = 0;
-
-		/** Build physics model from DOM!
-			\param file 
-			\return 
-		*/
-		virtual bool load( const SharedPtr<dom::INode>& docNode,  physics::IWorld* pPWorld );
-
-		/** Prepare for next run of load/store.
-		*/
-		virtual void reset();
-	
-	protected:
-		/// XODE "transform" node representation
-		struct Transform
-		{
-			Vector3 	mPosition;
-			Quaternion	mRotation;
-			Vector3		mScale;
-			
-			Transform() : mScale( Vector3::kUnitScale )
-			{
-			}
-			
-			bool isIdentity() const
-			{
-				bool result = mScale == Vector3::kUnitScale;
-				result &= mPosition == Vector3::kZero;
-				result &= mRotation == Quaternion::kZero;
-				
-				return result;
-			}
-			
-			const Transform getDerivedTransform( Transform const& parentTransform )
-			{
-				Transform result;
-				
-				Quaternion const& rParRot = parentTransform.mRotation;
-				Vector3 const& rParPos = parentTransform.mPosition;
-				Vector3 const& rParScale = parentTransform.mScale;
-				
-				result.mPosition = parentTransform.mPosition 
-					+ rParRot*( mPosition*rParScale );
-					
-				result.mRotation = rParRot*mRotation;
-				
-				result.mScale = mScale*rParScale;;  
-				
-				return result;
-			}
-		};
-		
-		/// Default implementations for common functions.
-		
-
-		virtual void readXODE( SharedPtr<dom::INode> const& pNode );
-		virtual void readWorld( SharedPtr<dom::INode> const& pWorldNode );
-		virtual void readSpace( SharedPtr<dom::INode> const& pSpaceNode );
-		virtual void readBody( SharedPtr<dom::INode> const& pBodyNode );
-		virtual void readGeom( SharedPtr<dom::INode> const& pGeomNode, physics::IComplexObject* pParentObject = NULL, Transform const& rParentTransform = Transform() );
-		virtual void readBox( SharedPtr<dom::INode> const& pNode, real& sX, real& sY, real& sZ );
-		virtual void readCappedCylinder( SharedPtr<dom::INode> const& pNode, real& radius, real& length );
-		virtual void readCone( SharedPtr<dom::INode> const& pNode, real& radius, real& length );
-		virtual void readCylinder( SharedPtr<dom::INode> const& pNode, real& radius, real& length );
-		virtual void readPlane( SharedPtr<dom::INode> const& pNode, real& a, real& b, real& c, real& d );
-		virtual void readRay( SharedPtr<dom::INode> const& pNode, real& length );
-		virtual void readSphere( SharedPtr<dom::INode> const& pNode, real& radius );
-		virtual void readTrimesh( SharedPtr<dom::INode> const& pNode, physics::ICollisionGeometry* pCollGeom );
-		
-		virtual void readTransform( SharedPtr<dom::INode> const& pTransformNode, Transform& rTrans );
-
-		virtual void readVector3( SharedPtr<dom::INode> const& pVecNode, Vector3& rVec );  
-		virtual void readPosition( SharedPtr<dom::INode> const& pPosNode, Vector3& rPos );  
-		virtual void readQuaternion( SharedPtr<dom::INode> const& pQuatNode, Quaternion& rQuat );
-		virtual void readRotation( SharedPtr<dom::INode> const& pRotNode, Quaternion& rRot );
-		virtual void readScale( SharedPtr<dom::INode> const& pScaleNode, Vector3& rScale );  
-		virtual void readAxisAngleRot( SharedPtr<dom::INode> const& pRotNode, Quaternion& rRot );
-		virtual void readMass( SharedPtr<dom::INode> const& pMassNode, physics::IBody* pBody, Transform const& rParentTransform ); 
-		virtual void readMassShape( SharedPtr<dom::INode> const& pMShapeNode, physics::IBody* pBody, Transform const& rParentTransform ); 
-		virtual void readMassAdjust( SharedPtr<dom::INode> const& pMAdjustNode, physics::IBody* pBody ); 
-				
-// 		readGroup
-// 		readJointgroup
-// 		virtual void readJoint
-// 		virtual void readMass
-// 		virtual void readMassStruct
-// 		readMassShape
-// 		readTransform
-		
-		
-		
-		
-/*		virtual void readScene( const SharedPtr<dom::INode> & pNode, graphics::ISceneNode* pParentSN );
-		virtual void readNodes( const SharedPtr<dom::INode> & pNodes, graphics::ISceneNode* pParentSN );
-		virtual void readNode( const SharedPtr<dom::INode> & pNode, graphics::ISceneNode* pParentSN );
-		virtual void readEntity( const SharedPtr<dom::INode> & pNode, graphics::ISceneNode* pParentSN );
-		virtual void readOrientation( const SharedPtr<dom::INode> & pNode, Quaternion & orientation );
-		virtual void readPosition( const SharedPtr<dom::INode> & pNode, Vector3 & position );*/
-		
-	private:
-		SharedPtr<dom::INode>					mDocNode;
-		physics::IWorld*					mPWorld;
-		model::Physical&					mBaseModel;
-	};
-	
-	class XODEParserV1 : public XODEParser
-	{
-	public:
-		XODEParserV1( model::Physical& rBaseModel ):XODEParser( rBaseModel ) {}
-		virtual ~XODEParserV1() {}
-		
-		virtual Version getVersion() const
-		{ 
-			return Version( 0, 1, 0 );
-		}
-	};
-
-} // dotscene
-} // serializer
-} // data
-} // yake
-
-#endif

Modified: trunk/yake/yapp/loader/yakeXODEParser.h
===================================================================
--- trunk/yake/yapp/loader/yakeXODEParser.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/loader/yakeXODEParser.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -68,19 +68,19 @@
 		/// XODE "transform" node representation
 		struct Transform
 		{
-			Vector3 	position_;
-			Quaternion	rotation_;
-			Vector3		scale_;
+			math::Vector3		position_;
+			math::Quaternion	rotation_;
+			math::Vector3		scale_;
 			
-			Transform() : scale_( Vector3::kUnitScale )
+			Transform() : scale_( math::Vector3::kUnitScale )
 			{
 			}
 			
 			bool isIdentity() const
 			{
-				bool result = scale_ == Vector3::kUnitScale;
-				result &= position_ == Vector3::kZero;
-				result &= rotation_ == Quaternion::kZero;
+				bool result = scale_ == math::Vector3::kUnitScale;
+				result &= position_ == math::Vector3::kZero;
+				result &= rotation_ == math::Quaternion::kZero;
 				
 				return result;
 			}
@@ -89,9 +89,9 @@
 			{
 				Transform result;
 				
-				Quaternion const& rParRot = parentTransform.rotation_;
-				Vector3 const& rParPos = parentTransform.position_;
-				Vector3 const& rParScale = parentTransform.scale_;
+				const math::Quaternion& rParRot = parentTransform.rotation_;
+				const math::Vector3& rParPos = parentTransform.position_;
+				const math::Vector3& rParScale = parentTransform.scale_;
 				
 				result.position_ = parentTransform.position_ 
 					+ rParRot*( position_*rParScale );
@@ -107,9 +107,9 @@
 		// Event-spawning parser makes heavy use of these
 		struct Desc
 		{
-		  String	name_;
-		  String	parentName_;
-		  Transform	transform_;
+		    String	name_;
+		    String	parentName_;
+		    Transform	transform_;
 		};
 
 		struct BodyDesc : public Desc
@@ -121,21 +121,22 @@
 		    SharedPtr<physics::IShape::Desc> shape_;
 		};
 
-		struct MassDesc : public Desc // ??? is this needed??
+		struct MassDesc : public Desc
 		{
-		  SharedPtr<physics::IBody::MassDesc> mass_;
+		    SharedPtr<physics::IBody::MassDesc> mass_;
 		};
 
 		struct JointDesc : public Desc
 		{
-		  String otherBody_;
+		    String body1_;
+		    String body2_;
 
-		  SharedPtr<physics::IJoint::DescBase> joint_;
+		    SharedPtr<physics::IJoint::DescBase> joint_;
 		};
 
-		struct MaterialDesc : public Desc // ?? no... not needed
+		struct MaterialDesc : public Desc
 		{
-		  physics::IMaterial::Desc material_;
+		    physics::IMaterial::Desc material_;
 		};
 		
 		typedef SignalX< void( const BodyDesc& ) > BodySignal;
@@ -190,7 +191,8 @@
 		virtual void readWorld( const NodeSharedPtr pWorldNode );
 		virtual void readSpace( const NodeSharedPtr pSpaceNode, const String& parent );
 		virtual void readBody( const NodeSharedPtr pBodyNode, const String& parent );
-		virtual void readGeom( const NodeSharedPtr pGeomNode, const String& parent , const Transform& rParentTransform = Transform() );
+		virtual void readGeom( const NodeSharedPtr pGeomNode, const String& parent , 
+			const Transform& rParentTransform = Transform(), bool absoluteTransform = false );
 		virtual void readBox( const NodeSharedPtr pNode, real& sX, real& sY, real& sZ );
 		virtual void readCappedCylinder( const NodeSharedPtr pNode, real& radius, real& length );
 		virtual void readCone( const NodeSharedPtr pNode, real& radius, real& length );
@@ -204,27 +206,32 @@
 		
 		virtual void readTransform( const NodeSharedPtr pTransformNode, Transform& rTrans );
 
-		virtual void readVector3( const NodeSharedPtr pVecNode, Vector3& rVec );  
-		virtual void readPosition( const NodeSharedPtr pPosNode, Vector3& rPos );  
-		virtual void readQuaternion( const NodeSharedPtr pQuatNode, Quaternion& rQuat );
-		virtual void readRotation( const NodeSharedPtr pRotNode, Quaternion& rRot );
-		virtual void readScale( const NodeSharedPtr pScaleNode, Vector3& rScale );  
-		virtual void readAxisAngleRot( const NodeSharedPtr pRotNode, Quaternion& rRot );
+		virtual void readVector3( const NodeSharedPtr pVecNode, math::Vector3& rVec );  
+		virtual void readPosition( const NodeSharedPtr pPosNode, math::Vector3& rPos );  
+		virtual void readQuaternion( const NodeSharedPtr pQuatNode, math::Quaternion& rQuat );
+		virtual void readRotation( const NodeSharedPtr pRotNode, math::Quaternion& rRot );
+		virtual void readScale( const NodeSharedPtr pScaleNode, math::Vector3& rScale );  
+		virtual void readAxisAngleRot( const NodeSharedPtr pRotNode, math::Quaternion& rRot );
 		virtual void readMass( const NodeSharedPtr pMassNode, const String& parent , const Transform& rParentTransform ); 
 		virtual void readMassShape( const NodeSharedPtr pMShapeNode, const String& parent, const Transform& rParentTransform ); 
 		virtual void readMassAdjust( const NodeSharedPtr pMAdjustNode, const String& parent ); 
-		virtual void readJoint( const NodeSharedPtr pJointNode, const String& parent , Transform& rParentTransform );
+		virtual void readJoint( const NodeSharedPtr pJointNode, const String& parent , const Transform& rParentTransform = Transform() );
 		
-		virtual physics::IJoint::DescBase* readBall( const NodeSharedPtr pJointNode, Transform& rJointTransform );
-		virtual physics::IJoint::DescBase* readFixed( const NodeSharedPtr pJointNode, Transform& rJointTransform );
-		virtual physics::IJoint::DescBase* readHinge( const NodeSharedPtr pJointNode, Transform& rJointTransform );
-		virtual physics::IJoint::DescBase* readHinge2( const NodeSharedPtr pJointNode, Transform& rJointTransform );
-		virtual physics::IJoint::DescBase* readSlider( const NodeSharedPtr pJointNode, Transform& rJointTransform );
-		virtual physics::IJoint::DescBase* readUniversal( const NodeSharedPtr pJointNode, Transform& rJointTransform );
+		virtual physics::IJoint::DescBase* readBall( const NodeSharedPtr pJointNode, const Transform& rJointTransform );
+		virtual physics::IJoint::DescBase* readFixed( const NodeSharedPtr pJointNode, const Transform& rJointTransform );
+		virtual physics::IJoint::DescBase* readHinge( const NodeSharedPtr pJointNode, const Transform& rJointTransform );
+		virtual physics::IJoint::DescBase* readHinge2( const NodeSharedPtr pJointNode, const Transform& rJointTransform );
+		virtual physics::IJoint::DescBase* readSlider( const NodeSharedPtr pJointNode, const Transform& rJointTransform );
+		virtual physics::IJoint::DescBase* readUniversal( const NodeSharedPtr pJointNode, const Transform& rJointTransform );
 		
-		virtual void readAnchor( const NodeSharedPtr pAnchorNode, Vector3& rAnchor, Transform& rJointTransform );
-		virtual void readAxis( const NodeSharedPtr pAxisNode, Vector3& rAxis, Transform& rJointTransform );
+		virtual void readAnchor( const NodeSharedPtr pAnchorNode, math::Vector3& rAnchor, const Transform& rJointTransform );
+		virtual void readAxis( const NodeSharedPtr pAxisNode, math::Vector3& rAxis, const Transform& rJointTransform );
 		virtual void readMaterialExt( const NodeSharedPtr pNode, const String& parent  );
+		
+		// override to read xode extensions unknown to original parser
+		virtual void readExtension( const NodeSharedPtr, 
+			const String& parent, 
+			const Transform& parentTransformIfAny );
 
 	private:
 		NodeSharedPtr		mDocNode;
@@ -237,7 +244,7 @@
 		
 		virtual Version getVersion() const
 		{ 
-			return Version( 0, 5, 0 );
+			return Version( 0, 5, 2 );
 		}
 	};
 
@@ -247,3 +254,4 @@
 } // yake
 
 #endif
+

Modified: trunk/yake/yapp/model/yakeComplexModel.h
===================================================================
--- trunk/yake/yapp/model/yakeComplexModel.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/model/yakeComplexModel.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -30,14 +30,14 @@
 #include <yapp/base/yappPrerequisites.h>
 #include <yapp/model/yakeGraphical.h>
 #include <yapp/model/yakePhysical.h>
+#include <yapp/model/yakeModelLink.h>
 
-
 namespace yake {
 	using namespace base::templates;
 namespace model {
-
 	class ModelLink;
 	class ModelMovableLink;
+	class ModelMovableWorldLink;
 
 namespace complex {
 
@@ -57,20 +57,20 @@
 		/** @todo Exchange "Model" with "Entity" (which has dynamic properties etc) ?
 		*/
 		Model* getParentModel() const;
-		void addChildModel( SharedPtr<Model> & rModel );
-		SharedPtr<Model> getChildModelByName( const String & rName ) const;
-		SharedPtr<Model> removeChildModel( const String & rName );
+		void addChildModel( SharedPtr<Model>& rModel );
+		SharedPtr<Model> getChildModelByName( const String& rName ) const;
+		SharedPtr<Model> removeChildModel( const String& rName );
 		SharedPtr<Model> removeChildModel( const SharedPtr<Model>& rModel );
 
 		/**
 			"graphical://model.model...model/graphicalname"
 			"physical://model.model...model/physicalname"
 		*/
-		Physical* queryPhysical( const String & rQuery ) const;
-		Graphical* queryGraphical( const String & rQuery ) const;
+		Physical* queryPhysical( const String& rQuery ) const;
+		Graphical* queryGraphical( const String& rQuery ) const;
 
-		Physical* getPhysicalByName( const String & rName ) const;
-		Graphical* getGraphicalByName( const String & rName ) const;
+		Physical* getPhysicalByName( const String& rName ) const;
+		Graphical* getGraphicalByName( const String& rName ) const;
 
 		/** Adds a "Physical" object to this model.
 			The model references it using a shared pointer.
@@ -79,10 +79,10 @@
 			A name can optionally be supplied. It can then be used for retrieving
 			objects by name.
 		*/
-		void addPhysical( const SharedPtr<Physical> & pPhysical, const String & rName = ""/*, bool bManaged*/ );
+		void addPhysical( const SharedPtr<Physical>& pPhysical, const String& rName = ""/*, bool bManaged*/ );
 
 		/** @copydoc addPhysical */
-		void addPhysical( Physical* pPhysical, const String & rName = ""/*, bool bManaged*/ );
+		void addPhysical( Physical* pPhysical, const String& rName = ""/*, bool bManaged*/ );
 
 		/** Adds a "Graphical" object to this model.
 			The model references it using a shared pointer.
@@ -91,15 +91,15 @@
 			A name can optionally be supplied. It can then be used for retrieving
 			objects by name.
 		*/
-		void addGraphical( const SharedPtr<Graphical> & pGraphical, const String & rName = "" );
+		void addGraphical( const SharedPtr<Graphical>& pGraphical, const String& rName = "" );
 
 		/** @copydoc addGraphical
 		*/
-		void addGraphical( Graphical* pGraphical, const String & rName = "" );
+		void addGraphical( Graphical* pGraphical, const String& rName = "" );
 
-		void addGraphicsController( const SharedPtr<IObjectController> & pController, const String & rName = "" );
-		void addGraphicsController( IObjectController* pController, const String & rName = "" );
-		void addLink( const SharedPtr<ModelLink> & pModelLink, const String & rName = "" );
+		void addGraphicsController( const SharedPtr<IObjectController>& pController, const String& rName = "" );
+		void addGraphicsController( IObjectController* pController, const String& rName = "" );
+		void addLink( const SharedPtr<ModelLink>& pModelLink, const String& rName = "" );
 
 		void updatePhysics( real timeElapsed );
 		void updateGraphics( real timeElapsed );
@@ -113,6 +113,7 @@
 				pair of source/target objects).
 		*/
 		ModelMovableLink* addLink( Movable* pSource, Movable* pTarget );
+		ModelMovableWorldLink* addWorldLink( Movable* pSource, Movable* pTarget );
 	private:
 		typedef AssocVector< String, SharedPtr<Physical> > PhysicalMap;
 		PhysicalMap			mPhysicals;
@@ -122,8 +123,8 @@
 
 		typedef Vector< SharedPtr<Model> > ModelList;
 		ModelList			mChildren;
-
-		typedef AssocVector< Movable*, ModelMovableLink* > MovableLinkMap;
+		
+		typedef AssocVector< Movable*, ModelLinkController< Movable >* > MovableLinkMap;
 		MovableLinkMap		mMovableLinkMap;
 
 		Model*				mParent;
@@ -137,3 +138,4 @@
 } // yake
 
 #endif
+

Modified: trunk/yake/yapp/model/yakeGraphical.h
===================================================================
--- trunk/yake/yapp/model/yakeGraphical.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/model/yakeGraphical.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -93,3 +93,4 @@
 } // yake
 
 #endif
+

Modified: trunk/yake/yapp/model/yakeModel.h
===================================================================
--- trunk/yake/yapp/model/yakeModel.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/model/yakeModel.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -46,3 +46,4 @@
 }
 
 #endif
+

Modified: trunk/yake/yapp/model/yakeModelLink.h
===================================================================
--- trunk/yake/yapp/model/yakeModelLink.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/model/yakeModelLink.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -51,7 +51,7 @@
 	class ModelLinkController : public ModelLink
 	{
 	private:
-		SourceType	* mSource;
+		SourceType*	mSource;
 	public:
 		virtual void setSource( SourceType * source )
 		{ mSource = source; }
@@ -63,3 +63,4 @@
 }
 
 #endif
+

Modified: trunk/yake/yapp/model/yakeModelMovableLink.h
===================================================================
--- trunk/yake/yapp/model/yakeModelMovableLink.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/model/yakeModelMovableLink.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -40,10 +40,10 @@
 	class YAPP_BASE_API ModelMovableLink : public ModelLinkController< Movable >
 	{
 	protected:
-		typedef Signal1< void(const Vector3 &) > PositionSignal;
+		typedef Signal1< void(const Vector3&) > PositionSignal;
 		PositionSignal		mPositionSignal;
 
-		typedef Signal1< void(const Quaternion &) > OrientationSignal;
+		typedef Signal1< void(const Quaternion&) > OrientationSignal;
 		OrientationSignal	mOrientationSignal;
 
 		Vector3				mLastPosition;
@@ -53,14 +53,42 @@
 		YAKE_DECLARE_CONCRETE( ModelMovableLink, "yake.movable" );
 
 		ModelMovableLink();
-		SignalConnection subscribeToPositionChanged( const PositionSignal::slot_type & slot );
-		SignalConnection subscribeToOrientationChanged( const OrientationSignal::slot_type & slot );
+		SignalConnection subscribeToPositionChanged( const PositionSignal::slot_type& slot );
+		SignalConnection subscribeToOrientationChanged( const OrientationSignal::slot_type& slot );
 		SignalConnection subscribeToPositionChanged( Movable* pMovable );
 		SignalConnection subscribeToOrientationChanged( Movable* pMovable );
 		virtual void update( real timeElapsed );
 	};
+	
+	/** A link controller designed to WORLD forward position and/or orientation to
+		to other clients using signals. Factory item id is "yake.movable_world".
+		@Remarks A controller only fires signals when the values have changed!
+	*/
+	class YAPP_BASE_API ModelMovableWorldLink : public ModelLinkController< Movable >
+	{
+	protected:
+		typedef Signal1< void(const Vector3&) > PositionSignal;
+		PositionSignal		mPositionSignal;
 
+		typedef Signal1< void(const Quaternion&) > OrientationSignal;
+		OrientationSignal	mOrientationSignal;
+
+		Vector3				mLastPosition;
+		Quaternion			mLastOrientation;
+
+	public:
+		YAKE_DECLARE_CONCRETE( ModelMovableWorldLink, "yake.movable_world" );
+
+		ModelMovableWorldLink();
+		SignalConnection subscribeToPositionChanged( const PositionSignal::slot_type& slot );
+		SignalConnection subscribeToOrientationChanged( const OrientationSignal::slot_type& slot );
+		SignalConnection subscribeToPositionChanged( Movable* pMovable );
+		SignalConnection subscribeToOrientationChanged( Movable* pMovable );
+		virtual void update( real timeElapsed );
+	};
+
 }
 }
 
 #endif
+

Modified: trunk/yake/yapp/model/yakePhysical.h
===================================================================
--- trunk/yake/yapp/model/yakePhysical.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/model/yakePhysical.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -27,6 +27,8 @@
 #ifndef YAPP_MODEL_PHYSICAL_H
 #define YAPP_MODEL_PHYSICAL_H
 
+#include <map>
+
 #include <yapp/base/yappPrerequisites.h>
 #include <yake/physics/yakePhysics.h>
 #include <yapp/model/yakeModel.h>
@@ -46,21 +48,21 @@
 
 		/** Adds a physical actor and registers it with a name for easy lookup.
 		*/
-		void addActor( physics::IActorPtr pActor, const String & rName );
+		void addActor( physics::IActorPtr pActor, const String& rName );
 
 		/** Retrieve a physical actor by the name it was registered within this model::Physical object.
 		*/
 		physics::IActorPtr getActorByName( const String& rName ) const;
 
 		/** Adds a body affector. */
-		void addAffector( SharedPtr<physics::IBodyAffector>& pAffector );
+		void addAffector( SharedPtr<physics::IBodyAffector> pAffector, const String& rName );
 
 		/** Adds a joint. */
 		void addJoint( physics::IJointPtr pJoint );
-		//void addJointGroup( SharedPtr<physics::IJointGroup> & pJointGroup );
+		//void addJointGroup( SharedPtr<physics::IJointGroup>& pJointGroup );
 
 		/** Adds a body. */
-		void addBody( SharedPtr<physics::IBody>& pBody, const String & rName );
+		void addBody( SharedPtr<physics::IBody>& pBody, const String& rName );
 
 		/** Translates this model::Physical object by translating all contained actors. */
 		void translate( const Vector3& d );
@@ -68,6 +70,8 @@
 		typedef Vector< physics::IActorPtr > ActorVector;
 		/** @todo optimize! */
 		ActorVector getActors() const;
+
+		void updateAffectors( real timeElapsed );
 	private:
 		typedef AssocVector< String, physics::IActorPtr > ActorMap;
 		ActorMap		mActors;
@@ -75,9 +79,13 @@
 		typedef Vector< physics::IJointPtr > JointList;
 		JointList		mJoints;
 
+		typedef std::pair< String, SharedPtr<physics::IBodyAffector> > AffectorRecord;
+		typedef Vector< AffectorRecord > AffectorList;
+		AffectorList		mAffectors;
 	};
 
 } // model
 } // yake
 
 #endif
+

Modified: trunk/yake/yapp/model/yakePhysicalDataImporter.h
===================================================================
--- trunk/yake/yapp/model/yakePhysicalDataImporter.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/model/yakePhysicalDataImporter.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -52,15 +52,23 @@
 
 	    virtual ~XODEListener() {}		
 
-	    void processBody( const XODEParser::BodyDesc& desc );
-	    void processGeom( const XODEParser::GeomDesc& desc );
-	    void processMass( const XODEParser::MassDesc& desc );
-	    void processJoint( const XODEParser::JointDesc& desc );
-	    void processMaterial( const XODEParser::MaterialDesc& desc );
-	    void postprocess();
+	    virtual void processBody( const XODEParser::BodyDesc& desc );
+	    virtual void processGeom( const XODEParser::GeomDesc& desc );
+	    virtual void processMass( const XODEParser::MassDesc& desc );
+	    virtual void processJoint( const XODEParser::JointDesc& desc );
+	    virtual void processMaterial( const XODEParser::MaterialDesc& desc );
+	    virtual void postprocess();
 
-	private:
+	    IJoint* getJointByName( const String& name )
+	    {
+		if ( joints_.find( name ) != joints_.end() )
+		    return joints_[ name ].joint_;
+		else
+		    return NULL;
+	    }
 
+	protected:
+
 	    struct ActorInfo
 	    {
 		IActor*	actor_;

Modified: trunk/yake/yapp/plugins/ceguiOgreRendererAdapter/pch.h
===================================================================
--- trunk/yake/yapp/plugins/ceguiOgreRendererAdapter/pch.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/plugins/ceguiOgreRendererAdapter/pch.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -37,4 +37,4 @@
 #include <yake/samples/common/yakeExampleApplication.h>
 #include <yake/data/yakeData.h>
 
-#include <Ogre.h>
\ No newline at end of file
+#include "Ogre.h"
\ No newline at end of file

Added: trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeActor.h
===================================================================
--- trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeActor.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeActor.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -0,0 +1,72 @@
+/*
+  ------------------------------------------------------------------------------------
+  This file is part of YAKE
+  Copyright  2004 The YAKE Team
+  For the latest information visit http://www.yake.org 
+  ------------------------------------------------------------------------------------
+  This program is free software; you can redistribute it and/or modify it under
+  the terms of the GNU Lesser General Public License as published by the Free Software
+  Foundation; either version 2 of the License, or (at your option) any later
+  version.
+
+  This program is distributed in the hope that it will be useful, but WITHOUT
+  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+  FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+  You should have received a copy of the GNU Lesser General Public License along with
+  this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+  Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+  http://www.gnu.org/copyleft/lesser.txt.
+  ------------------------------------------------------------------------------------
+  If you are interested in another license model contact the Yake Team via
+  E-Mail: team at yake.org.
+  For more information see the LICENSE file in the root directory of the
+  source code distribution.
+  ------------------------------------------------------------------------------------
+*/
+#ifndef TERRAIN_ACTOR_H
+#define TERRAIN_ACTOR_H
+
+#include <map>
+#include <vector>
+
+#include <yake/plugins/physicsODE/yakePCH.h>
+
+#include <yake/plugins/physicsODE/OdeWorld.h>
+#include <yake/plugins/physicsODE/OdeBody.h>
+#include <yake/plugins/physicsODE/OdeActor.h>
+
+#include "TerrainPhysicsManager.h"
+
+#include "OgrePagingLandScapeTileInfo.h"
+
+using namespace std;
+
+namespace yake
+{
+	namespace physics
+	{
+		class OdeWorld;
+		class OdeGeom;
+		class Ogre::PagingLandScapeTileInfo;
+		
+		class YAKE_PHYSICSODE_API TerrainCollisionDetectionActor : public OdeActor
+		{
+			public:
+				TerrainCollisionDetectionActor( OdeWorld* pOdeWorld );
+				virtual ~TerrainCollisionDetectionActor();
+
+				void createTerrainCollisionDetectionShape( const math::Vector3& rDimensions,
+					        const math::Vector3& rPosition,
+				       		Ogre::PagingLandScapeTileInfo* tileInfo );
+
+				void createTerrainCollisionShape(  const math::Vector3& rPosition, TriangleMeshDesc::VertexVector & vertices,
+						TriangleMeshDesc::IndexVector & indexes);
+				
+				void onCollision( const ActorCollisionInfo & collisionInfo );
+		};
+		//------------------------------------------------------------------------------------
+	} // physics
+} // yake
+
+#endif //	TERRAIN_ACTOR_H

Added: trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeShape.h
===================================================================
--- trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeShape.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeShape.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -0,0 +1,66 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright  2004 The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#ifndef YAKE_TERRAIN_ODESHAPES_H
+#define YAKE_TERRAIN_ODESHAPES_H
+
+#include <yake/plugins/physicsODE/OdeShapes.h>
+
+#include "OgreRenderQueue.h"
+#include "OgreRenderable.h"
+#include "OgreMovableObject.h"
+
+#include "OgrePagingLandScapePrerequisites.h"
+#include "OgrePagingLandScapeRenderable.h"
+
+#include "OgrePagingLandScapeTile.h"
+#include "OgrePagingLandScapeTileInfo.h"
+
+namespace yake {
+namespace physics {
+
+	class YAKE_PHYSICSODE_API OdeTerrainCollisionBox : public OdeBox
+	{
+		public:
+			OdeTerrainCollisionBox( dSpace* pSpace, OdeActor* pOwner, real sizex, real sizey, real sizez, Ogre::PagingLandScapeTileInfo * _tileInfo) : 
+				OdeBox( pSpace, pOwner, sizex, sizey, sizez)
+			{
+				tileInfo.pageX = _tileInfo->pageX;
+				tileInfo.pageZ = _tileInfo->pageZ;
+				tileInfo.tileX = _tileInfo->tileX;
+				tileInfo.tileZ = _tileInfo->tileZ;
+			};
+							
+			Ogre::PagingLandScapeTileInfo * getTileInfo() { return &tileInfo;};
+			
+		protected:
+					
+			Ogre::PagingLandScapeTileInfo 	tileInfo;						
+	};
+	
+}
+}
+#endif //YAKE_TERRAIN_ODESHAPES_H

Added: trunk/yake/yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.h
===================================================================
--- trunk/yake/yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -0,0 +1,109 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright  2004 The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#ifndef __TERRAIN_PHYS_MANAGER
+#define  __TERRAIN_PHYS_MANAGER
+
+#include <yake/base/yakePCH.h>
+
+#include <Ogre.h>
+
+#include <OgrePagingLandScapeSceneManager.h>
+#include <OgrePagingLandScapeCallBackEvent.h>
+#include <OgrePagingLandScapeListener.h>
+#include <OgreDefaultHardwareBufferManager.h>
+#include <OgrePagingLandScapePageManager.h>
+
+#include <yapp/plugins/terrainPhysMgr/TerrainOdeActor.h>
+
+#include <yake/plugins/graphicsOgre/yakeGraphicsSystem.h>
+#include <yapp/model/yakeGraphical.h>
+
+namespace yake
+{
+namespace physics
+{	
+	class IWorld;
+	class IActor;
+	class OdeWorld;
+	class TerrainCollisionDetectionActor;
+	class TerrainCollisionActor;
+		
+	class PLSMTerrainPhysicsManager
+	{
+		protected:
+			void pageLoaded( Ogre::PagingLandscapeEvent* event);
+			void tileLoaded( Ogre::PagingLandscapeEvent* event);
+			
+			void processAllTilesInPage( Ogre::PagingLandScapePage * page, int pageX, int pageZ);
+			
+			void createCollisionBoundingBox( Ogre::PagingLandScapeTile* tile);
+			
+			void convertIndexDataForOde( Ogre::IndexData* indexData, TriangleMeshDesc::IndexVector & destBuffer) ;
+			
+		public: 
+			PLSMTerrainPhysicsManager( );
+			~PLSMTerrainPhysicsManager();
+	
+			void init( Ogre::PagingLandScapeSceneManager * _sceneManager, IWorld *  _odeWorld, 
+				   graphics::IWorld* graphicsWorld = 0);
+			
+			void processTile( Ogre::PagingLandScapeTileInfo * tileInfo);
+	
+			real getHeightAt( const math::Vector3& position);
+			real getHeightAt( const Ogre::Vector3& position);
+			
+			Ogre::AxisAlignedBox calcActorAABB( IActor * _actor);
+		
+			void placeActorOnTerrain( const math::Vector3 & position,  IActor * _actor);
+			
+		protected:
+			Ogre::PagingLandScapeSceneManager * sceneManager;
+			
+			Ogre::PagingLandscapeDelegate * 	pageLoadListener;		
+			Ogre::PagingLandscapeDelegate * 	tileLoadListener;		
+			
+			Ogre::Ray 				ray;
+			Ogre::RaySceneQuery * 			rayQuery;
+			
+			OdeWorld *	odeWorld;
+			
+			TerrainCollisionDetectionActor * 	terrainCollisionDetectionActor;
+			
+			graphics::IWorld* graphicsWorld;
+			
+			typedef std::list<Ogre::PagingLandScapeTile*> TileList;
+			typedef TileList::iterator TileListIterator;
+			
+			TileList 				alreadyLoadedCollisionTiles;
+			TileList				alreadyLoadedCollisionDetectionTiles;
+	};
+	
+ 	typedef yake::base::templates::SingletonHolder< PLSMTerrainPhysicsManager, 
+	 		yake::base::templates::CreateUsingNew> TerrainPhysicsManager;
+}
+}
+#endif // __TERRAIN_PHYS_MANAGER

Modified: trunk/yake/yapp/raf/pch.h
===================================================================
--- trunk/yake/yapp/raf/pch.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/raf/pch.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -36,4 +36,3 @@
 #include <yake/statemachine/fsm_oo_machine.h>
 #include <yake/ent/ent.h>
 
-#include <yapp/raf/yakePrerequisites.h>

Modified: trunk/yake/yapp/raf/yakeApplication.h
===================================================================
--- trunk/yake/yapp/raf/yakeApplication.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/raf/yakeApplication.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -168,7 +168,7 @@
 		void onKeyUp( const yake::input::KeyboardEvent& rEvent );
 		void onMBDown( uint8 btn );
 		void onMBUp( uint8 btn );
-		void onMouseMoved( const Vector3& rDelta );
+		void onMouseMoved( const math::Vector3& rDelta );
 #endif
 	private:
 		typedef Deque<SharedPtr<base::Library> > LibList;
@@ -225,3 +225,4 @@
 } // namespace yake
 
 #endif
+

Modified: trunk/yake/yapp/raf/yakeApplicationState.h
===================================================================
--- trunk/yake/yapp/raf/yakeApplicationState.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/raf/yakeApplicationState.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -27,6 +27,9 @@
 #ifndef YAKE_RAF_APPLICATIONSTATE_H
 #define YAKE_RAF_APPLICATIONSTATE_H
 
+#include "yapp/raf/yakePrerequisites.h"
+#include "yake/statemachine/fsm_core.h"
+
 namespace yake {
 namespace raf {
 	class Application;

Modified: trunk/yake/yapp/raf/yakePrerequisites.h
===================================================================
--- trunk/yake/yapp/raf/yakePrerequisites.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/raf/yakePrerequisites.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -47,4 +47,5 @@
 } // namespace yake
 
 #endif
+//
 

Modified: trunk/yake/yapp/vehicle/yakeDotVehicle.h
===================================================================
--- trunk/yake/yapp/vehicle/yakeDotVehicle.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/vehicle/yakeDotVehicle.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -31,11 +31,12 @@
 #include "yakeTemplates.h"
 
 namespace yake {
-	namespace data {
-		namespace dom {
-			class INode;
-		}
-	}
+namespace data {
+namespace dom {
+    class INode;
+}
+}
+
 namespace vehicle {
 
 	class YAKE_VEH_API DotVehicleParser
@@ -50,24 +51,24 @@
 		YAKE_MEMBERSIGNAL(public,void(DotVehicleParser&,const String&),OnVehicleTpl);
 	private:
 		void parseVehicleTpl( const data::dom::INode& n );
-		 void parseChassis( const data::dom::INode& n );
-		  void parseBody( const data::dom::INode& n );
-		  void parseShapeSet( const data::dom::INode& n );
-		   void parseShape( const data::dom::INode& n );
-		    void parseShapeBox( const data::dom::INode& n, const String& matId );
-		    void parseShapeSphere( const data::dom::INode& n, const String& matId );
-		   void parseMountPoint( const data::dom::INode& n, VehicleTemplate::MountPointTpl* parentMtPt = 0 );
-		 void parseEngine( const data::dom::INode& n );
-		  void parseRPM( vehicle::VehicleTemplate::CarEngineTpl&, const data::dom::INode& n );
-		  void parseGearBox( vehicle::VehicleTemplate::CarEngineTpl&, const data::dom::INode& n );
-		 //void parseAxle( const data::dom::INode& n );
-		 void parseSteeringGroup( const data::dom::INode& n );
-		 void parseWheel( const data::dom::INode& n );
+		void parseChassis( const data::dom::INode& n );
+		void parseBody( const data::dom::INode& n );
+		void parseShapeSet( const data::dom::INode& n );
+		void parseShape( const data::dom::INode& n );
+		void parseShapeBox( const data::dom::INode& n, const String& matId );
+		void parseShapeSphere( const data::dom::INode& n, const String& matId );
+		void parseMountPoint( const data::dom::INode& n, VehicleTemplate::MountPointTpl* parentMtPt = 0 );
+		void parseEngine( const data::dom::INode& n );
+		void parseRPM( vehicle::VehicleTemplate::CarEngineTpl&, const data::dom::INode& n );
+		void parseGearBox( vehicle::VehicleTemplate::CarEngineTpl&, const data::dom::INode& n );
+		//void parseAxle( const data::dom::INode& n );
+		void parseSteeringGroup( const data::dom::INode& n );
+		void parseWheel( const data::dom::INode& n );
 		void parseEngineTpl( const data::dom::INode& n );
 
-		void parsePosition( const data::dom::INode& n, Vector3& ret );
-		void parseOrientation( const data::dom::INode& n, Quaternion& ret );
-		void parseDirection( const data::dom::INode& n, Vector3& ret );
+		void parsePosition( const data::dom::INode& n, math::Vector3& ret );
+		void parseOrientation( const data::dom::INode& n, math::Quaternion& ret );
+		void parseDirection( const data::dom::INode& n, math::Vector3& ret );
 
 		VehicleTemplate*	mpCurrVehTpl;
 	};
@@ -77,3 +78,4 @@
 
 
 #endif
+

Modified: trunk/yake/yapp/vehicle/yakeInterfaces.h
===================================================================
--- trunk/yake/yapp/vehicle/yakeInterfaces.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/vehicle/yakeInterfaces.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -28,7 +28,7 @@
 #define YAKE_VEHICLE_INTERFACES_H
 
 #include <yapp/vehicle/yakePrerequisites.h>
-#include "yakeTemplates.h"
+#include <yapp/vehicle/yakeTemplates.h>
 
 namespace yake {
 namespace vehicle {
@@ -66,8 +66,8 @@
 		virtual void setSteering( const uint32 sg, const real ) = 0;
 		virtual real getSteering( const uint32 sg ) const = 0;
 
-		virtual Vector3 getChassisPosition() const = 0;
-		virtual Quaternion getChassisOrientation() const = 0;
+		virtual math::Vector3 getChassisPosition() const = 0;
+		virtual math::Quaternion getChassisOrientation() const = 0;
 		virtual Movable* getChassisMovable() const = 0;
 
 		virtual void enableDebugGeometry(graphics::IWorld&) = 0;
@@ -85,8 +85,11 @@
 
 		virtual void updateSimulation( real timeElapsed ) = 0;
 
-		virtual void setThrottle( real throttle ) = 0;
-		virtual real getThrottle() const = 0;
+		/** set input signal for an engine. That is throttle for a car
+		 * and voltage for electric motor.
+		 */
+		virtual void setInputSignal( real value ) = 0;
+		virtual real getInputSignal() const = 0;
 	};
 
 	/** Interface to a vehicle engine.
@@ -98,6 +101,15 @@
 		virtual ~ICarEngine() 
 		{}
 
+		virtual void setThrottle( real throttle ) = 0;
+		virtual real getThrottle() const = 0;
+
+		/** Inherited general engine interface. 
+		 * Implemented in terms of car engine.
+		 */
+		virtual void setInputSignal( real value ) { setThrottle( value ); }
+		virtual real getInputSignal() const { return getThrottle(); }
+
 		//virtual void setParameter( const String & name, const String & value );
 		virtual void setParamMinRPM( const real rpm ) = 0;
 		virtual void setParamMaxRPM( const real rpm ) = 0;
@@ -113,16 +125,31 @@
 		virtual real getDriveTorque() const = 0;
 	};
 
-	/** A thruster is a special kind of engine. It applies force to the vehicle
-		it's attached to at a specified offset, direction etc.
+	/** A thruster is a special kind of IEngine which applies force to the vehicle it's attached to at a specified offset, direction etc.
+		Thruster force is applied lineary Fmin + k_throttle*( Fmax - Fmin ).
 		@see MountedThruster
 		@see vehicle::IEngine
 	*/
 	class YAKE_VEH_API IThruster : public IEngine
 	{
+	public:
+	    virtual real getForce() const { return mForce; }
+
 	protected:
-		virtual ~IThruster();
-		IThruster();
+	    virtual void setForce( real force ) { mForce = force; }
+
+	protected:
+	    real	mForce; // cached force value
+	};
+
+	/** Simplest class of linear thruster. If mounted it just applies force and does no
+	 * additional calculations.
+	*/
+	class YAKE_VEH_API ILinearThruster : public IThruster
+	{
+	protected:
+		virtual ~ILinearThruster();
+		ILinearThruster();
 	public:
 		/** At least the following methods are inherited from vehicle::IEngine:
 
@@ -134,13 +161,12 @@
 		real getMinimumForce() const;
 		void setMaximumForce( real force );
 		real getMaximumForce() const;
-		real getForce() const;
+		virtual real getForce() const;
 	protected:
-		void setForce( real force );
+		virtual void setForce( real force );
 	private:
 		real	mMaxForce;
 		real	mMinForce;
-		real	mForce;
 	};
 
 	/** A thruster that can be attached to a mount point.
@@ -181,3 +207,4 @@
 
 
 #endif
+

Modified: trunk/yake/yapp/vehicle/yakeMountPoint.h
===================================================================
--- trunk/yake/yapp/vehicle/yakeMountPoint.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/vehicle/yakeMountPoint.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -27,7 +27,7 @@
 #ifndef YAKE_VEHICLE_MOUNTPOINT_H
 #define YAKE_VEHICLE_MOUNTPOINT_H
 
-#include "yakePrerequisites.h"
+#include "yapp/vehicle/yakePrerequisites.h"
 
 namespace yake {
 namespace vehicle {
@@ -72,20 +72,20 @@
 		virtual bool isSuitableFor( const Mountable* mountable ) const;
 		void attach( Mountable* mountable );
 		void detach( Mountable* mountable );
-		void setDirection( const Vector3& dir );
-		Vector3 getDirection() const;
-		virtual void setOrientation( const Quaternion& );
-		virtual Quaternion getOrientation() const;
-		virtual void setPosition(const Vector3& rPosition );
-		virtual Vector3 getPosition() const;
-		Vector3 getDerivedPosition() const;
-		Quaternion getDerivedOrientation() const;
-		void lookAt(const Vector3&);
+		void setDirection( const math::Vector3& dir );
+		math::Vector3 getDirection() const;
+		virtual void setOrientation( const math::Quaternion& );
+		virtual math::Quaternion getOrientation() const;
+		virtual void setPosition(const math::Vector3& rPosition );
+		virtual math::Vector3 getPosition() const;
+		math::Vector3 getDerivedPosition() const;
+		math::Quaternion getDerivedOrientation() const;
+		void lookAt(const math::Vector3&);
 	private:
 		typedef Deque< Mountable* > MountablePtrList;
 		MountablePtrList	mMountables;
-		Quaternion			mOrientation;
-		Vector3				mPosition;
+		math::Quaternion			mOrientation;
+		math::Vector3				mPosition;
 		typedef Deque< std::pair<MountPoint*,bool> > MountPointList;
 		MountPointList		mChildren;
 		MountPoint*			mParent;
@@ -97,3 +97,4 @@
 
 
 #endif
+

Modified: trunk/yake/yapp/vehicle/yakeNativeOde.h
===================================================================
--- trunk/yake/yapp/vehicle/yakeNativeOde.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/vehicle/yakeNativeOde.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -27,7 +27,7 @@
 #ifndef YAKE_VEHICLE_NATIVEODE_H
 #define YAKE_VEHICLE_NATIVEODE_H
 
-#include "yakePrerequisites.h"
+#include <yapp/vehicle/yakePrerequisites.h>
 
 namespace yake {
 namespace vehicle {
@@ -68,11 +68,11 @@
 	public:
 		GenericVehicleSystem();
 		~GenericVehicleSystem();
-		virtual IVehicle* create(const VehicleTemplate&, physics::IWorld& PWorld);
+		virtual IVehicle* create(const VehicleTemplate&, physics::IWorld& PWorld, model::Physical& physModel);
 		virtual bool loadTemplates(const String& fn);
 		virtual VehicleTemplate* getTemplate(const String& tpl) const;
 		//virtual VehicleTemplate* cloneTemplate(const String& tpl);
-		virtual IVehicle* create(const String& tpl, physics::IWorld& PWorld);
+		virtual IVehicle* create(const String& tpl, physics::IWorld& PWorld, model::Physical& physModel);
 	private:
 		void _onVehicleTpl(DotVehicleParser& parser, const String& tplId);
 	private:
@@ -98,8 +98,8 @@
 		virtual IEnginePtrList getEngineInterfaces() const;
 		virtual IWheel* getWheelInterface(const String& id) const;
 
-		virtual Vector3 getChassisPosition() const;
-		virtual Quaternion getChassisOrientation() const;
+		virtual math::Vector3 getChassisPosition() const;
+		virtual math::Quaternion getChassisOrientation() const;
 		virtual Movable* getChassisMovable() const;
 
 		virtual void setSteering( const uint32 sg, const real );
@@ -108,7 +108,7 @@
 		virtual void enableDebugGeometry(graphics::IWorld&);
 		virtual void disableDebugGeometry();
 
-		void _create(const VehicleTemplate&, physics::IWorld& PWorld);
+		void _create(const VehicleTemplate&, physics::IWorld& PWorld, model::Physical& physModel );
 
 		YAKE_MEMBERSIGNAL(private,void(real),UpdateEngineSimulation);
 		YAKE_MEMBERSIGNAL(private,void(void),ApplyThrusterToTargets);
@@ -205,10 +205,12 @@
 					const VehicleTemplate::WheelTpl& tpl,
 					physics::IWorld& PWorld );
 
-		virtual void setPosition(const Vector3&) {}
-		virtual Vector3 getPosition() const;
-		virtual void setOrientation(const Quaternion&) {}
-		virtual Quaternion getOrientation() const;
+		virtual void setPosition(const math::Vector3&) {}
+		virtual math::Vector3 getPosition() const;
+		virtual math::Vector3 getDerivedPosition() const;
+		virtual void setOrientation(const math::Quaternion&) {}
+		virtual math::Quaternion getOrientation() const;
+		virtual math::Quaternion getDerivedOrientation() const;
 
 		virtual real getRadius() const;
 
@@ -220,8 +222,8 @@
 
 		void _applyDriveTq( const real tq );
 	private:
-		void _applyTq( const Vector3 & torque );
-		void _applyBrakeTq( const Vector3 & torque );
+		void _applyTq( const math::Vector3 & torque );
+		void _applyBrakeTq( const math::Vector3 & torque );
 		void _applyMotor( real velocity, real fmax );
 
 		void _onPreStepInternal( const real dt );
@@ -230,12 +232,12 @@
 		physics::IActorPtr		mpChassis;
 		physics::IJointPtr		mpJoint;
 		physics::IActorPtr		mpWheel;
-		real					mRadius;
-		real					mTargetSteer;
-		real					mCurrSteer;
+		real				mRadius;
+		real				mTargetSteer;
+		real				mCurrSteer;
 		SignalConnection		mPreStepSigConn, mPostStepSigConn;
-		real					mBrakeRatio;
-		real					mSkid;
+		real				mBrakeRatio;
+		real				mSkid;
 	};
 #endif // YAKE_VEHICLE_USE_ODE
 	class GenericMountPoint : public MountPoint
@@ -248,17 +250,40 @@
 		//ThrusterPtrList		mThrusters; // references thruster engines (does NOT own them!)
 	};
 
+	/** In terms of control systems it is just a gain.
+	 * Output = input*K_gain; force = voltage*k.
+	 */
 	class GenericThruster : public IThruster
 	{
 	public:
-		GenericThruster();
+	    GenericThruster();
 
-		virtual void setThrottle( real throttle );
-		virtual real getThrottle() const;
+	    virtual void setInputSignal( real voltage );
+	    virtual real getInputSignal() const;
+
+	    virtual void updateSimulation( real timeElapsed );
+
+	    virtual void setGain( real gain );
+	    virtual real getGain() const;
+
+	private:
+	    real    mVoltage; // cached gain value
+
+	    /// gain coefficient is the only *real* characteristic of such device.
+	    real    mGain;
+	};
+
+	class GenericLinearThruster : public ILinearThruster
+	{
+	public:
+		GenericLinearThruster();
+
+		virtual void setInputSignal( real voltage );
+		virtual real getInputSignal() const;
 		virtual void updateSimulation( real timeElapsed );
 
 	private:
-		real	mThrottle;
+		real	mVoltage;
 	};
 	class GenericMountedThruster : public IMountedThruster
 	{
@@ -274,3 +299,4 @@
 
 
 #endif
+

Modified: trunk/yake/yapp/vehicle/yakeTemplates.h
===================================================================
--- trunk/yake/yapp/vehicle/yakeTemplates.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/vehicle/yakeTemplates.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -27,7 +27,7 @@
 #ifndef YAKE_VEHICLE_TEMPLATES_H
 #define YAKE_VEHICLE_TEMPLATES_H
 
-#include "yakePrerequisites.h"
+#include "yapp/vehicle/yakePrerequisites.h"
 
 namespace yake {
 namespace vehicle {
@@ -40,31 +40,31 @@
 		typedef AssocVector< String, MountPointTpl > MountPointTplList;
 		struct MountPointTpl
 		{
-			Vector3				mPosition;
-			Quaternion			mOrientation;
-			Vector3				mDirection;
-			bool				mUseDirection;
+			math::Vector3		mPosition;
+			math::Quaternion	mOrientation;
+			math::Vector3		mDirection;
+			bool			mUseDirection;
 			MountPointTplList	mChildren;
 			MountPointTpl(
-				const Vector3& pos = Vector3::kZero,
-				const Quaternion rot = Quaternion::kIdentity) :
+				const math::Vector3& pos = math::Vector3::kZero,
+				const math::Quaternion& rot = math::Quaternion::kIdentity) :
 				mPosition(pos),
 				mOrientation(rot),
 				mUseDirection(false)
 			{}
 			MountPointTpl(
-				const Vector3& pos,
-				const Vector3& dir) :
+				const math::Vector3& pos,
+				const math::Vector3& dir) :
 				mPosition(pos),
 				mDirection(dir),
 				mUseDirection(true)
 			{}
 			MountPointTpl& addMountPoint(
-				const Vector3& pos = Vector3::kZero,
-				const Quaternion rot = Quaternion::kIdentity);
+				const math::Vector3& pos = math::Vector3::kZero,
+				const math::Quaternion& rot = math::Quaternion::kIdentity);
 			MountPointTpl& addMountPoint(
-				const Vector3& pos,
-				const Vector3& dir);
+				const math::Vector3& pos,
+				const math::Vector3& dir);
 		};
 		enum GearMode
 		{
@@ -87,7 +87,9 @@
 		{
 			real				minForce;
 			real				maxForce;
+			real				gain;
 			String				mountPt;
+			String				type;
 			ThrusterTpl(real minF = 0., real maxF = 1., const String& mtPt = "") : minForce(minF), maxForce(maxF), mountPt(mtPt) {}
 		};
 		struct CarEngineTpl : public EngineTpl
@@ -117,36 +119,38 @@
 		typedef AssocVector<String,EngineTpl*> EngineTplList;
 
 		typedef Deque<physics::IShape::Desc*> ShapeTplList;
-
+		
 		struct ChassisTpl
 		{
-			Vector3			mPosition; // initial position
+			math::Vector3		mPosition; // initial position
 			real			mMass;
-			ShapeTplList	mChassisShapes;
+			ShapeTplList		mChassisShapes;
 			String			mGfxReference; // e.g. dotScene file
+			String			mPhysicsBody; // e.g. physical body loaded from .xode file
+			    
 			ChassisTpl() : 
-				mPosition(Vector3::kZero),
-				mMass(real(1.6))
+				mPosition(math::Vector3::kZero),
+				mMass(real(1.6)) // @todo FIXME magic number
 			{}
 		};
 
 		struct WheelTpl
 		{
 			uint32			mAxle;
-			Vector3			mPosition;
-			Quaternion		mOrientation;
+			math::Vector3		mPosition;
+			math::Quaternion	mOrientation;
 			uint32			mSteeringGroup;
 			real			mRadius;
 			real			mMass;
 			bool			mMassRelativeToChassis;
 			real			mSuspensionSpring;
 			real			mSuspensionDamping;
-			//String			mGfxReference; // e.g. dotScene file
-			//String			mGfxReferenceType; // e.g. "dotscene"
+			//String		mGfxReference; // e.g. dotScene file
+			//String		mGfxReferenceType; // e.g. "dotscene"
 			String			mMaterial;
 			WheelTpl(
-				const Vector3& position = Vector3::kZero,
-				const Quaternion& orientation = Quaternion::kIdentity,
+				const math::Vector3& position = math::Vector3::kZero,
+				const math::Quaternion& orientation = math::Quaternion::kIdentity,
 				const real radius = real(0.2),
 				const real mass = real(0.018),
 				const bool massRelativeToChassis = true,
@@ -175,9 +179,9 @@
 
 		ChassisTpl		mChassis;
 		MountPointTplList	mMountPoints;
-		EngineTplList	mEngines;
+		EngineTplList		mEngines;
 		uint32			mSteeringGroups;
-		WheelTplList	mWheels;
+		WheelTplList		mWheels;
 
 		VehicleTemplate() : mSteeringGroups(0)
 		{}
@@ -200,3 +204,4 @@
 
 
 #endif
+

Modified: trunk/yake/yapp/vehicle/yakeVehicle.h
===================================================================
--- trunk/yake/yapp/vehicle/yakeVehicle.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/vehicle/yakeVehicle.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -44,3 +44,4 @@
 #include <yapp/vehicle/yakeVehicleSystem.h>
 
 #endif
+

Modified: trunk/yake/yapp/vehicle/yakeVehicleSystem.h
===================================================================
--- trunk/yake/yapp/vehicle/yakeVehicleSystem.h	2006-03-19 17:10:16 UTC (rev 1301)
+++ trunk/yake/yapp/vehicle/yakeVehicleSystem.h	2006-03-19 17:54:00 UTC (rev 1302)
@@ -27,7 +27,7 @@
 #ifndef YAKE_VEHICLE_SYSTEM_H
 #define YAKE_VEHICLE_SYSTEM_H
 
-#include "yakePrerequisites.h"
+#include <yapp/vehicle/yakePrerequisites.h>
 
 namespace yake {
 namespace vehicle {
@@ -38,15 +38,15 @@
 		YAKE_DECLARE_REGISTRY_0(IVehicleSystem,String);
 	public:
 		virtual ~IVehicleSystem() {}
-		virtual IVehicle* create(const VehicleTemplate&, physics::IWorld& PWorld) = 0;
+		virtual IVehicle* create(const VehicleTemplate&, physics::IWorld& PWorld, model::Physical& physModel ) = 0;
 		virtual bool loadTemplates(const String& fn) = 0;
 		//virtual VehicleTemplate* cloneTemplate(const String& tpl) = 0;
 		virtual VehicleTemplate* getTemplate(const String& tpl) const = 0;
-		virtual IVehicle* create(const String& tpl, physics::IWorld& PWorld) = 0;
+		virtual IVehicle* create(const String& tpl, physics::IWorld& PWorld, model::Physical& physModel) = 0;
 	};
 
 } // namespace vehicle
 } // namespace yake
 
+#endif
 
-#endif



From codeandroid at berlios.de  Sun Mar 19 18:56:27 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 18:56:27 +0100
Subject: [Yake-svn] r1303 - in trunk/yake/src/yapp/samples: . physics physics/paging_terrain
Message-ID: <200603191756.k2JHuRq6012019@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 18:56:19 +0100 (Sun, 19 Mar 2006)
New Revision: 1303

Added:
   trunk/yake/src/yapp/samples/physics/
   trunk/yake/src/yapp/samples/physics/paging_terrain/
   trunk/yake/src/yapp/samples/physics/paging_terrain/yakeDemo.cpp
   trunk/yake/src/yapp/samples/physics/paging_terrain/yakePCH.cpp
Log:
patch #1453160 by mj, slightly modified by psy;
major points includes linux compatibility, OGRE Dagon compatibility, vehicles enhancements, physics enhancements, paging landscape ode<->ogre physics plugin, and various other fixes.

Added: trunk/yake/src/yapp/samples/physics/paging_terrain/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/physics/paging_terrain/yakeDemo.cpp	2006-03-19 17:54:00 UTC (rev 1302)
+++ trunk/yake/src/yapp/samples/physics/paging_terrain/yakeDemo.cpp	2006-03-19 17:56:19 UTC (rev 1303)
@@ -0,0 +1,390 @@
+#include <yapp/samples/base/vehicle/yakePCH.h>
+#include <yake/audio/yakeAudio.h>
+#include <yapp/raf/yakeRaf.h>
+#include <yapp/model/yakeModelMovableLink.h>
+#include <yapp/vehicle/yakeVehicle.h>
+#include <yake/input/yakeInput.h>
+
+#include <yapp/vehicle/yakeNativeOde.h>
+
+#include <yake/plugins/graphicsOgre/graphicsOgreCore.h>
+#include <yake/plugins/graphicsOgre/yakeGraphicsSystem.h>
+
+#include <yake/plugins/physicsODE/yakePCH.h>
+#include <yake/plugins/physicsODE/PhysicsSystemODE.h>
+
+#include <yapp/plugins/terrainPhysMgr/TerrainOdeActor.h>
+#include <yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.h>
+
+#include <OgrePagingLandScapeData2DManager.h>
+
+using namespace yake;
+
+/** Configuration of the application */
+struct TheConfiguration : public raf::ApplicationConfiguration
+{
+	virtual StringVector getLibraries()
+	{ return MakeStringVector() << "graphicsOgre" << "inputOgre" << "physicsODE"; }
+
+	virtual StringVector getGraphicsSystems()
+	{ return MakeStringVector() << "ogre3d"; }
+
+  	virtual StringVector getInputSystems()
+  	{ return MakeStringVector() << "ogre"; }
+
+	virtual StringVector getPhysicsSystems()
+	{ return MakeStringVector() << "ode"; }
+};
+
+class VehicleHumanInputController
+{
+public:
+	void setVehicle(vehicle::IVehicle*);
+};
+
+/** Main application state */
+class TheMainState : public raf::RtMainState
+{
+	public:
+	TheMainState(raf::Application& owner) :
+		raf::RtMainState(owner)
+		{
+			enableInstantQuitByKey( input::KC_ESCAPE );
+		}
+
+		~TheMainState()
+		{}
+		
+		void setupTerrain()
+		{
+			YAKE_LOG( "INITIALIZING TERRAIN");
+
+			Ogre::PagingLandScapeSceneManager * sceneMgr = (Ogre::PagingLandScapeSceneManager *) getSceneMgr();
+			
+			sceneMgr->setWorldGeometry("paginglandscape2.cfg"); 
+						
+			pG = new model::Graphical();
+			YAKE_ASSERT( pG);
+			
+			pPh = new model::Physical();
+			YAKE_ASSERT( pPh);
+
+  			sceneMgr->setOption( "LoadNow", NULL); 
+// 			sceneMgr->InitScene();
+// 			sceneMgr->PagingLandScapeOctreeResize();
+			
+			physics::TerrainPhysicsManager::instance().init( sceneMgr, getPhysicalWorld() );
+		}
+
+		void onMouseMoved( const math::Vector3& rDelta )
+		{
+			getDefaultCamera()->yaw( -(rDelta.x)*0.13 );
+			getDefaultCamera()->pitch( -(rDelta.y)*0.13 );
+		}
+
+protected:
+	
+	void createDebugBox( model::complex::Model * model, model::Graphical* pG, model::Physical* pP, math::Vector3  position, math::Vector3  dims)
+	{
+		static int ID = 0; ++ID;
+		
+		/// visual scenenode & entity creation
+		graphics::IEntity* pBoxE = getGraphicalWorld()->createEntity("box_1x1x1.mesh");
+		pBoxE->setMaterial("box");
+				
+		graphics::ISceneNode* pBoxSN = getGraphicalWorld()->createSceneNode();
+		YAKE_ASSERT( pBoxSN);
+		
+		pBoxSN->attachEntity( pBoxE );
+		pBoxSN->setScale( dims);
+		pBoxSN->setPosition( position );
+				
+		/// Graphical model
+		pG->addSceneNode( pBoxSN );
+			
+		physics::IActor::Desc debugActorDesc( physics::ACTOR_MOVABLE );
+		physics::IActorPtr pBoxActor = getPhysicalWorld()->createActor( debugActorDesc);
+		
+		pBoxActor->createShape( physics::IShape::BoxDesc( dims));
+				
+		pBoxActor->setPosition( position) ;
+		
+// 		pBoxActor->getBody().setMass( 0.1);
+	
+		pP->addActor( pBoxActor, String("debugBox" ) << ID);
+				
+		/// Physical model
+		physics::IShapePtrList shapes = pBoxActor->getShapes();
+		ConstDequeIterator<physics::IShapePtrList> itShape( shapes );
+		const physics::IShapePtr pShape = itShape.getNext();
+		
+ 		model::ModelMovableLink* pLink = new model::ModelMovableLink();
+				
+ 		pLink->setSource( pShape );
+ 		pLink->subscribeToPositionChanged( pBoxSN );
+ 		pLink->subscribeToOrientationChanged( pBoxSN );
+				
+ 		model->addGraphical( pG);
+		model->addPhysical( pP );
+		
+ 		model->addLink( pBoxActor, pBoxSN);
+		
+		physics::TerrainPhysicsManager::instance().placeActorOnTerrain( position, pBoxActor);
+	}
+	
+	virtual void onCreateScene()
+	{
+		YAKE_LOG_INFORMATION("Creating scene");
+
+		// create a light
+		graphics::ILight* pLight = getGraphicalWorld()->createLight();
+		pLight->setType( graphics::ILight::LT_DIRECTIONAL );
+		pLight->setDirection( math::Vector3(0,-1,1) );
+		getGraphicalWorld()->createSceneNode("lightnode0")->attachLight( pLight );
+
+		// position camera and look at the razor
+		getDefaultCamera()->setNearClipDistance(1);
+		getDefaultCamera()->setFarClipDistance(100000);
+		
+		getDefaultCamera()->setPosition(math::Vector3(150, 650, 150));
+		getDefaultCamera()->lookAt( math::Vector3( 0, 0, 0));
+
+		getPhysicalWorld()->setGlobalGravity( math::Vector3( 0, -20, 0 ) ); 
+
+		// create ground
+		mGround = new model::complex::Model();
+		
+		math::Vector3 dims( 100, 100, 100);
+		int a = 1500, b = 600;
+		
+		for ( int i = 0; i < 15; i++)
+			createDebugBox( mGround, pG, pPh, math::Vector3( -a + 210*i, b, -a + 210*i), dims);
+	}
+
+	Ogre::SceneManager * getSceneMgr()
+	{
+		graphics::ogre3d::GraphicsSystem* pSys = (graphics::ogre3d::GraphicsSystem *)getApp().getGraphicsSystem();
+			
+		graphics::ogre3d::OgreCore * ogreCore = pSys->getCore();
+				
+		return ogreCore->getSceneMgr();
+	}
+		
+	virtual void onDestroyScene()
+	{
+		YAKE_SAFE_DELETE( mGround );
+	}
+
+	virtual void onEnter()
+	{
+		setupTerrain();
+		
+		RtMainState::onEnter();
+		using namespace input;
+
+		//camera controls
+		mActionMap.reg( ACTIONID_A,
+				new input::KeyboardActionCondition( getApp().getKeyboard(), KC_A, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_A, boost::bind(&TheMainState::onCameraLeft,this) );
+		
+		mActionMap.reg( ACTIONID_D,
+				new input::KeyboardActionCondition( getApp().getKeyboard(), KC_D, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_D, boost::bind(&TheMainState::onCameraRight,this) );
+
+		mActionMap.reg( ACTIONID_W,
+				new input::KeyboardActionCondition( getApp().getKeyboard(), KC_W, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_W, boost::bind(&TheMainState::onCameraUp,this) );
+
+		mActionMap.reg( ACTIONID_S,
+				new input::KeyboardActionCondition( getApp().getKeyboard(), KC_S, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_S, boost::bind(&TheMainState::onCameraDown,this) );
+
+		mActionMap.reg( ACTIONID_T,
+				new input::KeyboardActionCondition( getApp().getKeyboard(), KC_T, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_T, boost::bind(&TheMainState::cycleCameraDetailWiews,this) );
+
+		// front wheel controls
+
+		mActionMap.reg( ACTIONID_LEFT,
+			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_COMMA, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_LEFT, boost::bind(&TheMainState::onFrontWheelLeft,this) );
+
+		mActionMap.reg( ACTIONID_RIGHT,
+			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_PERIOD, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_RIGHT, boost::bind(&TheMainState::onFrontWheelRight,this) );
+
+		// thruster controls
+
+		mActionMap.reg( ACTIONID_STRAFE_LEFT,
+			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_LEFT, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_STRAFE_LEFT, boost::bind(&TheMainState::onStrafeLeft,this) );
+
+		mActionMap.reg( ACTIONID_STRAFE_RIGHT,
+			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_RIGHT, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_STRAFE_RIGHT, boost::bind(&TheMainState::onStrafeRight,this) );
+
+		mActionMap.reg( ACTIONID_FORWARD,
+			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_UP, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_FORWARD, boost::bind(&TheMainState::onForward,this) );
+
+		mActionMap.reg( ACTIONID_REVERSE,
+			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_DOWN, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_REVERSE, boost::bind(&TheMainState::onReverse,this) );
+
+		mActionMap.reg( ACTIONID_UP,
+			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_PGUP, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_UP, boost::bind(&TheMainState::onUp,this) );
+		
+		mActionMap.reg( ACTIONID_DOWN,
+			new input::KeyboardActionCondition( getApp().getKeyboard(), KC_PGDOWN, KAM_CONTINUOUS ) );
+		mActionMap.subscribeToActionId( ACTIONID_DOWN, boost::bind(&TheMainState::onDown,this) );
+	
+	}
+
+	virtual void onExit()
+	{}
+
+	virtual void onFrame(const real timeElapsed)
+	{
+		mActionMap.update();
+
+		ConstDequeIterator< ActionIdList > itAction( mActiveActions );
+		
+		while (itAction.hasMoreElements())
+		{
+ 			const input::ActionId activeId = itAction.getNext();
+
+			 if (activeId == input::ACTIONID_A)
+			{
+				getDefaultCamera()->translate(  math::Vector3( -2.5, 0,0));
+			}
+			else if (activeId == input::ACTIONID_D)
+			{	
+				getDefaultCamera()->translate(  math::Vector3( 2.5, 0,0));
+			}
+			else if (activeId == input::ACTIONID_S)
+			{	
+				math::Vector3 currentDir = getDefaultCamera()->getDirection();
+				currentDir *= -15;
+				
+				getDefaultCamera()->translate(  currentDir);
+			}
+			else if (activeId == input::ACTIONID_W)
+			{	
+				math::Vector3 currentDir = getDefaultCamera()->getDirection();
+				currentDir *= 15;
+				
+				getDefaultCamera()->translate(  currentDir);
+			}
+			else if( activeId == input::ACTIONID_UP)
+			{
+				math::Vector3 dims( 100, 100, 100);
+				int a = 1500, b = 600;
+		
+				for ( int i = 0; i < 15; i++)
+					createDebugBox( mGround, pG, pPh, math::Vector3( -a + 210*i, b, -a + 210*i), dims);
+			}
+		}
+   		mGround->updatePhysics( timeElapsed);
+ 		mGround->updateGraphics( timeElapsed);
+		
+		mActiveActions.clear();
+	}
+	
+protected:
+	void onStrafeLeft()
+	{ mActiveActions.insert( input::ACTIONID_STRAFE_LEFT ); }
+
+	void onStrafeRight()
+	{ mActiveActions.insert( input::ACTIONID_STRAFE_RIGHT ); }
+
+	void onForward()
+	{ mActiveActions.insert( input::ACTIONID_FORWARD ); }
+
+	void onReverse()
+	{ mActiveActions.insert( input::ACTIONID_REVERSE ); }
+	
+	void onUp()
+	{ mActiveActions.insert( input::ACTIONID_UP ); }
+	
+	void onDown()
+	{ mActiveActions.insert( input::ACTIONID_DOWN);}
+	
+	void onFrontWheelLeft()
+	{ mActiveActions.insert( input::ACTIONID_LEFT ); }
+	
+	void onFrontWheelRight()
+	{ mActiveActions.insert( input::ACTIONID_RIGHT ); }
+	
+	void onCameraLeft()
+	{ mActiveActions.insert( input::ACTIONID_A); }
+	
+	void onCameraRight()
+	{ mActiveActions.insert( input::ACTIONID_D); }
+
+	void onCameraUp()
+	{ mActiveActions.insert( input::ACTIONID_W); }
+
+	void onCameraDown()
+	{ mActiveActions.insert( input::ACTIONID_S); }
+
+	void cycleCameraDetailWiews()
+	{
+		char currentDetailLevel = getDefaultCamera()->getDetailLevel();
+//  		currentDetailLevel++;
+//  		if( currentDetailLevel > graphics::ICamera::SDL_SOLID)
+			currentDetailLevel = graphics::SDL_WIREFRAME;
+		
+		getDefaultCamera()->setDetailLevel ( (graphics::SceneDetailLevel)currentDetailLevel);
+	}
+
+private:
+	model::complex::Model*	mGround;
+	
+	input::ActionMap		mActionMap;
+
+	typedef std::set<input::ActionId> ActionIdList;
+	ActionIdList			mActiveActions;
+	
+	model::Graphical* pG;
+	model::Physical* pPh;
+};
+
+/** The mighty application itself! */
+class TheApp : public raf::ExampleApplication<TheConfiguration>
+{
+public:
+	TheApp() 
+	{
+		mainState = new TheMainState( *this);
+	}
+
+	void onMouseMoved( const math::Vector3& rDelta )
+	{
+		mainState->onMouseMoved( rDelta);
+	}
+
+	bool onInitialise() 
+	{ 
+ 		getMouseEventGenerator()->subscribeToMouseMoved( Bind1( &TheApp::onMouseMoved, this ) );
+		return true; 
+	}
+
+protected:
+	TheMainState * mainState;
+		
+	virtual raf::MainState* createMainState()
+	{
+		return mainState;
+	}
+};
+
+int main( int argc, char** argv )
+{
+	// Use default executor for convenience.
+	// It's always possible to manually execute TheApp::initialise() etc.
+	TheApp theApp;
+	
+	return (raf::runApplication( theApp )) ? 0 : 1;
+}
+

Added: trunk/yake/src/yapp/samples/physics/paging_terrain/yakePCH.cpp
===================================================================
--- trunk/yake/src/yapp/samples/physics/paging_terrain/yakePCH.cpp	2006-03-19 17:54:00 UTC (rev 1302)
+++ trunk/yake/src/yapp/samples/physics/paging_terrain/yakePCH.cpp	2006-03-19 17:56:19 UTC (rev 1303)
@@ -0,0 +1 @@
+#include <yapp/samples/base/vehicle/yakePCH.h>



From codeandroid at berlios.de  Sun Mar 19 23:27:07 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 23:27:07 +0100
Subject: [Yake-svn] r1305 - trunk/yake/src/yake/plugins/physicsODE
Message-ID: <200603192227.k2JMR7jK003717@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 23:27:07 +0100 (Sun, 19 Mar 2006)
New Revision: 1305

Modified:
   trunk/yake/src/yake/plugins/physicsODE/OdeWorld.cpp
Log:
added addActor()

Modified: trunk/yake/src/yake/plugins/physicsODE/OdeWorld.cpp
===================================================================
--- trunk/yake/src/yake/plugins/physicsODE/OdeWorld.cpp	2006-03-19 22:26:26 UTC (rev 1304)
+++ trunk/yake/src/yake/plugins/physicsODE/OdeWorld.cpp	2006-03-19 22:27:07 UTC (rev 1305)
@@ -289,6 +289,12 @@
 		return pAvatar;
 	}
 	//-----------------------------------------------------
+	void OdeWorld::addActor( IActorPtr actor )
+	{
+		YAKE_ASSERT( actor );
+		mActors.push_back( SharedPtr<OdeActor>( checked_cast<OdeActor*>(actor) ) );
+	}
+	//-----------------------------------------------------
 	IActorPtr OdeWorld::createActor( const IActor::Desc& rActorDesc )
 	{
 		OdeActor* pActor = new OdeActor( this, (rActorDesc.type == ACTOR_DYNAMIC) );



From codeandroid at berlios.de  Sun Mar 19 23:26:27 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 23:26:27 +0100
Subject: [Yake-svn] r1304 - trunk/yake/src/yapp/samples/physics/paging_terrain
Message-ID: <200603192226.k2JMQRIa003619@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 23:26:26 +0100 (Sun, 19 Mar 2006)
New Revision: 1304

Modified:
   trunk/yake/src/yapp/samples/physics/paging_terrain/yakeDemo.cpp
Log:
small fixes

Modified: trunk/yake/src/yapp/samples/physics/paging_terrain/yakeDemo.cpp
===================================================================
--- trunk/yake/src/yapp/samples/physics/paging_terrain/yakeDemo.cpp	2006-03-19 17:56:19 UTC (rev 1303)
+++ trunk/yake/src/yapp/samples/physics/paging_terrain/yakeDemo.cpp	2006-03-19 22:26:26 UTC (rev 1304)
@@ -1,4 +1,4 @@
-#include <yapp/samples/base/vehicle/yakePCH.h>
+#include <yake/base/yake.h>
 #include <yake/audio/yakeAudio.h>
 #include <yapp/raf/yakeRaf.h>
 #include <yapp/model/yakeModelMovableLink.h>
@@ -7,8 +7,8 @@
 
 #include <yapp/vehicle/yakeNativeOde.h>
 
+#include "Ogre.h"
 #include <yake/plugins/graphicsOgre/graphicsOgreCore.h>
-#include <yake/plugins/graphicsOgre/yakeGraphicsSystem.h>
 
 #include <yake/plugins/physicsODE/yakePCH.h>
 #include <yake/plugins/physicsODE/PhysicsSystemODE.h>
@@ -20,6 +20,11 @@
 
 using namespace yake;
 
+const input::ActionId ACTIONID_CAM_LEFT( input::ACTIONID_USER+1, "camLeft" );
+const input::ActionId ACTIONID_CAM_RIGHT( input::ACTIONID_USER+2, "camRight" );
+const input::ActionId ACTIONID_CAM_UP( input::ACTIONID_USER+3, "camUp" );
+const input::ActionId ACTIONID_CAM_DOWN( input::ACTIONID_USER+4, "camDown" );
+
 /** Configuration of the application */
 struct TheConfiguration : public raf::ApplicationConfiguration
 {
@@ -59,21 +64,28 @@
 		{
 			YAKE_LOG( "INITIALIZING TERRAIN");
 
-			Ogre::PagingLandScapeSceneManager * sceneMgr = (Ogre::PagingLandScapeSceneManager *) getSceneMgr();
-			
-			sceneMgr->setWorldGeometry("paginglandscape2.cfg"); 
-						
-			pG = new model::Graphical();
-			YAKE_ASSERT( pG);
-			
-			pPh = new model::Physical();
-			YAKE_ASSERT( pPh);
+			try {
 
-  			sceneMgr->setOption( "LoadNow", NULL); 
-// 			sceneMgr->InitScene();
-// 			sceneMgr->PagingLandScapeOctreeResize();
-			
-			physics::TerrainPhysicsManager::instance().init( sceneMgr, getPhysicalWorld() );
+				Ogre::PagingLandScapeSceneManager * sceneMgr = (Ogre::PagingLandScapeSceneManager *) getSceneMgr();
+				
+				sceneMgr->setWorldGeometry("paginglandscape2.cfg"); 
+							
+				pG = new model::Graphical();
+				YAKE_ASSERT( pG);
+				
+				pPh = new model::Physical();
+				YAKE_ASSERT( pPh);
+
+  				sceneMgr->setOption( "LoadNow", NULL); 
+	// 			sceneMgr->InitScene();
+	// 			sceneMgr->PagingLandScapeOctreeResize();
+				
+				physics::TerrainPhysicsManager::instance().init( sceneMgr, getPhysicalWorld() );
+			} catch (Ogre::Exception& e)
+			{
+				YAKE_LOG_ERROR( e.getFullDescription() );
+				YAKE_EXCEPT("Caught OGRE exception.");
+			}
 		}
 
 		void onMouseMoved( const math::Vector3& rDelta )
@@ -165,7 +177,7 @@
 	{
 		graphics::ogre3d::GraphicsSystem* pSys = (graphics::ogre3d::GraphicsSystem *)getApp().getGraphicsSystem();
 			
-		graphics::ogre3d::OgreCore * ogreCore = pSys->getCore();
+		graphics::ogre3d::OgreCore * ogreCore = pSys->_getCore();
 				
 		return ogreCore->getSceneMgr();
 	}
@@ -183,25 +195,25 @@
 		using namespace input;
 
 		//camera controls
-		mActionMap.reg( ACTIONID_A,
+		mActionMap.reg( ACTIONID_CAM_LEFT,
 				new input::KeyboardActionCondition( getApp().getKeyboard(), KC_A, KAM_CONTINUOUS ) );
-		mActionMap.subscribeToActionId( ACTIONID_A, boost::bind(&TheMainState::onCameraLeft,this) );
+		mActionMap.subscribeToActionId( ACTIONID_CAM_LEFT, boost::bind(&TheMainState::onCameraLeft,this) );
 		
-		mActionMap.reg( ACTIONID_D,
+		mActionMap.reg( ACTIONID_CAM_RIGHT,
 				new input::KeyboardActionCondition( getApp().getKeyboard(), KC_D, KAM_CONTINUOUS ) );
-		mActionMap.subscribeToActionId( ACTIONID_D, boost::bind(&TheMainState::onCameraRight,this) );
+		mActionMap.subscribeToActionId( ACTIONID_CAM_RIGHT, boost::bind(&TheMainState::onCameraRight,this) );
 
-		mActionMap.reg( ACTIONID_W,
+		mActionMap.reg( ACTIONID_CAM_UP,
 				new input::KeyboardActionCondition( getApp().getKeyboard(), KC_W, KAM_CONTINUOUS ) );
-		mActionMap.subscribeToActionId( ACTIONID_W, boost::bind(&TheMainState::onCameraUp,this) );
+		mActionMap.subscribeToActionId( ACTIONID_CAM_UP, boost::bind(&TheMainState::onCameraUp,this) );
 
-		mActionMap.reg( ACTIONID_S,
+		mActionMap.reg( ACTIONID_CAM_DOWN,
 				new input::KeyboardActionCondition( getApp().getKeyboard(), KC_S, KAM_CONTINUOUS ) );
-		mActionMap.subscribeToActionId( ACTIONID_S, boost::bind(&TheMainState::onCameraDown,this) );
+		mActionMap.subscribeToActionId( ACTIONID_CAM_DOWN, boost::bind(&TheMainState::onCameraDown,this) );
 
-		mActionMap.reg( ACTIONID_T,
-				new input::KeyboardActionCondition( getApp().getKeyboard(), KC_T, KAM_CONTINUOUS ) );
-		mActionMap.subscribeToActionId( ACTIONID_T, boost::bind(&TheMainState::cycleCameraDetailWiews,this) );
+		mActionMap.reg( ACTIONID_FIRE1,
+				new input::KeyboardActionCondition( getApp().getKeyboard(), KC_T, KAM_RELEASED ) );
+		mActionMap.subscribeToActionId( ACTIONID_FIRE1, boost::bind(&TheMainState::cycleCameraDetailWiews,this) );
 
 		// front wheel controls
 
@@ -254,22 +266,22 @@
 		{
  			const input::ActionId activeId = itAction.getNext();
 
-			 if (activeId == input::ACTIONID_A)
+			 if (activeId == ACTIONID_CAM_LEFT)
 			{
 				getDefaultCamera()->translate(  math::Vector3( -2.5, 0,0));
 			}
-			else if (activeId == input::ACTIONID_D)
+			else if (activeId == ACTIONID_CAM_RIGHT)
 			{	
 				getDefaultCamera()->translate(  math::Vector3( 2.5, 0,0));
 			}
-			else if (activeId == input::ACTIONID_S)
+			else if (activeId == ACTIONID_CAM_DOWN)
 			{	
 				math::Vector3 currentDir = getDefaultCamera()->getDirection();
 				currentDir *= -15;
 				
 				getDefaultCamera()->translate(  currentDir);
 			}
-			else if (activeId == input::ACTIONID_W)
+			else if (activeId == ACTIONID_CAM_UP)
 			{	
 				math::Vector3 currentDir = getDefaultCamera()->getDirection();
 				currentDir *= 15;
@@ -317,16 +329,16 @@
 	{ mActiveActions.insert( input::ACTIONID_RIGHT ); }
 	
 	void onCameraLeft()
-	{ mActiveActions.insert( input::ACTIONID_A); }
+	{ mActiveActions.insert( ACTIONID_CAM_LEFT); }
 	
 	void onCameraRight()
-	{ mActiveActions.insert( input::ACTIONID_D); }
+	{ mActiveActions.insert( ACTIONID_CAM_RIGHT); }
 
 	void onCameraUp()
-	{ mActiveActions.insert( input::ACTIONID_W); }
+	{ mActiveActions.insert( ACTIONID_CAM_UP); }
 
 	void onCameraDown()
-	{ mActiveActions.insert( input::ACTIONID_S); }
+	{ mActiveActions.insert( ACTIONID_CAM_DOWN); }
 
 	void cycleCameraDetailWiews()
 	{



From codeandroid at berlios.de  Sun Mar 19 23:27:48 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 23:27:48 +0100
Subject: [Yake-svn] r1307 - trunk/yake/yake/base
Message-ID: <200603192227.k2JMRm3X003817@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 23:27:48 +0100 (Sun, 19 Mar 2006)
New Revision: 1307

Modified:
   trunk/yake/yake/base/yakePlatform.h
Log:
YAKE_ prefix

Modified: trunk/yake/yake/base/yakePlatform.h
===================================================================
--- trunk/yake/yake/base/yakePlatform.h	2006-03-19 22:27:23 UTC (rev 1306)
+++ trunk/yake/yake/base/yakePlatform.h	2006-03-19 22:27:48 UTC (rev 1307)
@@ -39,8 +39,8 @@
 #define COMPILER_GNUC 2
 #define COMPILER_BORL 3
 
-#define ENDIAN_LITTLE 1
-#define ENDIAN_BIG 2
+#define YAKE_ENDIAN_LITTLE 1
+#define YAKE_ENDIAN_BIG 2
 
 // Get compiler and version
 #if defined( _MSC_VER )



From codeandroid at berlios.de  Sun Mar 19 23:27:24 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 23:27:24 +0100
Subject: [Yake-svn] r1306 - trunk/yake/src/yake/plugins/graphicsOgre
Message-ID: <200603192227.k2JMROa3003763@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 23:27:23 +0100 (Sun, 19 Mar 2006)
New Revision: 1306

Modified:
   trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreCamera.cpp
Log:
dagon 1.2 support

Modified: trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreCamera.cpp
===================================================================
--- trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreCamera.cpp	2006-03-19 22:27:07 UTC (rev 1305)
+++ trunk/yake/src/yake/plugins/graphicsOgre/graphicsOgreCamera.cpp	2006-03-19 22:27:23 UTC (rev 1306)
@@ -113,23 +113,13 @@
 	//------------------------------------------------------
 	void OgreCamera::setDetailLevel( SceneDetailLevel sd )
 	{
-// for Ogre 1.1.0 "Dagon" compatibility
-#if OGRE_VERSION_MINOR >= 1 
 		mCam->setPolygonMode( Ogre::PolygonMode( sd ) );
-#else
-		mCam->setDetailLevel( Ogre::SceneDetailLevel( sd ) );
-#endif
 	}
 	
 	//------------------------------------------------------
 	SceneDetailLevel OgreCamera::getDetailLevel() const
 	{
-// for Ogre 1.1.0 "Dagon" compatibility
-#if OGRE_VERSION_MINOR >= 1 
 		return SceneDetailLevel( mCam->getPolygonMode() );
-#else
-		return SceneDetailLevel( mCam->getDetailLevel() );
-#endif
 	}
 	
 	//------------------------------------------------------



From codeandroid at berlios.de  Sun Mar 19 23:28:34 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 23:28:34 +0100
Subject: [Yake-svn] r1308 - trunk/yake/yake/plugins/graphicsOgre
Message-ID: <200603192228.k2JMSYQv003901@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 23:28:33 +0100 (Sun, 19 Mar 2006)
New Revision: 1308

Modified:
   trunk/yake/yake/plugins/graphicsOgre/graphicsOgreCore.h
Log:
added dll interface

Modified: trunk/yake/yake/plugins/graphicsOgre/graphicsOgreCore.h
===================================================================
--- trunk/yake/yake/plugins/graphicsOgre/graphicsOgreCore.h	2006-03-19 22:27:48 UTC (rev 1307)
+++ trunk/yake/yake/plugins/graphicsOgre/graphicsOgreCore.h	2006-03-19 22:28:33 UTC (rev 1308)
@@ -27,6 +27,12 @@
 #ifndef YAKE_GRAPHICSSYSTEMOGRE_CORE_H
 #define YAKE_GRAPHICSSYSTEMOGRE_CORE_H
 
+#if defined( YAKE_GRAPHICSCONCRETEAPI_EXPORTS )
+#	define YAKE_GRAPHICS_CONCRETE_API DLLEXPORT
+#else
+#	define YAKE_GRAPHICS_CONCRETE_API DLLIMPORT
+#endif
+
 namespace Ogre {
 	class SceneManager;
 	class Root;
@@ -42,7 +48,7 @@
 namespace ogre3d {
 
 	class SystemFrameListener;
-	class OgreCore
+	class YAKE_GRAPHICS_CONCRETE_API OgreCore
 	{
 		YAKE_DECLARE_CLASS( OgreCore );
 	public:



From codeandroid at berlios.de  Sun Mar 19 23:29:26 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 23:29:26 +0100
Subject: [Yake-svn] r1309 - trunk/yake/yake/plugins/physicsODE
Message-ID: <200603192229.k2JMTQ70004005@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 23:29:25 +0100 (Sun, 19 Mar 2006)
New Revision: 1309

Modified:
   trunk/yake/yake/plugins/physicsODE/OdeWorld.h
Log:
added addActor()

Modified: trunk/yake/yake/plugins/physicsODE/OdeWorld.h
===================================================================
--- trunk/yake/yake/plugins/physicsODE/OdeWorld.h	2006-03-19 22:28:33 UTC (rev 1308)
+++ trunk/yake/yake/plugins/physicsODE/OdeWorld.h	2006-03-19 22:29:25 UTC (rev 1309)
@@ -49,7 +49,10 @@
 			virtual IJointPtr createJoint( const IJoint::DescBase& rkJointDesc );
 			virtual IActorPtr createActor( const IActor::Desc& rActorDesc = IActor::Desc( ACTOR_MOVABLE ) );
 			virtual IAvatarPtr createAvatar( const IAvatar::Desc& rkAvatarDesc );
-	
+
+			/** Take care using this method. */
+			void addActor( IActorPtr );
+
 			virtual IMaterialPtr getMaterial( const String& id ) const;
 			virtual IMaterialPtr createMaterial( const IMaterial::Desc& rkMatDesc, const String& id = "" );
 			virtual void destroyJoint( IJointPtr pJoint );



From codeandroid at berlios.de  Sun Mar 19 23:30:37 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 23:30:37 +0100
Subject: [Yake-svn] r1310 - trunk/yake/yapp/plugins/terrainPhysMgr
Message-ID: <200603192230.k2JMUbH8004172@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 23:30:37 +0100 (Sun, 19 Mar 2006)
New Revision: 1310

Modified:
   trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeActor.h
   trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeShape.h
   trunk/yake/yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.h
Log:
fixed includes and dll interface

Modified: trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeActor.h
===================================================================
--- trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeActor.h	2006-03-19 22:29:25 UTC (rev 1309)
+++ trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeActor.h	2006-03-19 22:30:37 UTC (rev 1310)
@@ -30,6 +30,7 @@
 #include <map>
 #include <vector>
 
+#include <yapp/plugins/terrainPhysMgr/TerrainOdePrerequisites.h>
 #include <yake/plugins/physicsODE/yakePCH.h>
 
 #include <yake/plugins/physicsODE/OdeWorld.h>
@@ -50,7 +51,7 @@
 		class OdeGeom;
 		class Ogre::PagingLandScapeTileInfo;
 		
-		class YAKE_PHYSICSODE_API TerrainCollisionDetectionActor : public OdeActor
+		class YAKE_PHYSICSPLSM_API TerrainCollisionDetectionActor : public OdeActor
 		{
 			public:
 				TerrainCollisionDetectionActor( OdeWorld* pOdeWorld );

Modified: trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeShape.h
===================================================================
--- trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeShape.h	2006-03-19 22:29:25 UTC (rev 1309)
+++ trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdeShape.h	2006-03-19 22:30:37 UTC (rev 1310)
@@ -27,6 +27,7 @@
 #ifndef YAKE_TERRAIN_ODESHAPES_H
 #define YAKE_TERRAIN_ODESHAPES_H
 
+#include <yapp/plugins/terrainPhysMgr/TerrainOdePrerequisites.h>
 #include <yake/plugins/physicsODE/OdeShapes.h>
 
 #include "OgreRenderQueue.h"
@@ -42,7 +43,7 @@
 namespace yake {
 namespace physics {
 
-	class YAKE_PHYSICSODE_API OdeTerrainCollisionBox : public OdeBox
+	class YAKE_PHYSICSPLSM_API OdeTerrainCollisionBox : public OdeBox
 	{
 		public:
 			OdeTerrainCollisionBox( dSpace* pSpace, OdeActor* pOwner, real sizex, real sizey, real sizez, Ogre::PagingLandScapeTileInfo * _tileInfo) : 

Modified: trunk/yake/yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.h
===================================================================
--- trunk/yake/yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.h	2006-03-19 22:29:25 UTC (rev 1309)
+++ trunk/yake/yapp/plugins/terrainPhysMgr/TerrainPhysicsManager.h	2006-03-19 22:30:37 UTC (rev 1310)
@@ -27,6 +27,8 @@
 #ifndef __TERRAIN_PHYS_MANAGER
 #define  __TERRAIN_PHYS_MANAGER
 
+#include <yapp/plugins/terrainPhysMgr/TerrainOdePrerequisites.h>
+#include <yapp/plugins/terrainPhysMgr/TerrainOdePrerequisites.h>
 #include <yake/base/yakePCH.h>
 
 #include <Ogre.h>
@@ -52,7 +54,7 @@
 	class TerrainCollisionDetectionActor;
 	class TerrainCollisionActor;
 		
-	class PLSMTerrainPhysicsManager
+	class YAKE_PHYSICSPLSM_API PLSMTerrainPhysicsManager
 	{
 		protected:
 			void pageLoaded( Ogre::PagingLandscapeEvent* event);



From codeandroid at berlios.de  Sun Mar 19 23:30:56 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 23:30:56 +0100
Subject: [Yake-svn] r1311 - trunk/yake/yapp/raf
Message-ID: <200603192230.k2JMUuQ9004224@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 23:30:56 +0100 (Sun, 19 Mar 2006)
New Revision: 1311

Modified:
   trunk/yake/yapp/raf/yakeRtApplicationState.h
Log:
added includes

Modified: trunk/yake/yapp/raf/yakeRtApplicationState.h
===================================================================
--- trunk/yake/yapp/raf/yakeRtApplicationState.h	2006-03-19 22:30:37 UTC (rev 1310)
+++ trunk/yake/yapp/raf/yakeRtApplicationState.h	2006-03-19 22:30:56 UTC (rev 1311)
@@ -28,6 +28,9 @@
 #define YAKE_RAF_RTAPPLICATIONSTATE_H
 
 #include "yake/input/yakeInputSystem.h"
+#include "yake/graphics/yakeGraphics.h"
+#include "yake/physics/yakePhysics.h"
+#include "yake/scripting/yakeScriptingSystem.h"
 
 namespace yake {
 namespace raf {



From codeandroid at berlios.de  Sun Mar 19 23:31:21 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 23:31:21 +0100
Subject: [Yake-svn] r1312 - trunk/yake/yapp/plugins/terrainPhysMgr
Message-ID: <200603192231.k2JMVLc0004300@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 23:31:21 +0100 (Sun, 19 Mar 2006)
New Revision: 1312

Added:
   trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdePrerequisites.h
Log:
initial revision

Added: trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdePrerequisites.h
===================================================================
--- trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdePrerequisites.h	2006-03-19 22:30:56 UTC (rev 1311)
+++ trunk/yake/yapp/plugins/terrainPhysMgr/TerrainOdePrerequisites.h	2006-03-19 22:31:21 UTC (rev 1312)
@@ -0,0 +1,41 @@
+/*
+   ------------------------------------------------------------------------------------
+   This file is part of YAKE
+   Copyright  2004 The YAKE Team
+   For the latest information visit http://www.yake.org 
+   ------------------------------------------------------------------------------------
+   This program is free software; you can redistribute it and/or modify it under
+   the terms of the GNU Lesser General Public License as published by the Free Software
+   Foundation; either version 2 of the License, or (at your option) any later
+   version.
+
+   This program is distributed in the hope that it will be useful, but WITHOUT
+   ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
+   FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License along with
+   this program; if not, write to the Free Software Foundation, Inc., 59 Temple
+   Place - Suite 330, Boston, MA 02111-1307, USA, or go to
+   http://www.gnu.org/copyleft/lesser.txt.
+   ------------------------------------------------------------------------------------
+   If you are interested in another license model contact the Yake Team via
+   E-Mail: team at yake.org.
+   For more information see the LICENSE file in the root directory of the
+   source code distribution.
+   ------------------------------------------------------------------------------------
+*/
+#ifndef YAKE_TERRAIN_ODE_PREREQUISITES_H
+#define YAKE_TERRAIN_ODE_PREREQUISITES_H
+
+#if YAKE_PLATFORM == PLATFORM_WIN32
+#	if defined(YAKEPHYSICSODE_PLSM_EXPORTS)
+#		define	YAKE_PHYSICSPLSM_API DLLEXPORT
+#	else
+#		define	YAKE_PHYSICSPLSM_API DLLIMPORT
+#	endif
+#else
+#	define YAKE_PHYSICSPLSM_API
+#endif
+	
+#endif
+



From codeandroid at berlios.de  Sun Mar 19 23:32:30 2006
From: codeandroid at berlios.de (codeandroid at BerliOS)
Date: Sun, 19 Mar 2006 23:32:30 +0100
Subject: [Yake-svn] r1313 - in trunk/yake/scripts/msvc8: . plugins/physics samples/physics
Message-ID: <200603192232.k2JMWUYu004415@sheep.berlios.de>

Author: codeandroid
Date: 2006-03-19 23:32:30 +0100 (Sun, 19 Mar 2006)
New Revision: 1313

Added:
   trunk/yake/scripts/msvc8/plugins/physics/terrainPhysMgr.vcproj
   trunk/yake/scripts/msvc8/samples/physics/samplePhysicsPagingTerrain.vcproj
Modified:
   trunk/yake/scripts/msvc8/yake.sln
Log:
added terrPhysMgr plugin and sample

Added: trunk/yake/scripts/msvc8/plugins/physics/terrainPhysMgr.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/plugins/physics/terrainPhysMgr.vcproj	2006-03-19 22:31:21 UTC (rev 1312)
+++ trunk/yake/scripts/msvc8/plugins/physics/terrainPhysMgr.vcproj	2006-03-19 22:32:30 UTC (rev 1313)
@@ -0,0 +1,227 @@
+<?xml version="1.0" encoding="Windows-1252"?>
+<VisualStudioProject
+	ProjectType="Visual C++"
+	Version="8,00"
+	Name="terrainPhysMgr"
+	ProjectGUID="{6FC81A1C-0463-45EB-94F9-F7D084E3C169}"
+	Keyword="Win32Proj"
+	>
+	<Platforms>
+		<Platform
+			Name="Win32"
+		/>
+	</Platforms>
+	<ToolFiles>
+	</ToolFiles>
+	<Configurations>
+		<Configuration
+			Name="Debug|Win32"
+			OutputDirectory="../../../../common/bin/debug"
+			IntermediateDirectory="../../../../common/obj/debug/$(ProjectName)"
+			ConfigurationType="2"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				Optimization="0"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/ttl/;../../../../dependencies/boost/;../../../../dependencies/ode/include;../../../../dependencies/ogrenew/ogremain/include;../../../..\dependencies\ogreaddons\paginglandscape\PlugIns\PagingLandScape2\include"
+				PreprocessorDefinitions="_STLP_DEBUG;WIN32;_DEBUG;_WINDOWS;_USRDLL;YAKEPHYSICSODE_PLSM_EXPORTS"
+				MinimalRebuild="true"
+				BasicRuntimeChecks="3"
+				RuntimeLibrary="3"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="0"
+				PrecompiledHeaderThrough="yake/plugins/physicsODE/yakePCH.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="4"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="yapp.lib oded.lib physics.lib ogremain_d.lib Plugin_PagingLandScapeSceneManager2_d.lib"
+				OutputFile="$(OutDir)/$(ProjectName).dll"
+				LinkIncremental="2"
+				AdditionalLibraryDirectories="../../../../common/lib/debug;../../../../dependencies/ode/lib;../../../../dependencies/lib;&quot;../../../../dependencies/ogrenew/ogremain/lib/$(ConfigurationName)&quot;;&quot;../../../../dependencies/ogreaddons/paginglandscape/plugins/paginglandscape2/bin/$(ConfigurationName)&quot;"
+				ModuleDefinitionFile=""
+				GenerateDebugInformation="true"
+				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
+				SubSystem="2"
+				ImportLibrary="../../../../common/lib/debug/$(TargetName).lib"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+		<Configuration
+			Name="Release|Win32"
+			OutputDirectory="../../../../common/bin/release"
+			IntermediateDirectory="../../../../common/obj/release/$(ProjectName)"
+			ConfigurationType="2"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/ttl/;../../../../dependencies/boost/;../../../../dependencies/ode/include;../../../../dependencies/ogrenew/ogremain/include"
+				PreprocessorDefinitions="WIN32;NDEBUG;_WINDOWS;_USRDLL;YAKEPHYSICSODE_PLSM_EXPORTS"
+				RuntimeLibrary="2"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="0"
+				PrecompiledHeaderThrough="yake/plugins/physicsODE/yakePCH.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="3"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="ode.lib physics.lib"
+				OutputFile="$(OutDir)/$(ProjectName).dll"
+				LinkIncremental="1"
+				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/ode/lib;../../../../dependencies/lib"
+				GenerateDebugInformation="false"
+				SubSystem="2"
+				OptimizeReferences="2"
+				EnableCOMDATFolding="2"
+				ImportLibrary="../../../../common/lib/release/$(TargetName).lib"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+	</Configurations>
+	<References>
+	</References>
+	<Files>
+		<Filter
+			Name="src"
+			Filter="cpp;c;cxx;def;odl;idl;hpj;bat;asm;asmx"
+			UniqueIdentifier="{C32CAEC8-F86A-4f69-9F85-D0905FAC6B9F}"
+			>
+			<File
+				RelativePath="..\..\..\..\src\yapp\plugins\terrainPhysMgr\TerrainOdeActor.cpp"
+				>
+			</File>
+			<File
+				RelativePath="..\..\..\..\src\yapp\plugins\terrainPhysMgr\TerrainPhysicsManager.cpp"
+				>
+			</File>
+		</Filter>
+		<Filter
+			Name="inc"
+			Filter="h;hpp;hxx;hm;inl;inc;xsd"
+			UniqueIdentifier="{A1820E11-8F2E-42b8-9DA5-29CC46F7C651}"
+			>
+			<File
+				RelativePath="..\..\..\..\yapp\plugins\terrainPhysMgr\TerrainOdeActor.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\..\..\yapp\plugins\terrainPhysMgr\TerrainOdePrerequisites.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\..\..\yapp\plugins\terrainPhysMgr\TerrainOdeShape.h"
+				>
+			</File>
+			<File
+				RelativePath="..\..\..\..\yapp\plugins\terrainPhysMgr\TerrainPhysicsManager.h"
+				>
+			</File>
+		</Filter>
+	</Files>
+	<Globals>
+	</Globals>
+</VisualStudioProject>

Added: trunk/yake/scripts/msvc8/samples/physics/samplePhysicsPagingTerrain.vcproj
===================================================================
--- trunk/yake/scripts/msvc8/samples/physics/samplePhysicsPagingTerrain.vcproj	2006-03-19 22:31:21 UTC (rev 1312)
+++ trunk/yake/scripts/msvc8/samples/physics/samplePhysicsPagingTerrain.vcproj	2006-03-19 22:32:30 UTC (rev 1313)
@@ -0,0 +1,208 @@
+<?xml version="1.0" encoding="Windows-1252"?>
+<VisualStudioProject
+	ProjectType="Visual C++"
+	Version="8,00"
+	Name="samplePhysicsPagingTerrain"
+	ProjectGUID="{1DDC8FAB-4D08-45B1-AFBC-47DED1B16C11}"
+	Keyword="Win32Proj"
+	>
+	<Platforms>
+		<Platform
+			Name="Win32"
+		/>
+	</Platforms>
+	<ToolFiles>
+	</ToolFiles>
+	<Configurations>
+		<Configuration
+			Name="Debug|Win32"
+			OutputDirectory="../../../../common/bin/debug"
+			IntermediateDirectory="../../../../common/obj/debug/$(ProjectName)"
+			ConfigurationType="1"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				Optimization="0"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/;../../../../dependencies/ogrenew/ogremain/include;../../../..\dependencies\ogreaddons\paginglandscape\PlugIns\PagingLandScape2\include;../../../../dependencies/ode/include"
+				PreprocessorDefinitions="_STLP_DEBUG;WIN32;_DEBUG;_CONSOLE"
+				MinimalRebuild="true"
+				BasicRuntimeChecks="3"
+				RuntimeLibrary="3"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="2"
+				PrecompiledHeaderThrough="yake/samples/physics/demo/pch.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="4"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib data.lib input.lib graphics.lib graphicsOgre.lib audio.lib physics.lib Plugin_PagingLandScapeSceneManager2_d.lib terrainPhysMgr.lib  ogremain_d.lib"
+				OutputFile="$(OutDir)/$(ProjectName).exe"
+				LinkIncremental="2"
+				AdditionalLibraryDirectories="&quot;../../../../common/lib/$(ConfigurationName)&quot;;../../../../dependencies/lib;&quot;../../../../dependencies/ogreaddons/paginglandscape/plugins/paginglandscape2/bin/$(ConfigurationName)&quot;;&quot;../../../../dependencies/ogrenew/ogremain/lib/$(ConfigurationName)&quot;"
+				GenerateDebugInformation="true"
+				ProgramDatabaseFile="$(OutDir)/$(ProjectName).pdb"
+				SubSystem="1"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+		<Configuration
+			Name="Release|Win32"
+			OutputDirectory="../../../../common/bin/release"
+			IntermediateDirectory="../../../../common/obj/release/$(ProjectName)"
+			ConfigurationType="1"
+			InheritedPropertySheets="$(VCInstallDir)VCProjectDefaults\UpgradeFromVC71.vsprops"
+			CharacterSet="2"
+			>
+			<Tool
+				Name="VCPreBuildEventTool"
+			/>
+			<Tool
+				Name="VCCustomBuildTool"
+			/>
+			<Tool
+				Name="VCXMLDataGeneratorTool"
+			/>
+			<Tool
+				Name="VCWebServiceProxyGeneratorTool"
+			/>
+			<Tool
+				Name="VCMIDLTool"
+			/>
+			<Tool
+				Name="VCCLCompilerTool"
+				AdditionalIncludeDirectories="../../../../;../../../../dependencies/boost/;../../../../dependencies/ttl/"
+				PreprocessorDefinitions="WIN32;NDEBUG;_CONSOLE"
+				RuntimeLibrary="2"
+				RuntimeTypeInfo="true"
+				UsePrecompiledHeader="2"
+				PrecompiledHeaderThrough="yake/samples/physics/demo/pch.h"
+				WarningLevel="3"
+				Detect64BitPortabilityProblems="true"
+				DebugInformationFormat="3"
+			/>
+			<Tool
+				Name="VCManagedResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCResourceCompilerTool"
+			/>
+			<Tool
+				Name="VCPreLinkEventTool"
+			/>
+			<Tool
+				Name="VCLinkerTool"
+				AdditionalDependencies="base.lib data.lib input.lib graphics.lib audio.lib physics.lib"
+				OutputFile="$(OutDir)/$(ProjectName).exe"
+				LinkIncremental="1"
+				AdditionalLibraryDirectories="../../../../common/lib/release;../../../../dependencies/lib"
+				GenerateDebugInformation="false"
+				SubSystem="1"
+				OptimizeReferences="2"
+				EnableCOMDATFolding="2"
+				TargetMachine="1"
+			/>
+			<Tool
+				Name="VCALinkTool"
+			/>
+			<Tool
+				Name="VCManifestTool"
+			/>
+			<Tool
+				Name="VCXDCMakeTool"
+			/>
+			<Tool
+				Name="VCBscMakeTool"
+			/>
+			<Tool
+				Name="VCFxCopTool"
+			/>
+			<Tool
+				Name="VCAppVerifierTool"
+			/>
+			<Tool
+				Name="VCWebDeploymentTool"
+			/>
+			<Tool
+				Name="VCPostBuildEventTool"
+			/>
+		</Configuration>
+	</Configurations>
+	<References>
+	</References>
+	<Files>
+		<Filter
+			Name="inc"
+			>
+		</Filter>
+		<Filter
+			Name="src"
+			>
+			<File
+				RelativePath="..\..\..\..\src\yapp\samples\physics\paging_terrain\yakeDemo.cpp"
+				>
+				<FileConfiguration
+					Name="Debug|Win32"
+					>
+					<Tool
+						Name="VCCLCompilerTool"
+						UsePrecompiledHeader="0"
+					/>
+				</FileConfiguration>
+			</File>
+		</Filter>
+	</Files>
+	<Globals>
+	</Globals>
+</VisualStudioProject>

Modified: trunk/yake/scripts/msvc8/yake.sln
===================================================================
--- trunk/yake/scripts/msvc8/yake.sln	2006-03-19 22:31:21 UTC (rev 1312)
+++ trunk/yake/scripts/msvc8/yake.sln	2006-03-19 22:32:30 UTC (rev 1313)
@@ -9,8 +9,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "graphicsOGRE", "plugins\graphics\graphicsOgre.vcproj", "{A2C2A0B2-2EB0-4254-891D-FE93466809CF}"
 	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "physics", "physics.vcproj", "{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}"
@@ -20,8 +20,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "physicsODE", "plugins\physics\physicsODE.vcproj", "{2F5124AA-56BD-4909-811A-E79901978C86}"
 	ProjectSection(ProjectDependencies) = postProject
-		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
 		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
+		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "input", "input.vcproj", "{1AF3930A-4E72-4455-AFD0-6B78684105CD}"
@@ -31,8 +31,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "inputOGRE", "plugins\input\inputOgre.vcproj", "{A1A2FE19-7B7E-42F1-808B-8FA5B6AA697E}"
 	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 		{1AF3930A-4E72-4455-AFD0-6B78684105CD} = {1AF3930A-4E72-4455-AFD0-6B78684105CD}
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "scripting", "scripting.vcproj", "{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}"
@@ -42,8 +42,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "scriptingLua", "plugins\scripting\scriptingLua.vcproj", "{41CEA11B-9678-43E5-B2F4-754944D7B461}"
 	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "data", "data.vcproj", "{77A59B89-C2B3-429C-8317-ADE0D046CC3B}"
@@ -53,8 +53,8 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "scriptingBindingsLua", "plugins\scripting\scriptingLuaBindings.vcproj", "{CA63F621-0912-4551-B51A-7BD18F491181}"
 	ProjectSection(ProjectDependencies) = postProject
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 		{41CEA11B-9678-43E5-B2F4-754944D7B461} = {41CEA11B-9678-43E5-B2F4-754944D7B461}
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "audio", "audio.vcproj", "{42BB6F78-B04C-4968-AA5E-271DC45BEFBB}"
@@ -74,34 +74,32 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "graphicsBindingsLua", "plugins\scripting\graphicsLuaBindings.vcproj", "{2D5E8A7F-96DA-4CC5-BFC8-430916ACF18A}"
 	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
-		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
 		{41CEA11B-9678-43E5-B2F4-754944D7B461} = {41CEA11B-9678-43E5-B2F4-754944D7B461}
+		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "baseBindingsLua", "plugins\scripting\baseLuaBindings.vcproj", "{3867E9A4-41F3-4969-B0A8-40757BCB6C29}"
 	ProjectSection(ProjectDependencies) = postProject
-		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 		{41CEA11B-9678-43E5-B2F4-754944D7B461} = {41CEA11B-9678-43E5-B2F4-754944D7B461}
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
+		{D29771DD-715F-452B-B71C-911BACF5956D} = {D29771DD-715F-452B-B71C-911BACF5956D}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "yapp", "yapp.vcproj", "{F1116FDF-65C1-4788-AC1F-F339279B937A}"
 	ProjectSection(ProjectDependencies) = postProject
-		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
-		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
-		{42BB6F78-B04C-4968-AA5E-271DC45BEFBB} = {42BB6F78-B04C-4968-AA5E-271DC45BEFBB}
-		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
 		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
+		{ECC8FA24-93AC-4659-8EBD-26B6F418AC64} = {ECC8FA24-93AC-4659-8EBD-26B6F418AC64}
+		{42BB6F78-B04C-4968-AA5E-271DC45BEFBB} = {42BB6F78-B04C-4968-AA5E-271DC45BEFBB}
+		{77A59B89-C2B3-429C-8317-ADE0D046CC3B} = {77A59B89-C2B3-429C-8317-ADE0D046CC3B}
+		{8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03} = {8A16CDB5-B272-49AD-AF22-B8FD0E5E1A03}
 	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "raf", "raf.vcproj", "{6D6DD5E8-3B81-4C98-B460-B434DEE23EE2}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "msg", "msg.vcproj", "{7EB6A55E-D262-4C82-862C-33E831DDF04C}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "entCommon", "plugins\ent\entCommon.vcproj", "{9E975777-551F-45F8-85FD-40BE6B0183A4}"
-EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "ceguiOgreRendererAdapter", "plugins\gui\ceguiOgreRendererAdapter.vcproj", "{526DC299-3C9B-46ED-8C16-0490AE5CAE88}"
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "modelLua", "plugins\model\modelLua.vcproj", "{8150E623-2456-4152-AC96-D302B1CFF6E9}"
@@ -124,7 +122,11 @@
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "ent", "ent.vcproj", "{08BC40D8-33D8-4677-993A-32599A93A460}"
 EndProject
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "sampleMsg1", "samples\msg\sampleMsg1.vcproj", "{452438E8-F03B-47B9-984B-2CF79D2F6734}"
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "terrainPhysMgr", "plugins\physics\terrainPhysMgr.vcproj", "{6FC81A1C-0463-45EB-94F9-F7D084E3C169}"
+	ProjectSection(ProjectDependencies) = postProject
+		{1C674F1C-7DDF-4AC5-A52A-14C31248A9D4} = {1C674F1C-7DDF-4AC5-A52A-14C31248A9D4}
+		{2F5124AA-56BD-4909-811A-E79901978C86} = {2F5124AA-56BD-4909-811A-E79901978C86}
+	EndProjectSection
 EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) = preSolution
@@ -206,10 +208,6 @@
 		{7EB6A55E-D262-4C82-862C-33E831DDF04C}.Debug|Win32.Build.0 = Debug|Win32
 		{7EB6A55E-D262-4C82-862C-33E831DDF04C}.Release|Win32.ActiveCfg = Release|Win32
 		{7EB6A55E-D262-4C82-862C-33E831DDF04C}.Release|Win32.Build.0 = Release|Win32
-		{9E975777-551F-45F8-85FD-40BE6B0183A4}.Debug|Win32.ActiveCfg = Debug|Win32
-		{9E975777-551F-45F8-85FD-40BE6B0183A4}.Debug|Win32.Build.0 = Debug|Win32
-		{9E975777-551F-45F8-85FD-40BE6B0183A4}.Release|Win32.ActiveCfg = Release|Win32
-		{9E975777-551F-45F8-85FD-40BE6B0183A4}.Release|Win32.Build.0 = Release|Win32
 		{526DC299-3C9B-46ED-8C16-0490AE5CAE88}.Debug|Win32.ActiveCfg = Debug|Win32
 		{526DC299-3C9B-46ED-8C16-0490AE5CAE88}.Debug|Win32.Build.0 = Debug|Win32
 		{526DC299-3C9B-46ED-8C16-0490AE5CAE88}.Release|Win32.ActiveCfg = Release|Win32
@@ -242,10 +240,10 @@
 		{08BC40D8-33D8-4677-993A-32599A93A460}.Debug|Win32.Build.0 = Debug|Win32
 		{08BC40D8-33D8-4677-993A-32599A93A460}.Release|Win32.ActiveCfg = Release|Win32
 		{08BC40D8-33D8-4677-993A-32599A93A460}.Release|Win32.Build.0 = Release|Win32
-		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Debug|Win32.ActiveCfg = Debug|Win32
-		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Debug|Win32.Build.0 = Debug|Win32
-		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Release|Win32.ActiveCfg = Release|Win32
-		{452438E8-F03B-47B9-984B-2CF79D2F6734}.Release|Win32.Build.0 = Release|Win32
+		{6FC81A1C-0463-45EB-94F9-F7D084E3C169}.Debug|Win32.ActiveCfg = Debug|Win32
+		{6FC81A1C-0463-45EB-94F9-F7D084E3C169}.Debug|Win32.Build.0 = Debug|Win32
+		{6FC81A1C-0463-45EB-94F9-F7D084E3C169}.Release|Win32.ActiveCfg = Release|Win32
+		{6FC81A1C-0463-45EB-94F9-F7D084E3C169}.Release|Win32.Build.0 = Release|Win32
 	EndGlobalSection
 	GlobalSection(SolutionProperties) = preSolution
 		HideSolutionNode = FALSE



